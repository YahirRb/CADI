var ky=Object.defineProperty;var vy=(g,e,I)=>e in g?ky(g,e,{enumerable:!0,configurable:!0,writable:!0,value:I}):g[e]=I;var Cn=(g,e,I)=>vy(g,typeof e!="symbol"?e+"":e,I);function Pb(g,e){for(var I=0;I<e.length;I++){const t=e[I];if(typeof t!="string"&&!Array.isArray(t)){for(const C in t)if(C!=="default"&&!(C in g)){const l=Object.getOwnPropertyDescriptor(t,C);l&&Object.defineProperty(g,C,l.get?l:{enumerable:!0,get:()=>t[C]})}}}return Object.freeze(Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))t(C);new MutationObserver(C=>{for(const l of C)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&t(n)}).observe(document,{childList:!0,subtree:!0});function I(C){const l={};return C.integrity&&(l.integrity=C.integrity),C.referrerPolicy&&(l.referrerPolicy=C.referrerPolicy),C.crossOrigin==="use-credentials"?l.credentials="include":C.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function t(C){if(C.ep)return;C.ep=!0;const l=I(C);fetch(C.href,l)}})();function Ka(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var Ob={exports:{}},xa={},qb={exports:{}},Xg={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wo=Symbol.for("react.element"),Yy=Symbol.for("react.portal"),Hy=Symbol.for("react.fragment"),wy=Symbol.for("react.strict_mode"),Ny=Symbol.for("react.profiler"),Fy=Symbol.for("react.provider"),Ky=Symbol.for("react.context"),xy=Symbol.for("react.forward_ref"),Ey=Symbol.for("react.suspense"),zy=Symbol.for("react.memo"),My=Symbol.for("react.lazy"),vu=Symbol.iterator;function Uy(g){return g===null||typeof g!="object"?null:(g=vu&&g[vu]||g["@@iterator"],typeof g=="function"?g:null)}var $b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_b=Object.assign,gG={};function Dl(g,e,I){this.props=g,this.context=e,this.refs=gG,this.updater=I||$b}Dl.prototype.isReactComponent={};Dl.prototype.setState=function(g,e){if(typeof g!="object"&&typeof g!="function"&&g!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,g,e,"setState")};Dl.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")};function eG(){}eG.prototype=Dl.prototype;function YA(g,e,I){this.props=g,this.context=e,this.refs=gG,this.updater=I||$b}var HA=YA.prototype=new eG;HA.constructor=YA;_b(HA,Dl.prototype);HA.isPureReactComponent=!0;var Yu=Array.isArray,IG=Object.prototype.hasOwnProperty,wA={current:null},tG={key:!0,ref:!0,__self:!0,__source:!0};function CG(g,e,I){var t,C={},l=null,n=null;if(e!=null)for(t in e.ref!==void 0&&(n=e.ref),e.key!==void 0&&(l=""+e.key),e)IG.call(e,t)&&!tG.hasOwnProperty(t)&&(C[t]=e[t]);var o=arguments.length-2;if(o===1)C.children=I;else if(1<o){for(var r=Array(o),a=0;a<o;a++)r[a]=arguments[a+2];C.children=r}if(g&&g.defaultProps)for(t in o=g.defaultProps,o)C[t]===void 0&&(C[t]=o[t]);return{$$typeof:Wo,type:g,key:l,ref:n,props:C,_owner:wA.current}}function Ly(g,e){return{$$typeof:Wo,type:g.type,key:e,ref:g.ref,props:g.props,_owner:g._owner}}function NA(g){return typeof g=="object"&&g!==null&&g.$$typeof===Wo}function Qy(g){var e={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,function(I){return e[I]})}var Hu=/\/+/g;function Zs(g,e){return typeof g=="object"&&g!==null&&g.key!=null?Qy(""+g.key):e.toString(36)}function Rr(g,e,I,t,C){var l=typeof g;(l==="undefined"||l==="boolean")&&(g=null);var n=!1;if(g===null)n=!0;else switch(l){case"string":case"number":n=!0;break;case"object":switch(g.$$typeof){case Wo:case Yy:n=!0}}if(n)return n=g,C=C(n),g=t===""?"."+Zs(n,0):t,Yu(C)?(I="",g!=null&&(I=g.replace(Hu,"$&/")+"/"),Rr(C,e,I,"",function(a){return a})):C!=null&&(NA(C)&&(C=Ly(C,I+(!C.key||n&&n.key===C.key?"":(""+C.key).replace(Hu,"$&/")+"/")+g)),e.push(C)),1;if(n=0,t=t===""?".":t+":",Yu(g))for(var o=0;o<g.length;o++){l=g[o];var r=t+Zs(l,o);n+=Rr(l,e,I,r,C)}else if(r=Uy(g),typeof r=="function")for(g=r.call(g),o=0;!(l=g.next()).done;)l=l.value,r=t+Zs(l,o++),n+=Rr(l,e,I,r,C);else if(l==="object")throw e=String(g),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return n}function er(g,e,I){if(g==null)return g;var t=[],C=0;return Rr(g,t,"","",function(l){return e.call(I,l,C++)}),t}function Ty(g){if(g._status===-1){var e=g._result;e=e(),e.then(function(I){(g._status===0||g._status===-1)&&(g._status=1,g._result=I)},function(I){(g._status===0||g._status===-1)&&(g._status=2,g._result=I)}),g._status===-1&&(g._status=0,g._result=e)}if(g._status===1)return g._result.default;throw g._result}var II={current:null},fr={transition:null},Dy={ReactCurrentDispatcher:II,ReactCurrentBatchConfig:fr,ReactCurrentOwner:wA};function lG(){throw Error("act(...) is not supported in production builds of React.")}Xg.Children={map:er,forEach:function(g,e,I){er(g,function(){e.apply(this,arguments)},I)},count:function(g){var e=0;return er(g,function(){e++}),e},toArray:function(g){return er(g,function(e){return e})||[]},only:function(g){if(!NA(g))throw Error("React.Children.only expected to receive a single React element child.");return g}};Xg.Component=Dl;Xg.Fragment=Hy;Xg.Profiler=Ny;Xg.PureComponent=YA;Xg.StrictMode=wy;Xg.Suspense=Ey;Xg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dy;Xg.act=lG;Xg.cloneElement=function(g,e,I){if(g==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+g+".");var t=_b({},g.props),C=g.key,l=g.ref,n=g._owner;if(e!=null){if(e.ref!==void 0&&(l=e.ref,n=wA.current),e.key!==void 0&&(C=""+e.key),g.type&&g.type.defaultProps)var o=g.type.defaultProps;for(r in e)IG.call(e,r)&&!tG.hasOwnProperty(r)&&(t[r]=e[r]===void 0&&o!==void 0?o[r]:e[r])}var r=arguments.length-2;if(r===1)t.children=I;else if(1<r){o=Array(r);for(var a=0;a<r;a++)o[a]=arguments[a+2];t.children=o}return{$$typeof:Wo,type:g.type,key:C,ref:l,props:t,_owner:n}};Xg.createContext=function(g){return g={$$typeof:Ky,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},g.Provider={$$typeof:Fy,_context:g},g.Consumer=g};Xg.createElement=CG;Xg.createFactory=function(g){var e=CG.bind(null,g);return e.type=g,e};Xg.createRef=function(){return{current:null}};Xg.forwardRef=function(g){return{$$typeof:xy,render:g}};Xg.isValidElement=NA;Xg.lazy=function(g){return{$$typeof:My,_payload:{_status:-1,_result:g},_init:Ty}};Xg.memo=function(g,e){return{$$typeof:zy,type:g,compare:e===void 0?null:e}};Xg.startTransition=function(g){var e=fr.transition;fr.transition={};try{g()}finally{fr.transition=e}};Xg.unstable_act=lG;Xg.useCallback=function(g,e){return II.current.useCallback(g,e)};Xg.useContext=function(g){return II.current.useContext(g)};Xg.useDebugValue=function(){};Xg.useDeferredValue=function(g){return II.current.useDeferredValue(g)};Xg.useEffect=function(g,e){return II.current.useEffect(g,e)};Xg.useId=function(){return II.current.useId()};Xg.useImperativeHandle=function(g,e,I){return II.current.useImperativeHandle(g,e,I)};Xg.useInsertionEffect=function(g,e){return II.current.useInsertionEffect(g,e)};Xg.useLayoutEffect=function(g,e){return II.current.useLayoutEffect(g,e)};Xg.useMemo=function(g,e){return II.current.useMemo(g,e)};Xg.useReducer=function(g,e,I){return II.current.useReducer(g,e,I)};Xg.useRef=function(g){return II.current.useRef(g)};Xg.useState=function(g){return II.current.useState(g)};Xg.useSyncExternalStore=function(g,e,I){return II.current.useSyncExternalStore(g,e,I)};Xg.useTransition=function(){return II.current.useTransition()};Xg.version="18.3.1";qb.exports=Xg;var d=qb.exports;const tt=Ka(d),jr=Pb({__proto__:null,default:tt},[d]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jy=d,Py=Symbol.for("react.element"),Oy=Symbol.for("react.fragment"),qy=Object.prototype.hasOwnProperty,$y=jy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_y={key:!0,ref:!0,__self:!0,__source:!0};function nG(g,e,I){var t,C={},l=null,n=null;I!==void 0&&(l=""+I),e.key!==void 0&&(l=""+e.key),e.ref!==void 0&&(n=e.ref);for(t in e)qy.call(e,t)&&!_y.hasOwnProperty(t)&&(C[t]=e[t]);if(g&&g.defaultProps)for(t in e=g.defaultProps,e)C[t]===void 0&&(C[t]=e[t]);return{$$typeof:Py,type:g,key:l,ref:n,props:C,_owner:$y.current}}xa.Fragment=Oy;xa.jsx=nG;xa.jsxs=nG;Ob.exports=xa;var s=Ob.exports,oG={exports:{}},kI={},rG={exports:{}},aG={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(g){function e(Y,K){var O=Y.length;Y.push(K);g:for(;0<O;){var lg=O-1>>>1,ag=Y[lg];if(0<C(ag,K))Y[lg]=K,Y[O]=ag,O=lg;else break g}}function I(Y){return Y.length===0?null:Y[0]}function t(Y){if(Y.length===0)return null;var K=Y[0],O=Y.pop();if(O!==K){Y[0]=O;g:for(var lg=0,ag=Y.length,ig=ag>>>1;lg<ig;){var sg=2*(lg+1)-1,eg=Y[sg],q=sg+1,E=Y[q];if(0>C(eg,O))q<ag&&0>C(E,eg)?(Y[lg]=E,Y[q]=O,lg=q):(Y[lg]=eg,Y[sg]=O,lg=sg);else if(q<ag&&0>C(E,O))Y[lg]=E,Y[q]=O,lg=q;else break g}}return K}function C(Y,K){var O=Y.sortIndex-K.sortIndex;return O!==0?O:Y.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;g.unstable_now=function(){return l.now()}}else{var n=Date,o=n.now();g.unstable_now=function(){return n.now()-o}}var r=[],a=[],i=1,c=null,A=3,p=!1,G=!1,Z=!1,h=typeof setTimeout=="function"?setTimeout:null,u=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(Y){for(var K=I(a);K!==null;){if(K.callback===null)t(a);else if(K.startTime<=Y)t(a),K.sortIndex=K.expirationTime,e(r,K);else break;K=I(a)}}function B(Y){if(Z=!1,m(Y),!G)if(I(r)!==null)G=!0,L(W);else{var K=I(a);K!==null&&D(B,K.startTime-Y)}}function W(Y,K){G=!1,Z&&(Z=!1,u(S),S=-1),p=!0;var O=A;try{for(m(K),c=I(r);c!==null&&(!(c.expirationTime>K)||Y&&!k());){var lg=c.callback;if(typeof lg=="function"){c.callback=null,A=c.priorityLevel;var ag=lg(c.expirationTime<=K);K=g.unstable_now(),typeof ag=="function"?c.callback=ag:c===I(r)&&t(r),m(K)}else t(r);c=I(r)}if(c!==null)var ig=!0;else{var sg=I(a);sg!==null&&D(B,sg.startTime-K),ig=!1}return ig}finally{c=null,A=O,p=!1}}var R=!1,V=null,S=-1,y=5,f=-1;function k(){return!(g.unstable_now()-f<y)}function H(){if(V!==null){var Y=g.unstable_now();f=Y;var K=!0;try{K=V(!0,Y)}finally{K?M():(R=!1,V=null)}}else R=!1}var M;if(typeof b=="function")M=function(){b(H)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,x=F.port2;F.port1.onmessage=H,M=function(){x.postMessage(null)}}else M=function(){h(H,0)};function L(Y){V=Y,R||(R=!0,M())}function D(Y,K){S=h(function(){Y(g.unstable_now())},K)}g.unstable_IdlePriority=5,g.unstable_ImmediatePriority=1,g.unstable_LowPriority=4,g.unstable_NormalPriority=3,g.unstable_Profiling=null,g.unstable_UserBlockingPriority=2,g.unstable_cancelCallback=function(Y){Y.callback=null},g.unstable_continueExecution=function(){G||p||(G=!0,L(W))},g.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<Y?Math.floor(1e3/Y):5},g.unstable_getCurrentPriorityLevel=function(){return A},g.unstable_getFirstCallbackNode=function(){return I(r)},g.unstable_next=function(Y){switch(A){case 1:case 2:case 3:var K=3;break;default:K=A}var O=A;A=K;try{return Y()}finally{A=O}},g.unstable_pauseExecution=function(){},g.unstable_requestPaint=function(){},g.unstable_runWithPriority=function(Y,K){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var O=A;A=Y;try{return K()}finally{A=O}},g.unstable_scheduleCallback=function(Y,K,O){var lg=g.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?lg+O:lg):O=lg,Y){case 1:var ag=-1;break;case 2:ag=250;break;case 5:ag=1073741823;break;case 4:ag=1e4;break;default:ag=5e3}return ag=O+ag,Y={id:i++,callback:K,priorityLevel:Y,startTime:O,expirationTime:ag,sortIndex:-1},O>lg?(Y.sortIndex=O,e(a,Y),I(r)===null&&Y===I(a)&&(Z?(u(S),S=-1):Z=!0,D(B,O-lg))):(Y.sortIndex=ag,e(r,Y),G||p||(G=!0,L(W))),Y},g.unstable_shouldYield=k,g.unstable_wrapCallback=function(Y){var K=A;return function(){var O=A;A=K;try{return Y.apply(this,arguments)}finally{A=O}}}})(aG);rG.exports=aG;var gB=rG.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eB=d,XI=gB;function T(g){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+g,I=1;I<arguments.length;I++)e+="&args[]="+encodeURIComponent(arguments[I]);return"Minified React error #"+g+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iG=new Set,jn={};function jC(g,e){vl(g,e),vl(g+"Capture",e)}function vl(g,e){for(jn[g]=e,g=0;g<e.length;g++)iG.add(e[g])}var xt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sc=Object.prototype.hasOwnProperty,IB=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wu={},Nu={};function tB(g){return sc.call(Nu,g)?!0:sc.call(wu,g)?!1:IB.test(g)?Nu[g]=!0:(wu[g]=!0,!1)}function CB(g,e,I,t){if(I!==null&&I.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return t?!1:I!==null?!I.acceptsBooleans:(g=g.toLowerCase().slice(0,5),g!=="data-"&&g!=="aria-");default:return!1}}function lB(g,e,I,t){if(e===null||typeof e>"u"||CB(g,e,I,t))return!0;if(t)return!1;if(I!==null)switch(I.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function tI(g,e,I,t,C,l,n){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=t,this.attributeNamespace=C,this.mustUseProperty=I,this.propertyName=g,this.type=e,this.sanitizeURL=l,this.removeEmptyString=n}var ze={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(g){ze[g]=new tI(g,0,!1,g,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(g){var e=g[0];ze[e]=new tI(e,1,!1,g[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(g){ze[g]=new tI(g,2,!1,g.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(g){ze[g]=new tI(g,2,!1,g,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(g){ze[g]=new tI(g,3,!1,g.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(g){ze[g]=new tI(g,3,!0,g,null,!1,!1)});["capture","download"].forEach(function(g){ze[g]=new tI(g,4,!1,g,null,!1,!1)});["cols","rows","size","span"].forEach(function(g){ze[g]=new tI(g,6,!1,g,null,!1,!1)});["rowSpan","start"].forEach(function(g){ze[g]=new tI(g,5,!1,g.toLowerCase(),null,!1,!1)});var FA=/[\-:]([a-z])/g;function KA(g){return g[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(g){var e=g.replace(FA,KA);ze[e]=new tI(e,1,!1,g,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(g){var e=g.replace(FA,KA);ze[e]=new tI(e,1,!1,g,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(g){var e=g.replace(FA,KA);ze[e]=new tI(e,1,!1,g,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(g){ze[g]=new tI(g,1,!1,g.toLowerCase(),null,!1,!1)});ze.xlinkHref=new tI("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(g){ze[g]=new tI(g,1,!1,g.toLowerCase(),null,!0,!0)});function xA(g,e,I,t){var C=ze.hasOwnProperty(e)?ze[e]:null;(C!==null?C.type!==0:t||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(lB(e,I,C,t)&&(I=null),t||C===null?tB(e)&&(I===null?g.removeAttribute(e):g.setAttribute(e,""+I)):C.mustUseProperty?g[C.propertyName]=I===null?C.type===3?!1:"":I:(e=C.attributeName,t=C.attributeNamespace,I===null?g.removeAttribute(e):(C=C.type,I=C===3||C===4&&I===!0?"":""+I,t?g.setAttributeNS(t,e,I):g.setAttribute(e,I))))}var Lt=eB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ir=Symbol.for("react.element"),il=Symbol.for("react.portal"),sl=Symbol.for("react.fragment"),EA=Symbol.for("react.strict_mode"),cc=Symbol.for("react.profiler"),sG=Symbol.for("react.provider"),cG=Symbol.for("react.context"),zA=Symbol.for("react.forward_ref"),Ac=Symbol.for("react.suspense"),dc=Symbol.for("react.suspense_list"),MA=Symbol.for("react.memo"),$t=Symbol.for("react.lazy"),AG=Symbol.for("react.offscreen"),Fu=Symbol.iterator;function ln(g){return g===null||typeof g!="object"?null:(g=Fu&&g[Fu]||g["@@iterator"],typeof g=="function"?g:null)}var ie=Object.assign,bs;function Wn(g){if(bs===void 0)try{throw Error()}catch(I){var e=I.stack.trim().match(/\n( *(at )?)/);bs=e&&e[1]||""}return`
`+bs+g}var Gs=!1;function ps(g,e){if(!g||Gs)return"";Gs=!0;var I=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(a){var t=a}Reflect.construct(g,[],e)}else{try{e.call()}catch(a){t=a}g.call(e.prototype)}else{try{throw Error()}catch(a){t=a}g()}}catch(a){if(a&&t&&typeof a.stack=="string"){for(var C=a.stack.split(`
`),l=t.stack.split(`
`),n=C.length-1,o=l.length-1;1<=n&&0<=o&&C[n]!==l[o];)o--;for(;1<=n&&0<=o;n--,o--)if(C[n]!==l[o]){if(n!==1||o!==1)do if(n--,o--,0>o||C[n]!==l[o]){var r=`
`+C[n].replace(" at new "," at ");return g.displayName&&r.includes("<anonymous>")&&(r=r.replace("<anonymous>",g.displayName)),r}while(1<=n&&0<=o);break}}}finally{Gs=!1,Error.prepareStackTrace=I}return(g=g?g.displayName||g.name:"")?Wn(g):""}function nB(g){switch(g.tag){case 5:return Wn(g.type);case 16:return Wn("Lazy");case 13:return Wn("Suspense");case 19:return Wn("SuspenseList");case 0:case 2:case 15:return g=ps(g.type,!1),g;case 11:return g=ps(g.type.render,!1),g;case 1:return g=ps(g.type,!0),g;default:return""}}function uc(g){if(g==null)return null;if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g;switch(g){case sl:return"Fragment";case il:return"Portal";case cc:return"Profiler";case EA:return"StrictMode";case Ac:return"Suspense";case dc:return"SuspenseList"}if(typeof g=="object")switch(g.$$typeof){case cG:return(g.displayName||"Context")+".Consumer";case sG:return(g._context.displayName||"Context")+".Provider";case zA:var e=g.render;return g=g.displayName,g||(g=e.displayName||e.name||"",g=g!==""?"ForwardRef("+g+")":"ForwardRef"),g;case MA:return e=g.displayName||null,e!==null?e:uc(g.type)||"Memo";case $t:e=g._payload,g=g._init;try{return uc(g(e))}catch{}}return null}function oB(g){var e=g.type;switch(g.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=e.render,g=g.displayName||g.name||"",e.displayName||(g!==""?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return uc(e);case 8:return e===EA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function cC(g){switch(typeof g){case"boolean":case"number":case"string":case"undefined":return g;case"object":return g;default:return""}}function dG(g){var e=g.type;return(g=g.nodeName)&&g.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rB(g){var e=dG(g)?"checked":"value",I=Object.getOwnPropertyDescriptor(g.constructor.prototype,e),t=""+g[e];if(!g.hasOwnProperty(e)&&typeof I<"u"&&typeof I.get=="function"&&typeof I.set=="function"){var C=I.get,l=I.set;return Object.defineProperty(g,e,{configurable:!0,get:function(){return C.call(this)},set:function(n){t=""+n,l.call(this,n)}}),Object.defineProperty(g,e,{enumerable:I.enumerable}),{getValue:function(){return t},setValue:function(n){t=""+n},stopTracking:function(){g._valueTracker=null,delete g[e]}}}}function tr(g){g._valueTracker||(g._valueTracker=rB(g))}function uG(g){if(!g)return!1;var e=g._valueTracker;if(!e)return!0;var I=e.getValue(),t="";return g&&(t=dG(g)?g.checked?"true":"false":g.value),g=t,g!==I?(e.setValue(g),!0):!1}function Pr(g){if(g=g||(typeof document<"u"?document:void 0),typeof g>"u")return null;try{return g.activeElement||g.body}catch{return g.body}}function mc(g,e){var I=e.checked;return ie({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:I??g._wrapperState.initialChecked})}function Ku(g,e){var I=e.defaultValue==null?"":e.defaultValue,t=e.checked!=null?e.checked:e.defaultChecked;I=cC(e.value!=null?e.value:I),g._wrapperState={initialChecked:t,initialValue:I,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mG(g,e){e=e.checked,e!=null&&xA(g,"checked",e,!1)}function Zc(g,e){mG(g,e);var I=cC(e.value),t=e.type;if(I!=null)t==="number"?(I===0&&g.value===""||g.value!=I)&&(g.value=""+I):g.value!==""+I&&(g.value=""+I);else if(t==="submit"||t==="reset"){g.removeAttribute("value");return}e.hasOwnProperty("value")?bc(g,e.type,I):e.hasOwnProperty("defaultValue")&&bc(g,e.type,cC(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(g.defaultChecked=!!e.defaultChecked)}function xu(g,e,I){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var t=e.type;if(!(t!=="submit"&&t!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+g._wrapperState.initialValue,I||e===g.value||(g.value=e),g.defaultValue=e}I=g.name,I!==""&&(g.name=""),g.defaultChecked=!!g._wrapperState.initialChecked,I!==""&&(g.name=I)}function bc(g,e,I){(e!=="number"||Pr(g.ownerDocument)!==g)&&(I==null?g.defaultValue=""+g._wrapperState.initialValue:g.defaultValue!==""+I&&(g.defaultValue=""+I))}var Vn=Array.isArray;function Sl(g,e,I,t){if(g=g.options,e){e={};for(var C=0;C<I.length;C++)e["$"+I[C]]=!0;for(I=0;I<g.length;I++)C=e.hasOwnProperty("$"+g[I].value),g[I].selected!==C&&(g[I].selected=C),C&&t&&(g[I].defaultSelected=!0)}else{for(I=""+cC(I),e=null,C=0;C<g.length;C++){if(g[C].value===I){g[C].selected=!0,t&&(g[C].defaultSelected=!0);return}e!==null||g[C].disabled||(e=g[C])}e!==null&&(e.selected=!0)}}function Gc(g,e){if(e.dangerouslySetInnerHTML!=null)throw Error(T(91));return ie({},e,{value:void 0,defaultValue:void 0,children:""+g._wrapperState.initialValue})}function Eu(g,e){var I=e.value;if(I==null){if(I=e.children,e=e.defaultValue,I!=null){if(e!=null)throw Error(T(92));if(Vn(I)){if(1<I.length)throw Error(T(93));I=I[0]}e=I}e==null&&(e=""),I=e}g._wrapperState={initialValue:cC(I)}}function ZG(g,e){var I=cC(e.value),t=cC(e.defaultValue);I!=null&&(I=""+I,I!==g.value&&(g.value=I),e.defaultValue==null&&g.defaultValue!==I&&(g.defaultValue=I)),t!=null&&(g.defaultValue=""+t)}function zu(g){var e=g.textContent;e===g._wrapperState.initialValue&&e!==""&&e!==null&&(g.value=e)}function bG(g){switch(g){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pc(g,e){return g==null||g==="http://www.w3.org/1999/xhtml"?bG(e):g==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":g}var Cr,GG=function(g){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,I,t,C){MSApp.execUnsafeLocalFunction(function(){return g(e,I,t,C)})}:g}(function(g,e){if(g.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in g)g.innerHTML=e;else{for(Cr=Cr||document.createElement("div"),Cr.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Cr.firstChild;g.firstChild;)g.removeChild(g.firstChild);for(;e.firstChild;)g.appendChild(e.firstChild)}});function Pn(g,e){if(e){var I=g.firstChild;if(I&&I===g.lastChild&&I.nodeType===3){I.nodeValue=e;return}}g.textContent=e}var Nn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aB=["Webkit","ms","Moz","O"];Object.keys(Nn).forEach(function(g){aB.forEach(function(e){e=e+g.charAt(0).toUpperCase()+g.substring(1),Nn[e]=Nn[g]})});function pG(g,e,I){return e==null||typeof e=="boolean"||e===""?"":I||typeof e!="number"||e===0||Nn.hasOwnProperty(g)&&Nn[g]?(""+e).trim():e+"px"}function hG(g,e){g=g.style;for(var I in e)if(e.hasOwnProperty(I)){var t=I.indexOf("--")===0,C=pG(I,e[I],t);I==="float"&&(I="cssFloat"),t?g.setProperty(I,C):g[I]=C}}var iB=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hc(g,e){if(e){if(iB[g]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(T(137,g));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(T(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(T(61))}if(e.style!=null&&typeof e.style!="object")throw Error(T(62))}}function yc(g,e){if(g.indexOf("-")===-1)return typeof e.is=="string";switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bc=null;function UA(g){return g=g.target||g.srcElement||window,g.correspondingUseElement&&(g=g.correspondingUseElement),g.nodeType===3?g.parentNode:g}var Sc=null,Wl=null,Vl=null;function Mu(g){if(g=fo(g)){if(typeof Sc!="function")throw Error(T(280));var e=g.stateNode;e&&(e=La(e),Sc(g.stateNode,g.type,e))}}function yG(g){Wl?Vl?Vl.push(g):Vl=[g]:Wl=g}function BG(){if(Wl){var g=Wl,e=Vl;if(Vl=Wl=null,Mu(g),e)for(g=0;g<e.length;g++)Mu(e[g])}}function SG(g,e){return g(e)}function WG(){}var hs=!1;function VG(g,e,I){if(hs)return g(e,I);hs=!0;try{return SG(g,e,I)}finally{hs=!1,(Wl!==null||Vl!==null)&&(WG(),BG())}}function On(g,e){var I=g.stateNode;if(I===null)return null;var t=La(I);if(t===null)return null;I=t[e];g:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(t=!t.disabled)||(g=g.type,t=!(g==="button"||g==="input"||g==="select"||g==="textarea")),g=!t;break g;default:g=!1}if(g)return null;if(I&&typeof I!="function")throw Error(T(231,e,typeof I));return I}var Wc=!1;if(xt)try{var nn={};Object.defineProperty(nn,"passive",{get:function(){Wc=!0}}),window.addEventListener("test",nn,nn),window.removeEventListener("test",nn,nn)}catch{Wc=!1}function sB(g,e,I,t,C,l,n,o,r){var a=Array.prototype.slice.call(arguments,3);try{e.apply(I,a)}catch(i){this.onError(i)}}var Fn=!1,Or=null,qr=!1,Vc=null,cB={onError:function(g){Fn=!0,Or=g}};function AB(g,e,I,t,C,l,n,o,r){Fn=!1,Or=null,sB.apply(cB,arguments)}function dB(g,e,I,t,C,l,n,o,r){if(AB.apply(this,arguments),Fn){if(Fn){var a=Or;Fn=!1,Or=null}else throw Error(T(198));qr||(qr=!0,Vc=a)}}function PC(g){var e=g,I=g;if(g.alternate)for(;e.return;)e=e.return;else{g=e;do e=g,e.flags&4098&&(I=e.return),g=e.return;while(g)}return e.tag===3?I:null}function RG(g){if(g.tag===13){var e=g.memoizedState;if(e===null&&(g=g.alternate,g!==null&&(e=g.memoizedState)),e!==null)return e.dehydrated}return null}function Uu(g){if(PC(g)!==g)throw Error(T(188))}function uB(g){var e=g.alternate;if(!e){if(e=PC(g),e===null)throw Error(T(188));return e!==g?null:g}for(var I=g,t=e;;){var C=I.return;if(C===null)break;var l=C.alternate;if(l===null){if(t=C.return,t!==null){I=t;continue}break}if(C.child===l.child){for(l=C.child;l;){if(l===I)return Uu(C),g;if(l===t)return Uu(C),e;l=l.sibling}throw Error(T(188))}if(I.return!==t.return)I=C,t=l;else{for(var n=!1,o=C.child;o;){if(o===I){n=!0,I=C,t=l;break}if(o===t){n=!0,t=C,I=l;break}o=o.sibling}if(!n){for(o=l.child;o;){if(o===I){n=!0,I=l,t=C;break}if(o===t){n=!0,t=l,I=C;break}o=o.sibling}if(!n)throw Error(T(189))}}if(I.alternate!==t)throw Error(T(190))}if(I.tag!==3)throw Error(T(188));return I.stateNode.current===I?g:e}function fG(g){return g=uB(g),g!==null?XG(g):null}function XG(g){if(g.tag===5||g.tag===6)return g;for(g=g.child;g!==null;){var e=XG(g);if(e!==null)return e;g=g.sibling}return null}var JG=XI.unstable_scheduleCallback,Lu=XI.unstable_cancelCallback,mB=XI.unstable_shouldYield,ZB=XI.unstable_requestPaint,be=XI.unstable_now,bB=XI.unstable_getCurrentPriorityLevel,LA=XI.unstable_ImmediatePriority,kG=XI.unstable_UserBlockingPriority,$r=XI.unstable_NormalPriority,GB=XI.unstable_LowPriority,vG=XI.unstable_IdlePriority,Ea=null,ht=null;function pB(g){if(ht&&typeof ht.onCommitFiberRoot=="function")try{ht.onCommitFiberRoot(Ea,g,void 0,(g.current.flags&128)===128)}catch{}}var Ct=Math.clz32?Math.clz32:BB,hB=Math.log,yB=Math.LN2;function BB(g){return g>>>=0,g===0?32:31-(hB(g)/yB|0)|0}var lr=64,nr=4194304;function Rn(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return g&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function _r(g,e){var I=g.pendingLanes;if(I===0)return 0;var t=0,C=g.suspendedLanes,l=g.pingedLanes,n=I&268435455;if(n!==0){var o=n&~C;o!==0?t=Rn(o):(l&=n,l!==0&&(t=Rn(l)))}else n=I&~C,n!==0?t=Rn(n):l!==0&&(t=Rn(l));if(t===0)return 0;if(e!==0&&e!==t&&!(e&C)&&(C=t&-t,l=e&-e,C>=l||C===16&&(l&4194240)!==0))return e;if(t&4&&(t|=I&16),e=g.entangledLanes,e!==0)for(g=g.entanglements,e&=t;0<e;)I=31-Ct(e),C=1<<I,t|=g[I],e&=~C;return t}function SB(g,e){switch(g){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function WB(g,e){for(var I=g.suspendedLanes,t=g.pingedLanes,C=g.expirationTimes,l=g.pendingLanes;0<l;){var n=31-Ct(l),o=1<<n,r=C[n];r===-1?(!(o&I)||o&t)&&(C[n]=SB(o,e)):r<=e&&(g.expiredLanes|=o),l&=~o}}function Rc(g){return g=g.pendingLanes&-1073741825,g!==0?g:g&1073741824?1073741824:0}function YG(){var g=lr;return lr<<=1,!(lr&4194240)&&(lr=64),g}function ys(g){for(var e=[],I=0;31>I;I++)e.push(g);return e}function Vo(g,e,I){g.pendingLanes|=e,e!==536870912&&(g.suspendedLanes=0,g.pingedLanes=0),g=g.eventTimes,e=31-Ct(e),g[e]=I}function VB(g,e){var I=g.pendingLanes&~e;g.pendingLanes=e,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=e,g.mutableReadLanes&=e,g.entangledLanes&=e,e=g.entanglements;var t=g.eventTimes;for(g=g.expirationTimes;0<I;){var C=31-Ct(I),l=1<<C;e[C]=0,t[C]=-1,g[C]=-1,I&=~l}}function QA(g,e){var I=g.entangledLanes|=e;for(g=g.entanglements;I;){var t=31-Ct(I),C=1<<t;C&e|g[t]&e&&(g[t]|=e),I&=~C}}var Mg=0;function HG(g){return g&=-g,1<g?4<g?g&268435455?16:536870912:4:1}var wG,TA,NG,FG,KG,fc=!1,or=[],CC=null,lC=null,nC=null,qn=new Map,$n=new Map,gC=[],RB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qu(g,e){switch(g){case"focusin":case"focusout":CC=null;break;case"dragenter":case"dragleave":lC=null;break;case"mouseover":case"mouseout":nC=null;break;case"pointerover":case"pointerout":qn.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$n.delete(e.pointerId)}}function on(g,e,I,t,C,l){return g===null||g.nativeEvent!==l?(g={blockedOn:e,domEventName:I,eventSystemFlags:t,nativeEvent:l,targetContainers:[C]},e!==null&&(e=fo(e),e!==null&&TA(e)),g):(g.eventSystemFlags|=t,e=g.targetContainers,C!==null&&e.indexOf(C)===-1&&e.push(C),g)}function fB(g,e,I,t,C){switch(e){case"focusin":return CC=on(CC,g,e,I,t,C),!0;case"dragenter":return lC=on(lC,g,e,I,t,C),!0;case"mouseover":return nC=on(nC,g,e,I,t,C),!0;case"pointerover":var l=C.pointerId;return qn.set(l,on(qn.get(l)||null,g,e,I,t,C)),!0;case"gotpointercapture":return l=C.pointerId,$n.set(l,on($n.get(l)||null,g,e,I,t,C)),!0}return!1}function xG(g){var e=JC(g.target);if(e!==null){var I=PC(e);if(I!==null){if(e=I.tag,e===13){if(e=RG(I),e!==null){g.blockedOn=e,KG(g.priority,function(){NG(I)});return}}else if(e===3&&I.stateNode.current.memoizedState.isDehydrated){g.blockedOn=I.tag===3?I.stateNode.containerInfo:null;return}}}g.blockedOn=null}function Xr(g){if(g.blockedOn!==null)return!1;for(var e=g.targetContainers;0<e.length;){var I=Xc(g.domEventName,g.eventSystemFlags,e[0],g.nativeEvent);if(I===null){I=g.nativeEvent;var t=new I.constructor(I.type,I);Bc=t,I.target.dispatchEvent(t),Bc=null}else return e=fo(I),e!==null&&TA(e),g.blockedOn=I,!1;e.shift()}return!0}function Tu(g,e,I){Xr(g)&&I.delete(e)}function XB(){fc=!1,CC!==null&&Xr(CC)&&(CC=null),lC!==null&&Xr(lC)&&(lC=null),nC!==null&&Xr(nC)&&(nC=null),qn.forEach(Tu),$n.forEach(Tu)}function rn(g,e){g.blockedOn===e&&(g.blockedOn=null,fc||(fc=!0,XI.unstable_scheduleCallback(XI.unstable_NormalPriority,XB)))}function _n(g){function e(C){return rn(C,g)}if(0<or.length){rn(or[0],g);for(var I=1;I<or.length;I++){var t=or[I];t.blockedOn===g&&(t.blockedOn=null)}}for(CC!==null&&rn(CC,g),lC!==null&&rn(lC,g),nC!==null&&rn(nC,g),qn.forEach(e),$n.forEach(e),I=0;I<gC.length;I++)t=gC[I],t.blockedOn===g&&(t.blockedOn=null);for(;0<gC.length&&(I=gC[0],I.blockedOn===null);)xG(I),I.blockedOn===null&&gC.shift()}var Rl=Lt.ReactCurrentBatchConfig,ga=!0;function JB(g,e,I,t){var C=Mg,l=Rl.transition;Rl.transition=null;try{Mg=1,DA(g,e,I,t)}finally{Mg=C,Rl.transition=l}}function kB(g,e,I,t){var C=Mg,l=Rl.transition;Rl.transition=null;try{Mg=4,DA(g,e,I,t)}finally{Mg=C,Rl.transition=l}}function DA(g,e,I,t){if(ga){var C=Xc(g,e,I,t);if(C===null)vs(g,e,t,ea,I),Qu(g,t);else if(fB(C,g,e,I,t))t.stopPropagation();else if(Qu(g,t),e&4&&-1<RB.indexOf(g)){for(;C!==null;){var l=fo(C);if(l!==null&&wG(l),l=Xc(g,e,I,t),l===null&&vs(g,e,t,ea,I),l===C)break;C=l}C!==null&&t.stopPropagation()}else vs(g,e,t,null,I)}}var ea=null;function Xc(g,e,I,t){if(ea=null,g=UA(t),g=JC(g),g!==null)if(e=PC(g),e===null)g=null;else if(I=e.tag,I===13){if(g=RG(e),g!==null)return g;g=null}else if(I===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;g=null}else e!==g&&(g=null);return ea=g,null}function EG(g){switch(g){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bB()){case LA:return 1;case kG:return 4;case $r:case GB:return 16;case vG:return 536870912;default:return 16}default:return 16}}var IC=null,jA=null,Jr=null;function zG(){if(Jr)return Jr;var g,e=jA,I=e.length,t,C="value"in IC?IC.value:IC.textContent,l=C.length;for(g=0;g<I&&e[g]===C[g];g++);var n=I-g;for(t=1;t<=n&&e[I-t]===C[l-t];t++);return Jr=C.slice(g,1<t?1-t:void 0)}function kr(g){var e=g.keyCode;return"charCode"in g?(g=g.charCode,g===0&&e===13&&(g=13)):g=e,g===10&&(g=13),32<=g||g===13?g:0}function rr(){return!0}function Du(){return!1}function vI(g){function e(I,t,C,l,n){this._reactName=I,this._targetInst=C,this.type=t,this.nativeEvent=l,this.target=n,this.currentTarget=null;for(var o in g)g.hasOwnProperty(o)&&(I=g[o],this[o]=I?I(l):l[o]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?rr:Du,this.isPropagationStopped=Du,this}return ie(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var I=this.nativeEvent;I&&(I.preventDefault?I.preventDefault():typeof I.returnValue!="unknown"&&(I.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var I=this.nativeEvent;I&&(I.stopPropagation?I.stopPropagation():typeof I.cancelBubble!="unknown"&&(I.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),e}var jl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},PA=vI(jl),Ro=ie({},jl,{view:0,detail:0}),vB=vI(Ro),Bs,Ss,an,za=ie({},Ro,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:OA,button:0,buttons:0,relatedTarget:function(g){return g.relatedTarget===void 0?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){return"movementX"in g?g.movementX:(g!==an&&(an&&g.type==="mousemove"?(Bs=g.screenX-an.screenX,Ss=g.screenY-an.screenY):Ss=Bs=0,an=g),Bs)},movementY:function(g){return"movementY"in g?g.movementY:Ss}}),ju=vI(za),YB=ie({},za,{dataTransfer:0}),HB=vI(YB),wB=ie({},Ro,{relatedTarget:0}),Ws=vI(wB),NB=ie({},jl,{animationName:0,elapsedTime:0,pseudoElement:0}),FB=vI(NB),KB=ie({},jl,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),xB=vI(KB),EB=ie({},jl,{data:0}),Pu=vI(EB),zB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},MB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},UB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LB(g){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(g):(g=UB[g])?!!e[g]:!1}function OA(){return LB}var QB=ie({},Ro,{key:function(g){if(g.key){var e=zB[g.key]||g.key;if(e!=="Unidentified")return e}return g.type==="keypress"?(g=kr(g),g===13?"Enter":String.fromCharCode(g)):g.type==="keydown"||g.type==="keyup"?MB[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:OA,charCode:function(g){return g.type==="keypress"?kr(g):0},keyCode:function(g){return g.type==="keydown"||g.type==="keyup"?g.keyCode:0},which:function(g){return g.type==="keypress"?kr(g):g.type==="keydown"||g.type==="keyup"?g.keyCode:0}}),TB=vI(QB),DB=ie({},za,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ou=vI(DB),jB=ie({},Ro,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:OA}),PB=vI(jB),OB=ie({},jl,{propertyName:0,elapsedTime:0,pseudoElement:0}),qB=vI(OB),$B=ie({},za,{deltaX:function(g){return"deltaX"in g?g.deltaX:"wheelDeltaX"in g?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:"wheelDeltaY"in g?-g.wheelDeltaY:"wheelDelta"in g?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),_B=vI($B),gS=[9,13,27,32],qA=xt&&"CompositionEvent"in window,Kn=null;xt&&"documentMode"in document&&(Kn=document.documentMode);var eS=xt&&"TextEvent"in window&&!Kn,MG=xt&&(!qA||Kn&&8<Kn&&11>=Kn),qu=" ",$u=!1;function UG(g,e){switch(g){case"keyup":return gS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function LG(g){return g=g.detail,typeof g=="object"&&"data"in g?g.data:null}var cl=!1;function IS(g,e){switch(g){case"compositionend":return LG(e);case"keypress":return e.which!==32?null:($u=!0,qu);case"textInput":return g=e.data,g===qu&&$u?null:g;default:return null}}function tS(g,e){if(cl)return g==="compositionend"||!qA&&UG(g,e)?(g=zG(),Jr=jA=IC=null,cl=!1,g):null;switch(g){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return MG&&e.locale!=="ko"?null:e.data;default:return null}}var CS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _u(g){var e=g&&g.nodeName&&g.nodeName.toLowerCase();return e==="input"?!!CS[g.type]:e==="textarea"}function QG(g,e,I,t){yG(t),e=Ia(e,"onChange"),0<e.length&&(I=new PA("onChange","change",null,I,t),g.push({event:I,listeners:e}))}var xn=null,go=null;function lS(g){Ip(g,0)}function Ma(g){var e=ul(g);if(uG(e))return g}function nS(g,e){if(g==="change")return e}var TG=!1;if(xt){var Vs;if(xt){var Rs="oninput"in document;if(!Rs){var gm=document.createElement("div");gm.setAttribute("oninput","return;"),Rs=typeof gm.oninput=="function"}Vs=Rs}else Vs=!1;TG=Vs&&(!document.documentMode||9<document.documentMode)}function em(){xn&&(xn.detachEvent("onpropertychange",DG),go=xn=null)}function DG(g){if(g.propertyName==="value"&&Ma(go)){var e=[];QG(e,go,g,UA(g)),VG(lS,e)}}function oS(g,e,I){g==="focusin"?(em(),xn=e,go=I,xn.attachEvent("onpropertychange",DG)):g==="focusout"&&em()}function rS(g){if(g==="selectionchange"||g==="keyup"||g==="keydown")return Ma(go)}function aS(g,e){if(g==="click")return Ma(e)}function iS(g,e){if(g==="input"||g==="change")return Ma(e)}function sS(g,e){return g===e&&(g!==0||1/g===1/e)||g!==g&&e!==e}var ot=typeof Object.is=="function"?Object.is:sS;function eo(g,e){if(ot(g,e))return!0;if(typeof g!="object"||g===null||typeof e!="object"||e===null)return!1;var I=Object.keys(g),t=Object.keys(e);if(I.length!==t.length)return!1;for(t=0;t<I.length;t++){var C=I[t];if(!sc.call(e,C)||!ot(g[C],e[C]))return!1}return!0}function Im(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function tm(g,e){var I=Im(g);g=0;for(var t;I;){if(I.nodeType===3){if(t=g+I.textContent.length,g<=e&&t>=e)return{node:I,offset:e-g};g=t}g:{for(;I;){if(I.nextSibling){I=I.nextSibling;break g}I=I.parentNode}I=void 0}I=Im(I)}}function jG(g,e){return g&&e?g===e?!0:g&&g.nodeType===3?!1:e&&e.nodeType===3?jG(g,e.parentNode):"contains"in g?g.contains(e):g.compareDocumentPosition?!!(g.compareDocumentPosition(e)&16):!1:!1}function PG(){for(var g=window,e=Pr();e instanceof g.HTMLIFrameElement;){try{var I=typeof e.contentWindow.location.href=="string"}catch{I=!1}if(I)g=e.contentWindow;else break;e=Pr(g.document)}return e}function $A(g){var e=g&&g.nodeName&&g.nodeName.toLowerCase();return e&&(e==="input"&&(g.type==="text"||g.type==="search"||g.type==="tel"||g.type==="url"||g.type==="password")||e==="textarea"||g.contentEditable==="true")}function cS(g){var e=PG(),I=g.focusedElem,t=g.selectionRange;if(e!==I&&I&&I.ownerDocument&&jG(I.ownerDocument.documentElement,I)){if(t!==null&&$A(I)){if(e=t.start,g=t.end,g===void 0&&(g=e),"selectionStart"in I)I.selectionStart=e,I.selectionEnd=Math.min(g,I.value.length);else if(g=(e=I.ownerDocument||document)&&e.defaultView||window,g.getSelection){g=g.getSelection();var C=I.textContent.length,l=Math.min(t.start,C);t=t.end===void 0?l:Math.min(t.end,C),!g.extend&&l>t&&(C=t,t=l,l=C),C=tm(I,l);var n=tm(I,t);C&&n&&(g.rangeCount!==1||g.anchorNode!==C.node||g.anchorOffset!==C.offset||g.focusNode!==n.node||g.focusOffset!==n.offset)&&(e=e.createRange(),e.setStart(C.node,C.offset),g.removeAllRanges(),l>t?(g.addRange(e),g.extend(n.node,n.offset)):(e.setEnd(n.node,n.offset),g.addRange(e)))}}for(e=[],g=I;g=g.parentNode;)g.nodeType===1&&e.push({element:g,left:g.scrollLeft,top:g.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<e.length;I++)g=e[I],g.element.scrollLeft=g.left,g.element.scrollTop=g.top}}var AS=xt&&"documentMode"in document&&11>=document.documentMode,Al=null,Jc=null,En=null,kc=!1;function Cm(g,e,I){var t=I.window===I?I.document:I.nodeType===9?I:I.ownerDocument;kc||Al==null||Al!==Pr(t)||(t=Al,"selectionStart"in t&&$A(t)?t={start:t.selectionStart,end:t.selectionEnd}:(t=(t.ownerDocument&&t.ownerDocument.defaultView||window).getSelection(),t={anchorNode:t.anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset}),En&&eo(En,t)||(En=t,t=Ia(Jc,"onSelect"),0<t.length&&(e=new PA("onSelect","select",null,e,I),g.push({event:e,listeners:t}),e.target=Al)))}function ar(g,e){var I={};return I[g.toLowerCase()]=e.toLowerCase(),I["Webkit"+g]="webkit"+e,I["Moz"+g]="moz"+e,I}var dl={animationend:ar("Animation","AnimationEnd"),animationiteration:ar("Animation","AnimationIteration"),animationstart:ar("Animation","AnimationStart"),transitionend:ar("Transition","TransitionEnd")},fs={},OG={};xt&&(OG=document.createElement("div").style,"AnimationEvent"in window||(delete dl.animationend.animation,delete dl.animationiteration.animation,delete dl.animationstart.animation),"TransitionEvent"in window||delete dl.transitionend.transition);function Ua(g){if(fs[g])return fs[g];if(!dl[g])return g;var e=dl[g],I;for(I in e)if(e.hasOwnProperty(I)&&I in OG)return fs[g]=e[I];return g}var qG=Ua("animationend"),$G=Ua("animationiteration"),_G=Ua("animationstart"),gp=Ua("transitionend"),ep=new Map,lm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mC(g,e){ep.set(g,e),jC(e,[g])}for(var Xs=0;Xs<lm.length;Xs++){var Js=lm[Xs],dS=Js.toLowerCase(),uS=Js[0].toUpperCase()+Js.slice(1);mC(dS,"on"+uS)}mC(qG,"onAnimationEnd");mC($G,"onAnimationIteration");mC(_G,"onAnimationStart");mC("dblclick","onDoubleClick");mC("focusin","onFocus");mC("focusout","onBlur");mC(gp,"onTransitionEnd");vl("onMouseEnter",["mouseout","mouseover"]);vl("onMouseLeave",["mouseout","mouseover"]);vl("onPointerEnter",["pointerout","pointerover"]);vl("onPointerLeave",["pointerout","pointerover"]);jC("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));jC("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));jC("onBeforeInput",["compositionend","keypress","textInput","paste"]);jC("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));jC("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));jC("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mS=new Set("cancel close invalid load scroll toggle".split(" ").concat(fn));function nm(g,e,I){var t=g.type||"unknown-event";g.currentTarget=I,dB(t,e,void 0,g),g.currentTarget=null}function Ip(g,e){e=(e&4)!==0;for(var I=0;I<g.length;I++){var t=g[I],C=t.event;t=t.listeners;g:{var l=void 0;if(e)for(var n=t.length-1;0<=n;n--){var o=t[n],r=o.instance,a=o.currentTarget;if(o=o.listener,r!==l&&C.isPropagationStopped())break g;nm(C,o,a),l=r}else for(n=0;n<t.length;n++){if(o=t[n],r=o.instance,a=o.currentTarget,o=o.listener,r!==l&&C.isPropagationStopped())break g;nm(C,o,a),l=r}}}if(qr)throw g=Vc,qr=!1,Vc=null,g}function ee(g,e){var I=e[Nc];I===void 0&&(I=e[Nc]=new Set);var t=g+"__bubble";I.has(t)||(tp(e,g,2,!1),I.add(t))}function ks(g,e,I){var t=0;e&&(t|=4),tp(I,g,t,e)}var ir="_reactListening"+Math.random().toString(36).slice(2);function Io(g){if(!g[ir]){g[ir]=!0,iG.forEach(function(I){I!=="selectionchange"&&(mS.has(I)||ks(I,!1,g),ks(I,!0,g))});var e=g.nodeType===9?g:g.ownerDocument;e===null||e[ir]||(e[ir]=!0,ks("selectionchange",!1,e))}}function tp(g,e,I,t){switch(EG(e)){case 1:var C=JB;break;case 4:C=kB;break;default:C=DA}I=C.bind(null,e,I,g),C=void 0,!Wc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(C=!0),t?C!==void 0?g.addEventListener(e,I,{capture:!0,passive:C}):g.addEventListener(e,I,!0):C!==void 0?g.addEventListener(e,I,{passive:C}):g.addEventListener(e,I,!1)}function vs(g,e,I,t,C){var l=t;if(!(e&1)&&!(e&2)&&t!==null)g:for(;;){if(t===null)return;var n=t.tag;if(n===3||n===4){var o=t.stateNode.containerInfo;if(o===C||o.nodeType===8&&o.parentNode===C)break;if(n===4)for(n=t.return;n!==null;){var r=n.tag;if((r===3||r===4)&&(r=n.stateNode.containerInfo,r===C||r.nodeType===8&&r.parentNode===C))return;n=n.return}for(;o!==null;){if(n=JC(o),n===null)return;if(r=n.tag,r===5||r===6){t=l=n;continue g}o=o.parentNode}}t=t.return}VG(function(){var a=l,i=UA(I),c=[];g:{var A=ep.get(g);if(A!==void 0){var p=PA,G=g;switch(g){case"keypress":if(kr(I)===0)break g;case"keydown":case"keyup":p=TB;break;case"focusin":G="focus",p=Ws;break;case"focusout":G="blur",p=Ws;break;case"beforeblur":case"afterblur":p=Ws;break;case"click":if(I.button===2)break g;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=ju;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=HB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=PB;break;case qG:case $G:case _G:p=FB;break;case gp:p=qB;break;case"scroll":p=vB;break;case"wheel":p=_B;break;case"copy":case"cut":case"paste":p=xB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Ou}var Z=(e&4)!==0,h=!Z&&g==="scroll",u=Z?A!==null?A+"Capture":null:A;Z=[];for(var b=a,m;b!==null;){m=b;var B=m.stateNode;if(m.tag===5&&B!==null&&(m=B,u!==null&&(B=On(b,u),B!=null&&Z.push(to(b,B,m)))),h)break;b=b.return}0<Z.length&&(A=new p(A,G,null,I,i),c.push({event:A,listeners:Z}))}}if(!(e&7)){g:{if(A=g==="mouseover"||g==="pointerover",p=g==="mouseout"||g==="pointerout",A&&I!==Bc&&(G=I.relatedTarget||I.fromElement)&&(JC(G)||G[Et]))break g;if((p||A)&&(A=i.window===i?i:(A=i.ownerDocument)?A.defaultView||A.parentWindow:window,p?(G=I.relatedTarget||I.toElement,p=a,G=G?JC(G):null,G!==null&&(h=PC(G),G!==h||G.tag!==5&&G.tag!==6)&&(G=null)):(p=null,G=a),p!==G)){if(Z=ju,B="onMouseLeave",u="onMouseEnter",b="mouse",(g==="pointerout"||g==="pointerover")&&(Z=Ou,B="onPointerLeave",u="onPointerEnter",b="pointer"),h=p==null?A:ul(p),m=G==null?A:ul(G),A=new Z(B,b+"leave",p,I,i),A.target=h,A.relatedTarget=m,B=null,JC(i)===a&&(Z=new Z(u,b+"enter",G,I,i),Z.target=m,Z.relatedTarget=h,B=Z),h=B,p&&G)e:{for(Z=p,u=G,b=0,m=Z;m;m=_C(m))b++;for(m=0,B=u;B;B=_C(B))m++;for(;0<b-m;)Z=_C(Z),b--;for(;0<m-b;)u=_C(u),m--;for(;b--;){if(Z===u||u!==null&&Z===u.alternate)break e;Z=_C(Z),u=_C(u)}Z=null}else Z=null;p!==null&&om(c,A,p,Z,!1),G!==null&&h!==null&&om(c,h,G,Z,!0)}}g:{if(A=a?ul(a):window,p=A.nodeName&&A.nodeName.toLowerCase(),p==="select"||p==="input"&&A.type==="file")var W=nS;else if(_u(A))if(TG)W=iS;else{W=rS;var R=oS}else(p=A.nodeName)&&p.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(W=aS);if(W&&(W=W(g,a))){QG(c,W,I,i);break g}R&&R(g,A,a),g==="focusout"&&(R=A._wrapperState)&&R.controlled&&A.type==="number"&&bc(A,"number",A.value)}switch(R=a?ul(a):window,g){case"focusin":(_u(R)||R.contentEditable==="true")&&(Al=R,Jc=a,En=null);break;case"focusout":En=Jc=Al=null;break;case"mousedown":kc=!0;break;case"contextmenu":case"mouseup":case"dragend":kc=!1,Cm(c,I,i);break;case"selectionchange":if(AS)break;case"keydown":case"keyup":Cm(c,I,i)}var V;if(qA)g:{switch(g){case"compositionstart":var S="onCompositionStart";break g;case"compositionend":S="onCompositionEnd";break g;case"compositionupdate":S="onCompositionUpdate";break g}S=void 0}else cl?UG(g,I)&&(S="onCompositionEnd"):g==="keydown"&&I.keyCode===229&&(S="onCompositionStart");S&&(MG&&I.locale!=="ko"&&(cl||S!=="onCompositionStart"?S==="onCompositionEnd"&&cl&&(V=zG()):(IC=i,jA="value"in IC?IC.value:IC.textContent,cl=!0)),R=Ia(a,S),0<R.length&&(S=new Pu(S,g,null,I,i),c.push({event:S,listeners:R}),V?S.data=V:(V=LG(I),V!==null&&(S.data=V)))),(V=eS?IS(g,I):tS(g,I))&&(a=Ia(a,"onBeforeInput"),0<a.length&&(i=new Pu("onBeforeInput","beforeinput",null,I,i),c.push({event:i,listeners:a}),i.data=V))}Ip(c,e)})}function to(g,e,I){return{instance:g,listener:e,currentTarget:I}}function Ia(g,e){for(var I=e+"Capture",t=[];g!==null;){var C=g,l=C.stateNode;C.tag===5&&l!==null&&(C=l,l=On(g,I),l!=null&&t.unshift(to(g,l,C)),l=On(g,e),l!=null&&t.push(to(g,l,C))),g=g.return}return t}function _C(g){if(g===null)return null;do g=g.return;while(g&&g.tag!==5);return g||null}function om(g,e,I,t,C){for(var l=e._reactName,n=[];I!==null&&I!==t;){var o=I,r=o.alternate,a=o.stateNode;if(r!==null&&r===t)break;o.tag===5&&a!==null&&(o=a,C?(r=On(I,l),r!=null&&n.unshift(to(I,r,o))):C||(r=On(I,l),r!=null&&n.push(to(I,r,o)))),I=I.return}n.length!==0&&g.push({event:e,listeners:n})}var ZS=/\r\n?/g,bS=/\u0000|\uFFFD/g;function rm(g){return(typeof g=="string"?g:""+g).replace(ZS,`
`).replace(bS,"")}function sr(g,e,I){if(e=rm(e),rm(g)!==e&&I)throw Error(T(425))}function ta(){}var vc=null,Yc=null;function Hc(g,e){return g==="textarea"||g==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var wc=typeof setTimeout=="function"?setTimeout:void 0,GS=typeof clearTimeout=="function"?clearTimeout:void 0,am=typeof Promise=="function"?Promise:void 0,pS=typeof queueMicrotask=="function"?queueMicrotask:typeof am<"u"?function(g){return am.resolve(null).then(g).catch(hS)}:wc;function hS(g){setTimeout(function(){throw g})}function Ys(g,e){var I=e,t=0;do{var C=I.nextSibling;if(g.removeChild(I),C&&C.nodeType===8)if(I=C.data,I==="/$"){if(t===0){g.removeChild(C),_n(e);return}t--}else I!=="$"&&I!=="$?"&&I!=="$!"||t++;I=C}while(I);_n(e)}function oC(g){for(;g!=null;g=g.nextSibling){var e=g.nodeType;if(e===1||e===3)break;if(e===8){if(e=g.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return g}function im(g){g=g.previousSibling;for(var e=0;g;){if(g.nodeType===8){var I=g.data;if(I==="$"||I==="$!"||I==="$?"){if(e===0)return g;e--}else I==="/$"&&e++}g=g.previousSibling}return null}var Pl=Math.random().toString(36).slice(2),Zt="__reactFiber$"+Pl,Co="__reactProps$"+Pl,Et="__reactContainer$"+Pl,Nc="__reactEvents$"+Pl,yS="__reactListeners$"+Pl,BS="__reactHandles$"+Pl;function JC(g){var e=g[Zt];if(e)return e;for(var I=g.parentNode;I;){if(e=I[Et]||I[Zt]){if(I=e.alternate,e.child!==null||I!==null&&I.child!==null)for(g=im(g);g!==null;){if(I=g[Zt])return I;g=im(g)}return e}g=I,I=g.parentNode}return null}function fo(g){return g=g[Zt]||g[Et],!g||g.tag!==5&&g.tag!==6&&g.tag!==13&&g.tag!==3?null:g}function ul(g){if(g.tag===5||g.tag===6)return g.stateNode;throw Error(T(33))}function La(g){return g[Co]||null}var Fc=[],ml=-1;function ZC(g){return{current:g}}function Ie(g){0>ml||(g.current=Fc[ml],Fc[ml]=null,ml--)}function ge(g,e){ml++,Fc[ml]=g.current,g.current=e}var AC={},Oe=ZC(AC),aI=ZC(!1),EC=AC;function Yl(g,e){var I=g.type.contextTypes;if(!I)return AC;var t=g.stateNode;if(t&&t.__reactInternalMemoizedUnmaskedChildContext===e)return t.__reactInternalMemoizedMaskedChildContext;var C={},l;for(l in I)C[l]=e[l];return t&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=e,g.__reactInternalMemoizedMaskedChildContext=C),C}function iI(g){return g=g.childContextTypes,g!=null}function Ca(){Ie(aI),Ie(Oe)}function sm(g,e,I){if(Oe.current!==AC)throw Error(T(168));ge(Oe,e),ge(aI,I)}function Cp(g,e,I){var t=g.stateNode;if(e=e.childContextTypes,typeof t.getChildContext!="function")return I;t=t.getChildContext();for(var C in t)if(!(C in e))throw Error(T(108,oB(g)||"Unknown",C));return ie({},I,t)}function la(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||AC,EC=Oe.current,ge(Oe,g),ge(aI,aI.current),!0}function cm(g,e,I){var t=g.stateNode;if(!t)throw Error(T(169));I?(g=Cp(g,e,EC),t.__reactInternalMemoizedMergedChildContext=g,Ie(aI),Ie(Oe),ge(Oe,g)):Ie(aI),ge(aI,I)}var Yt=null,Qa=!1,Hs=!1;function lp(g){Yt===null?Yt=[g]:Yt.push(g)}function SS(g){Qa=!0,lp(g)}function bC(){if(!Hs&&Yt!==null){Hs=!0;var g=0,e=Mg;try{var I=Yt;for(Mg=1;g<I.length;g++){var t=I[g];do t=t(!0);while(t!==null)}Yt=null,Qa=!1}catch(C){throw Yt!==null&&(Yt=Yt.slice(g+1)),JG(LA,bC),C}finally{Mg=e,Hs=!1}}return null}var Zl=[],bl=0,na=null,oa=0,EI=[],zI=0,zC=null,Ht=1,wt="";function WC(g,e){Zl[bl++]=oa,Zl[bl++]=na,na=g,oa=e}function np(g,e,I){EI[zI++]=Ht,EI[zI++]=wt,EI[zI++]=zC,zC=g;var t=Ht;g=wt;var C=32-Ct(t)-1;t&=~(1<<C),I+=1;var l=32-Ct(e)+C;if(30<l){var n=C-C%5;l=(t&(1<<n)-1).toString(32),t>>=n,C-=n,Ht=1<<32-Ct(e)+C|I<<C|t,wt=l+g}else Ht=1<<l|I<<C|t,wt=g}function _A(g){g.return!==null&&(WC(g,1),np(g,1,0))}function gd(g){for(;g===na;)na=Zl[--bl],Zl[bl]=null,oa=Zl[--bl],Zl[bl]=null;for(;g===zC;)zC=EI[--zI],EI[zI]=null,wt=EI[--zI],EI[zI]=null,Ht=EI[--zI],EI[zI]=null}var WI=null,SI=null,ne=!1,et=null;function op(g,e){var I=UI(5,null,null,0);I.elementType="DELETED",I.stateNode=e,I.return=g,e=g.deletions,e===null?(g.deletions=[I],g.flags|=16):e.push(I)}function Am(g,e){switch(g.tag){case 5:var I=g.type;return e=e.nodeType!==1||I.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(g.stateNode=e,WI=g,SI=oC(e.firstChild),!0):!1;case 6:return e=g.pendingProps===""||e.nodeType!==3?null:e,e!==null?(g.stateNode=e,WI=g,SI=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(I=zC!==null?{id:Ht,overflow:wt}:null,g.memoizedState={dehydrated:e,treeContext:I,retryLane:1073741824},I=UI(18,null,null,0),I.stateNode=e,I.return=g,g.child=I,WI=g,SI=null,!0):!1;default:return!1}}function Kc(g){return(g.mode&1)!==0&&(g.flags&128)===0}function xc(g){if(ne){var e=SI;if(e){var I=e;if(!Am(g,e)){if(Kc(g))throw Error(T(418));e=oC(I.nextSibling);var t=WI;e&&Am(g,e)?op(t,I):(g.flags=g.flags&-4097|2,ne=!1,WI=g)}}else{if(Kc(g))throw Error(T(418));g.flags=g.flags&-4097|2,ne=!1,WI=g}}}function dm(g){for(g=g.return;g!==null&&g.tag!==5&&g.tag!==3&&g.tag!==13;)g=g.return;WI=g}function cr(g){if(g!==WI)return!1;if(!ne)return dm(g),ne=!0,!1;var e;if((e=g.tag!==3)&&!(e=g.tag!==5)&&(e=g.type,e=e!=="head"&&e!=="body"&&!Hc(g.type,g.memoizedProps)),e&&(e=SI)){if(Kc(g))throw rp(),Error(T(418));for(;e;)op(g,e),e=oC(e.nextSibling)}if(dm(g),g.tag===13){if(g=g.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(T(317));g:{for(g=g.nextSibling,e=0;g;){if(g.nodeType===8){var I=g.data;if(I==="/$"){if(e===0){SI=oC(g.nextSibling);break g}e--}else I!=="$"&&I!=="$!"&&I!=="$?"||e++}g=g.nextSibling}SI=null}}else SI=WI?oC(g.stateNode.nextSibling):null;return!0}function rp(){for(var g=SI;g;)g=oC(g.nextSibling)}function Hl(){SI=WI=null,ne=!1}function ed(g){et===null?et=[g]:et.push(g)}var WS=Lt.ReactCurrentBatchConfig;function sn(g,e,I){if(g=I.ref,g!==null&&typeof g!="function"&&typeof g!="object"){if(I._owner){if(I=I._owner,I){if(I.tag!==1)throw Error(T(309));var t=I.stateNode}if(!t)throw Error(T(147,g));var C=t,l=""+g;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===l?e.ref:(e=function(n){var o=C.refs;n===null?delete o[l]:o[l]=n},e._stringRef=l,e)}if(typeof g!="string")throw Error(T(284));if(!I._owner)throw Error(T(290,g))}return g}function Ar(g,e){throw g=Object.prototype.toString.call(e),Error(T(31,g==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":g))}function um(g){var e=g._init;return e(g._payload)}function ap(g){function e(u,b){if(g){var m=u.deletions;m===null?(u.deletions=[b],u.flags|=16):m.push(b)}}function I(u,b){if(!g)return null;for(;b!==null;)e(u,b),b=b.sibling;return null}function t(u,b){for(u=new Map;b!==null;)b.key!==null?u.set(b.key,b):u.set(b.index,b),b=b.sibling;return u}function C(u,b){return u=sC(u,b),u.index=0,u.sibling=null,u}function l(u,b,m){return u.index=m,g?(m=u.alternate,m!==null?(m=m.index,m<b?(u.flags|=2,b):m):(u.flags|=2,b)):(u.flags|=1048576,b)}function n(u){return g&&u.alternate===null&&(u.flags|=2),u}function o(u,b,m,B){return b===null||b.tag!==6?(b=zs(m,u.mode,B),b.return=u,b):(b=C(b,m),b.return=u,b)}function r(u,b,m,B){var W=m.type;return W===sl?i(u,b,m.props.children,B,m.key):b!==null&&(b.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===$t&&um(W)===b.type)?(B=C(b,m.props),B.ref=sn(u,b,m),B.return=u,B):(B=Kr(m.type,m.key,m.props,null,u.mode,B),B.ref=sn(u,b,m),B.return=u,B)}function a(u,b,m,B){return b===null||b.tag!==4||b.stateNode.containerInfo!==m.containerInfo||b.stateNode.implementation!==m.implementation?(b=Ms(m,u.mode,B),b.return=u,b):(b=C(b,m.children||[]),b.return=u,b)}function i(u,b,m,B,W){return b===null||b.tag!==7?(b=KC(m,u.mode,B,W),b.return=u,b):(b=C(b,m),b.return=u,b)}function c(u,b,m){if(typeof b=="string"&&b!==""||typeof b=="number")return b=zs(""+b,u.mode,m),b.return=u,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ir:return m=Kr(b.type,b.key,b.props,null,u.mode,m),m.ref=sn(u,null,b),m.return=u,m;case il:return b=Ms(b,u.mode,m),b.return=u,b;case $t:var B=b._init;return c(u,B(b._payload),m)}if(Vn(b)||ln(b))return b=KC(b,u.mode,m,null),b.return=u,b;Ar(u,b)}return null}function A(u,b,m,B){var W=b!==null?b.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return W!==null?null:o(u,b,""+m,B);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Ir:return m.key===W?r(u,b,m,B):null;case il:return m.key===W?a(u,b,m,B):null;case $t:return W=m._init,A(u,b,W(m._payload),B)}if(Vn(m)||ln(m))return W!==null?null:i(u,b,m,B,null);Ar(u,m)}return null}function p(u,b,m,B,W){if(typeof B=="string"&&B!==""||typeof B=="number")return u=u.get(m)||null,o(b,u,""+B,W);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case Ir:return u=u.get(B.key===null?m:B.key)||null,r(b,u,B,W);case il:return u=u.get(B.key===null?m:B.key)||null,a(b,u,B,W);case $t:var R=B._init;return p(u,b,m,R(B._payload),W)}if(Vn(B)||ln(B))return u=u.get(m)||null,i(b,u,B,W,null);Ar(b,B)}return null}function G(u,b,m,B){for(var W=null,R=null,V=b,S=b=0,y=null;V!==null&&S<m.length;S++){V.index>S?(y=V,V=null):y=V.sibling;var f=A(u,V,m[S],B);if(f===null){V===null&&(V=y);break}g&&V&&f.alternate===null&&e(u,V),b=l(f,b,S),R===null?W=f:R.sibling=f,R=f,V=y}if(S===m.length)return I(u,V),ne&&WC(u,S),W;if(V===null){for(;S<m.length;S++)V=c(u,m[S],B),V!==null&&(b=l(V,b,S),R===null?W=V:R.sibling=V,R=V);return ne&&WC(u,S),W}for(V=t(u,V);S<m.length;S++)y=p(V,u,S,m[S],B),y!==null&&(g&&y.alternate!==null&&V.delete(y.key===null?S:y.key),b=l(y,b,S),R===null?W=y:R.sibling=y,R=y);return g&&V.forEach(function(k){return e(u,k)}),ne&&WC(u,S),W}function Z(u,b,m,B){var W=ln(m);if(typeof W!="function")throw Error(T(150));if(m=W.call(m),m==null)throw Error(T(151));for(var R=W=null,V=b,S=b=0,y=null,f=m.next();V!==null&&!f.done;S++,f=m.next()){V.index>S?(y=V,V=null):y=V.sibling;var k=A(u,V,f.value,B);if(k===null){V===null&&(V=y);break}g&&V&&k.alternate===null&&e(u,V),b=l(k,b,S),R===null?W=k:R.sibling=k,R=k,V=y}if(f.done)return I(u,V),ne&&WC(u,S),W;if(V===null){for(;!f.done;S++,f=m.next())f=c(u,f.value,B),f!==null&&(b=l(f,b,S),R===null?W=f:R.sibling=f,R=f);return ne&&WC(u,S),W}for(V=t(u,V);!f.done;S++,f=m.next())f=p(V,u,S,f.value,B),f!==null&&(g&&f.alternate!==null&&V.delete(f.key===null?S:f.key),b=l(f,b,S),R===null?W=f:R.sibling=f,R=f);return g&&V.forEach(function(H){return e(u,H)}),ne&&WC(u,S),W}function h(u,b,m,B){if(typeof m=="object"&&m!==null&&m.type===sl&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Ir:g:{for(var W=m.key,R=b;R!==null;){if(R.key===W){if(W=m.type,W===sl){if(R.tag===7){I(u,R.sibling),b=C(R,m.props.children),b.return=u,u=b;break g}}else if(R.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===$t&&um(W)===R.type){I(u,R.sibling),b=C(R,m.props),b.ref=sn(u,R,m),b.return=u,u=b;break g}I(u,R);break}else e(u,R);R=R.sibling}m.type===sl?(b=KC(m.props.children,u.mode,B,m.key),b.return=u,u=b):(B=Kr(m.type,m.key,m.props,null,u.mode,B),B.ref=sn(u,b,m),B.return=u,u=B)}return n(u);case il:g:{for(R=m.key;b!==null;){if(b.key===R)if(b.tag===4&&b.stateNode.containerInfo===m.containerInfo&&b.stateNode.implementation===m.implementation){I(u,b.sibling),b=C(b,m.children||[]),b.return=u,u=b;break g}else{I(u,b);break}else e(u,b);b=b.sibling}b=Ms(m,u.mode,B),b.return=u,u=b}return n(u);case $t:return R=m._init,h(u,b,R(m._payload),B)}if(Vn(m))return G(u,b,m,B);if(ln(m))return Z(u,b,m,B);Ar(u,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,b!==null&&b.tag===6?(I(u,b.sibling),b=C(b,m),b.return=u,u=b):(I(u,b),b=zs(m,u.mode,B),b.return=u,u=b),n(u)):I(u,b)}return h}var wl=ap(!0),ip=ap(!1),ra=ZC(null),aa=null,Gl=null,Id=null;function td(){Id=Gl=aa=null}function Cd(g){var e=ra.current;Ie(ra),g._currentValue=e}function Ec(g,e,I){for(;g!==null;){var t=g.alternate;if((g.childLanes&e)!==e?(g.childLanes|=e,t!==null&&(t.childLanes|=e)):t!==null&&(t.childLanes&e)!==e&&(t.childLanes|=e),g===I)break;g=g.return}}function fl(g,e){aa=g,Id=Gl=null,g=g.dependencies,g!==null&&g.firstContext!==null&&(g.lanes&e&&(rI=!0),g.firstContext=null)}function QI(g){var e=g._currentValue;if(Id!==g)if(g={context:g,memoizedValue:e,next:null},Gl===null){if(aa===null)throw Error(T(308));Gl=g,aa.dependencies={lanes:0,firstContext:g}}else Gl=Gl.next=g;return e}var kC=null;function ld(g){kC===null?kC=[g]:kC.push(g)}function sp(g,e,I,t){var C=e.interleaved;return C===null?(I.next=I,ld(e)):(I.next=C.next,C.next=I),e.interleaved=I,zt(g,t)}function zt(g,e){g.lanes|=e;var I=g.alternate;for(I!==null&&(I.lanes|=e),I=g,g=g.return;g!==null;)g.childLanes|=e,I=g.alternate,I!==null&&(I.childLanes|=e),I=g,g=g.return;return I.tag===3?I.stateNode:null}var _t=!1;function nd(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cp(g,e){g=g.updateQueue,e.updateQueue===g&&(e.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function Nt(g,e){return{eventTime:g,lane:e,tag:0,payload:null,callback:null,next:null}}function rC(g,e,I){var t=g.updateQueue;if(t===null)return null;if(t=t.shared,Ng&2){var C=t.pending;return C===null?e.next=e:(e.next=C.next,C.next=e),t.pending=e,zt(g,I)}return C=t.interleaved,C===null?(e.next=e,ld(t)):(e.next=C.next,C.next=e),t.interleaved=e,zt(g,I)}function vr(g,e,I){if(e=e.updateQueue,e!==null&&(e=e.shared,(I&4194240)!==0)){var t=e.lanes;t&=g.pendingLanes,I|=t,e.lanes=I,QA(g,I)}}function mm(g,e){var I=g.updateQueue,t=g.alternate;if(t!==null&&(t=t.updateQueue,I===t)){var C=null,l=null;if(I=I.firstBaseUpdate,I!==null){do{var n={eventTime:I.eventTime,lane:I.lane,tag:I.tag,payload:I.payload,callback:I.callback,next:null};l===null?C=l=n:l=l.next=n,I=I.next}while(I!==null);l===null?C=l=e:l=l.next=e}else C=l=e;I={baseState:t.baseState,firstBaseUpdate:C,lastBaseUpdate:l,shared:t.shared,effects:t.effects},g.updateQueue=I;return}g=I.lastBaseUpdate,g===null?I.firstBaseUpdate=e:g.next=e,I.lastBaseUpdate=e}function ia(g,e,I,t){var C=g.updateQueue;_t=!1;var l=C.firstBaseUpdate,n=C.lastBaseUpdate,o=C.shared.pending;if(o!==null){C.shared.pending=null;var r=o,a=r.next;r.next=null,n===null?l=a:n.next=a,n=r;var i=g.alternate;i!==null&&(i=i.updateQueue,o=i.lastBaseUpdate,o!==n&&(o===null?i.firstBaseUpdate=a:o.next=a,i.lastBaseUpdate=r))}if(l!==null){var c=C.baseState;n=0,i=a=r=null,o=l;do{var A=o.lane,p=o.eventTime;if((t&A)===A){i!==null&&(i=i.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});g:{var G=g,Z=o;switch(A=e,p=I,Z.tag){case 1:if(G=Z.payload,typeof G=="function"){c=G.call(p,c,A);break g}c=G;break g;case 3:G.flags=G.flags&-65537|128;case 0:if(G=Z.payload,A=typeof G=="function"?G.call(p,c,A):G,A==null)break g;c=ie({},c,A);break g;case 2:_t=!0}}o.callback!==null&&o.lane!==0&&(g.flags|=64,A=C.effects,A===null?C.effects=[o]:A.push(o))}else p={eventTime:p,lane:A,tag:o.tag,payload:o.payload,callback:o.callback,next:null},i===null?(a=i=p,r=c):i=i.next=p,n|=A;if(o=o.next,o===null){if(o=C.shared.pending,o===null)break;A=o,o=A.next,A.next=null,C.lastBaseUpdate=A,C.shared.pending=null}}while(!0);if(i===null&&(r=c),C.baseState=r,C.firstBaseUpdate=a,C.lastBaseUpdate=i,e=C.shared.interleaved,e!==null){C=e;do n|=C.lane,C=C.next;while(C!==e)}else l===null&&(C.shared.lanes=0);UC|=n,g.lanes=n,g.memoizedState=c}}function Zm(g,e,I){if(g=e.effects,e.effects=null,g!==null)for(e=0;e<g.length;e++){var t=g[e],C=t.callback;if(C!==null){if(t.callback=null,t=I,typeof C!="function")throw Error(T(191,C));C.call(t)}}}var Xo={},yt=ZC(Xo),lo=ZC(Xo),no=ZC(Xo);function vC(g){if(g===Xo)throw Error(T(174));return g}function od(g,e){switch(ge(no,e),ge(lo,g),ge(yt,Xo),g=e.nodeType,g){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pc(null,"");break;default:g=g===8?e.parentNode:e,e=g.namespaceURI||null,g=g.tagName,e=pc(e,g)}Ie(yt),ge(yt,e)}function Nl(){Ie(yt),Ie(lo),Ie(no)}function Ap(g){vC(no.current);var e=vC(yt.current),I=pc(e,g.type);e!==I&&(ge(lo,g),ge(yt,I))}function rd(g){lo.current===g&&(Ie(yt),Ie(lo))}var re=ZC(0);function sa(g){for(var e=g;e!==null;){if(e.tag===13){var I=e.memoizedState;if(I!==null&&(I=I.dehydrated,I===null||I.data==="$?"||I.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===g)break;for(;e.sibling===null;){if(e.return===null||e.return===g)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ws=[];function ad(){for(var g=0;g<ws.length;g++)ws[g]._workInProgressVersionPrimary=null;ws.length=0}var Yr=Lt.ReactCurrentDispatcher,Ns=Lt.ReactCurrentBatchConfig,MC=0,ae=null,Re=null,Xe=null,ca=!1,zn=!1,oo=0,VS=0;function Ue(){throw Error(T(321))}function id(g,e){if(e===null)return!1;for(var I=0;I<e.length&&I<g.length;I++)if(!ot(g[I],e[I]))return!1;return!0}function sd(g,e,I,t,C,l){if(MC=l,ae=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Yr.current=g===null||g.memoizedState===null?JS:kS,g=I(t,C),zn){l=0;do{if(zn=!1,oo=0,25<=l)throw Error(T(301));l+=1,Xe=Re=null,e.updateQueue=null,Yr.current=vS,g=I(t,C)}while(zn)}if(Yr.current=Aa,e=Re!==null&&Re.next!==null,MC=0,Xe=Re=ae=null,ca=!1,e)throw Error(T(300));return g}function cd(){var g=oo!==0;return oo=0,g}function dt(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?ae.memoizedState=Xe=g:Xe=Xe.next=g,Xe}function TI(){if(Re===null){var g=ae.alternate;g=g!==null?g.memoizedState:null}else g=Re.next;var e=Xe===null?ae.memoizedState:Xe.next;if(e!==null)Xe=e,Re=g;else{if(g===null)throw Error(T(310));Re=g,g={memoizedState:Re.memoizedState,baseState:Re.baseState,baseQueue:Re.baseQueue,queue:Re.queue,next:null},Xe===null?ae.memoizedState=Xe=g:Xe=Xe.next=g}return Xe}function ro(g,e){return typeof e=="function"?e(g):e}function Fs(g){var e=TI(),I=e.queue;if(I===null)throw Error(T(311));I.lastRenderedReducer=g;var t=Re,C=t.baseQueue,l=I.pending;if(l!==null){if(C!==null){var n=C.next;C.next=l.next,l.next=n}t.baseQueue=C=l,I.pending=null}if(C!==null){l=C.next,t=t.baseState;var o=n=null,r=null,a=l;do{var i=a.lane;if((MC&i)===i)r!==null&&(r=r.next={lane:0,action:a.action,hasEagerState:a.hasEagerState,eagerState:a.eagerState,next:null}),t=a.hasEagerState?a.eagerState:g(t,a.action);else{var c={lane:i,action:a.action,hasEagerState:a.hasEagerState,eagerState:a.eagerState,next:null};r===null?(o=r=c,n=t):r=r.next=c,ae.lanes|=i,UC|=i}a=a.next}while(a!==null&&a!==l);r===null?n=t:r.next=o,ot(t,e.memoizedState)||(rI=!0),e.memoizedState=t,e.baseState=n,e.baseQueue=r,I.lastRenderedState=t}if(g=I.interleaved,g!==null){C=g;do l=C.lane,ae.lanes|=l,UC|=l,C=C.next;while(C!==g)}else C===null&&(I.lanes=0);return[e.memoizedState,I.dispatch]}function Ks(g){var e=TI(),I=e.queue;if(I===null)throw Error(T(311));I.lastRenderedReducer=g;var t=I.dispatch,C=I.pending,l=e.memoizedState;if(C!==null){I.pending=null;var n=C=C.next;do l=g(l,n.action),n=n.next;while(n!==C);ot(l,e.memoizedState)||(rI=!0),e.memoizedState=l,e.baseQueue===null&&(e.baseState=l),I.lastRenderedState=l}return[l,t]}function dp(){}function up(g,e){var I=ae,t=TI(),C=e(),l=!ot(t.memoizedState,C);if(l&&(t.memoizedState=C,rI=!0),t=t.queue,Ad(bp.bind(null,I,t,g),[g]),t.getSnapshot!==e||l||Xe!==null&&Xe.memoizedState.tag&1){if(I.flags|=2048,ao(9,Zp.bind(null,I,t,C,e),void 0,null),ke===null)throw Error(T(349));MC&30||mp(I,e,C)}return C}function mp(g,e,I){g.flags|=16384,g={getSnapshot:e,value:I},e=ae.updateQueue,e===null?(e={lastEffect:null,stores:null},ae.updateQueue=e,e.stores=[g]):(I=e.stores,I===null?e.stores=[g]:I.push(g))}function Zp(g,e,I,t){e.value=I,e.getSnapshot=t,Gp(e)&&pp(g)}function bp(g,e,I){return I(function(){Gp(e)&&pp(g)})}function Gp(g){var e=g.getSnapshot;g=g.value;try{var I=e();return!ot(g,I)}catch{return!0}}function pp(g){var e=zt(g,1);e!==null&&lt(e,g,1,-1)}function bm(g){var e=dt();return typeof g=="function"&&(g=g()),e.memoizedState=e.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ro,lastRenderedState:g},e.queue=g,g=g.dispatch=XS.bind(null,ae,g),[e.memoizedState,g]}function ao(g,e,I,t){return g={tag:g,create:e,destroy:I,deps:t,next:null},e=ae.updateQueue,e===null?(e={lastEffect:null,stores:null},ae.updateQueue=e,e.lastEffect=g.next=g):(I=e.lastEffect,I===null?e.lastEffect=g.next=g:(t=I.next,I.next=g,g.next=t,e.lastEffect=g)),g}function hp(){return TI().memoizedState}function Hr(g,e,I,t){var C=dt();ae.flags|=g,C.memoizedState=ao(1|e,I,void 0,t===void 0?null:t)}function Ta(g,e,I,t){var C=TI();t=t===void 0?null:t;var l=void 0;if(Re!==null){var n=Re.memoizedState;if(l=n.destroy,t!==null&&id(t,n.deps)){C.memoizedState=ao(e,I,l,t);return}}ae.flags|=g,C.memoizedState=ao(1|e,I,l,t)}function Gm(g,e){return Hr(8390656,8,g,e)}function Ad(g,e){return Ta(2048,8,g,e)}function yp(g,e){return Ta(4,2,g,e)}function Bp(g,e){return Ta(4,4,g,e)}function Sp(g,e){if(typeof e=="function")return g=g(),e(g),function(){e(null)};if(e!=null)return g=g(),e.current=g,function(){e.current=null}}function Wp(g,e,I){return I=I!=null?I.concat([g]):null,Ta(4,4,Sp.bind(null,e,g),I)}function dd(){}function Vp(g,e){var I=TI();e=e===void 0?null:e;var t=I.memoizedState;return t!==null&&e!==null&&id(e,t[1])?t[0]:(I.memoizedState=[g,e],g)}function Rp(g,e){var I=TI();e=e===void 0?null:e;var t=I.memoizedState;return t!==null&&e!==null&&id(e,t[1])?t[0]:(g=g(),I.memoizedState=[g,e],g)}function fp(g,e,I){return MC&21?(ot(I,e)||(I=YG(),ae.lanes|=I,UC|=I,g.baseState=!0),e):(g.baseState&&(g.baseState=!1,rI=!0),g.memoizedState=I)}function RS(g,e){var I=Mg;Mg=I!==0&&4>I?I:4,g(!0);var t=Ns.transition;Ns.transition={};try{g(!1),e()}finally{Mg=I,Ns.transition=t}}function Xp(){return TI().memoizedState}function fS(g,e,I){var t=iC(g);if(I={lane:t,action:I,hasEagerState:!1,eagerState:null,next:null},Jp(g))kp(e,I);else if(I=sp(g,e,I,t),I!==null){var C=eI();lt(I,g,t,C),vp(I,e,t)}}function XS(g,e,I){var t=iC(g),C={lane:t,action:I,hasEagerState:!1,eagerState:null,next:null};if(Jp(g))kp(e,C);else{var l=g.alternate;if(g.lanes===0&&(l===null||l.lanes===0)&&(l=e.lastRenderedReducer,l!==null))try{var n=e.lastRenderedState,o=l(n,I);if(C.hasEagerState=!0,C.eagerState=o,ot(o,n)){var r=e.interleaved;r===null?(C.next=C,ld(e)):(C.next=r.next,r.next=C),e.interleaved=C;return}}catch{}finally{}I=sp(g,e,C,t),I!==null&&(C=eI(),lt(I,g,t,C),vp(I,e,t))}}function Jp(g){var e=g.alternate;return g===ae||e!==null&&e===ae}function kp(g,e){zn=ca=!0;var I=g.pending;I===null?e.next=e:(e.next=I.next,I.next=e),g.pending=e}function vp(g,e,I){if(I&4194240){var t=e.lanes;t&=g.pendingLanes,I|=t,e.lanes=I,QA(g,I)}}var Aa={readContext:QI,useCallback:Ue,useContext:Ue,useEffect:Ue,useImperativeHandle:Ue,useInsertionEffect:Ue,useLayoutEffect:Ue,useMemo:Ue,useReducer:Ue,useRef:Ue,useState:Ue,useDebugValue:Ue,useDeferredValue:Ue,useTransition:Ue,useMutableSource:Ue,useSyncExternalStore:Ue,useId:Ue,unstable_isNewReconciler:!1},JS={readContext:QI,useCallback:function(g,e){return dt().memoizedState=[g,e===void 0?null:e],g},useContext:QI,useEffect:Gm,useImperativeHandle:function(g,e,I){return I=I!=null?I.concat([g]):null,Hr(4194308,4,Sp.bind(null,e,g),I)},useLayoutEffect:function(g,e){return Hr(4194308,4,g,e)},useInsertionEffect:function(g,e){return Hr(4,2,g,e)},useMemo:function(g,e){var I=dt();return e=e===void 0?null:e,g=g(),I.memoizedState=[g,e],g},useReducer:function(g,e,I){var t=dt();return e=I!==void 0?I(e):e,t.memoizedState=t.baseState=e,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:e},t.queue=g,g=g.dispatch=fS.bind(null,ae,g),[t.memoizedState,g]},useRef:function(g){var e=dt();return g={current:g},e.memoizedState=g},useState:bm,useDebugValue:dd,useDeferredValue:function(g){return dt().memoizedState=g},useTransition:function(){var g=bm(!1),e=g[0];return g=RS.bind(null,g[1]),dt().memoizedState=g,[e,g]},useMutableSource:function(){},useSyncExternalStore:function(g,e,I){var t=ae,C=dt();if(ne){if(I===void 0)throw Error(T(407));I=I()}else{if(I=e(),ke===null)throw Error(T(349));MC&30||mp(t,e,I)}C.memoizedState=I;var l={value:I,getSnapshot:e};return C.queue=l,Gm(bp.bind(null,t,l,g),[g]),t.flags|=2048,ao(9,Zp.bind(null,t,l,I,e),void 0,null),I},useId:function(){var g=dt(),e=ke.identifierPrefix;if(ne){var I=wt,t=Ht;I=(t&~(1<<32-Ct(t)-1)).toString(32)+I,e=":"+e+"R"+I,I=oo++,0<I&&(e+="H"+I.toString(32)),e+=":"}else I=VS++,e=":"+e+"r"+I.toString(32)+":";return g.memoizedState=e},unstable_isNewReconciler:!1},kS={readContext:QI,useCallback:Vp,useContext:QI,useEffect:Ad,useImperativeHandle:Wp,useInsertionEffect:yp,useLayoutEffect:Bp,useMemo:Rp,useReducer:Fs,useRef:hp,useState:function(){return Fs(ro)},useDebugValue:dd,useDeferredValue:function(g){var e=TI();return fp(e,Re.memoizedState,g)},useTransition:function(){var g=Fs(ro)[0],e=TI().memoizedState;return[g,e]},useMutableSource:dp,useSyncExternalStore:up,useId:Xp,unstable_isNewReconciler:!1},vS={readContext:QI,useCallback:Vp,useContext:QI,useEffect:Ad,useImperativeHandle:Wp,useInsertionEffect:yp,useLayoutEffect:Bp,useMemo:Rp,useReducer:Ks,useRef:hp,useState:function(){return Ks(ro)},useDebugValue:dd,useDeferredValue:function(g){var e=TI();return Re===null?e.memoizedState=g:fp(e,Re.memoizedState,g)},useTransition:function(){var g=Ks(ro)[0],e=TI().memoizedState;return[g,e]},useMutableSource:dp,useSyncExternalStore:up,useId:Xp,unstable_isNewReconciler:!1};function $I(g,e){if(g&&g.defaultProps){e=ie({},e),g=g.defaultProps;for(var I in g)e[I]===void 0&&(e[I]=g[I]);return e}return e}function zc(g,e,I,t){e=g.memoizedState,I=I(t,e),I=I==null?e:ie({},e,I),g.memoizedState=I,g.lanes===0&&(g.updateQueue.baseState=I)}var Da={isMounted:function(g){return(g=g._reactInternals)?PC(g)===g:!1},enqueueSetState:function(g,e,I){g=g._reactInternals;var t=eI(),C=iC(g),l=Nt(t,C);l.payload=e,I!=null&&(l.callback=I),e=rC(g,l,C),e!==null&&(lt(e,g,C,t),vr(e,g,C))},enqueueReplaceState:function(g,e,I){g=g._reactInternals;var t=eI(),C=iC(g),l=Nt(t,C);l.tag=1,l.payload=e,I!=null&&(l.callback=I),e=rC(g,l,C),e!==null&&(lt(e,g,C,t),vr(e,g,C))},enqueueForceUpdate:function(g,e){g=g._reactInternals;var I=eI(),t=iC(g),C=Nt(I,t);C.tag=2,e!=null&&(C.callback=e),e=rC(g,C,t),e!==null&&(lt(e,g,t,I),vr(e,g,t))}};function pm(g,e,I,t,C,l,n){return g=g.stateNode,typeof g.shouldComponentUpdate=="function"?g.shouldComponentUpdate(t,l,n):e.prototype&&e.prototype.isPureReactComponent?!eo(I,t)||!eo(C,l):!0}function Yp(g,e,I){var t=!1,C=AC,l=e.contextType;return typeof l=="object"&&l!==null?l=QI(l):(C=iI(e)?EC:Oe.current,t=e.contextTypes,l=(t=t!=null)?Yl(g,C):AC),e=new e(I,l),g.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Da,g.stateNode=e,e._reactInternals=g,t&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=C,g.__reactInternalMemoizedMaskedChildContext=l),e}function hm(g,e,I,t){g=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(I,t),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(I,t),e.state!==g&&Da.enqueueReplaceState(e,e.state,null)}function Mc(g,e,I,t){var C=g.stateNode;C.props=I,C.state=g.memoizedState,C.refs={},nd(g);var l=e.contextType;typeof l=="object"&&l!==null?C.context=QI(l):(l=iI(e)?EC:Oe.current,C.context=Yl(g,l)),C.state=g.memoizedState,l=e.getDerivedStateFromProps,typeof l=="function"&&(zc(g,e,l,I),C.state=g.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(e=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),e!==C.state&&Da.enqueueReplaceState(C,C.state,null),ia(g,I,C,t),C.state=g.memoizedState),typeof C.componentDidMount=="function"&&(g.flags|=4194308)}function Fl(g,e){try{var I="",t=e;do I+=nB(t),t=t.return;while(t);var C=I}catch(l){C=`
Error generating stack: `+l.message+`
`+l.stack}return{value:g,source:e,stack:C,digest:null}}function xs(g,e,I){return{value:g,source:null,stack:I??null,digest:e??null}}function Uc(g,e){try{console.error(e.value)}catch(I){setTimeout(function(){throw I})}}var YS=typeof WeakMap=="function"?WeakMap:Map;function Hp(g,e,I){I=Nt(-1,I),I.tag=3,I.payload={element:null};var t=e.value;return I.callback=function(){ua||(ua=!0,_c=t),Uc(g,e)},I}function wp(g,e,I){I=Nt(-1,I),I.tag=3;var t=g.type.getDerivedStateFromError;if(typeof t=="function"){var C=e.value;I.payload=function(){return t(C)},I.callback=function(){Uc(g,e)}}var l=g.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(I.callback=function(){Uc(g,e),typeof t!="function"&&(aC===null?aC=new Set([this]):aC.add(this));var n=e.stack;this.componentDidCatch(e.value,{componentStack:n!==null?n:""})}),I}function ym(g,e,I){var t=g.pingCache;if(t===null){t=g.pingCache=new YS;var C=new Set;t.set(e,C)}else C=t.get(e),C===void 0&&(C=new Set,t.set(e,C));C.has(I)||(C.add(I),g=DS.bind(null,g,e,I),e.then(g,g))}function Bm(g){do{var e;if((e=g.tag===13)&&(e=g.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return g;g=g.return}while(g!==null);return null}function Sm(g,e,I,t,C){return g.mode&1?(g.flags|=65536,g.lanes=C,g):(g===e?g.flags|=65536:(g.flags|=128,I.flags|=131072,I.flags&=-52805,I.tag===1&&(I.alternate===null?I.tag=17:(e=Nt(-1,1),e.tag=2,rC(I,e,1))),I.lanes|=1),g)}var HS=Lt.ReactCurrentOwner,rI=!1;function _e(g,e,I,t){e.child=g===null?ip(e,null,I,t):wl(e,g.child,I,t)}function Wm(g,e,I,t,C){I=I.render;var l=e.ref;return fl(e,C),t=sd(g,e,I,t,l,C),I=cd(),g!==null&&!rI?(e.updateQueue=g.updateQueue,e.flags&=-2053,g.lanes&=~C,Mt(g,e,C)):(ne&&I&&_A(e),e.flags|=1,_e(g,e,t,C),e.child)}function Vm(g,e,I,t,C){if(g===null){var l=I.type;return typeof l=="function"&&!yd(l)&&l.defaultProps===void 0&&I.compare===null&&I.defaultProps===void 0?(e.tag=15,e.type=l,Np(g,e,l,t,C)):(g=Kr(I.type,null,t,e,e.mode,C),g.ref=e.ref,g.return=e,e.child=g)}if(l=g.child,!(g.lanes&C)){var n=l.memoizedProps;if(I=I.compare,I=I!==null?I:eo,I(n,t)&&g.ref===e.ref)return Mt(g,e,C)}return e.flags|=1,g=sC(l,t),g.ref=e.ref,g.return=e,e.child=g}function Np(g,e,I,t,C){if(g!==null){var l=g.memoizedProps;if(eo(l,t)&&g.ref===e.ref)if(rI=!1,e.pendingProps=t=l,(g.lanes&C)!==0)g.flags&131072&&(rI=!0);else return e.lanes=g.lanes,Mt(g,e,C)}return Lc(g,e,I,t,C)}function Fp(g,e,I){var t=e.pendingProps,C=t.children,l=g!==null?g.memoizedState:null;if(t.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ge(hl,hI),hI|=I;else{if(!(I&1073741824))return g=l!==null?l.baseLanes|I:I,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:g,cachePool:null,transitions:null},e.updateQueue=null,ge(hl,hI),hI|=g,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},t=l!==null?l.baseLanes:I,ge(hl,hI),hI|=t}else l!==null?(t=l.baseLanes|I,e.memoizedState=null):t=I,ge(hl,hI),hI|=t;return _e(g,e,C,I),e.child}function Kp(g,e){var I=e.ref;(g===null&&I!==null||g!==null&&g.ref!==I)&&(e.flags|=512,e.flags|=2097152)}function Lc(g,e,I,t,C){var l=iI(I)?EC:Oe.current;return l=Yl(e,l),fl(e,C),I=sd(g,e,I,t,l,C),t=cd(),g!==null&&!rI?(e.updateQueue=g.updateQueue,e.flags&=-2053,g.lanes&=~C,Mt(g,e,C)):(ne&&t&&_A(e),e.flags|=1,_e(g,e,I,C),e.child)}function Rm(g,e,I,t,C){if(iI(I)){var l=!0;la(e)}else l=!1;if(fl(e,C),e.stateNode===null)wr(g,e),Yp(e,I,t),Mc(e,I,t,C),t=!0;else if(g===null){var n=e.stateNode,o=e.memoizedProps;n.props=o;var r=n.context,a=I.contextType;typeof a=="object"&&a!==null?a=QI(a):(a=iI(I)?EC:Oe.current,a=Yl(e,a));var i=I.getDerivedStateFromProps,c=typeof i=="function"||typeof n.getSnapshotBeforeUpdate=="function";c||typeof n.UNSAFE_componentWillReceiveProps!="function"&&typeof n.componentWillReceiveProps!="function"||(o!==t||r!==a)&&hm(e,n,t,a),_t=!1;var A=e.memoizedState;n.state=A,ia(e,t,n,C),r=e.memoizedState,o!==t||A!==r||aI.current||_t?(typeof i=="function"&&(zc(e,I,i,t),r=e.memoizedState),(o=_t||pm(e,I,o,t,A,r,a))?(c||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount()),typeof n.componentDidMount=="function"&&(e.flags|=4194308)):(typeof n.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=t,e.memoizedState=r),n.props=t,n.state=r,n.context=a,t=o):(typeof n.componentDidMount=="function"&&(e.flags|=4194308),t=!1)}else{n=e.stateNode,cp(g,e),o=e.memoizedProps,a=e.type===e.elementType?o:$I(e.type,o),n.props=a,c=e.pendingProps,A=n.context,r=I.contextType,typeof r=="object"&&r!==null?r=QI(r):(r=iI(I)?EC:Oe.current,r=Yl(e,r));var p=I.getDerivedStateFromProps;(i=typeof p=="function"||typeof n.getSnapshotBeforeUpdate=="function")||typeof n.UNSAFE_componentWillReceiveProps!="function"&&typeof n.componentWillReceiveProps!="function"||(o!==c||A!==r)&&hm(e,n,t,r),_t=!1,A=e.memoizedState,n.state=A,ia(e,t,n,C);var G=e.memoizedState;o!==c||A!==G||aI.current||_t?(typeof p=="function"&&(zc(e,I,p,t),G=e.memoizedState),(a=_t||pm(e,I,a,t,A,G,r)||!1)?(i||typeof n.UNSAFE_componentWillUpdate!="function"&&typeof n.componentWillUpdate!="function"||(typeof n.componentWillUpdate=="function"&&n.componentWillUpdate(t,G,r),typeof n.UNSAFE_componentWillUpdate=="function"&&n.UNSAFE_componentWillUpdate(t,G,r)),typeof n.componentDidUpdate=="function"&&(e.flags|=4),typeof n.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof n.componentDidUpdate!="function"||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=4),typeof n.getSnapshotBeforeUpdate!="function"||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=1024),e.memoizedProps=t,e.memoizedState=G),n.props=t,n.state=G,n.context=r,t=a):(typeof n.componentDidUpdate!="function"||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=4),typeof n.getSnapshotBeforeUpdate!="function"||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=1024),t=!1)}return Qc(g,e,I,t,l,C)}function Qc(g,e,I,t,C,l){Kp(g,e);var n=(e.flags&128)!==0;if(!t&&!n)return C&&cm(e,I,!1),Mt(g,e,l);t=e.stateNode,HS.current=e;var o=n&&typeof I.getDerivedStateFromError!="function"?null:t.render();return e.flags|=1,g!==null&&n?(e.child=wl(e,g.child,null,l),e.child=wl(e,null,o,l)):_e(g,e,o,l),e.memoizedState=t.state,C&&cm(e,I,!0),e.child}function xp(g){var e=g.stateNode;e.pendingContext?sm(g,e.pendingContext,e.pendingContext!==e.context):e.context&&sm(g,e.context,!1),od(g,e.containerInfo)}function fm(g,e,I,t,C){return Hl(),ed(C),e.flags|=256,_e(g,e,I,t),e.child}var Tc={dehydrated:null,treeContext:null,retryLane:0};function Dc(g){return{baseLanes:g,cachePool:null,transitions:null}}function Ep(g,e,I){var t=e.pendingProps,C=re.current,l=!1,n=(e.flags&128)!==0,o;if((o=n)||(o=g!==null&&g.memoizedState===null?!1:(C&2)!==0),o?(l=!0,e.flags&=-129):(g===null||g.memoizedState!==null)&&(C|=1),ge(re,C&1),g===null)return xc(e),g=e.memoizedState,g!==null&&(g=g.dehydrated,g!==null)?(e.mode&1?g.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(n=t.children,g=t.fallback,l?(t=e.mode,l=e.child,n={mode:"hidden",children:n},!(t&1)&&l!==null?(l.childLanes=0,l.pendingProps=n):l=Oa(n,t,0,null),g=KC(g,t,I,null),l.return=e,g.return=e,l.sibling=g,e.child=l,e.child.memoizedState=Dc(I),e.memoizedState=Tc,g):ud(e,n));if(C=g.memoizedState,C!==null&&(o=C.dehydrated,o!==null))return wS(g,e,n,t,o,C,I);if(l){l=t.fallback,n=e.mode,C=g.child,o=C.sibling;var r={mode:"hidden",children:t.children};return!(n&1)&&e.child!==C?(t=e.child,t.childLanes=0,t.pendingProps=r,e.deletions=null):(t=sC(C,r),t.subtreeFlags=C.subtreeFlags&14680064),o!==null?l=sC(o,l):(l=KC(l,n,I,null),l.flags|=2),l.return=e,t.return=e,t.sibling=l,e.child=t,t=l,l=e.child,n=g.child.memoizedState,n=n===null?Dc(I):{baseLanes:n.baseLanes|I,cachePool:null,transitions:n.transitions},l.memoizedState=n,l.childLanes=g.childLanes&~I,e.memoizedState=Tc,t}return l=g.child,g=l.sibling,t=sC(l,{mode:"visible",children:t.children}),!(e.mode&1)&&(t.lanes=I),t.return=e,t.sibling=null,g!==null&&(I=e.deletions,I===null?(e.deletions=[g],e.flags|=16):I.push(g)),e.child=t,e.memoizedState=null,t}function ud(g,e){return e=Oa({mode:"visible",children:e},g.mode,0,null),e.return=g,g.child=e}function dr(g,e,I,t){return t!==null&&ed(t),wl(e,g.child,null,I),g=ud(e,e.pendingProps.children),g.flags|=2,e.memoizedState=null,g}function wS(g,e,I,t,C,l,n){if(I)return e.flags&256?(e.flags&=-257,t=xs(Error(T(422))),dr(g,e,n,t)):e.memoizedState!==null?(e.child=g.child,e.flags|=128,null):(l=t.fallback,C=e.mode,t=Oa({mode:"visible",children:t.children},C,0,null),l=KC(l,C,n,null),l.flags|=2,t.return=e,l.return=e,t.sibling=l,e.child=t,e.mode&1&&wl(e,g.child,null,n),e.child.memoizedState=Dc(n),e.memoizedState=Tc,l);if(!(e.mode&1))return dr(g,e,n,null);if(C.data==="$!"){if(t=C.nextSibling&&C.nextSibling.dataset,t)var o=t.dgst;return t=o,l=Error(T(419)),t=xs(l,t,void 0),dr(g,e,n,t)}if(o=(n&g.childLanes)!==0,rI||o){if(t=ke,t!==null){switch(n&-n){case 4:C=2;break;case 16:C=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:C=32;break;case 536870912:C=268435456;break;default:C=0}C=C&(t.suspendedLanes|n)?0:C,C!==0&&C!==l.retryLane&&(l.retryLane=C,zt(g,C),lt(t,g,C,-1))}return hd(),t=xs(Error(T(421))),dr(g,e,n,t)}return C.data==="$?"?(e.flags|=128,e.child=g.child,e=jS.bind(null,g),C._reactRetry=e,null):(g=l.treeContext,SI=oC(C.nextSibling),WI=e,ne=!0,et=null,g!==null&&(EI[zI++]=Ht,EI[zI++]=wt,EI[zI++]=zC,Ht=g.id,wt=g.overflow,zC=e),e=ud(e,t.children),e.flags|=4096,e)}function Xm(g,e,I){g.lanes|=e;var t=g.alternate;t!==null&&(t.lanes|=e),Ec(g.return,e,I)}function Es(g,e,I,t,C){var l=g.memoizedState;l===null?g.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:t,tail:I,tailMode:C}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=t,l.tail=I,l.tailMode=C)}function zp(g,e,I){var t=e.pendingProps,C=t.revealOrder,l=t.tail;if(_e(g,e,t.children,I),t=re.current,t&2)t=t&1|2,e.flags|=128;else{if(g!==null&&g.flags&128)g:for(g=e.child;g!==null;){if(g.tag===13)g.memoizedState!==null&&Xm(g,I,e);else if(g.tag===19)Xm(g,I,e);else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break g;for(;g.sibling===null;){if(g.return===null||g.return===e)break g;g=g.return}g.sibling.return=g.return,g=g.sibling}t&=1}if(ge(re,t),!(e.mode&1))e.memoizedState=null;else switch(C){case"forwards":for(I=e.child,C=null;I!==null;)g=I.alternate,g!==null&&sa(g)===null&&(C=I),I=I.sibling;I=C,I===null?(C=e.child,e.child=null):(C=I.sibling,I.sibling=null),Es(e,!1,C,I,l);break;case"backwards":for(I=null,C=e.child,e.child=null;C!==null;){if(g=C.alternate,g!==null&&sa(g)===null){e.child=C;break}g=C.sibling,C.sibling=I,I=C,C=g}Es(e,!0,I,null,l);break;case"together":Es(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wr(g,e){!(e.mode&1)&&g!==null&&(g.alternate=null,e.alternate=null,e.flags|=2)}function Mt(g,e,I){if(g!==null&&(e.dependencies=g.dependencies),UC|=e.lanes,!(I&e.childLanes))return null;if(g!==null&&e.child!==g.child)throw Error(T(153));if(e.child!==null){for(g=e.child,I=sC(g,g.pendingProps),e.child=I,I.return=e;g.sibling!==null;)g=g.sibling,I=I.sibling=sC(g,g.pendingProps),I.return=e;I.sibling=null}return e.child}function NS(g,e,I){switch(e.tag){case 3:xp(e),Hl();break;case 5:Ap(e);break;case 1:iI(e.type)&&la(e);break;case 4:od(e,e.stateNode.containerInfo);break;case 10:var t=e.type._context,C=e.memoizedProps.value;ge(ra,t._currentValue),t._currentValue=C;break;case 13:if(t=e.memoizedState,t!==null)return t.dehydrated!==null?(ge(re,re.current&1),e.flags|=128,null):I&e.child.childLanes?Ep(g,e,I):(ge(re,re.current&1),g=Mt(g,e,I),g!==null?g.sibling:null);ge(re,re.current&1);break;case 19:if(t=(I&e.childLanes)!==0,g.flags&128){if(t)return zp(g,e,I);e.flags|=128}if(C=e.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),ge(re,re.current),t)break;return null;case 22:case 23:return e.lanes=0,Fp(g,e,I)}return Mt(g,e,I)}var Mp,jc,Up,Lp;Mp=function(g,e){for(var I=e.child;I!==null;){if(I.tag===5||I.tag===6)g.appendChild(I.stateNode);else if(I.tag!==4&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===e)break;for(;I.sibling===null;){if(I.return===null||I.return===e)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};jc=function(){};Up=function(g,e,I,t){var C=g.memoizedProps;if(C!==t){g=e.stateNode,vC(yt.current);var l=null;switch(I){case"input":C=mc(g,C),t=mc(g,t),l=[];break;case"select":C=ie({},C,{value:void 0}),t=ie({},t,{value:void 0}),l=[];break;case"textarea":C=Gc(g,C),t=Gc(g,t),l=[];break;default:typeof C.onClick!="function"&&typeof t.onClick=="function"&&(g.onclick=ta)}hc(I,t);var n;I=null;for(a in C)if(!t.hasOwnProperty(a)&&C.hasOwnProperty(a)&&C[a]!=null)if(a==="style"){var o=C[a];for(n in o)o.hasOwnProperty(n)&&(I||(I={}),I[n]="")}else a!=="dangerouslySetInnerHTML"&&a!=="children"&&a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(jn.hasOwnProperty(a)?l||(l=[]):(l=l||[]).push(a,null));for(a in t){var r=t[a];if(o=C!=null?C[a]:void 0,t.hasOwnProperty(a)&&r!==o&&(r!=null||o!=null))if(a==="style")if(o){for(n in o)!o.hasOwnProperty(n)||r&&r.hasOwnProperty(n)||(I||(I={}),I[n]="");for(n in r)r.hasOwnProperty(n)&&o[n]!==r[n]&&(I||(I={}),I[n]=r[n])}else I||(l||(l=[]),l.push(a,I)),I=r;else a==="dangerouslySetInnerHTML"?(r=r?r.__html:void 0,o=o?o.__html:void 0,r!=null&&o!==r&&(l=l||[]).push(a,r)):a==="children"?typeof r!="string"&&typeof r!="number"||(l=l||[]).push(a,""+r):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&(jn.hasOwnProperty(a)?(r!=null&&a==="onScroll"&&ee("scroll",g),l||o===r||(l=[])):(l=l||[]).push(a,r))}I&&(l=l||[]).push("style",I);var a=l;(e.updateQueue=a)&&(e.flags|=4)}};Lp=function(g,e,I,t){I!==t&&(e.flags|=4)};function cn(g,e){if(!ne)switch(g.tailMode){case"hidden":e=g.tail;for(var I=null;e!==null;)e.alternate!==null&&(I=e),e=e.sibling;I===null?g.tail=null:I.sibling=null;break;case"collapsed":I=g.tail;for(var t=null;I!==null;)I.alternate!==null&&(t=I),I=I.sibling;t===null?e||g.tail===null?g.tail=null:g.tail.sibling=null:t.sibling=null}}function Le(g){var e=g.alternate!==null&&g.alternate.child===g.child,I=0,t=0;if(e)for(var C=g.child;C!==null;)I|=C.lanes|C.childLanes,t|=C.subtreeFlags&14680064,t|=C.flags&14680064,C.return=g,C=C.sibling;else for(C=g.child;C!==null;)I|=C.lanes|C.childLanes,t|=C.subtreeFlags,t|=C.flags,C.return=g,C=C.sibling;return g.subtreeFlags|=t,g.childLanes=I,e}function FS(g,e,I){var t=e.pendingProps;switch(gd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Le(e),null;case 1:return iI(e.type)&&Ca(),Le(e),null;case 3:return t=e.stateNode,Nl(),Ie(aI),Ie(Oe),ad(),t.pendingContext&&(t.context=t.pendingContext,t.pendingContext=null),(g===null||g.child===null)&&(cr(e)?e.flags|=4:g===null||g.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,et!==null&&(IA(et),et=null))),jc(g,e),Le(e),null;case 5:rd(e);var C=vC(no.current);if(I=e.type,g!==null&&e.stateNode!=null)Up(g,e,I,t,C),g.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!t){if(e.stateNode===null)throw Error(T(166));return Le(e),null}if(g=vC(yt.current),cr(e)){t=e.stateNode,I=e.type;var l=e.memoizedProps;switch(t[Zt]=e,t[Co]=l,g=(e.mode&1)!==0,I){case"dialog":ee("cancel",t),ee("close",t);break;case"iframe":case"object":case"embed":ee("load",t);break;case"video":case"audio":for(C=0;C<fn.length;C++)ee(fn[C],t);break;case"source":ee("error",t);break;case"img":case"image":case"link":ee("error",t),ee("load",t);break;case"details":ee("toggle",t);break;case"input":Ku(t,l),ee("invalid",t);break;case"select":t._wrapperState={wasMultiple:!!l.multiple},ee("invalid",t);break;case"textarea":Eu(t,l),ee("invalid",t)}hc(I,l),C=null;for(var n in l)if(l.hasOwnProperty(n)){var o=l[n];n==="children"?typeof o=="string"?t.textContent!==o&&(l.suppressHydrationWarning!==!0&&sr(t.textContent,o,g),C=["children",o]):typeof o=="number"&&t.textContent!==""+o&&(l.suppressHydrationWarning!==!0&&sr(t.textContent,o,g),C=["children",""+o]):jn.hasOwnProperty(n)&&o!=null&&n==="onScroll"&&ee("scroll",t)}switch(I){case"input":tr(t),xu(t,l,!0);break;case"textarea":tr(t),zu(t);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(t.onclick=ta)}t=C,e.updateQueue=t,t!==null&&(e.flags|=4)}else{n=C.nodeType===9?C:C.ownerDocument,g==="http://www.w3.org/1999/xhtml"&&(g=bG(I)),g==="http://www.w3.org/1999/xhtml"?I==="script"?(g=n.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild)):typeof t.is=="string"?g=n.createElement(I,{is:t.is}):(g=n.createElement(I),I==="select"&&(n=g,t.multiple?n.multiple=!0:t.size&&(n.size=t.size))):g=n.createElementNS(g,I),g[Zt]=e,g[Co]=t,Mp(g,e,!1,!1),e.stateNode=g;g:{switch(n=yc(I,t),I){case"dialog":ee("cancel",g),ee("close",g),C=t;break;case"iframe":case"object":case"embed":ee("load",g),C=t;break;case"video":case"audio":for(C=0;C<fn.length;C++)ee(fn[C],g);C=t;break;case"source":ee("error",g),C=t;break;case"img":case"image":case"link":ee("error",g),ee("load",g),C=t;break;case"details":ee("toggle",g),C=t;break;case"input":Ku(g,t),C=mc(g,t),ee("invalid",g);break;case"option":C=t;break;case"select":g._wrapperState={wasMultiple:!!t.multiple},C=ie({},t,{value:void 0}),ee("invalid",g);break;case"textarea":Eu(g,t),C=Gc(g,t),ee("invalid",g);break;default:C=t}hc(I,C),o=C;for(l in o)if(o.hasOwnProperty(l)){var r=o[l];l==="style"?hG(g,r):l==="dangerouslySetInnerHTML"?(r=r?r.__html:void 0,r!=null&&GG(g,r)):l==="children"?typeof r=="string"?(I!=="textarea"||r!=="")&&Pn(g,r):typeof r=="number"&&Pn(g,""+r):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(jn.hasOwnProperty(l)?r!=null&&l==="onScroll"&&ee("scroll",g):r!=null&&xA(g,l,r,n))}switch(I){case"input":tr(g),xu(g,t,!1);break;case"textarea":tr(g),zu(g);break;case"option":t.value!=null&&g.setAttribute("value",""+cC(t.value));break;case"select":g.multiple=!!t.multiple,l=t.value,l!=null?Sl(g,!!t.multiple,l,!1):t.defaultValue!=null&&Sl(g,!!t.multiple,t.defaultValue,!0);break;default:typeof C.onClick=="function"&&(g.onclick=ta)}switch(I){case"button":case"input":case"select":case"textarea":t=!!t.autoFocus;break g;case"img":t=!0;break g;default:t=!1}}t&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Le(e),null;case 6:if(g&&e.stateNode!=null)Lp(g,e,g.memoizedProps,t);else{if(typeof t!="string"&&e.stateNode===null)throw Error(T(166));if(I=vC(no.current),vC(yt.current),cr(e)){if(t=e.stateNode,I=e.memoizedProps,t[Zt]=e,(l=t.nodeValue!==I)&&(g=WI,g!==null))switch(g.tag){case 3:sr(t.nodeValue,I,(g.mode&1)!==0);break;case 5:g.memoizedProps.suppressHydrationWarning!==!0&&sr(t.nodeValue,I,(g.mode&1)!==0)}l&&(e.flags|=4)}else t=(I.nodeType===9?I:I.ownerDocument).createTextNode(t),t[Zt]=e,e.stateNode=t}return Le(e),null;case 13:if(Ie(re),t=e.memoizedState,g===null||g.memoizedState!==null&&g.memoizedState.dehydrated!==null){if(ne&&SI!==null&&e.mode&1&&!(e.flags&128))rp(),Hl(),e.flags|=98560,l=!1;else if(l=cr(e),t!==null&&t.dehydrated!==null){if(g===null){if(!l)throw Error(T(318));if(l=e.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(T(317));l[Zt]=e}else Hl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Le(e),l=!1}else et!==null&&(IA(et),et=null),l=!0;if(!l)return e.flags&65536?e:null}return e.flags&128?(e.lanes=I,e):(t=t!==null,t!==(g!==null&&g.memoizedState!==null)&&t&&(e.child.flags|=8192,e.mode&1&&(g===null||re.current&1?fe===0&&(fe=3):hd())),e.updateQueue!==null&&(e.flags|=4),Le(e),null);case 4:return Nl(),jc(g,e),g===null&&Io(e.stateNode.containerInfo),Le(e),null;case 10:return Cd(e.type._context),Le(e),null;case 17:return iI(e.type)&&Ca(),Le(e),null;case 19:if(Ie(re),l=e.memoizedState,l===null)return Le(e),null;if(t=(e.flags&128)!==0,n=l.rendering,n===null)if(t)cn(l,!1);else{if(fe!==0||g!==null&&g.flags&128)for(g=e.child;g!==null;){if(n=sa(g),n!==null){for(e.flags|=128,cn(l,!1),t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),e.subtreeFlags=0,t=I,I=e.child;I!==null;)l=I,g=t,l.flags&=14680066,n=l.alternate,n===null?(l.childLanes=0,l.lanes=g,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,l.type=n.type,g=n.dependencies,l.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),I=I.sibling;return ge(re,re.current&1|2),e.child}g=g.sibling}l.tail!==null&&be()>Kl&&(e.flags|=128,t=!0,cn(l,!1),e.lanes=4194304)}else{if(!t)if(g=sa(n),g!==null){if(e.flags|=128,t=!0,I=g.updateQueue,I!==null&&(e.updateQueue=I,e.flags|=4),cn(l,!0),l.tail===null&&l.tailMode==="hidden"&&!n.alternate&&!ne)return Le(e),null}else 2*be()-l.renderingStartTime>Kl&&I!==1073741824&&(e.flags|=128,t=!0,cn(l,!1),e.lanes=4194304);l.isBackwards?(n.sibling=e.child,e.child=n):(I=l.last,I!==null?I.sibling=n:e.child=n,l.last=n)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=be(),e.sibling=null,I=re.current,ge(re,t?I&1|2:I&1),e):(Le(e),null);case 22:case 23:return pd(),t=e.memoizedState!==null,g!==null&&g.memoizedState!==null!==t&&(e.flags|=8192),t&&e.mode&1?hI&1073741824&&(Le(e),e.subtreeFlags&6&&(e.flags|=8192)):Le(e),null;case 24:return null;case 25:return null}throw Error(T(156,e.tag))}function KS(g,e){switch(gd(e),e.tag){case 1:return iI(e.type)&&Ca(),g=e.flags,g&65536?(e.flags=g&-65537|128,e):null;case 3:return Nl(),Ie(aI),Ie(Oe),ad(),g=e.flags,g&65536&&!(g&128)?(e.flags=g&-65537|128,e):null;case 5:return rd(e),null;case 13:if(Ie(re),g=e.memoizedState,g!==null&&g.dehydrated!==null){if(e.alternate===null)throw Error(T(340));Hl()}return g=e.flags,g&65536?(e.flags=g&-65537|128,e):null;case 19:return Ie(re),null;case 4:return Nl(),null;case 10:return Cd(e.type._context),null;case 22:case 23:return pd(),null;case 24:return null;default:return null}}var ur=!1,De=!1,xS=typeof WeakSet=="function"?WeakSet:Set,gg=null;function pl(g,e){var I=g.ref;if(I!==null)if(typeof I=="function")try{I(null)}catch(t){me(g,e,t)}else I.current=null}function Pc(g,e,I){try{I()}catch(t){me(g,e,t)}}var Jm=!1;function ES(g,e){if(vc=ga,g=PG(),$A(g)){if("selectionStart"in g)var I={start:g.selectionStart,end:g.selectionEnd};else g:{I=(I=g.ownerDocument)&&I.defaultView||window;var t=I.getSelection&&I.getSelection();if(t&&t.rangeCount!==0){I=t.anchorNode;var C=t.anchorOffset,l=t.focusNode;t=t.focusOffset;try{I.nodeType,l.nodeType}catch{I=null;break g}var n=0,o=-1,r=-1,a=0,i=0,c=g,A=null;e:for(;;){for(var p;c!==I||C!==0&&c.nodeType!==3||(o=n+C),c!==l||t!==0&&c.nodeType!==3||(r=n+t),c.nodeType===3&&(n+=c.nodeValue.length),(p=c.firstChild)!==null;)A=c,c=p;for(;;){if(c===g)break e;if(A===I&&++a===C&&(o=n),A===l&&++i===t&&(r=n),(p=c.nextSibling)!==null)break;c=A,A=c.parentNode}c=p}I=o===-1||r===-1?null:{start:o,end:r}}else I=null}I=I||{start:0,end:0}}else I=null;for(Yc={focusedElem:g,selectionRange:I},ga=!1,gg=e;gg!==null;)if(e=gg,g=e.child,(e.subtreeFlags&1028)!==0&&g!==null)g.return=e,gg=g;else for(;gg!==null;){e=gg;try{var G=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(G!==null){var Z=G.memoizedProps,h=G.memoizedState,u=e.stateNode,b=u.getSnapshotBeforeUpdate(e.elementType===e.type?Z:$I(e.type,Z),h);u.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(T(163))}}catch(B){me(e,e.return,B)}if(g=e.sibling,g!==null){g.return=e.return,gg=g;break}gg=e.return}return G=Jm,Jm=!1,G}function Mn(g,e,I){var t=e.updateQueue;if(t=t!==null?t.lastEffect:null,t!==null){var C=t=t.next;do{if((C.tag&g)===g){var l=C.destroy;C.destroy=void 0,l!==void 0&&Pc(e,I,l)}C=C.next}while(C!==t)}}function ja(g,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var I=e=e.next;do{if((I.tag&g)===g){var t=I.create;I.destroy=t()}I=I.next}while(I!==e)}}function Oc(g){var e=g.ref;if(e!==null){var I=g.stateNode;switch(g.tag){case 5:g=I;break;default:g=I}typeof e=="function"?e(g):e.current=g}}function Qp(g){var e=g.alternate;e!==null&&(g.alternate=null,Qp(e)),g.child=null,g.deletions=null,g.sibling=null,g.tag===5&&(e=g.stateNode,e!==null&&(delete e[Zt],delete e[Co],delete e[Nc],delete e[yS],delete e[BS])),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function Tp(g){return g.tag===5||g.tag===3||g.tag===4}function km(g){g:for(;;){for(;g.sibling===null;){if(g.return===null||Tp(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;g.tag!==5&&g.tag!==6&&g.tag!==18;){if(g.flags&2||g.child===null||g.tag===4)continue g;g.child.return=g,g=g.child}if(!(g.flags&2))return g.stateNode}}function qc(g,e,I){var t=g.tag;if(t===5||t===6)g=g.stateNode,e?I.nodeType===8?I.parentNode.insertBefore(g,e):I.insertBefore(g,e):(I.nodeType===8?(e=I.parentNode,e.insertBefore(g,I)):(e=I,e.appendChild(g)),I=I._reactRootContainer,I!=null||e.onclick!==null||(e.onclick=ta));else if(t!==4&&(g=g.child,g!==null))for(qc(g,e,I),g=g.sibling;g!==null;)qc(g,e,I),g=g.sibling}function $c(g,e,I){var t=g.tag;if(t===5||t===6)g=g.stateNode,e?I.insertBefore(g,e):I.appendChild(g);else if(t!==4&&(g=g.child,g!==null))for($c(g,e,I),g=g.sibling;g!==null;)$c(g,e,I),g=g.sibling}var Fe=null,_I=!1;function Tt(g,e,I){for(I=I.child;I!==null;)Dp(g,e,I),I=I.sibling}function Dp(g,e,I){if(ht&&typeof ht.onCommitFiberUnmount=="function")try{ht.onCommitFiberUnmount(Ea,I)}catch{}switch(I.tag){case 5:De||pl(I,e);case 6:var t=Fe,C=_I;Fe=null,Tt(g,e,I),Fe=t,_I=C,Fe!==null&&(_I?(g=Fe,I=I.stateNode,g.nodeType===8?g.parentNode.removeChild(I):g.removeChild(I)):Fe.removeChild(I.stateNode));break;case 18:Fe!==null&&(_I?(g=Fe,I=I.stateNode,g.nodeType===8?Ys(g.parentNode,I):g.nodeType===1&&Ys(g,I),_n(g)):Ys(Fe,I.stateNode));break;case 4:t=Fe,C=_I,Fe=I.stateNode.containerInfo,_I=!0,Tt(g,e,I),Fe=t,_I=C;break;case 0:case 11:case 14:case 15:if(!De&&(t=I.updateQueue,t!==null&&(t=t.lastEffect,t!==null))){C=t=t.next;do{var l=C,n=l.destroy;l=l.tag,n!==void 0&&(l&2||l&4)&&Pc(I,e,n),C=C.next}while(C!==t)}Tt(g,e,I);break;case 1:if(!De&&(pl(I,e),t=I.stateNode,typeof t.componentWillUnmount=="function"))try{t.props=I.memoizedProps,t.state=I.memoizedState,t.componentWillUnmount()}catch(o){me(I,e,o)}Tt(g,e,I);break;case 21:Tt(g,e,I);break;case 22:I.mode&1?(De=(t=De)||I.memoizedState!==null,Tt(g,e,I),De=t):Tt(g,e,I);break;default:Tt(g,e,I)}}function vm(g){var e=g.updateQueue;if(e!==null){g.updateQueue=null;var I=g.stateNode;I===null&&(I=g.stateNode=new xS),e.forEach(function(t){var C=PS.bind(null,g,t);I.has(t)||(I.add(t),t.then(C,C))})}}function qI(g,e){var I=e.deletions;if(I!==null)for(var t=0;t<I.length;t++){var C=I[t];try{var l=g,n=e,o=n;g:for(;o!==null;){switch(o.tag){case 5:Fe=o.stateNode,_I=!1;break g;case 3:Fe=o.stateNode.containerInfo,_I=!0;break g;case 4:Fe=o.stateNode.containerInfo,_I=!0;break g}o=o.return}if(Fe===null)throw Error(T(160));Dp(l,n,C),Fe=null,_I=!1;var r=C.alternate;r!==null&&(r.return=null),C.return=null}catch(a){me(C,e,a)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)jp(e,g),e=e.sibling}function jp(g,e){var I=g.alternate,t=g.flags;switch(g.tag){case 0:case 11:case 14:case 15:if(qI(e,g),st(g),t&4){try{Mn(3,g,g.return),ja(3,g)}catch(Z){me(g,g.return,Z)}try{Mn(5,g,g.return)}catch(Z){me(g,g.return,Z)}}break;case 1:qI(e,g),st(g),t&512&&I!==null&&pl(I,I.return);break;case 5:if(qI(e,g),st(g),t&512&&I!==null&&pl(I,I.return),g.flags&32){var C=g.stateNode;try{Pn(C,"")}catch(Z){me(g,g.return,Z)}}if(t&4&&(C=g.stateNode,C!=null)){var l=g.memoizedProps,n=I!==null?I.memoizedProps:l,o=g.type,r=g.updateQueue;if(g.updateQueue=null,r!==null)try{o==="input"&&l.type==="radio"&&l.name!=null&&mG(C,l),yc(o,n);var a=yc(o,l);for(n=0;n<r.length;n+=2){var i=r[n],c=r[n+1];i==="style"?hG(C,c):i==="dangerouslySetInnerHTML"?GG(C,c):i==="children"?Pn(C,c):xA(C,i,c,a)}switch(o){case"input":Zc(C,l);break;case"textarea":ZG(C,l);break;case"select":var A=C._wrapperState.wasMultiple;C._wrapperState.wasMultiple=!!l.multiple;var p=l.value;p!=null?Sl(C,!!l.multiple,p,!1):A!==!!l.multiple&&(l.defaultValue!=null?Sl(C,!!l.multiple,l.defaultValue,!0):Sl(C,!!l.multiple,l.multiple?[]:"",!1))}C[Co]=l}catch(Z){me(g,g.return,Z)}}break;case 6:if(qI(e,g),st(g),t&4){if(g.stateNode===null)throw Error(T(162));C=g.stateNode,l=g.memoizedProps;try{C.nodeValue=l}catch(Z){me(g,g.return,Z)}}break;case 3:if(qI(e,g),st(g),t&4&&I!==null&&I.memoizedState.isDehydrated)try{_n(e.containerInfo)}catch(Z){me(g,g.return,Z)}break;case 4:qI(e,g),st(g);break;case 13:qI(e,g),st(g),C=g.child,C.flags&8192&&(l=C.memoizedState!==null,C.stateNode.isHidden=l,!l||C.alternate!==null&&C.alternate.memoizedState!==null||(bd=be())),t&4&&vm(g);break;case 22:if(i=I!==null&&I.memoizedState!==null,g.mode&1?(De=(a=De)||i,qI(e,g),De=a):qI(e,g),st(g),t&8192){if(a=g.memoizedState!==null,(g.stateNode.isHidden=a)&&!i&&g.mode&1)for(gg=g,i=g.child;i!==null;){for(c=gg=i;gg!==null;){switch(A=gg,p=A.child,A.tag){case 0:case 11:case 14:case 15:Mn(4,A,A.return);break;case 1:pl(A,A.return);var G=A.stateNode;if(typeof G.componentWillUnmount=="function"){t=A,I=A.return;try{e=t,G.props=e.memoizedProps,G.state=e.memoizedState,G.componentWillUnmount()}catch(Z){me(t,I,Z)}}break;case 5:pl(A,A.return);break;case 22:if(A.memoizedState!==null){Hm(c);continue}}p!==null?(p.return=A,gg=p):Hm(c)}i=i.sibling}g:for(i=null,c=g;;){if(c.tag===5){if(i===null){i=c;try{C=c.stateNode,a?(l=C.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(o=c.stateNode,r=c.memoizedProps.style,n=r!=null&&r.hasOwnProperty("display")?r.display:null,o.style.display=pG("display",n))}catch(Z){me(g,g.return,Z)}}}else if(c.tag===6){if(i===null)try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(Z){me(g,g.return,Z)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===g)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===g)break g;for(;c.sibling===null;){if(c.return===null||c.return===g)break g;i===c&&(i=null),c=c.return}i===c&&(i=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:qI(e,g),st(g),t&4&&vm(g);break;case 21:break;default:qI(e,g),st(g)}}function st(g){var e=g.flags;if(e&2){try{g:{for(var I=g.return;I!==null;){if(Tp(I)){var t=I;break g}I=I.return}throw Error(T(160))}switch(t.tag){case 5:var C=t.stateNode;t.flags&32&&(Pn(C,""),t.flags&=-33);var l=km(g);$c(g,l,C);break;case 3:case 4:var n=t.stateNode.containerInfo,o=km(g);qc(g,o,n);break;default:throw Error(T(161))}}catch(r){me(g,g.return,r)}g.flags&=-3}e&4096&&(g.flags&=-4097)}function zS(g,e,I){gg=g,Pp(g)}function Pp(g,e,I){for(var t=(g.mode&1)!==0;gg!==null;){var C=gg,l=C.child;if(C.tag===22&&t){var n=C.memoizedState!==null||ur;if(!n){var o=C.alternate,r=o!==null&&o.memoizedState!==null||De;o=ur;var a=De;if(ur=n,(De=r)&&!a)for(gg=C;gg!==null;)n=gg,r=n.child,n.tag===22&&n.memoizedState!==null?wm(C):r!==null?(r.return=n,gg=r):wm(C);for(;l!==null;)gg=l,Pp(l),l=l.sibling;gg=C,ur=o,De=a}Ym(g)}else C.subtreeFlags&8772&&l!==null?(l.return=C,gg=l):Ym(g)}}function Ym(g){for(;gg!==null;){var e=gg;if(e.flags&8772){var I=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:De||ja(5,e);break;case 1:var t=e.stateNode;if(e.flags&4&&!De)if(I===null)t.componentDidMount();else{var C=e.elementType===e.type?I.memoizedProps:$I(e.type,I.memoizedProps);t.componentDidUpdate(C,I.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;l!==null&&Zm(e,l,t);break;case 3:var n=e.updateQueue;if(n!==null){if(I=null,e.child!==null)switch(e.child.tag){case 5:I=e.child.stateNode;break;case 1:I=e.child.stateNode}Zm(e,n,I)}break;case 5:var o=e.stateNode;if(I===null&&e.flags&4){I=o;var r=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":r.autoFocus&&I.focus();break;case"img":r.src&&(I.src=r.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var a=e.alternate;if(a!==null){var i=a.memoizedState;if(i!==null){var c=i.dehydrated;c!==null&&_n(c)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(T(163))}De||e.flags&512&&Oc(e)}catch(A){me(e,e.return,A)}}if(e===g){gg=null;break}if(I=e.sibling,I!==null){I.return=e.return,gg=I;break}gg=e.return}}function Hm(g){for(;gg!==null;){var e=gg;if(e===g){gg=null;break}var I=e.sibling;if(I!==null){I.return=e.return,gg=I;break}gg=e.return}}function wm(g){for(;gg!==null;){var e=gg;try{switch(e.tag){case 0:case 11:case 15:var I=e.return;try{ja(4,e)}catch(r){me(e,I,r)}break;case 1:var t=e.stateNode;if(typeof t.componentDidMount=="function"){var C=e.return;try{t.componentDidMount()}catch(r){me(e,C,r)}}var l=e.return;try{Oc(e)}catch(r){me(e,l,r)}break;case 5:var n=e.return;try{Oc(e)}catch(r){me(e,n,r)}}}catch(r){me(e,e.return,r)}if(e===g){gg=null;break}var o=e.sibling;if(o!==null){o.return=e.return,gg=o;break}gg=e.return}}var MS=Math.ceil,da=Lt.ReactCurrentDispatcher,md=Lt.ReactCurrentOwner,LI=Lt.ReactCurrentBatchConfig,Ng=0,ke=null,We=null,Ee=0,hI=0,hl=ZC(0),fe=0,io=null,UC=0,Pa=0,Zd=0,Un=null,nI=null,bd=0,Kl=1/0,vt=null,ua=!1,_c=null,aC=null,mr=!1,tC=null,ma=0,Ln=0,gA=null,Nr=-1,Fr=0;function eI(){return Ng&6?be():Nr!==-1?Nr:Nr=be()}function iC(g){return g.mode&1?Ng&2&&Ee!==0?Ee&-Ee:WS.transition!==null?(Fr===0&&(Fr=YG()),Fr):(g=Mg,g!==0||(g=window.event,g=g===void 0?16:EG(g.type)),g):1}function lt(g,e,I,t){if(50<Ln)throw Ln=0,gA=null,Error(T(185));Vo(g,I,t),(!(Ng&2)||g!==ke)&&(g===ke&&(!(Ng&2)&&(Pa|=I),fe===4&&eC(g,Ee)),sI(g,t),I===1&&Ng===0&&!(e.mode&1)&&(Kl=be()+500,Qa&&bC()))}function sI(g,e){var I=g.callbackNode;WB(g,e);var t=_r(g,g===ke?Ee:0);if(t===0)I!==null&&Lu(I),g.callbackNode=null,g.callbackPriority=0;else if(e=t&-t,g.callbackPriority!==e){if(I!=null&&Lu(I),e===1)g.tag===0?SS(Nm.bind(null,g)):lp(Nm.bind(null,g)),pS(function(){!(Ng&6)&&bC()}),I=null;else{switch(HG(t)){case 1:I=LA;break;case 4:I=kG;break;case 16:I=$r;break;case 536870912:I=vG;break;default:I=$r}I=t0(I,Op.bind(null,g))}g.callbackPriority=e,g.callbackNode=I}}function Op(g,e){if(Nr=-1,Fr=0,Ng&6)throw Error(T(327));var I=g.callbackNode;if(Xl()&&g.callbackNode!==I)return null;var t=_r(g,g===ke?Ee:0);if(t===0)return null;if(t&30||t&g.expiredLanes||e)e=Za(g,t);else{e=t;var C=Ng;Ng|=2;var l=$p();(ke!==g||Ee!==e)&&(vt=null,Kl=be()+500,FC(g,e));do try{QS();break}catch(o){qp(g,o)}while(!0);td(),da.current=l,Ng=C,We!==null?e=0:(ke=null,Ee=0,e=fe)}if(e!==0){if(e===2&&(C=Rc(g),C!==0&&(t=C,e=eA(g,C))),e===1)throw I=io,FC(g,0),eC(g,t),sI(g,be()),I;if(e===6)eC(g,t);else{if(C=g.current.alternate,!(t&30)&&!US(C)&&(e=Za(g,t),e===2&&(l=Rc(g),l!==0&&(t=l,e=eA(g,l))),e===1))throw I=io,FC(g,0),eC(g,t),sI(g,be()),I;switch(g.finishedWork=C,g.finishedLanes=t,e){case 0:case 1:throw Error(T(345));case 2:VC(g,nI,vt);break;case 3:if(eC(g,t),(t&130023424)===t&&(e=bd+500-be(),10<e)){if(_r(g,0)!==0)break;if(C=g.suspendedLanes,(C&t)!==t){eI(),g.pingedLanes|=g.suspendedLanes&C;break}g.timeoutHandle=wc(VC.bind(null,g,nI,vt),e);break}VC(g,nI,vt);break;case 4:if(eC(g,t),(t&4194240)===t)break;for(e=g.eventTimes,C=-1;0<t;){var n=31-Ct(t);l=1<<n,n=e[n],n>C&&(C=n),t&=~l}if(t=C,t=be()-t,t=(120>t?120:480>t?480:1080>t?1080:1920>t?1920:3e3>t?3e3:4320>t?4320:1960*MS(t/1960))-t,10<t){g.timeoutHandle=wc(VC.bind(null,g,nI,vt),t);break}VC(g,nI,vt);break;case 5:VC(g,nI,vt);break;default:throw Error(T(329))}}}return sI(g,be()),g.callbackNode===I?Op.bind(null,g):null}function eA(g,e){var I=Un;return g.current.memoizedState.isDehydrated&&(FC(g,e).flags|=256),g=Za(g,e),g!==2&&(e=nI,nI=I,e!==null&&IA(e)),g}function IA(g){nI===null?nI=g:nI.push.apply(nI,g)}function US(g){for(var e=g;;){if(e.flags&16384){var I=e.updateQueue;if(I!==null&&(I=I.stores,I!==null))for(var t=0;t<I.length;t++){var C=I[t],l=C.getSnapshot;C=C.value;try{if(!ot(l(),C))return!1}catch{return!1}}}if(I=e.child,e.subtreeFlags&16384&&I!==null)I.return=e,e=I;else{if(e===g)break;for(;e.sibling===null;){if(e.return===null||e.return===g)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function eC(g,e){for(e&=~Zd,e&=~Pa,g.suspendedLanes|=e,g.pingedLanes&=~e,g=g.expirationTimes;0<e;){var I=31-Ct(e),t=1<<I;g[I]=-1,e&=~t}}function Nm(g){if(Ng&6)throw Error(T(327));Xl();var e=_r(g,0);if(!(e&1))return sI(g,be()),null;var I=Za(g,e);if(g.tag!==0&&I===2){var t=Rc(g);t!==0&&(e=t,I=eA(g,t))}if(I===1)throw I=io,FC(g,0),eC(g,e),sI(g,be()),I;if(I===6)throw Error(T(345));return g.finishedWork=g.current.alternate,g.finishedLanes=e,VC(g,nI,vt),sI(g,be()),null}function Gd(g,e){var I=Ng;Ng|=1;try{return g(e)}finally{Ng=I,Ng===0&&(Kl=be()+500,Qa&&bC())}}function LC(g){tC!==null&&tC.tag===0&&!(Ng&6)&&Xl();var e=Ng;Ng|=1;var I=LI.transition,t=Mg;try{if(LI.transition=null,Mg=1,g)return g()}finally{Mg=t,LI.transition=I,Ng=e,!(Ng&6)&&bC()}}function pd(){hI=hl.current,Ie(hl)}function FC(g,e){g.finishedWork=null,g.finishedLanes=0;var I=g.timeoutHandle;if(I!==-1&&(g.timeoutHandle=-1,GS(I)),We!==null)for(I=We.return;I!==null;){var t=I;switch(gd(t),t.tag){case 1:t=t.type.childContextTypes,t!=null&&Ca();break;case 3:Nl(),Ie(aI),Ie(Oe),ad();break;case 5:rd(t);break;case 4:Nl();break;case 13:Ie(re);break;case 19:Ie(re);break;case 10:Cd(t.type._context);break;case 22:case 23:pd()}I=I.return}if(ke=g,We=g=sC(g.current,null),Ee=hI=e,fe=0,io=null,Zd=Pa=UC=0,nI=Un=null,kC!==null){for(e=0;e<kC.length;e++)if(I=kC[e],t=I.interleaved,t!==null){I.interleaved=null;var C=t.next,l=I.pending;if(l!==null){var n=l.next;l.next=C,t.next=n}I.pending=t}kC=null}return g}function qp(g,e){do{var I=We;try{if(td(),Yr.current=Aa,ca){for(var t=ae.memoizedState;t!==null;){var C=t.queue;C!==null&&(C.pending=null),t=t.next}ca=!1}if(MC=0,Xe=Re=ae=null,zn=!1,oo=0,md.current=null,I===null||I.return===null){fe=1,io=e,We=null;break}g:{var l=g,n=I.return,o=I,r=e;if(e=Ee,o.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){var a=r,i=o,c=i.tag;if(!(i.mode&1)&&(c===0||c===11||c===15)){var A=i.alternate;A?(i.updateQueue=A.updateQueue,i.memoizedState=A.memoizedState,i.lanes=A.lanes):(i.updateQueue=null,i.memoizedState=null)}var p=Bm(n);if(p!==null){p.flags&=-257,Sm(p,n,o,l,e),p.mode&1&&ym(l,a,e),e=p,r=a;var G=e.updateQueue;if(G===null){var Z=new Set;Z.add(r),e.updateQueue=Z}else G.add(r);break g}else{if(!(e&1)){ym(l,a,e),hd();break g}r=Error(T(426))}}else if(ne&&o.mode&1){var h=Bm(n);if(h!==null){!(h.flags&65536)&&(h.flags|=256),Sm(h,n,o,l,e),ed(Fl(r,o));break g}}l=r=Fl(r,o),fe!==4&&(fe=2),Un===null?Un=[l]:Un.push(l),l=n;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e;var u=Hp(l,r,e);mm(l,u);break g;case 1:o=r;var b=l.type,m=l.stateNode;if(!(l.flags&128)&&(typeof b.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(aC===null||!aC.has(m)))){l.flags|=65536,e&=-e,l.lanes|=e;var B=wp(l,o,e);mm(l,B);break g}}l=l.return}while(l!==null)}g0(I)}catch(W){e=W,We===I&&I!==null&&(We=I=I.return);continue}break}while(!0)}function $p(){var g=da.current;return da.current=Aa,g===null?Aa:g}function hd(){(fe===0||fe===3||fe===2)&&(fe=4),ke===null||!(UC&268435455)&&!(Pa&268435455)||eC(ke,Ee)}function Za(g,e){var I=Ng;Ng|=2;var t=$p();(ke!==g||Ee!==e)&&(vt=null,FC(g,e));do try{LS();break}catch(C){qp(g,C)}while(!0);if(td(),Ng=I,da.current=t,We!==null)throw Error(T(261));return ke=null,Ee=0,fe}function LS(){for(;We!==null;)_p(We)}function QS(){for(;We!==null&&!mB();)_p(We)}function _p(g){var e=I0(g.alternate,g,hI);g.memoizedProps=g.pendingProps,e===null?g0(g):We=e,md.current=null}function g0(g){var e=g;do{var I=e.alternate;if(g=e.return,e.flags&32768){if(I=KS(I,e),I!==null){I.flags&=32767,We=I;return}if(g!==null)g.flags|=32768,g.subtreeFlags=0,g.deletions=null;else{fe=6,We=null;return}}else if(I=FS(I,e,hI),I!==null){We=I;return}if(e=e.sibling,e!==null){We=e;return}We=e=g}while(e!==null);fe===0&&(fe=5)}function VC(g,e,I){var t=Mg,C=LI.transition;try{LI.transition=null,Mg=1,TS(g,e,I,t)}finally{LI.transition=C,Mg=t}return null}function TS(g,e,I,t){do Xl();while(tC!==null);if(Ng&6)throw Error(T(327));I=g.finishedWork;var C=g.finishedLanes;if(I===null)return null;if(g.finishedWork=null,g.finishedLanes=0,I===g.current)throw Error(T(177));g.callbackNode=null,g.callbackPriority=0;var l=I.lanes|I.childLanes;if(VB(g,l),g===ke&&(We=ke=null,Ee=0),!(I.subtreeFlags&2064)&&!(I.flags&2064)||mr||(mr=!0,t0($r,function(){return Xl(),null})),l=(I.flags&15990)!==0,I.subtreeFlags&15990||l){l=LI.transition,LI.transition=null;var n=Mg;Mg=1;var o=Ng;Ng|=4,md.current=null,ES(g,I),jp(I,g),cS(Yc),ga=!!vc,Yc=vc=null,g.current=I,zS(I),ZB(),Ng=o,Mg=n,LI.transition=l}else g.current=I;if(mr&&(mr=!1,tC=g,ma=C),l=g.pendingLanes,l===0&&(aC=null),pB(I.stateNode),sI(g,be()),e!==null)for(t=g.onRecoverableError,I=0;I<e.length;I++)C=e[I],t(C.value,{componentStack:C.stack,digest:C.digest});if(ua)throw ua=!1,g=_c,_c=null,g;return ma&1&&g.tag!==0&&Xl(),l=g.pendingLanes,l&1?g===gA?Ln++:(Ln=0,gA=g):Ln=0,bC(),null}function Xl(){if(tC!==null){var g=HG(ma),e=LI.transition,I=Mg;try{if(LI.transition=null,Mg=16>g?16:g,tC===null)var t=!1;else{if(g=tC,tC=null,ma=0,Ng&6)throw Error(T(331));var C=Ng;for(Ng|=4,gg=g.current;gg!==null;){var l=gg,n=l.child;if(gg.flags&16){var o=l.deletions;if(o!==null){for(var r=0;r<o.length;r++){var a=o[r];for(gg=a;gg!==null;){var i=gg;switch(i.tag){case 0:case 11:case 15:Mn(8,i,l)}var c=i.child;if(c!==null)c.return=i,gg=c;else for(;gg!==null;){i=gg;var A=i.sibling,p=i.return;if(Qp(i),i===a){gg=null;break}if(A!==null){A.return=p,gg=A;break}gg=p}}}var G=l.alternate;if(G!==null){var Z=G.child;if(Z!==null){G.child=null;do{var h=Z.sibling;Z.sibling=null,Z=h}while(Z!==null)}}gg=l}}if(l.subtreeFlags&2064&&n!==null)n.return=l,gg=n;else g:for(;gg!==null;){if(l=gg,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Mn(9,l,l.return)}var u=l.sibling;if(u!==null){u.return=l.return,gg=u;break g}gg=l.return}}var b=g.current;for(gg=b;gg!==null;){n=gg;var m=n.child;if(n.subtreeFlags&2064&&m!==null)m.return=n,gg=m;else g:for(n=b;gg!==null;){if(o=gg,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:ja(9,o)}}catch(W){me(o,o.return,W)}if(o===n){gg=null;break g}var B=o.sibling;if(B!==null){B.return=o.return,gg=B;break g}gg=o.return}}if(Ng=C,bC(),ht&&typeof ht.onPostCommitFiberRoot=="function")try{ht.onPostCommitFiberRoot(Ea,g)}catch{}t=!0}return t}finally{Mg=I,LI.transition=e}}return!1}function Fm(g,e,I){e=Fl(I,e),e=Hp(g,e,1),g=rC(g,e,1),e=eI(),g!==null&&(Vo(g,1,e),sI(g,e))}function me(g,e,I){if(g.tag===3)Fm(g,g,I);else for(;e!==null;){if(e.tag===3){Fm(e,g,I);break}else if(e.tag===1){var t=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof t.componentDidCatch=="function"&&(aC===null||!aC.has(t))){g=Fl(I,g),g=wp(e,g,1),e=rC(e,g,1),g=eI(),e!==null&&(Vo(e,1,g),sI(e,g));break}}e=e.return}}function DS(g,e,I){var t=g.pingCache;t!==null&&t.delete(e),e=eI(),g.pingedLanes|=g.suspendedLanes&I,ke===g&&(Ee&I)===I&&(fe===4||fe===3&&(Ee&130023424)===Ee&&500>be()-bd?FC(g,0):Zd|=I),sI(g,e)}function e0(g,e){e===0&&(g.mode&1?(e=nr,nr<<=1,!(nr&130023424)&&(nr=4194304)):e=1);var I=eI();g=zt(g,e),g!==null&&(Vo(g,e,I),sI(g,I))}function jS(g){var e=g.memoizedState,I=0;e!==null&&(I=e.retryLane),e0(g,I)}function PS(g,e){var I=0;switch(g.tag){case 13:var t=g.stateNode,C=g.memoizedState;C!==null&&(I=C.retryLane);break;case 19:t=g.stateNode;break;default:throw Error(T(314))}t!==null&&t.delete(e),e0(g,I)}var I0;I0=function(g,e,I){if(g!==null)if(g.memoizedProps!==e.pendingProps||aI.current)rI=!0;else{if(!(g.lanes&I)&&!(e.flags&128))return rI=!1,NS(g,e,I);rI=!!(g.flags&131072)}else rI=!1,ne&&e.flags&1048576&&np(e,oa,e.index);switch(e.lanes=0,e.tag){case 2:var t=e.type;wr(g,e),g=e.pendingProps;var C=Yl(e,Oe.current);fl(e,I),C=sd(null,e,t,g,C,I);var l=cd();return e.flags|=1,typeof C=="object"&&C!==null&&typeof C.render=="function"&&C.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,iI(t)?(l=!0,la(e)):l=!1,e.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,nd(e),C.updater=Da,e.stateNode=C,C._reactInternals=e,Mc(e,t,g,I),e=Qc(null,e,t,!0,l,I)):(e.tag=0,ne&&l&&_A(e),_e(null,e,C,I),e=e.child),e;case 16:t=e.elementType;g:{switch(wr(g,e),g=e.pendingProps,C=t._init,t=C(t._payload),e.type=t,C=e.tag=qS(t),g=$I(t,g),C){case 0:e=Lc(null,e,t,g,I);break g;case 1:e=Rm(null,e,t,g,I);break g;case 11:e=Wm(null,e,t,g,I);break g;case 14:e=Vm(null,e,t,$I(t.type,g),I);break g}throw Error(T(306,t,""))}return e;case 0:return t=e.type,C=e.pendingProps,C=e.elementType===t?C:$I(t,C),Lc(g,e,t,C,I);case 1:return t=e.type,C=e.pendingProps,C=e.elementType===t?C:$I(t,C),Rm(g,e,t,C,I);case 3:g:{if(xp(e),g===null)throw Error(T(387));t=e.pendingProps,l=e.memoizedState,C=l.element,cp(g,e),ia(e,t,null,I);var n=e.memoizedState;if(t=n.element,l.isDehydrated)if(l={element:t,isDehydrated:!1,cache:n.cache,pendingSuspenseBoundaries:n.pendingSuspenseBoundaries,transitions:n.transitions},e.updateQueue.baseState=l,e.memoizedState=l,e.flags&256){C=Fl(Error(T(423)),e),e=fm(g,e,t,I,C);break g}else if(t!==C){C=Fl(Error(T(424)),e),e=fm(g,e,t,I,C);break g}else for(SI=oC(e.stateNode.containerInfo.firstChild),WI=e,ne=!0,et=null,I=ip(e,null,t,I),e.child=I;I;)I.flags=I.flags&-3|4096,I=I.sibling;else{if(Hl(),t===C){e=Mt(g,e,I);break g}_e(g,e,t,I)}e=e.child}return e;case 5:return Ap(e),g===null&&xc(e),t=e.type,C=e.pendingProps,l=g!==null?g.memoizedProps:null,n=C.children,Hc(t,C)?n=null:l!==null&&Hc(t,l)&&(e.flags|=32),Kp(g,e),_e(g,e,n,I),e.child;case 6:return g===null&&xc(e),null;case 13:return Ep(g,e,I);case 4:return od(e,e.stateNode.containerInfo),t=e.pendingProps,g===null?e.child=wl(e,null,t,I):_e(g,e,t,I),e.child;case 11:return t=e.type,C=e.pendingProps,C=e.elementType===t?C:$I(t,C),Wm(g,e,t,C,I);case 7:return _e(g,e,e.pendingProps,I),e.child;case 8:return _e(g,e,e.pendingProps.children,I),e.child;case 12:return _e(g,e,e.pendingProps.children,I),e.child;case 10:g:{if(t=e.type._context,C=e.pendingProps,l=e.memoizedProps,n=C.value,ge(ra,t._currentValue),t._currentValue=n,l!==null)if(ot(l.value,n)){if(l.children===C.children&&!aI.current){e=Mt(g,e,I);break g}}else for(l=e.child,l!==null&&(l.return=e);l!==null;){var o=l.dependencies;if(o!==null){n=l.child;for(var r=o.firstContext;r!==null;){if(r.context===t){if(l.tag===1){r=Nt(-1,I&-I),r.tag=2;var a=l.updateQueue;if(a!==null){a=a.shared;var i=a.pending;i===null?r.next=r:(r.next=i.next,i.next=r),a.pending=r}}l.lanes|=I,r=l.alternate,r!==null&&(r.lanes|=I),Ec(l.return,I,e),o.lanes|=I;break}r=r.next}}else if(l.tag===10)n=l.type===e.type?null:l.child;else if(l.tag===18){if(n=l.return,n===null)throw Error(T(341));n.lanes|=I,o=n.alternate,o!==null&&(o.lanes|=I),Ec(n,I,e),n=l.sibling}else n=l.child;if(n!==null)n.return=l;else for(n=l;n!==null;){if(n===e){n=null;break}if(l=n.sibling,l!==null){l.return=n.return,n=l;break}n=n.return}l=n}_e(g,e,C.children,I),e=e.child}return e;case 9:return C=e.type,t=e.pendingProps.children,fl(e,I),C=QI(C),t=t(C),e.flags|=1,_e(g,e,t,I),e.child;case 14:return t=e.type,C=$I(t,e.pendingProps),C=$I(t.type,C),Vm(g,e,t,C,I);case 15:return Np(g,e,e.type,e.pendingProps,I);case 17:return t=e.type,C=e.pendingProps,C=e.elementType===t?C:$I(t,C),wr(g,e),e.tag=1,iI(t)?(g=!0,la(e)):g=!1,fl(e,I),Yp(e,t,C),Mc(e,t,C,I),Qc(null,e,t,!0,g,I);case 19:return zp(g,e,I);case 22:return Fp(g,e,I)}throw Error(T(156,e.tag))};function t0(g,e){return JG(g,e)}function OS(g,e,I,t){this.tag=g,this.key=I,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=t,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function UI(g,e,I,t){return new OS(g,e,I,t)}function yd(g){return g=g.prototype,!(!g||!g.isReactComponent)}function qS(g){if(typeof g=="function")return yd(g)?1:0;if(g!=null){if(g=g.$$typeof,g===zA)return 11;if(g===MA)return 14}return 2}function sC(g,e){var I=g.alternate;return I===null?(I=UI(g.tag,e,g.key,g.mode),I.elementType=g.elementType,I.type=g.type,I.stateNode=g.stateNode,I.alternate=g,g.alternate=I):(I.pendingProps=e,I.type=g.type,I.flags=0,I.subtreeFlags=0,I.deletions=null),I.flags=g.flags&14680064,I.childLanes=g.childLanes,I.lanes=g.lanes,I.child=g.child,I.memoizedProps=g.memoizedProps,I.memoizedState=g.memoizedState,I.updateQueue=g.updateQueue,e=g.dependencies,I.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},I.sibling=g.sibling,I.index=g.index,I.ref=g.ref,I}function Kr(g,e,I,t,C,l){var n=2;if(t=g,typeof g=="function")yd(g)&&(n=1);else if(typeof g=="string")n=5;else g:switch(g){case sl:return KC(I.children,C,l,e);case EA:n=8,C|=8;break;case cc:return g=UI(12,I,e,C|2),g.elementType=cc,g.lanes=l,g;case Ac:return g=UI(13,I,e,C),g.elementType=Ac,g.lanes=l,g;case dc:return g=UI(19,I,e,C),g.elementType=dc,g.lanes=l,g;case AG:return Oa(I,C,l,e);default:if(typeof g=="object"&&g!==null)switch(g.$$typeof){case sG:n=10;break g;case cG:n=9;break g;case zA:n=11;break g;case MA:n=14;break g;case $t:n=16,t=null;break g}throw Error(T(130,g==null?g:typeof g,""))}return e=UI(n,I,e,C),e.elementType=g,e.type=t,e.lanes=l,e}function KC(g,e,I,t){return g=UI(7,g,t,e),g.lanes=I,g}function Oa(g,e,I,t){return g=UI(22,g,t,e),g.elementType=AG,g.lanes=I,g.stateNode={isHidden:!1},g}function zs(g,e,I){return g=UI(6,g,null,e),g.lanes=I,g}function Ms(g,e,I){return e=UI(4,g.children!==null?g.children:[],g.key,e),e.lanes=I,e.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},e}function $S(g,e,I,t,C){this.tag=e,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ys(0),this.expirationTimes=ys(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ys(0),this.identifierPrefix=t,this.onRecoverableError=C,this.mutableSourceEagerHydrationData=null}function Bd(g,e,I,t,C,l,n,o,r){return g=new $S(g,e,I,o,r),e===1?(e=1,l===!0&&(e|=8)):e=0,l=UI(3,null,null,e),g.current=l,l.stateNode=g,l.memoizedState={element:t,isDehydrated:I,cache:null,transitions:null,pendingSuspenseBoundaries:null},nd(l),g}function _S(g,e,I){var t=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:il,key:t==null?null:""+t,children:g,containerInfo:e,implementation:I}}function C0(g){if(!g)return AC;g=g._reactInternals;g:{if(PC(g)!==g||g.tag!==1)throw Error(T(170));var e=g;do{switch(e.tag){case 3:e=e.stateNode.context;break g;case 1:if(iI(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break g}}e=e.return}while(e!==null);throw Error(T(171))}if(g.tag===1){var I=g.type;if(iI(I))return Cp(g,I,e)}return e}function l0(g,e,I,t,C,l,n,o,r){return g=Bd(I,t,!0,g,C,l,n,o,r),g.context=C0(null),I=g.current,t=eI(),C=iC(I),l=Nt(t,C),l.callback=e??null,rC(I,l,C),g.current.lanes=C,Vo(g,C,t),sI(g,t),g}function qa(g,e,I,t){var C=e.current,l=eI(),n=iC(C);return I=C0(I),e.context===null?e.context=I:e.pendingContext=I,e=Nt(l,n),e.payload={element:g},t=t===void 0?null:t,t!==null&&(e.callback=t),g=rC(C,e,n),g!==null&&(lt(g,C,n,l),vr(g,C,n)),n}function ba(g){if(g=g.current,!g.child)return null;switch(g.child.tag){case 5:return g.child.stateNode;default:return g.child.stateNode}}function Km(g,e){if(g=g.memoizedState,g!==null&&g.dehydrated!==null){var I=g.retryLane;g.retryLane=I!==0&&I<e?I:e}}function Sd(g,e){Km(g,e),(g=g.alternate)&&Km(g,e)}function gW(){return null}var n0=typeof reportError=="function"?reportError:function(g){console.error(g)};function Wd(g){this._internalRoot=g}$a.prototype.render=Wd.prototype.render=function(g){var e=this._internalRoot;if(e===null)throw Error(T(409));qa(g,e,null,null)};$a.prototype.unmount=Wd.prototype.unmount=function(){var g=this._internalRoot;if(g!==null){this._internalRoot=null;var e=g.containerInfo;LC(function(){qa(null,g,null,null)}),e[Et]=null}};function $a(g){this._internalRoot=g}$a.prototype.unstable_scheduleHydration=function(g){if(g){var e=FG();g={blockedOn:null,target:g,priority:e};for(var I=0;I<gC.length&&e!==0&&e<gC[I].priority;I++);gC.splice(I,0,g),I===0&&xG(g)}};function Vd(g){return!(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)}function _a(g){return!(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11&&(g.nodeType!==8||g.nodeValue!==" react-mount-point-unstable "))}function xm(){}function eW(g,e,I,t,C){if(C){if(typeof t=="function"){var l=t;t=function(){var a=ba(n);l.call(a)}}var n=l0(e,t,g,0,null,!1,!1,"",xm);return g._reactRootContainer=n,g[Et]=n.current,Io(g.nodeType===8?g.parentNode:g),LC(),n}for(;C=g.lastChild;)g.removeChild(C);if(typeof t=="function"){var o=t;t=function(){var a=ba(r);o.call(a)}}var r=Bd(g,0,!1,null,null,!1,!1,"",xm);return g._reactRootContainer=r,g[Et]=r.current,Io(g.nodeType===8?g.parentNode:g),LC(function(){qa(e,r,I,t)}),r}function gi(g,e,I,t,C){var l=I._reactRootContainer;if(l){var n=l;if(typeof C=="function"){var o=C;C=function(){var r=ba(n);o.call(r)}}qa(e,n,g,C)}else n=eW(I,e,g,C,t);return ba(n)}wG=function(g){switch(g.tag){case 3:var e=g.stateNode;if(e.current.memoizedState.isDehydrated){var I=Rn(e.pendingLanes);I!==0&&(QA(e,I|1),sI(e,be()),!(Ng&6)&&(Kl=be()+500,bC()))}break;case 13:LC(function(){var t=zt(g,1);if(t!==null){var C=eI();lt(t,g,1,C)}}),Sd(g,1)}};TA=function(g){if(g.tag===13){var e=zt(g,134217728);if(e!==null){var I=eI();lt(e,g,134217728,I)}Sd(g,134217728)}};NG=function(g){if(g.tag===13){var e=iC(g),I=zt(g,e);if(I!==null){var t=eI();lt(I,g,e,t)}Sd(g,e)}};FG=function(){return Mg};KG=function(g,e){var I=Mg;try{return Mg=g,e()}finally{Mg=I}};Sc=function(g,e,I){switch(e){case"input":if(Zc(g,I),e=I.name,I.type==="radio"&&e!=null){for(I=g;I.parentNode;)I=I.parentNode;for(I=I.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<I.length;e++){var t=I[e];if(t!==g&&t.form===g.form){var C=La(t);if(!C)throw Error(T(90));uG(t),Zc(t,C)}}}break;case"textarea":ZG(g,I);break;case"select":e=I.value,e!=null&&Sl(g,!!I.multiple,e,!1)}};SG=Gd;WG=LC;var IW={usingClientEntryPoint:!1,Events:[fo,ul,La,yG,BG,Gd]},An={findFiberByHostInstance:JC,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tW={bundleType:An.bundleType,version:An.version,rendererPackageName:An.rendererPackageName,rendererConfig:An.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lt.ReactCurrentDispatcher,findHostInstanceByFiber:function(g){return g=fG(g),g===null?null:g.stateNode},findFiberByHostInstance:An.findFiberByHostInstance||gW,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zr.isDisabled&&Zr.supportsFiber)try{Ea=Zr.inject(tW),ht=Zr}catch{}}kI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IW;kI.createPortal=function(g,e){var I=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vd(e))throw Error(T(200));return _S(g,e,null,I)};kI.createRoot=function(g,e){if(!Vd(g))throw Error(T(299));var I=!1,t="",C=n0;return e!=null&&(e.unstable_strictMode===!0&&(I=!0),e.identifierPrefix!==void 0&&(t=e.identifierPrefix),e.onRecoverableError!==void 0&&(C=e.onRecoverableError)),e=Bd(g,1,!1,null,null,I,!1,t,C),g[Et]=e.current,Io(g.nodeType===8?g.parentNode:g),new Wd(e)};kI.findDOMNode=function(g){if(g==null)return null;if(g.nodeType===1)return g;var e=g._reactInternals;if(e===void 0)throw typeof g.render=="function"?Error(T(188)):(g=Object.keys(g).join(","),Error(T(268,g)));return g=fG(e),g=g===null?null:g.stateNode,g};kI.flushSync=function(g){return LC(g)};kI.hydrate=function(g,e,I){if(!_a(e))throw Error(T(200));return gi(null,g,e,!0,I)};kI.hydrateRoot=function(g,e,I){if(!Vd(g))throw Error(T(405));var t=I!=null&&I.hydratedSources||null,C=!1,l="",n=n0;if(I!=null&&(I.unstable_strictMode===!0&&(C=!0),I.identifierPrefix!==void 0&&(l=I.identifierPrefix),I.onRecoverableError!==void 0&&(n=I.onRecoverableError)),e=l0(e,null,g,1,I??null,C,!1,l,n),g[Et]=e.current,Io(g),t)for(g=0;g<t.length;g++)I=t[g],C=I._getVersion,C=C(I._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[I,C]:e.mutableSourceEagerHydrationData.push(I,C);return new $a(e)};kI.render=function(g,e,I){if(!_a(e))throw Error(T(200));return gi(null,g,e,!1,I)};kI.unmountComponentAtNode=function(g){if(!_a(g))throw Error(T(40));return g._reactRootContainer?(LC(function(){gi(null,null,g,!1,function(){g._reactRootContainer=null,g[Et]=null})}),!0):!1};kI.unstable_batchedUpdates=Gd;kI.unstable_renderSubtreeIntoContainer=function(g,e,I,t){if(!_a(I))throw Error(T(200));if(g==null||g._reactInternals===void 0)throw Error(T(38));return gi(g,e,I,!1,t)};kI.version="18.3.1-next-f1338f8080-20240426";function o0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o0)}catch(g){console.error(g)}}o0(),oG.exports=kI;var ei=oG.exports;const Xn=Ka(ei),CW=Pb({__proto__:null,default:Xn},[ei]);var r0,Em=ei;r0=Em.createRoot,Em.hydrateRoot;/**
 * @remix-run/router v1.19.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function oe(){return oe=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},oe.apply(this,arguments)}var Be;(function(g){g.Pop="POP",g.Push="PUSH",g.Replace="REPLACE"})(Be||(Be={}));const zm="popstate";function lW(g){g===void 0&&(g={});function e(t,C){let{pathname:l,search:n,hash:o}=t.location;return so("",{pathname:l,search:n,hash:o},C.state&&C.state.usr||null,C.state&&C.state.key||"default")}function I(t,C){return typeof C=="string"?C:QC(C)}return oW(e,I,null,g)}function Rg(g,e){if(g===!1||g===null||typeof g>"u")throw new Error(e)}function xl(g,e){if(!g){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nW(){return Math.random().toString(36).substr(2,8)}function Mm(g,e){return{usr:g.state,key:g.key,idx:e}}function so(g,e,I,t){return I===void 0&&(I=null),oe({pathname:typeof g=="string"?g:g.pathname,search:"",hash:""},typeof e=="string"?GC(e):e,{state:I,key:e&&e.key||t||nW()})}function QC(g){let{pathname:e="/",search:I="",hash:t=""}=g;return I&&I!=="?"&&(e+=I.charAt(0)==="?"?I:"?"+I),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function GC(g){let e={};if(g){let I=g.indexOf("#");I>=0&&(e.hash=g.substr(I),g=g.substr(0,I));let t=g.indexOf("?");t>=0&&(e.search=g.substr(t),g=g.substr(0,t)),g&&(e.pathname=g)}return e}function oW(g,e,I,t){t===void 0&&(t={});let{window:C=document.defaultView,v5Compat:l=!1}=t,n=C.history,o=Be.Pop,r=null,a=i();a==null&&(a=0,n.replaceState(oe({},n.state,{idx:a}),""));function i(){return(n.state||{idx:null}).idx}function c(){o=Be.Pop;let h=i(),u=h==null?null:h-a;a=h,r&&r({action:o,location:Z.location,delta:u})}function A(h,u){o=Be.Push;let b=so(Z.location,h,u);a=i()+1;let m=Mm(b,a),B=Z.createHref(b);try{n.pushState(m,"",B)}catch(W){if(W instanceof DOMException&&W.name==="DataCloneError")throw W;C.location.assign(B)}l&&r&&r({action:o,location:Z.location,delta:1})}function p(h,u){o=Be.Replace;let b=so(Z.location,h,u);a=i();let m=Mm(b,a),B=Z.createHref(b);n.replaceState(m,"",B),l&&r&&r({action:o,location:Z.location,delta:0})}function G(h){let u=C.location.origin!=="null"?C.location.origin:C.location.href,b=typeof h=="string"?h:QC(h);return b=b.replace(/ $/,"%20"),Rg(u,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,u)}let Z={get action(){return o},get location(){return g(C,n)},listen(h){if(r)throw new Error("A history only accepts one active listener");return C.addEventListener(zm,c),r=h,()=>{C.removeEventListener(zm,c),r=null}},createHref(h){return e(C,h)},createURL:G,encodeLocation(h){let u=G(h);return{pathname:u.pathname,search:u.search,hash:u.hash}},push:A,replace:p,go(h){return n.go(h)}};return Z}var Qg;(function(g){g.data="data",g.deferred="deferred",g.redirect="redirect",g.error="error"})(Qg||(Qg={}));const rW=new Set(["lazy","caseSensitive","path","id","index","children"]);function aW(g){return g.index===!0}function co(g,e,I,t){return I===void 0&&(I=[]),t===void 0&&(t={}),g.map((C,l)=>{let n=[...I,String(l)],o=typeof C.id=="string"?C.id:n.join("-");if(Rg(C.index!==!0||!C.children,"Cannot specify children on an index route"),Rg(!t[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),aW(C)){let r=oe({},C,e(C),{id:o});return t[o]=r,r}else{let r=oe({},C,e(C),{id:o,children:void 0});return t[o]=r,C.children&&(r.children=co(C.children,e,n,t)),r}})}function XC(g,e,I){return I===void 0&&(I="/"),xr(g,e,I,!1)}function xr(g,e,I,t){let C=typeof e=="string"?GC(e):e,l=Ol(C.pathname||"/",I);if(l==null)return null;let n=a0(g);sW(n);let o=null;for(let r=0;o==null&&r<n.length;++r){let a=yW(l);o=pW(n[r],a,t)}return o}function iW(g,e){let{route:I,pathname:t,params:C}=g;return{id:I.id,pathname:t,params:C,data:e[I.id],handle:I.handle}}function a0(g,e,I,t){e===void 0&&(e=[]),I===void 0&&(I=[]),t===void 0&&(t="");let C=(l,n,o)=>{let r={relativePath:o===void 0?l.path||"":o,caseSensitive:l.caseSensitive===!0,childrenIndex:n,route:l};r.relativePath.startsWith("/")&&(Rg(r.relativePath.startsWith(t),'Absolute route path "'+r.relativePath+'" nested under path '+('"'+t+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),r.relativePath=r.relativePath.slice(t.length));let a=Ft([t,r.relativePath]),i=I.concat(r);l.children&&l.children.length>0&&(Rg(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+a+'".')),a0(l.children,e,i,a)),!(l.path==null&&!l.index)&&e.push({path:a,score:bW(a,l.index),routesMeta:i})};return g.forEach((l,n)=>{var o;if(l.path===""||!((o=l.path)!=null&&o.includes("?")))C(l,n);else for(let r of i0(l.path))C(l,n,r)}),e}function i0(g){let e=g.split("/");if(e.length===0)return[];let[I,...t]=e,C=I.endsWith("?"),l=I.replace(/\?$/,"");if(t.length===0)return C?[l,""]:[l];let n=i0(t.join("/")),o=[];return o.push(...n.map(r=>r===""?l:[l,r].join("/"))),C&&o.push(...n),o.map(r=>g.startsWith("/")&&r===""?"/":r)}function sW(g){g.sort((e,I)=>e.score!==I.score?I.score-e.score:GW(e.routesMeta.map(t=>t.childrenIndex),I.routesMeta.map(t=>t.childrenIndex)))}const cW=/^:[\w-]+$/,AW=3,dW=2,uW=1,mW=10,ZW=-2,Um=g=>g==="*";function bW(g,e){let I=g.split("/"),t=I.length;return I.some(Um)&&(t+=ZW),e&&(t+=dW),I.filter(C=>!Um(C)).reduce((C,l)=>C+(cW.test(l)?AW:l===""?uW:mW),t)}function GW(g,e){return g.length===e.length&&g.slice(0,-1).every((t,C)=>t===e[C])?g[g.length-1]-e[e.length-1]:0}function pW(g,e,I){I===void 0&&(I=!1);let{routesMeta:t}=g,C={},l="/",n=[];for(let o=0;o<t.length;++o){let r=t[o],a=o===t.length-1,i=l==="/"?e:e.slice(l.length)||"/",c=Lm({path:r.relativePath,caseSensitive:r.caseSensitive,end:a},i),A=r.route;if(!c&&a&&I&&!t[t.length-1].route.index&&(c=Lm({path:r.relativePath,caseSensitive:r.caseSensitive,end:!1},i)),!c)return null;Object.assign(C,c.params),n.push({params:C,pathname:Ft([l,c.pathname]),pathnameBase:WW(Ft([l,c.pathnameBase])),route:A}),c.pathnameBase!=="/"&&(l=Ft([l,c.pathnameBase]))}return n}function Lm(g,e){typeof g=="string"&&(g={path:g,caseSensitive:!1,end:!0});let[I,t]=hW(g.path,g.caseSensitive,g.end),C=e.match(I);if(!C)return null;let l=C[0],n=l.replace(/(.)\/+$/,"$1"),o=C.slice(1);return{params:t.reduce((a,i,c)=>{let{paramName:A,isOptional:p}=i;if(A==="*"){let Z=o[c]||"";n=l.slice(0,l.length-Z.length).replace(/(.)\/+$/,"$1")}const G=o[c];return p&&!G?a[A]=void 0:a[A]=(G||"").replace(/%2F/g,"/"),a},{}),pathname:l,pathnameBase:n,pattern:g}}function hW(g,e,I){e===void 0&&(e=!1),I===void 0&&(I=!0),xl(g==="*"||!g.endsWith("*")||g.endsWith("/*"),'Route path "'+g+'" will be treated as if it were '+('"'+g.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+g.replace(/\*$/,"/*")+'".'));let t=[],C="^"+g.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(n,o,r)=>(t.push({paramName:o,isOptional:r!=null}),r?"/?([^\\/]+)?":"/([^\\/]+)"));return g.endsWith("*")?(t.push({paramName:"*"}),C+=g==="*"||g==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):I?C+="\\/*$":g!==""&&g!=="/"&&(C+="(?:(?=\\/|$))"),[new RegExp(C,e?void 0:"i"),t]}function yW(g){try{return g.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return xl(!1,'The URL path "'+g+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),g}}function Ol(g,e){if(e==="/")return g;if(!g.toLowerCase().startsWith(e.toLowerCase()))return null;let I=e.endsWith("/")?e.length-1:e.length,t=g.charAt(I);return t&&t!=="/"?null:g.slice(I)||"/"}function BW(g,e){e===void 0&&(e="/");let{pathname:I,search:t="",hash:C=""}=typeof g=="string"?GC(g):g;return{pathname:I?I.startsWith("/")?I:SW(I,e):e,search:VW(t),hash:RW(C)}}function SW(g,e){let I=e.replace(/\/+$/,"").split("/");return g.split("/").forEach(C=>{C===".."?I.length>1&&I.pop():C!=="."&&I.push(C)}),I.length>1?I.join("/"):"/"}function Us(g,e,I,t){return"Cannot include a '"+g+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(t)+"].  Please separate it out to the ")+("`to."+I+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function s0(g){return g.filter((e,I)=>I===0||e.route.path&&e.route.path.length>0)}function Ii(g,e){let I=s0(g);return e?I.map((t,C)=>C===I.length-1?t.pathname:t.pathnameBase):I.map(t=>t.pathnameBase)}function ti(g,e,I,t){t===void 0&&(t=!1);let C;typeof g=="string"?C=GC(g):(C=oe({},g),Rg(!C.pathname||!C.pathname.includes("?"),Us("?","pathname","search",C)),Rg(!C.pathname||!C.pathname.includes("#"),Us("#","pathname","hash",C)),Rg(!C.search||!C.search.includes("#"),Us("#","search","hash",C)));let l=g===""||C.pathname==="",n=l?"/":C.pathname,o;if(n==null)o=I;else{let c=e.length-1;if(!t&&n.startsWith("..")){let A=n.split("/");for(;A[0]==="..";)A.shift(),c-=1;C.pathname=A.join("/")}o=c>=0?e[c]:"/"}let r=BW(C,o),a=n&&n!=="/"&&n.endsWith("/"),i=(l||n===".")&&I.endsWith("/");return!r.pathname.endsWith("/")&&(a||i)&&(r.pathname+="/"),r}const Ft=g=>g.join("/").replace(/\/\/+/g,"/"),WW=g=>g.replace(/\/+$/,"").replace(/^\/*/,"/"),VW=g=>!g||g==="?"?"":g.startsWith("?")?g:"?"+g,RW=g=>!g||g==="#"?"":g.startsWith("#")?g:"#"+g;class Ga{constructor(e,I,t,C){C===void 0&&(C=!1),this.status=e,this.statusText=I||"",this.internal=C,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}}function Ci(g){return g!=null&&typeof g.status=="number"&&typeof g.statusText=="string"&&typeof g.internal=="boolean"&&"data"in g}const c0=["post","put","patch","delete"],fW=new Set(c0),XW=["get",...c0],JW=new Set(XW),kW=new Set([301,302,303,307,308]),vW=new Set([307,308]),Ls={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},YW={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},dn={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Rd=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,HW=g=>({hasErrorBoundary:!!g.hasErrorBoundary}),A0="remix-router-transitions";function wW(g){const e=g.window?g.window:typeof window<"u"?window:void 0,I=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",t=!I;Rg(g.routes.length>0,"You must provide a non-empty routes array to createRouter");let C;if(g.mapRouteProperties)C=g.mapRouteProperties;else if(g.detectErrorBoundary){let X=g.detectErrorBoundary;C=J=>({hasErrorBoundary:X(J)})}else C=HW;let l={},n=co(g.routes,C,void 0,l),o,r=g.basename||"/",a=g.unstable_dataStrategy||EW,i=g.unstable_patchRoutesOnNavigation,c=oe({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},g.future),A=null,p=new Set,G=1e3,Z=new Set,h=null,u=null,b=null,m=g.hydrationData!=null,B=XC(n,g.history.location,r),W=null;if(B==null&&!i){let X=$e(404,{pathname:g.history.location.pathname}),{matches:J,route:v}=gZ(n);B=J,W={[v.id]:X}}B&&!g.hydrationData&&Oo(B,n,g.history.location.pathname).active&&(B=null);let R;if(B)if(B.some(X=>X.route.lazy))R=!1;else if(!B.some(X=>X.route.loader))R=!0;else if(c.v7_partialHydration){let X=g.hydrationData?g.hydrationData.loaderData:null,J=g.hydrationData?g.hydrationData.errors:null,v=z=>z.route.loader?typeof z.route.loader=="function"&&z.route.loader.hydrate===!0?!1:X&&X[z.route.id]!==void 0||J&&J[z.route.id]!==void 0:!0;if(J){let z=B.findIndex(_=>J[_.route.id]!==void 0);R=B.slice(0,z+1).every(v)}else R=B.every(v)}else R=g.hydrationData!=null;else if(R=!1,B=[],c.v7_partialHydration){let X=Oo(null,n,g.history.location.pathname);X.active&&X.matches&&(B=X.matches)}let V,S={historyAction:g.history.action,location:g.history.location,matches:B,initialized:R,navigation:Ls,restoreScrollPosition:g.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:g.hydrationData&&g.hydrationData.loaderData||{},actionData:g.hydrationData&&g.hydrationData.actionData||null,errors:g.hydrationData&&g.hydrationData.errors||W,fetchers:new Map,blockers:new Map},y=Be.Pop,f=!1,k,H=!1,M=new Map,F=null,x=!1,L=!1,D=[],Y=new Set,K=new Map,O=0,lg=-1,ag=new Map,ig=new Set,sg=new Map,eg=new Map,q=new Set,E=new Map,Q=new Map,Cg=new Map,Ig=!1;function cg(){if(A=g.history.listen(X=>{let{action:J,location:v,delta:z}=X;if(Ig){Ig=!1;return}xl(Q.size===0||z!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let _=Ru({currentLocation:S.location,nextLocation:v,historyAction:J});if(_&&z!=null){Ig=!0,g.history.go(z*-1),jo(_,{state:"blocked",location:v,proceed(){jo(_,{state:"proceeding",proceed:void 0,reset:void 0,location:v}),g.history.go(z)},reset(){let ng=new Map(S.blockers);ng.set(_,dn),Ag({blockers:ng})}});return}return jg(J,v)}),I){_W(e,M);let X=()=>gV(e,M);e.addEventListener("pagehide",X),F=()=>e.removeEventListener("pagehide",X)}return S.initialized||jg(Be.Pop,S.location,{initialHydration:!0}),V}function hg(){A&&A(),F&&F(),p.clear(),k&&k.abort(),S.fetchers.forEach((X,J)=>NI(J)),S.blockers.forEach((X,J)=>Vu(J))}function se(X){return p.add(X),()=>p.delete(X)}function Ag(X,J){J===void 0&&(J={}),S=oe({},S,X);let v=[],z=[];c.v7_fetcherPersist&&S.fetchers.forEach((_,ng)=>{_.state==="idle"&&(q.has(ng)?z.push(ng):v.push(ng))}),[...p].forEach(_=>_(S,{deletedFetchers:z,unstable_viewTransitionOpts:J.viewTransitionOpts,unstable_flushSync:J.flushSync===!0})),c.v7_fetcherPersist&&(v.forEach(_=>S.fetchers.delete(_)),z.forEach(_=>NI(_)))}function Jg(X,J,v){var z,_;let{flushSync:ng}=v===void 0?{}:v,bg=S.actionData!=null&&S.navigation.formMethod!=null&&gt(S.navigation.formMethod)&&S.navigation.state==="loading"&&((z=X.state)==null?void 0:z._isRedirect)!==!0,P;J.actionData?Object.keys(J.actionData).length>0?P=J.actionData:P=null:bg?P=S.actionData:P=null;let yg=J.loaderData?$m(S.loaderData,J.loaderData,J.matches||[],J.errors):S.loaderData,dg=S.blockers;dg.size>0&&(dg=new Map(dg),dg.forEach((zg,Pg)=>dg.set(Pg,dn)));let Wg=f===!0||S.navigation.formMethod!=null&&gt(S.navigation.formMethod)&&((_=X.state)==null?void 0:_._isRedirect)!==!0;o&&(n=o,o=void 0),x||y===Be.Pop||(y===Be.Push?g.history.push(X,X.state):y===Be.Replace&&g.history.replace(X,X.state));let Lg;if(y===Be.Pop){let zg=M.get(S.location.pathname);zg&&zg.has(X.pathname)?Lg={currentLocation:S.location,nextLocation:X}:M.has(X.pathname)&&(Lg={currentLocation:X,nextLocation:S.location})}else if(H){let zg=M.get(S.location.pathname);zg?zg.add(X.pathname):(zg=new Set([X.pathname]),M.set(S.location.pathname,zg)),Lg={currentLocation:S.location,nextLocation:X}}Ag(oe({},J,{actionData:P,loaderData:yg,historyAction:y,location:X,initialized:!0,navigation:Ls,revalidation:"idle",restoreScrollPosition:Xu(X,J.matches||S.matches),preventScrollReset:Wg,blockers:dg}),{viewTransitionOpts:Lg,flushSync:ng===!0}),y=Be.Pop,f=!1,H=!1,x=!1,L=!1,D=[]}async function Ve(X,J){if(typeof X=="number"){g.history.go(X);return}let v=tA(S.location,S.matches,r,c.v7_prependBasename,X,c.v7_relativeSplatPath,J==null?void 0:J.fromRouteId,J==null?void 0:J.relative),{path:z,submission:_,error:ng}=Qm(c.v7_normalizeFormMethod,!1,v,J),bg=S.location,P=so(S.location,z,J&&J.state);P=oe({},P,g.history.encodeLocation(P));let yg=J&&J.replace!=null?J.replace:void 0,dg=Be.Push;yg===!0?dg=Be.Replace:yg===!1||_!=null&&gt(_.formMethod)&&_.formAction===S.location.pathname+S.location.search&&(dg=Be.Replace);let Wg=J&&"preventScrollReset"in J?J.preventScrollReset===!0:void 0,Lg=(J&&J.unstable_flushSync)===!0,zg=Ru({currentLocation:bg,nextLocation:P,historyAction:dg});if(zg){jo(zg,{state:"blocked",location:P,proceed(){jo(zg,{state:"proceeding",proceed:void 0,reset:void 0,location:P}),Ve(X,J)},reset(){let Pg=new Map(S.blockers);Pg.set(zg,dn),Ag({blockers:Pg})}});return}return await jg(dg,P,{submission:_,pendingError:ng,preventScrollReset:Wg,replace:J&&J.replace,enableViewTransition:J&&J.unstable_viewTransition,flushSync:Lg})}function Me(){if(bI(),Ag({revalidation:"loading"}),S.navigation.state!=="submitting"){if(S.navigation.state==="idle"){jg(S.historyAction,S.location,{startUninterruptedRevalidation:!0});return}jg(y||S.historyAction,S.navigation.location,{overrideNavigation:S.navigation})}}async function jg(X,J,v){k&&k.abort(),k=null,y=X,x=(v&&v.startUninterruptedRevalidation)===!0,Ry(S.location,S.matches),f=(v&&v.preventScrollReset)===!0,H=(v&&v.enableViewTransition)===!0;let z=o||n,_=v&&v.overrideNavigation,ng=XC(z,J,r),bg=(v&&v.flushSync)===!0,P=Oo(ng,z,J.pathname);if(P.active&&P.matches&&(ng=P.matches),!ng){let{error:Eg,notFoundMatches:we,route:ye}=us(J.pathname);Jg(J,{matches:we,loaderData:{},errors:{[ye.id]:Eg}},{flushSync:bg});return}if(S.initialized&&!L&&TW(S.location,J)&&!(v&&v.submission&&gt(v.submission.formMethod))){Jg(J,{matches:ng},{flushSync:bg});return}k=new AbortController;let yg=gl(g.history,J,k.signal,v&&v.submission),dg;if(v&&v.pendingError)dg=[yl(ng).route.id,{type:Qg.error,error:v.pendingError}];else if(v&&v.submission&&gt(v.submission.formMethod)){let Eg=await ce(yg,J,v.submission,ng,P.active,{replace:v.replace,flushSync:bg});if(Eg.shortCircuited)return;if(Eg.pendingActionResult){let[we,ye]=Eg.pendingActionResult;if(yI(ye)&&Ci(ye.error)&&ye.error.status===404){k=null,Jg(J,{matches:Eg.matches,loaderData:{},errors:{[we]:ye.error}});return}}ng=Eg.matches||ng,dg=Eg.pendingActionResult,_=Qs(J,v.submission),bg=!1,P.active=!1,yg=gl(g.history,yg.url,yg.signal)}let{shortCircuited:Wg,matches:Lg,loaderData:zg,errors:Pg}=await CI(yg,J,ng,P.active,_,v&&v.submission,v&&v.fetcherSubmission,v&&v.replace,v&&v.initialHydration===!0,bg,dg);Wg||(k=null,Jg(J,oe({matches:Lg||ng},_m(dg),{loaderData:zg,errors:Pg})))}async function ce(X,J,v,z,_,ng){ng===void 0&&(ng={}),bI();let bg=qW(J,v);if(Ag({navigation:bg},{flushSync:ng.flushSync===!0}),_){let dg=await qo(z,J.pathname,X.signal);if(dg.type==="aborted")return{shortCircuited:!0};if(dg.type==="error"){let{boundaryId:Wg,error:Lg}=Po(J.pathname,dg);return{matches:dg.partialMatches,pendingActionResult:[Wg,{type:Qg.error,error:Lg}]}}else if(dg.matches)z=dg.matches;else{let{notFoundMatches:Wg,error:Lg,route:zg}=us(J.pathname);return{matches:Wg,pendingActionResult:[zg.id,{type:Qg.error,error:Lg}]}}}let P,yg=Jn(z,J);if(!yg.route.action&&!yg.route.lazy)P={type:Qg.error,error:$e(405,{method:X.method,pathname:J.pathname,routeId:yg.route.id})};else if(P=(await _g("action",X,[yg],z))[0],X.signal.aborted)return{shortCircuited:!0};if(HC(P)){let dg;return ng&&ng.replace!=null?dg=ng.replace:dg=Pm(P.response.headers.get("Location"),new URL(X.url),r)===S.location.pathname+S.location.search,await Zg(X,P,{submission:v,replace:dg}),{shortCircuited:!0}}if(YC(P))throw $e(400,{type:"defer-action"});if(yI(P)){let dg=yl(z,yg.route.id);return(ng&&ng.replace)!==!0&&(y=Be.Push),{matches:z,pendingActionResult:[dg.route.id,P]}}return{matches:z,pendingActionResult:[yg.route.id,P]}}async function CI(X,J,v,z,_,ng,bg,P,yg,dg,Wg){let Lg=_||Qs(J,ng),zg=ng||bg||CZ(Lg),Pg=!x&&(!c.v7_partialHydration||!yg);if(z){if(Pg){let Ae=xg(Wg);Ag(oe({navigation:Lg},Ae!==void 0?{actionData:Ae}:{}),{flushSync:dg})}let Vg=await qo(v,J.pathname,X.signal);if(Vg.type==="aborted")return{shortCircuited:!0};if(Vg.type==="error"){let{boundaryId:Ae,error:GI}=Po(J.pathname,Vg);return{matches:Vg.partialMatches,loaderData:{},errors:{[Ae]:GI}}}else if(Vg.matches)v=Vg.matches;else{let{error:Ae,notFoundMatches:GI,route:Ce}=us(J.pathname);return{matches:GI,loaderData:{},errors:{[Ce.id]:Ae}}}}let Eg=o||n,[we,ye]=Tm(g.history,S,v,zg,J,c.v7_partialHydration&&yg===!0,c.v7_skipActionErrorRevalidation,L,D,Y,q,sg,ig,Eg,r,Wg);if(ms(Vg=>!(v&&v.some(Ae=>Ae.route.id===Vg))||we&&we.some(Ae=>Ae.route.id===Vg)),lg=++O,we.length===0&&ye.length===0){let Vg=ft();return Jg(J,oe({matches:v,loaderData:{},errors:Wg&&yI(Wg[1])?{[Wg[0]]:Wg[1].error}:null},_m(Wg),Vg?{fetchers:new Map(S.fetchers)}:{}),{flushSync:dg}),{shortCircuited:!0}}if(Pg){let Vg={};if(!z){Vg.navigation=Lg;let Ae=xg(Wg);Ae!==void 0&&(Vg.actionData=Ae)}ye.length>0&&(Vg.fetchers=ZI(ye)),Ag(Vg,{flushSync:dg})}ye.forEach(Vg=>{K.has(Vg.key)&&Yg(Vg.key),Vg.controller&&K.set(Vg.key,Vg.controller)});let tn=()=>ye.forEach(Vg=>Yg(Vg.key));k&&k.signal.addEventListener("abort",tn);let{loaderResults:Qt,fetcherResults:OC}=await lI(S.matches,v,we,ye,X);if(X.signal.aborted)return{shortCircuited:!0};k&&k.signal.removeEventListener("abort",tn),ye.forEach(Vg=>K.delete(Vg.key));let qC=eZ([...Qt,...OC]);if(qC){if(qC.idx>=we.length){let Vg=ye[qC.idx-we.length].key;ig.add(Vg)}return await Zg(X,qC.result,{replace:P}),{shortCircuited:!0}}let{loaderData:$C,errors:it}=qm(S,v,we,Qt,Wg,ye,OC,E);E.forEach((Vg,Ae)=>{Vg.subscribe(GI=>{(GI||Vg.done)&&E.delete(Ae)})}),c.v7_partialHydration&&yg&&S.errors&&Object.entries(S.errors).filter(Vg=>{let[Ae]=Vg;return!we.some(GI=>GI.route.id===Ae)}).forEach(Vg=>{let[Ae,GI]=Vg;it=Object.assign(it||{},{[Ae]:GI})});let $o=ft(),_o=In(lg),gr=$o||_o||ye.length>0;return oe({matches:v,loaderData:$C,errors:it},gr?{fetchers:new Map(S.fetchers)}:{})}function xg(X){if(X&&!yI(X[1]))return{[X[0]]:X[1].data};if(S.actionData)return Object.keys(S.actionData).length===0?null:S.actionData}function ZI(X){return X.forEach(J=>{let v=S.fetchers.get(J.key),z=un(void 0,v?v.data:void 0);S.fetchers.set(J.key,z)}),new Map(S.fetchers)}function U(X,J,v,z){if(t)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");K.has(X)&&Yg(X);let _=(z&&z.unstable_flushSync)===!0,ng=o||n,bg=tA(S.location,S.matches,r,c.v7_prependBasename,v,c.v7_relativeSplatPath,J,z==null?void 0:z.relative),P=XC(ng,bg,r),yg=Oo(P,ng,bg);if(yg.active&&yg.matches&&(P=yg.matches),!P){kg(X,J,$e(404,{pathname:bg}),{flushSync:_});return}let{path:dg,submission:Wg,error:Lg}=Qm(c.v7_normalizeFormMethod,!0,bg,z);if(Lg){kg(X,J,Lg,{flushSync:_});return}let zg=Jn(P,dg);if(f=(z&&z.preventScrollReset)===!0,Wg&&gt(Wg.formMethod)){mg(X,J,dg,zg,P,yg.active,_,Wg);return}sg.set(X,{routeId:J,path:dg}),wg(X,J,dg,zg,P,yg.active,_,Wg)}async function mg(X,J,v,z,_,ng,bg,P){bI(),sg.delete(X);function yg(Ce){if(!Ce.route.action&&!Ce.route.lazy){let Xt=$e(405,{method:P.formMethod,pathname:v,routeId:J});return kg(X,J,Xt,{flushSync:bg}),!0}return!1}if(!ng&&yg(z))return;let dg=S.fetchers.get(X);pe(X,$W(P,dg),{flushSync:bg});let Wg=new AbortController,Lg=gl(g.history,v,Wg.signal,P);if(ng){let Ce=await qo(_,v,Lg.signal);if(Ce.type==="aborted")return;if(Ce.type==="error"){let{error:Xt}=Po(v,Ce);kg(X,J,Xt,{flushSync:bg});return}else if(Ce.matches){if(_=Ce.matches,z=Jn(_,v),yg(z))return}else{kg(X,J,$e(404,{pathname:v}),{flushSync:bg});return}}K.set(X,Wg);let zg=O,Eg=(await _g("action",Lg,[z],_))[0];if(Lg.signal.aborted){K.get(X)===Wg&&K.delete(X);return}if(c.v7_fetcherPersist&&q.has(X)){if(HC(Eg)||yI(Eg)){pe(X,qt(void 0));return}}else{if(HC(Eg))if(K.delete(X),lg>zg){pe(X,qt(void 0));return}else return ig.add(X),pe(X,un(P)),Zg(Lg,Eg,{fetcherSubmission:P});if(yI(Eg)){kg(X,J,Eg.error);return}}if(YC(Eg))throw $e(400,{type:"defer-action"});let we=S.navigation.location||S.location,ye=gl(g.history,we,Wg.signal),tn=o||n,Qt=S.navigation.state!=="idle"?XC(tn,S.navigation.location,r):S.matches;Rg(Qt,"Didn't find any matches after fetcher action");let OC=++O;ag.set(X,OC);let qC=un(P,Eg.data);S.fetchers.set(X,qC);let[$C,it]=Tm(g.history,S,Qt,P,we,!1,c.v7_skipActionErrorRevalidation,L,D,Y,q,sg,ig,tn,r,[z.route.id,Eg]);it.filter(Ce=>Ce.key!==X).forEach(Ce=>{let Xt=Ce.key,ku=S.fetchers.get(Xt),Jy=un(void 0,ku?ku.data:void 0);S.fetchers.set(Xt,Jy),K.has(Xt)&&Yg(Xt),Ce.controller&&K.set(Xt,Ce.controller)}),Ag({fetchers:new Map(S.fetchers)});let $o=()=>it.forEach(Ce=>Yg(Ce.key));Wg.signal.addEventListener("abort",$o);let{loaderResults:_o,fetcherResults:gr}=await lI(S.matches,Qt,$C,it,ye);if(Wg.signal.aborted)return;Wg.signal.removeEventListener("abort",$o),ag.delete(X),K.delete(X),it.forEach(Ce=>K.delete(Ce.key));let Vg=eZ([..._o,...gr]);if(Vg){if(Vg.idx>=$C.length){let Ce=it[Vg.idx-$C.length].key;ig.add(Ce)}return Zg(ye,Vg.result)}let{loaderData:Ae,errors:GI}=qm(S,S.matches,$C,_o,void 0,it,gr,E);if(S.fetchers.has(X)){let Ce=qt(Eg.data);S.fetchers.set(X,Ce)}In(OC),S.navigation.state==="loading"&&OC>lg?(Rg(y,"Expected pending action"),k&&k.abort(),Jg(S.navigation.location,{matches:Qt,loaderData:Ae,errors:GI,fetchers:new Map(S.fetchers)})):(Ag({errors:GI,loaderData:$m(S.loaderData,Ae,Qt,GI),fetchers:new Map(S.fetchers)}),L=!1)}async function wg(X,J,v,z,_,ng,bg,P){let yg=S.fetchers.get(X);pe(X,un(P,yg?yg.data:void 0),{flushSync:bg});let dg=new AbortController,Wg=gl(g.history,v,dg.signal);if(ng){let Eg=await qo(_,v,Wg.signal);if(Eg.type==="aborted")return;if(Eg.type==="error"){let{error:we}=Po(v,Eg);kg(X,J,we,{flushSync:bg});return}else if(Eg.matches)_=Eg.matches,z=Jn(_,v);else{kg(X,J,$e(404,{pathname:v}),{flushSync:bg});return}}K.set(X,dg);let Lg=O,Pg=(await _g("loader",Wg,[z],_))[0];if(YC(Pg)&&(Pg=await b0(Pg,Wg.signal,!0)||Pg),K.get(X)===dg&&K.delete(X),!Wg.signal.aborted){if(q.has(X)){pe(X,qt(void 0));return}if(HC(Pg))if(lg>Lg){pe(X,qt(void 0));return}else{ig.add(X),await Zg(Wg,Pg);return}if(yI(Pg)){kg(X,J,Pg.error);return}Rg(!YC(Pg),"Unhandled fetcher deferred data"),pe(X,qt(Pg.data))}}async function Zg(X,J,v){let{submission:z,fetcherSubmission:_,replace:ng}=v===void 0?{}:v;J.response.headers.has("X-Remix-Revalidate")&&(L=!0);let bg=J.response.headers.get("Location");Rg(bg,"Expected a Location header on the redirect Response"),bg=Pm(bg,new URL(X.url),r);let P=so(S.location,bg,{_isRedirect:!0});if(I){let Pg=!1;if(J.response.headers.has("X-Remix-Reload-Document"))Pg=!0;else if(Rd.test(bg)){const Eg=g.history.createURL(bg);Pg=Eg.origin!==e.location.origin||Ol(Eg.pathname,r)==null}if(Pg){ng?e.location.replace(bg):e.location.assign(bg);return}}k=null;let yg=ng===!0||J.response.headers.has("X-Remix-Replace")?Be.Replace:Be.Push,{formMethod:dg,formAction:Wg,formEncType:Lg}=S.navigation;!z&&!_&&dg&&Wg&&Lg&&(z=CZ(S.navigation));let zg=z||_;if(vW.has(J.response.status)&&zg&&gt(zg.formMethod))await jg(yg,P,{submission:oe({},zg,{formAction:bg}),preventScrollReset:f});else{let Pg=Qs(P,z);await jg(yg,P,{overrideNavigation:Pg,fetcherSubmission:_,preventScrollReset:f})}}async function _g(X,J,v,z){try{let _=await zW(a,X,J,v,z,l,C);return await Promise.all(_.map((ng,bg)=>{if(jW(ng)){let P=ng.result;return{type:Qg.redirect,response:LW(P,J,v[bg].route.id,z,r,c.v7_relativeSplatPath)}}return UW(ng)}))}catch(_){return v.map(()=>({type:Qg.error,error:_}))}}async function lI(X,J,v,z,_){let[ng,...bg]=await Promise.all([v.length?_g("loader",_,v,J):[],...z.map(P=>{if(P.matches&&P.match&&P.controller){let yg=gl(g.history,P.path,P.controller.signal);return _g("loader",yg,[P.match],P.matches).then(dg=>dg[0])}else return Promise.resolve({type:Qg.error,error:$e(404,{pathname:P.path})})})]);return await Promise.all([tZ(X,v,ng,ng.map(()=>_.signal),!1,S.loaderData),tZ(X,z.map(P=>P.match),bg,z.map(P=>P.controller?P.controller.signal:null),!0)]),{loaderResults:ng,fetcherResults:bg}}function bI(){L=!0,D.push(...ms()),sg.forEach((X,J)=>{K.has(J)&&(Y.add(J),Yg(J))})}function pe(X,J,v){v===void 0&&(v={}),S.fetchers.set(X,J),Ag({fetchers:new Map(S.fetchers)},{flushSync:(v&&v.flushSync)===!0})}function kg(X,J,v,z){z===void 0&&(z={});let _=yl(S.matches,J);NI(X),Ag({errors:{[_.route.id]:v},fetchers:new Map(S.fetchers)},{flushSync:(z&&z.flushSync)===!0})}function OI(X){return c.v7_fetcherPersist&&(eg.set(X,(eg.get(X)||0)+1),q.has(X)&&q.delete(X)),S.fetchers.get(X)||YW}function NI(X){let J=S.fetchers.get(X);K.has(X)&&!(J&&J.state==="loading"&&ag.has(X))&&Yg(X),sg.delete(X),ag.delete(X),ig.delete(X),q.delete(X),Y.delete(X),S.fetchers.delete(X)}function ug(X){if(c.v7_fetcherPersist){let J=(eg.get(X)||0)-1;J<=0?(eg.delete(X),q.add(X)):eg.set(X,J)}else NI(X);Ag({fetchers:new Map(S.fetchers)})}function Yg(X){let J=K.get(X);Rg(J,"Expected fetch controller: "+X),J.abort(),K.delete(X)}function he(X){for(let J of X){let v=OI(J),z=qt(v.data);S.fetchers.set(J,z)}}function ft(){let X=[],J=!1;for(let v of ig){let z=S.fetchers.get(v);Rg(z,"Expected fetcher: "+v),z.state==="loading"&&(ig.delete(v),X.push(v),J=!0)}return he(X),J}function In(X){let J=[];for(let[v,z]of ag)if(z<X){let _=S.fetchers.get(v);Rg(_,"Expected fetcher: "+v),_.state==="loading"&&(Yg(v),ag.delete(v),J.push(v))}return he(J),J.length>0}function Wy(X,J){let v=S.blockers.get(X)||dn;return Q.get(X)!==J&&Q.set(X,J),v}function Vu(X){S.blockers.delete(X),Q.delete(X)}function jo(X,J){let v=S.blockers.get(X)||dn;Rg(v.state==="unblocked"&&J.state==="blocked"||v.state==="blocked"&&J.state==="blocked"||v.state==="blocked"&&J.state==="proceeding"||v.state==="blocked"&&J.state==="unblocked"||v.state==="proceeding"&&J.state==="unblocked","Invalid blocker state transition: "+v.state+" -> "+J.state);let z=new Map(S.blockers);z.set(X,J),Ag({blockers:z})}function Ru(X){let{currentLocation:J,nextLocation:v,historyAction:z}=X;if(Q.size===0)return;Q.size>1&&xl(!1,"A router only supports one blocker at a time");let _=Array.from(Q.entries()),[ng,bg]=_[_.length-1],P=S.blockers.get(ng);if(!(P&&P.state==="proceeding")&&bg({currentLocation:J,nextLocation:v,historyAction:z}))return ng}function us(X){let J=$e(404,{pathname:X}),v=o||n,{matches:z,route:_}=gZ(v);return ms(),{notFoundMatches:z,route:_,error:J}}function Po(X,J){return{boundaryId:yl(J.partialMatches).route.id,error:$e(400,{type:"route-discovery",pathname:X,message:J.error!=null&&"message"in J.error?J.error:String(J.error)})}}function ms(X){let J=[];return E.forEach((v,z)=>{(!X||X(z))&&(v.cancel(),J.push(z),E.delete(z))}),J}function Vy(X,J,v){if(h=X,b=J,u=v||null,!m&&S.navigation===Ls){m=!0;let z=Xu(S.location,S.matches);z!=null&&Ag({restoreScrollPosition:z})}return()=>{h=null,b=null,u=null}}function fu(X,J){return u&&u(X,J.map(z=>iW(z,S.loaderData)))||X.key}function Ry(X,J){if(h&&b){let v=fu(X,J);h[v]=b()}}function Xu(X,J){if(h){let v=fu(X,J),z=h[v];if(typeof z=="number")return z}return null}function Oo(X,J,v){if(i){if(Z.has(v))return{active:!1,matches:X};if(X){if(Object.keys(X[0].params).length>0)return{active:!0,matches:xr(J,v,r,!0)}}else return{active:!0,matches:xr(J,v,r,!0)||[]}}return{active:!1,matches:null}}async function qo(X,J,v){let z=X;for(;;){let _=o==null,ng=o||n;try{await xW(i,J,z,ng,l,C,Cg,v)}catch(yg){return{type:"error",error:yg,partialMatches:z}}finally{_&&(n=[...n])}if(v.aborted)return{type:"aborted"};let bg=XC(ng,J,r);if(bg)return Ju(J,Z),{type:"success",matches:bg};let P=xr(ng,J,r,!0);if(!P||z.length===P.length&&z.every((yg,dg)=>yg.route.id===P[dg].route.id))return Ju(J,Z),{type:"success",matches:null};z=P}}function Ju(X,J){if(J.size>=G){let v=J.values().next().value;J.delete(v)}J.add(X)}function fy(X){l={},o=co(X,C,void 0,l)}function Xy(X,J){let v=o==null;u0(X,J,o||n,l,C),v&&(n=[...n],Ag({}))}return V={get basename(){return r},get future(){return c},get state(){return S},get routes(){return n},get window(){return e},initialize:cg,subscribe:se,enableScrollRestoration:Vy,navigate:Ve,fetch:U,revalidate:Me,createHref:X=>g.history.createHref(X),encodeLocation:X=>g.history.encodeLocation(X),getFetcher:OI,deleteFetcher:ug,dispose:hg,getBlocker:Wy,deleteBlocker:Vu,patchRoutes:Xy,_internalFetchControllers:K,_internalActiveDeferreds:E,_internalSetRoutes:fy},V}function NW(g){return g!=null&&("formData"in g&&g.formData!=null||"body"in g&&g.body!==void 0)}function tA(g,e,I,t,C,l,n,o){let r,a;if(n){r=[];for(let c of e)if(r.push(c),c.route.id===n){a=c;break}}else r=e,a=e[e.length-1];let i=ti(C||".",Ii(r,l),Ol(g.pathname,I)||g.pathname,o==="path");return C==null&&(i.search=g.search,i.hash=g.hash),(C==null||C===""||C===".")&&a&&a.route.index&&!fd(i.search)&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t&&I!=="/"&&(i.pathname=i.pathname==="/"?I:Ft([I,i.pathname])),QC(i)}function Qm(g,e,I,t){if(!t||!NW(t))return{path:I};if(t.formMethod&&!OW(t.formMethod))return{path:I,error:$e(405,{method:t.formMethod})};let C=()=>({path:I,error:$e(400,{type:"invalid-body"})}),l=t.formMethod||"get",n=g?l.toUpperCase():l.toLowerCase(),o=m0(I);if(t.body!==void 0){if(t.formEncType==="text/plain"){if(!gt(n))return C();let A=typeof t.body=="string"?t.body:t.body instanceof FormData||t.body instanceof URLSearchParams?Array.from(t.body.entries()).reduce((p,G)=>{let[Z,h]=G;return""+p+Z+"="+h+`
`},""):String(t.body);return{path:I,submission:{formMethod:n,formAction:o,formEncType:t.formEncType,formData:void 0,json:void 0,text:A}}}else if(t.formEncType==="application/json"){if(!gt(n))return C();try{let A=typeof t.body=="string"?JSON.parse(t.body):t.body;return{path:I,submission:{formMethod:n,formAction:o,formEncType:t.formEncType,formData:void 0,json:A,text:void 0}}}catch{return C()}}}Rg(typeof FormData=="function","FormData is not available in this environment");let r,a;if(t.formData)r=CA(t.formData),a=t.formData;else if(t.body instanceof FormData)r=CA(t.body),a=t.body;else if(t.body instanceof URLSearchParams)r=t.body,a=Om(r);else if(t.body==null)r=new URLSearchParams,a=new FormData;else try{r=new URLSearchParams(t.body),a=Om(r)}catch{return C()}let i={formMethod:n,formAction:o,formEncType:t&&t.formEncType||"application/x-www-form-urlencoded",formData:a,json:void 0,text:void 0};if(gt(i.formMethod))return{path:I,submission:i};let c=GC(I);return e&&c.search&&fd(c.search)&&r.append("index",""),c.search="?"+r,{path:QC(c),submission:i}}function FW(g,e){let I=g;if(e){let t=g.findIndex(C=>C.route.id===e);t>=0&&(I=g.slice(0,t))}return I}function Tm(g,e,I,t,C,l,n,o,r,a,i,c,A,p,G,Z){let h=Z?yI(Z[1])?Z[1].error:Z[1].data:void 0,u=g.createURL(e.location),b=g.createURL(C),m=Z&&yI(Z[1])?Z[0]:void 0,B=m?FW(I,m):I,W=Z?Z[1].statusCode:void 0,R=n&&W&&W>=400,V=B.filter((y,f)=>{let{route:k}=y;if(k.lazy)return!0;if(k.loader==null)return!1;if(l)return typeof k.loader!="function"||k.loader.hydrate?!0:e.loaderData[k.id]===void 0&&(!e.errors||e.errors[k.id]===void 0);if(KW(e.loaderData,e.matches[f],y)||r.some(F=>F===y.route.id))return!0;let H=e.matches[f],M=y;return Dm(y,oe({currentUrl:u,currentParams:H.params,nextUrl:b,nextParams:M.params},t,{actionResult:h,actionStatus:W,defaultShouldRevalidate:R?!1:o||u.pathname+u.search===b.pathname+b.search||u.search!==b.search||d0(H,M)}))}),S=[];return c.forEach((y,f)=>{if(l||!I.some(x=>x.route.id===y.routeId)||i.has(f))return;let k=XC(p,y.path,G);if(!k){S.push({key:f,routeId:y.routeId,path:y.path,matches:null,match:null,controller:null});return}let H=e.fetchers.get(f),M=Jn(k,y.path),F=!1;A.has(f)?F=!1:a.has(f)?(a.delete(f),F=!0):H&&H.state!=="idle"&&H.data===void 0?F=o:F=Dm(M,oe({currentUrl:u,currentParams:e.matches[e.matches.length-1].params,nextUrl:b,nextParams:I[I.length-1].params},t,{actionResult:h,actionStatus:W,defaultShouldRevalidate:R?!1:o})),F&&S.push({key:f,routeId:y.routeId,path:y.path,matches:k,match:M,controller:new AbortController})}),[V,S]}function KW(g,e,I){let t=!e||I.route.id!==e.route.id,C=g[I.route.id]===void 0;return t||C}function d0(g,e){let I=g.route.path;return g.pathname!==e.pathname||I!=null&&I.endsWith("*")&&g.params["*"]!==e.params["*"]}function Dm(g,e){if(g.route.shouldRevalidate){let I=g.route.shouldRevalidate(e);if(typeof I=="boolean")return I}return e.defaultShouldRevalidate}async function xW(g,e,I,t,C,l,n,o){let r=[e,...I.map(a=>a.route.id)].join("-");try{let a=n.get(r);a||(a=g({path:e,matches:I,patch:(i,c)=>{o.aborted||u0(i,c,t,C,l)}}),n.set(r,a)),a&&DW(a)&&await a}finally{n.delete(r)}}function u0(g,e,I,t,C){if(g){var l;let n=t[g];Rg(n,"No route found to patch children into: routeId = "+g);let o=co(e,C,[g,"patch",String(((l=n.children)==null?void 0:l.length)||"0")],t);n.children?n.children.push(...o):n.children=o}else{let n=co(e,C,["patch",String(I.length||"0")],t);I.push(...n)}}async function jm(g,e,I){if(!g.lazy)return;let t=await g.lazy();if(!g.lazy)return;let C=I[g.id];Rg(C,"No route found in manifest");let l={};for(let n in t){let r=C[n]!==void 0&&n!=="hasErrorBoundary";xl(!r,'Route "'+C.id+'" has a static property "'+n+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+n+'" will be ignored.')),!r&&!rW.has(n)&&(l[n]=t[n])}Object.assign(C,l),Object.assign(C,oe({},e(C),{lazy:void 0}))}function EW(g){return Promise.all(g.matches.map(e=>e.resolve()))}async function zW(g,e,I,t,C,l,n,o){let r=t.reduce((c,A)=>c.add(A.route.id),new Set),a=new Set,i=await g({matches:C.map(c=>{let A=r.has(c.route.id);return oe({},c,{shouldLoad:A,resolve:G=>(a.add(c.route.id),A?MW(e,I,c,l,n,G,o):Promise.resolve({type:Qg.data,result:void 0}))})}),request:I,params:C[0].params,context:o});return C.forEach(c=>Rg(a.has(c.route.id),'`match.resolve()` was not called for route id "'+c.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),i.filter((c,A)=>r.has(C[A].route.id))}async function MW(g,e,I,t,C,l,n){let o,r,a=i=>{let c,A=new Promise((Z,h)=>c=h);r=()=>c(),e.signal.addEventListener("abort",r);let p=Z=>typeof i!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+g+'" [routeId: '+I.route.id+"]"))):i({request:e,params:I.params,context:n},...Z!==void 0?[Z]:[]),G;return l?G=l(Z=>p(Z)):G=(async()=>{try{return{type:"data",result:await p()}}catch(Z){return{type:"error",result:Z}}})(),Promise.race([G,A])};try{let i=I.route[g];if(I.route.lazy)if(i){let c,[A]=await Promise.all([a(i).catch(p=>{c=p}),jm(I.route,C,t)]);if(c!==void 0)throw c;o=A}else if(await jm(I.route,C,t),i=I.route[g],i)o=await a(i);else if(g==="action"){let c=new URL(e.url),A=c.pathname+c.search;throw $e(405,{method:e.method,pathname:A,routeId:I.route.id})}else return{type:Qg.data,result:void 0};else if(i)o=await a(i);else{let c=new URL(e.url),A=c.pathname+c.search;throw $e(404,{pathname:A})}Rg(o.result!==void 0,"You defined "+(g==="action"?"an action":"a loader")+" for route "+('"'+I.route.id+"\" but didn't return anything from your `"+g+"` ")+"function. Please return a value or `null`.")}catch(i){return{type:Qg.error,result:i}}finally{r&&e.signal.removeEventListener("abort",r)}return o}async function UW(g){let{result:e,type:I}=g;if(Z0(e)){let a;try{let i=e.headers.get("Content-Type");i&&/\bapplication\/json\b/.test(i)?e.body==null?a=null:a=await e.json():a=await e.text()}catch(i){return{type:Qg.error,error:i}}return I===Qg.error?{type:Qg.error,error:new Ga(e.status,e.statusText,a),statusCode:e.status,headers:e.headers}:{type:Qg.data,data:a,statusCode:e.status,headers:e.headers}}if(I===Qg.error){if(IZ(e)){var t;if(e.data instanceof Error){var C;return{type:Qg.error,error:e.data,statusCode:(C=e.init)==null?void 0:C.status}}e=new Ga(((t=e.init)==null?void 0:t.status)||500,void 0,e.data)}return{type:Qg.error,error:e,statusCode:Ci(e)?e.status:void 0}}if(PW(e)){var l,n;return{type:Qg.deferred,deferredData:e,statusCode:(l=e.init)==null?void 0:l.status,headers:((n=e.init)==null?void 0:n.headers)&&new Headers(e.init.headers)}}if(IZ(e)){var o,r;return{type:Qg.data,data:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(r=e.init)!=null&&r.headers?new Headers(e.init.headers):void 0}}return{type:Qg.data,data:e}}function LW(g,e,I,t,C,l){let n=g.headers.get("Location");if(Rg(n,"Redirects returned/thrown from loaders/actions must have a Location header"),!Rd.test(n)){let o=t.slice(0,t.findIndex(r=>r.route.id===I)+1);n=tA(new URL(e.url),o,C,!0,n,l),g.headers.set("Location",n)}return g}function Pm(g,e,I){if(Rd.test(g)){let t=g,C=t.startsWith("//")?new URL(e.protocol+t):new URL(t),l=Ol(C.pathname,I)!=null;if(C.origin===e.origin&&l)return C.pathname+C.search+C.hash}return g}function gl(g,e,I,t){let C=g.createURL(m0(e)).toString(),l={signal:I};if(t&&gt(t.formMethod)){let{formMethod:n,formEncType:o}=t;l.method=n.toUpperCase(),o==="application/json"?(l.headers=new Headers({"Content-Type":o}),l.body=JSON.stringify(t.json)):o==="text/plain"?l.body=t.text:o==="application/x-www-form-urlencoded"&&t.formData?l.body=CA(t.formData):l.body=t.formData}return new Request(C,l)}function CA(g){let e=new URLSearchParams;for(let[I,t]of g.entries())e.append(I,typeof t=="string"?t:t.name);return e}function Om(g){let e=new FormData;for(let[I,t]of g.entries())e.append(I,t);return e}function QW(g,e,I,t,C,l){let n={},o=null,r,a=!1,i={},c=t&&yI(t[1])?t[1].error:void 0;return I.forEach((A,p)=>{let G=e[p].route.id;if(Rg(!HC(A),"Cannot handle redirect results in processLoaderData"),yI(A)){let Z=A.error;c!==void 0&&(Z=c,c=void 0),o=o||{};{let h=yl(g,G);o[h.route.id]==null&&(o[h.route.id]=Z)}n[G]=void 0,a||(a=!0,r=Ci(A.error)?A.error.status:500),A.headers&&(i[G]=A.headers)}else YC(A)?(C.set(G,A.deferredData),n[G]=A.deferredData.data,A.statusCode!=null&&A.statusCode!==200&&!a&&(r=A.statusCode),A.headers&&(i[G]=A.headers)):(n[G]=A.data,A.statusCode&&A.statusCode!==200&&!a&&(r=A.statusCode),A.headers&&(i[G]=A.headers))}),c!==void 0&&t&&(o={[t[0]]:c},n[t[0]]=void 0),{loaderData:n,errors:o,statusCode:r||200,loaderHeaders:i}}function qm(g,e,I,t,C,l,n,o){let{loaderData:r,errors:a}=QW(e,I,t,C,o);for(let i=0;i<l.length;i++){let{key:c,match:A,controller:p}=l[i];Rg(n!==void 0&&n[i]!==void 0,"Did not find corresponding fetcher result");let G=n[i];if(!(p&&p.signal.aborted))if(yI(G)){let Z=yl(g.matches,A==null?void 0:A.route.id);a&&a[Z.route.id]||(a=oe({},a,{[Z.route.id]:G.error})),g.fetchers.delete(c)}else if(HC(G))Rg(!1,"Unhandled fetcher revalidation redirect");else if(YC(G))Rg(!1,"Unhandled fetcher deferred data");else{let Z=qt(G.data);g.fetchers.set(c,Z)}}return{loaderData:r,errors:a}}function $m(g,e,I,t){let C=oe({},e);for(let l of I){let n=l.route.id;if(e.hasOwnProperty(n)?e[n]!==void 0&&(C[n]=e[n]):g[n]!==void 0&&l.route.loader&&(C[n]=g[n]),t&&t.hasOwnProperty(n))break}return C}function _m(g){return g?yI(g[1])?{actionData:{}}:{actionData:{[g[0]]:g[1].data}}:{}}function yl(g,e){return(e?g.slice(0,g.findIndex(t=>t.route.id===e)+1):[...g]).reverse().find(t=>t.route.hasErrorBoundary===!0)||g[0]}function gZ(g){let e=g.length===1?g[0]:g.find(I=>I.index||!I.path||I.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function $e(g,e){let{pathname:I,routeId:t,method:C,type:l,message:n}=e===void 0?{}:e,o="Unknown Server Error",r="Unknown @remix-run/router error";return g===400?(o="Bad Request",l==="route-discovery"?r='Unable to match URL "'+I+'" - the `unstable_patchRoutesOnNavigation()` '+(`function threw the following error:
`+n):C&&I&&t?r="You made a "+C+' request to "'+I+'" but '+('did not provide a `loader` for route "'+t+'", ')+"so there is no way to handle the request.":l==="defer-action"?r="defer() is not supported in actions":l==="invalid-body"&&(r="Unable to encode submission body")):g===403?(o="Forbidden",r='Route "'+t+'" does not match URL "'+I+'"'):g===404?(o="Not Found",r='No route matches URL "'+I+'"'):g===405&&(o="Method Not Allowed",C&&I&&t?r="You made a "+C.toUpperCase()+' request to "'+I+'" but '+('did not provide an `action` for route "'+t+'", ')+"so there is no way to handle the request.":C&&(r='Invalid request method "'+C.toUpperCase()+'"')),new Ga(g||500,o,new Error(r),!0)}function eZ(g){for(let e=g.length-1;e>=0;e--){let I=g[e];if(HC(I))return{result:I,idx:e}}}function m0(g){let e=typeof g=="string"?GC(g):g;return QC(oe({},e,{hash:""}))}function TW(g,e){return g.pathname!==e.pathname||g.search!==e.search?!1:g.hash===""?e.hash!=="":g.hash===e.hash?!0:e.hash!==""}function DW(g){return typeof g=="object"&&g!=null&&"then"in g}function jW(g){return Z0(g.result)&&kW.has(g.result.status)}function YC(g){return g.type===Qg.deferred}function yI(g){return g.type===Qg.error}function HC(g){return(g&&g.type)===Qg.redirect}function IZ(g){return typeof g=="object"&&g!=null&&"type"in g&&"data"in g&&"init"in g&&g.type==="DataWithResponseInit"}function PW(g){let e=g;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function Z0(g){return g!=null&&typeof g.status=="number"&&typeof g.statusText=="string"&&typeof g.headers=="object"&&typeof g.body<"u"}function OW(g){return JW.has(g.toLowerCase())}function gt(g){return fW.has(g.toLowerCase())}async function tZ(g,e,I,t,C,l){for(let n=0;n<I.length;n++){let o=I[n],r=e[n];if(!r)continue;let a=g.find(c=>c.route.id===r.route.id),i=a!=null&&!d0(a,r)&&(l&&l[r.route.id])!==void 0;if(YC(o)&&(C||i)){let c=t[n];Rg(c,"Expected an AbortSignal for revalidating fetcher deferred result"),await b0(o,c,C).then(A=>{A&&(I[n]=A||I[n])})}}}async function b0(g,e,I){if(I===void 0&&(I=!1),!await g.deferredData.resolveData(e)){if(I)try{return{type:Qg.data,data:g.deferredData.unwrappedData}}catch(C){return{type:Qg.error,error:C}}return{type:Qg.data,data:g.deferredData.data}}}function fd(g){return new URLSearchParams(g).getAll("index").some(e=>e==="")}function Jn(g,e){let I=typeof e=="string"?GC(e).search:e.search;if(g[g.length-1].route.index&&fd(I||""))return g[g.length-1];let t=s0(g);return t[t.length-1]}function CZ(g){let{formMethod:e,formAction:I,formEncType:t,text:C,formData:l,json:n}=g;if(!(!e||!I||!t)){if(C!=null)return{formMethod:e,formAction:I,formEncType:t,formData:void 0,json:void 0,text:C};if(l!=null)return{formMethod:e,formAction:I,formEncType:t,formData:l,json:void 0,text:void 0};if(n!==void 0)return{formMethod:e,formAction:I,formEncType:t,formData:void 0,json:n,text:void 0}}}function Qs(g,e){return e?{state:"loading",location:g,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:g,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function qW(g,e){return{state:"submitting",location:g,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function un(g,e){return g?{state:"loading",formMethod:g.formMethod,formAction:g.formAction,formEncType:g.formEncType,formData:g.formData,json:g.json,text:g.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function $W(g,e){return{state:"submitting",formMethod:g.formMethod,formAction:g.formAction,formEncType:g.formEncType,formData:g.formData,json:g.json,text:g.text,data:e?e.data:void 0}}function qt(g){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:g}}function _W(g,e){try{let I=g.sessionStorage.getItem(A0);if(I){let t=JSON.parse(I);for(let[C,l]of Object.entries(t||{}))l&&Array.isArray(l)&&e.set(C,new Set(l||[]))}}catch{}}function gV(g,e){if(e.size>0){let I={};for(let[t,C]of e)I[t]=[...C];try{g.sessionStorage.setItem(A0,JSON.stringify(I))}catch(t){xl(!1,"Failed to save applied view transitions in sessionStorage ("+t+").")}}}/**
 * React Router v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pa(){return pa=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},pa.apply(this,arguments)}const li=d.createContext(null),G0=d.createContext(null),pC=d.createContext(null),Xd=d.createContext(null),St=d.createContext({outlet:null,matches:[],isDataRoute:!1}),p0=d.createContext(null);function eV(g,e){let{relative:I}=e===void 0?{}:e;ql()||Rg(!1);let{basename:t,navigator:C}=d.useContext(pC),{hash:l,pathname:n,search:o}=y0(g,{relative:I}),r=n;return t!=="/"&&(r=n==="/"?t:Ft([t,n])),C.createHref({pathname:r,search:o,hash:l})}function ql(){return d.useContext(Xd)!=null}function Jo(){return ql()||Rg(!1),d.useContext(Xd).location}function h0(g){d.useContext(pC).static||d.useLayoutEffect(g)}function rt(){let{isDataRoute:g}=d.useContext(St);return g?uV():IV()}function IV(){ql()||Rg(!1);let g=d.useContext(li),{basename:e,future:I,navigator:t}=d.useContext(pC),{matches:C}=d.useContext(St),{pathname:l}=Jo(),n=JSON.stringify(Ii(C,I.v7_relativeSplatPath)),o=d.useRef(!1);return h0(()=>{o.current=!0}),d.useCallback(function(a,i){if(i===void 0&&(i={}),!o.current)return;if(typeof a=="number"){t.go(a);return}let c=ti(a,JSON.parse(n),l,i.relative==="path");g==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:Ft([e,c.pathname])),(i.replace?t.replace:t.push)(c,i.state,i)},[e,t,n,l,g])}const tV=d.createContext(null);function CV(g){let e=d.useContext(St).outlet;return e&&d.createElement(tV.Provider,{value:g},e)}function Jd(){let{matches:g}=d.useContext(St),e=g[g.length-1];return e?e.params:{}}function y0(g,e){let{relative:I}=e===void 0?{}:e,{future:t}=d.useContext(pC),{matches:C}=d.useContext(St),{pathname:l}=Jo(),n=JSON.stringify(Ii(C,t.v7_relativeSplatPath));return d.useMemo(()=>ti(g,JSON.parse(n),l,I==="path"),[g,n,l,I])}function lV(g,e,I,t){ql()||Rg(!1);let{navigator:C}=d.useContext(pC),{matches:l}=d.useContext(St),n=l[l.length-1],o=n?n.params:{};n&&n.pathname;let r=n?n.pathnameBase:"/";n&&n.route;let a=Jo(),i;i=a;let c=i.pathname||"/",A=c;if(r!=="/"){let Z=r.replace(/^\//,"").split("/");A="/"+c.replace(/^\//,"").split("/").slice(Z.length).join("/")}let p=XC(g,{pathname:A});return iV(p&&p.map(Z=>Object.assign({},Z,{params:Object.assign({},o,Z.params),pathname:Ft([r,C.encodeLocation?C.encodeLocation(Z.pathname).pathname:Z.pathname]),pathnameBase:Z.pathnameBase==="/"?r:Ft([r,C.encodeLocation?C.encodeLocation(Z.pathnameBase).pathname:Z.pathnameBase])})),l,I,t)}function nV(){let g=dV(),e=Ci(g)?g.status+" "+g.statusText:g instanceof Error?g.message:JSON.stringify(g),I=g instanceof Error?g.stack:null,C={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return d.createElement(d.Fragment,null,d.createElement("h2",null,"Unexpected Application Error!"),d.createElement("h3",{style:{fontStyle:"italic"}},e),I?d.createElement("pre",{style:C},I):null,null)}const oV=d.createElement(nV,null);class rV extends d.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,I){return I.location!==e.location||I.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:I.error,location:I.location,revalidation:e.revalidation||I.revalidation}}componentDidCatch(e,I){console.error("React Router caught the following error during render",e,I)}render(){return this.state.error!==void 0?d.createElement(St.Provider,{value:this.props.routeContext},d.createElement(p0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function aV(g){let{routeContext:e,match:I,children:t}=g,C=d.useContext(li);return C&&C.static&&C.staticContext&&(I.route.errorElement||I.route.ErrorBoundary)&&(C.staticContext._deepestRenderedBoundaryId=I.route.id),d.createElement(St.Provider,{value:e},t)}function iV(g,e,I,t){var C;if(e===void 0&&(e=[]),I===void 0&&(I=null),t===void 0&&(t=null),g==null){var l;if(!I)return null;if(I.errors)g=I.matches;else if((l=t)!=null&&l.v7_partialHydration&&e.length===0&&!I.initialized&&I.matches.length>0)g=I.matches;else return null}let n=g,o=(C=I)==null?void 0:C.errors;if(o!=null){let i=n.findIndex(c=>c.route.id&&(o==null?void 0:o[c.route.id])!==void 0);i>=0||Rg(!1),n=n.slice(0,Math.min(n.length,i+1))}let r=!1,a=-1;if(I&&t&&t.v7_partialHydration)for(let i=0;i<n.length;i++){let c=n[i];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=i),c.route.id){let{loaderData:A,errors:p}=I,G=c.route.loader&&A[c.route.id]===void 0&&(!p||p[c.route.id]===void 0);if(c.route.lazy||G){r=!0,a>=0?n=n.slice(0,a+1):n=[n[0]];break}}}return n.reduceRight((i,c,A)=>{let p,G=!1,Z=null,h=null;I&&(p=o&&c.route.id?o[c.route.id]:void 0,Z=c.route.errorElement||oV,r&&(a<0&&A===0?(G=!0,h=null):a===A&&(G=!0,h=c.route.hydrateFallbackElement||null)));let u=e.concat(n.slice(0,A+1)),b=()=>{let m;return p?m=Z:G?m=h:c.route.Component?m=d.createElement(c.route.Component,null):c.route.element?m=c.route.element:m=i,d.createElement(aV,{match:c,routeContext:{outlet:i,matches:u,isDataRoute:I!=null},children:m})};return I&&(c.route.ErrorBoundary||c.route.errorElement||A===0)?d.createElement(rV,{location:I.location,revalidation:I.revalidation,component:Z,error:p,children:b(),routeContext:{outlet:null,matches:u,isDataRoute:!0}}):b()},null)}var B0=function(g){return g.UseBlocker="useBlocker",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g}(B0||{}),ha=function(g){return g.UseBlocker="useBlocker",g.UseLoaderData="useLoaderData",g.UseActionData="useActionData",g.UseRouteError="useRouteError",g.UseNavigation="useNavigation",g.UseRouteLoaderData="useRouteLoaderData",g.UseMatches="useMatches",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g.UseRouteId="useRouteId",g}(ha||{});function sV(g){let e=d.useContext(li);return e||Rg(!1),e}function cV(g){let e=d.useContext(G0);return e||Rg(!1),e}function AV(g){let e=d.useContext(St);return e||Rg(!1),e}function S0(g){let e=AV(),I=e.matches[e.matches.length-1];return I.route.id||Rg(!1),I.route.id}function dV(){var g;let e=d.useContext(p0),I=cV(ha.UseRouteError),t=S0(ha.UseRouteError);return e!==void 0?e:(g=I.errors)==null?void 0:g[t]}function uV(){let{router:g}=sV(B0.UseNavigateStable),e=S0(ha.UseNavigateStable),I=d.useRef(!1);return h0(()=>{I.current=!0}),d.useCallback(function(C,l){l===void 0&&(l={}),I.current&&(typeof C=="number"?g.navigate(C):g.navigate(C,pa({fromRouteId:e},l)))},[g,e])}function lZ(g){let{to:e,replace:I,state:t,relative:C}=g;ql()||Rg(!1);let{future:l,static:n}=d.useContext(pC),{matches:o}=d.useContext(St),{pathname:r}=Jo(),a=rt(),i=ti(e,Ii(o,l.v7_relativeSplatPath),r,C==="path"),c=JSON.stringify(i);return d.useEffect(()=>a(JSON.parse(c),{replace:I,state:t,relative:C}),[a,c,C,I,t]),null}function mV(g){return CV(g.context)}function ZV(g){let{basename:e="/",children:I=null,location:t,navigationType:C=Be.Pop,navigator:l,static:n=!1,future:o}=g;ql()&&Rg(!1);let r=e.replace(/^\/*/,"/"),a=d.useMemo(()=>({basename:r,navigator:l,static:n,future:pa({v7_relativeSplatPath:!1},o)}),[r,o,l,n]);typeof t=="string"&&(t=GC(t));let{pathname:i="/",search:c="",hash:A="",state:p=null,key:G="default"}=t,Z=d.useMemo(()=>{let h=Ol(i,r);return h==null?null:{location:{pathname:h,search:c,hash:A,state:p,key:G},navigationType:C}},[r,i,c,A,p,G,C]);return Z==null?null:d.createElement(pC.Provider,{value:a},d.createElement(Xd.Provider,{children:I,value:Z}))}new Promise(()=>{});function bV(g){let e={hasErrorBoundary:g.ErrorBoundary!=null||g.errorElement!=null};return g.Component&&Object.assign(e,{element:d.createElement(g.Component),Component:void 0}),g.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:d.createElement(g.HydrateFallback),HydrateFallback:void 0}),g.ErrorBoundary&&Object.assign(e,{errorElement:d.createElement(g.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ao(){return Ao=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},Ao.apply(this,arguments)}function GV(g,e){if(g==null)return{};var I={},t=Object.keys(g),C,l;for(l=0;l<t.length;l++)C=t[l],!(e.indexOf(C)>=0)&&(I[C]=g[C]);return I}function pV(g){return!!(g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)}function hV(g,e){return g.button===0&&(!e||e==="_self")&&!pV(g)}const yV=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],BV="6";try{window.__reactRouterVersion=BV}catch{}function SV(g,e){return wW({basename:void 0,future:Ao({},void 0,{v7_prependBasename:!0}),history:lW({window:void 0}),hydrationData:WV(),routes:g,mapRouteProperties:bV,unstable_dataStrategy:void 0,unstable_patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function WV(){var g;let e=(g=window)==null?void 0:g.__staticRouterHydrationData;return e&&e.errors&&(e=Ao({},e,{errors:VV(e.errors)})),e}function VV(g){if(!g)return null;let e=Object.entries(g),I={};for(let[t,C]of e)if(C&&C.__type==="RouteErrorResponse")I[t]=new Ga(C.status,C.statusText,C.data,C.internal===!0);else if(C&&C.__type==="Error"){if(C.__subType){let l=window[C.__subType];if(typeof l=="function")try{let n=new l(C.message);n.stack="",I[t]=n}catch{}}if(I[t]==null){let l=new Error(C.message);l.stack="",I[t]=l}}else I[t]=C;return I}const RV=d.createContext({isTransitioning:!1}),fV=d.createContext(new Map),XV="startTransition",nZ=jr[XV],JV="flushSync",oZ=CW[JV];function kV(g){nZ?nZ(g):g()}function mn(g){oZ?oZ(g):g()}class vV{constructor(){this.status="pending",this.promise=new Promise((e,I)=>{this.resolve=t=>{this.status==="pending"&&(this.status="resolved",e(t))},this.reject=t=>{this.status==="pending"&&(this.status="rejected",I(t))}})}}function YV(g){let{fallbackElement:e,router:I,future:t}=g,[C,l]=d.useState(I.state),[n,o]=d.useState(),[r,a]=d.useState({isTransitioning:!1}),[i,c]=d.useState(),[A,p]=d.useState(),[G,Z]=d.useState(),h=d.useRef(new Map),{v7_startTransition:u}=t||{},b=d.useCallback(S=>{u?kV(S):S()},[u]),m=d.useCallback((S,y)=>{let{deletedFetchers:f,unstable_flushSync:k,unstable_viewTransitionOpts:H}=y;f.forEach(F=>h.current.delete(F)),S.fetchers.forEach((F,x)=>{F.data!==void 0&&h.current.set(x,F.data)});let M=I.window==null||I.window.document==null||typeof I.window.document.startViewTransition!="function";if(!H||M){k?mn(()=>l(S)):b(()=>l(S));return}if(k){mn(()=>{A&&(i&&i.resolve(),A.skipTransition()),a({isTransitioning:!0,flushSync:!0,currentLocation:H.currentLocation,nextLocation:H.nextLocation})});let F=I.window.document.startViewTransition(()=>{mn(()=>l(S))});F.finished.finally(()=>{mn(()=>{c(void 0),p(void 0),o(void 0),a({isTransitioning:!1})})}),mn(()=>p(F));return}A?(i&&i.resolve(),A.skipTransition(),Z({state:S,currentLocation:H.currentLocation,nextLocation:H.nextLocation})):(o(S),a({isTransitioning:!0,flushSync:!1,currentLocation:H.currentLocation,nextLocation:H.nextLocation}))},[I.window,A,i,h,b]);d.useLayoutEffect(()=>I.subscribe(m),[I,m]),d.useEffect(()=>{r.isTransitioning&&!r.flushSync&&c(new vV)},[r]),d.useEffect(()=>{if(i&&n&&I.window){let S=n,y=i.promise,f=I.window.document.startViewTransition(async()=>{b(()=>l(S)),await y});f.finished.finally(()=>{c(void 0),p(void 0),o(void 0),a({isTransitioning:!1})}),p(f)}},[b,n,i,I.window]),d.useEffect(()=>{i&&n&&C.location.key===n.location.key&&i.resolve()},[i,A,C.location,n]),d.useEffect(()=>{!r.isTransitioning&&G&&(o(G.state),a({isTransitioning:!0,flushSync:!1,currentLocation:G.currentLocation,nextLocation:G.nextLocation}),Z(void 0))},[r.isTransitioning,G]),d.useEffect(()=>{},[]);let B=d.useMemo(()=>({createHref:I.createHref,encodeLocation:I.encodeLocation,go:S=>I.navigate(S),push:(S,y,f)=>I.navigate(S,{state:y,preventScrollReset:f==null?void 0:f.preventScrollReset}),replace:(S,y,f)=>I.navigate(S,{replace:!0,state:y,preventScrollReset:f==null?void 0:f.preventScrollReset})}),[I]),W=I.basename||"/",R=d.useMemo(()=>({router:I,navigator:B,static:!1,basename:W}),[I,B,W]),V=d.useMemo(()=>({v7_relativeSplatPath:I.future.v7_relativeSplatPath}),[I.future.v7_relativeSplatPath]);return d.createElement(d.Fragment,null,d.createElement(li.Provider,{value:R},d.createElement(G0.Provider,{value:C},d.createElement(fV.Provider,{value:h.current},d.createElement(RV.Provider,{value:r},d.createElement(ZV,{basename:W,location:C.location,navigationType:C.historyAction,navigator:B,future:V},C.initialized||I.future.v7_partialHydration?d.createElement(HV,{routes:I.routes,future:I.future,state:C}):e))))),null)}const HV=d.memo(wV);function wV(g){let{routes:e,future:I,state:t}=g;return lV(e,void 0,t,I)}const NV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",FV=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KV=d.forwardRef(function(e,I){let{onClick:t,relative:C,reloadDocument:l,replace:n,state:o,target:r,to:a,preventScrollReset:i,unstable_viewTransition:c}=e,A=GV(e,yV),{basename:p}=d.useContext(pC),G,Z=!1;if(typeof a=="string"&&FV.test(a)&&(G=a,NV))try{let m=new URL(window.location.href),B=a.startsWith("//")?new URL(m.protocol+a):new URL(a),W=Ol(B.pathname,p);B.origin===m.origin&&W!=null?a=W+B.search+B.hash:Z=!0}catch{}let h=eV(a,{relative:C}),u=xV(a,{replace:n,state:o,target:r,preventScrollReset:i,relative:C,unstable_viewTransition:c});function b(m){t&&t(m),m.defaultPrevented||u(m)}return d.createElement("a",Ao({},A,{href:G||h,onClick:Z||l?t:b,ref:I,target:r}))});var rZ;(function(g){g.UseScrollRestoration="useScrollRestoration",g.UseSubmit="useSubmit",g.UseSubmitFetcher="useSubmitFetcher",g.UseFetcher="useFetcher",g.useViewTransitionState="useViewTransitionState"})(rZ||(rZ={}));var aZ;(function(g){g.UseFetcher="useFetcher",g.UseFetchers="useFetchers",g.UseScrollRestoration="useScrollRestoration"})(aZ||(aZ={}));function xV(g,e){let{target:I,replace:t,state:C,preventScrollReset:l,relative:n,unstable_viewTransition:o}=e===void 0?{}:e,r=rt(),a=Jo(),i=y0(g,{relative:n});return d.useCallback(c=>{if(hV(c,I)){c.preventDefault();let A=t!==void 0?t:QC(a)===QC(i);r(g,{replace:A,state:C,preventScrollReset:l,relative:n,unstable_viewTransition:o})}},[a,r,i,t,C,I,g,l,n,o])}var W0={exports:{}},EV="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",zV=EV,MV=zV;function V0(){}function R0(){}R0.resetWarningCache=V0;var UV=function(){function g(t,C,l,n,o,r){if(r!==MV){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}g.isRequired=g;function e(){return g}var I={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:e,element:g,elementType:g,instanceOf:e,node:g,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:R0,resetWarningCache:V0};return I.PropTypes=I,I};W0.exports=UV();var kd=W0.exports;const Er=Ka(kd),LV={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},iZ=g=>{let e;const I=new Set,t=(i,c)=>{const A=typeof i=="function"?i(e):i;if(!Object.is(A,e)){const p=e;e=c??(typeof A!="object"||A===null)?A:Object.assign({},e,A),I.forEach(G=>G(e,p))}},C=()=>e,r={setState:t,getState:C,getInitialState:()=>a,subscribe:i=>(I.add(i),()=>I.delete(i)),destroy:()=>{(LV?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),I.clear()}},a=e=g(t,C,r);return r},QV=g=>g?iZ(g):iZ;var f0={exports:{}},X0={},J0={exports:{}},k0={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var El=d;function TV(g,e){return g===e&&(g!==0||1/g===1/e)||g!==g&&e!==e}var DV=typeof Object.is=="function"?Object.is:TV,jV=El.useState,PV=El.useEffect,OV=El.useLayoutEffect,qV=El.useDebugValue;function $V(g,e){var I=e(),t=jV({inst:{value:I,getSnapshot:e}}),C=t[0].inst,l=t[1];return OV(function(){C.value=I,C.getSnapshot=e,Ts(C)&&l({inst:C})},[g,I,e]),PV(function(){return Ts(C)&&l({inst:C}),g(function(){Ts(C)&&l({inst:C})})},[g]),qV(I),I}function Ts(g){var e=g.getSnapshot;g=g.value;try{var I=e();return!DV(g,I)}catch{return!0}}function _V(g,e){return e()}var gR=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_V:$V;k0.useSyncExternalStore=El.useSyncExternalStore!==void 0?El.useSyncExternalStore:gR;J0.exports=k0;var eR=J0.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ni=d,IR=eR;function tR(g,e){return g===e&&(g!==0||1/g===1/e)||g!==g&&e!==e}var CR=typeof Object.is=="function"?Object.is:tR,lR=IR.useSyncExternalStore,nR=ni.useRef,oR=ni.useEffect,rR=ni.useMemo,aR=ni.useDebugValue;X0.useSyncExternalStoreWithSelector=function(g,e,I,t,C){var l=nR(null);if(l.current===null){var n={hasValue:!1,value:null};l.current=n}else n=l.current;l=rR(function(){function r(p){if(!a){if(a=!0,i=p,p=t(p),C!==void 0&&n.hasValue){var G=n.value;if(C(G,p))return c=G}return c=p}if(G=c,CR(i,p))return G;var Z=t(p);return C!==void 0&&C(G,Z)?G:(i=p,c=Z)}var a=!1,i,c,A=I===void 0?null:I;return[function(){return r(e())},A===null?void 0:function(){return r(A())}]},[e,I,t,C]);var o=lR(g,l[0],l[1]);return oR(function(){n.hasValue=!0,n.value=o},[o]),aR(o),o};f0.exports=X0;var iR=f0.exports;const sR=Ka(iR),vd={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},{useDebugValue:cR}=tt,{useSyncExternalStoreWithSelector:AR}=sR;let sZ=!1;const dR=g=>g;function uR(g,e=dR,I){(vd?"production":void 0)!=="production"&&I&&!sZ&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),sZ=!0);const t=AR(g.subscribe,g.getState,g.getServerState||g.getInitialState,e,I);return cR(t),t}const cZ=g=>{(vd?"production":void 0)!=="production"&&typeof g!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof g=="function"?QV(g):g,I=(t,C)=>uR(e,t,C);return Object.assign(I,e),I},mR=g=>g?cZ(g):cZ;var ZR=g=>((vd?"production":void 0)!=="production"&&console.warn("[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`."),mR(g));const bR={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function GR(g,e){let I;try{I=g()}catch{return}return{getItem:C=>{var l;const n=r=>r===null?null:JSON.parse(r,void 0),o=(l=I.getItem(C))!=null?l:null;return o instanceof Promise?o.then(n):n(o)},setItem:(C,l)=>I.setItem(C,JSON.stringify(l,void 0)),removeItem:C=>I.removeItem(C)}}const uo=g=>e=>{try{const I=g(e);return I instanceof Promise?I:{then(t){return uo(t)(I)},catch(t){return this}}}catch(I){return{then(t){return this},catch(t){return uo(t)(I)}}}},pR=(g,e)=>(I,t,C)=>{let l={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:h=>h,version:0,merge:(h,u)=>({...u,...h}),...e},n=!1;const o=new Set,r=new Set;let a;try{a=l.getStorage()}catch{}if(!a)return g((...h)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),I(...h)},t,C);const i=uo(l.serialize),c=()=>{const h=l.partialize({...t()});let u;const b=i({state:h,version:l.version}).then(m=>a.setItem(l.name,m)).catch(m=>{u=m});if(u)throw u;return b},A=C.setState;C.setState=(h,u)=>{A(h,u),c()};const p=g((...h)=>{I(...h),c()},t,C);let G;const Z=()=>{var h;if(!a)return;n=!1,o.forEach(b=>b(t()));const u=((h=l.onRehydrateStorage)==null?void 0:h.call(l,t()))||void 0;return uo(a.getItem.bind(a))(l.name).then(b=>{if(b)return l.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==l.version){if(l.migrate)return l.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var m;return G=l.merge(b,(m=t())!=null?m:p),I(G,!0),c()}).then(()=>{u==null||u(G,void 0),n=!0,r.forEach(b=>b(G))}).catch(b=>{u==null||u(void 0,b)})};return C.persist={setOptions:h=>{l={...l,...h},h.getStorage&&(a=h.getStorage())},clearStorage:()=>{a==null||a.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>Z(),hasHydrated:()=>n,onHydrate:h=>(o.add(h),()=>{o.delete(h)}),onFinishHydration:h=>(r.add(h),()=>{r.delete(h)})},Z(),G||p},hR=(g,e)=>(I,t,C)=>{let l={storage:GR(()=>localStorage),partialize:Z=>Z,version:0,merge:(Z,h)=>({...h,...Z}),...e},n=!1;const o=new Set,r=new Set;let a=l.storage;if(!a)return g((...Z)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),I(...Z)},t,C);const i=()=>{const Z=l.partialize({...t()});return a.setItem(l.name,{state:Z,version:l.version})},c=C.setState;C.setState=(Z,h)=>{c(Z,h),i()};const A=g((...Z)=>{I(...Z),i()},t,C);C.getInitialState=()=>A;let p;const G=()=>{var Z,h;if(!a)return;n=!1,o.forEach(b=>{var m;return b((m=t())!=null?m:A)});const u=((h=l.onRehydrateStorage)==null?void 0:h.call(l,(Z=t())!=null?Z:A))||void 0;return uo(a.getItem.bind(a))(l.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==l.version){if(l.migrate)return[!0,l.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var m;const[B,W]=b;if(p=l.merge(W,(m=t())!=null?m:A),I(p,!0),B)return i()}).then(()=>{u==null||u(p,void 0),p=t(),n=!0,r.forEach(b=>b(p))}).catch(b=>{u==null||u(void 0,b)})};return C.persist={setOptions:Z=>{l={...l,...Z},Z.storage&&(a=Z.storage)},clearStorage:()=>{a==null||a.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>G(),hasHydrated:()=>n,onHydrate:Z=>(o.add(Z),()=>{o.delete(Z)}),onFinishHydration:Z=>(r.add(Z),()=>{r.delete(Z)})},l.skipHydration||G(),p||A},yR=(g,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((bR?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),pR(g,e)):hR(g,e),BR=yR,ko=ZR(BR(g=>({accessToken:null,refreshToken:null,isAdmin:!1,isAlumno:!1,username:null,setTokens:(e,I,t,C)=>g({accessToken:e,refreshToken:I,isAdmin:t,username:C,isAlumno:!t}),logout:()=>g({accessToken:null,refreshToken:null,isAdmin:!1,isAlumno:!1,username:null})}),{name:"auth-storage",getStorage:()=>localStorage})),Qe=({element:g,isAdminRequired:e=!1,isAuthenticatedRequired:I=!1})=>{const{accessToken:t,isAdmin:C}=ko();return I&&!t?s.jsx(lZ,{to:"/login"}):e&&!C?s.jsx(lZ,{to:"/unauthorized"}):g};Qe.propTypes={element:Er.element.isRequired,isAdminRequired:Er.bool,isAuthenticatedRequired:Er.bool};function v0(g,e){return function(){return g.apply(e,arguments)}}const{toString:SR}=Object.prototype,{getPrototypeOf:Yd}=Object,oi=(g=>e=>{const I=SR.call(e);return g[I]||(g[I]=I.slice(8,-1).toLowerCase())})(Object.create(null)),at=g=>(g=g.toLowerCase(),e=>oi(e)===g),ri=g=>e=>typeof e===g,{isArray:$l}=Array,mo=ri("undefined");function WR(g){return g!==null&&!mo(g)&&g.constructor!==null&&!mo(g.constructor)&&VI(g.constructor.isBuffer)&&g.constructor.isBuffer(g)}const Y0=at("ArrayBuffer");function VR(g){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(g):e=g&&g.buffer&&Y0(g.buffer),e}const RR=ri("string"),VI=ri("function"),H0=ri("number"),ai=g=>g!==null&&typeof g=="object",fR=g=>g===!0||g===!1,zr=g=>{if(oi(g)!=="object")return!1;const e=Yd(g);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in g)&&!(Symbol.iterator in g)},XR=at("Date"),JR=at("File"),kR=at("Blob"),vR=at("FileList"),YR=g=>ai(g)&&VI(g.pipe),HR=g=>{let e;return g&&(typeof FormData=="function"&&g instanceof FormData||VI(g.append)&&((e=oi(g))==="formdata"||e==="object"&&VI(g.toString)&&g.toString()==="[object FormData]"))},wR=at("URLSearchParams"),[NR,FR,KR,xR]=["ReadableStream","Request","Response","Headers"].map(at),ER=g=>g.trim?g.trim():g.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function vo(g,e,{allOwnKeys:I=!1}={}){if(g===null||typeof g>"u")return;let t,C;if(typeof g!="object"&&(g=[g]),$l(g))for(t=0,C=g.length;t<C;t++)e.call(null,g[t],t,g);else{const l=I?Object.getOwnPropertyNames(g):Object.keys(g),n=l.length;let o;for(t=0;t<n;t++)o=l[t],e.call(null,g[o],o,g)}}function w0(g,e){e=e.toLowerCase();const I=Object.keys(g);let t=I.length,C;for(;t-- >0;)if(C=I[t],e===C.toLowerCase())return C;return null}const wC=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,N0=g=>!mo(g)&&g!==wC;function lA(){const{caseless:g}=N0(this)&&this||{},e={},I=(t,C)=>{const l=g&&w0(e,C)||C;zr(e[l])&&zr(t)?e[l]=lA(e[l],t):zr(t)?e[l]=lA({},t):$l(t)?e[l]=t.slice():e[l]=t};for(let t=0,C=arguments.length;t<C;t++)arguments[t]&&vo(arguments[t],I);return e}const zR=(g,e,I,{allOwnKeys:t}={})=>(vo(e,(C,l)=>{I&&VI(C)?g[l]=v0(C,I):g[l]=C},{allOwnKeys:t}),g),MR=g=>(g.charCodeAt(0)===65279&&(g=g.slice(1)),g),UR=(g,e,I,t)=>{g.prototype=Object.create(e.prototype,t),g.prototype.constructor=g,Object.defineProperty(g,"super",{value:e.prototype}),I&&Object.assign(g.prototype,I)},LR=(g,e,I,t)=>{let C,l,n;const o={};if(e=e||{},g==null)return e;do{for(C=Object.getOwnPropertyNames(g),l=C.length;l-- >0;)n=C[l],(!t||t(n,g,e))&&!o[n]&&(e[n]=g[n],o[n]=!0);g=I!==!1&&Yd(g)}while(g&&(!I||I(g,e))&&g!==Object.prototype);return e},QR=(g,e,I)=>{g=String(g),(I===void 0||I>g.length)&&(I=g.length),I-=e.length;const t=g.indexOf(e,I);return t!==-1&&t===I},TR=g=>{if(!g)return null;if($l(g))return g;let e=g.length;if(!H0(e))return null;const I=new Array(e);for(;e-- >0;)I[e]=g[e];return I},DR=(g=>e=>g&&e instanceof g)(typeof Uint8Array<"u"&&Yd(Uint8Array)),jR=(g,e)=>{const t=(g&&g[Symbol.iterator]).call(g);let C;for(;(C=t.next())&&!C.done;){const l=C.value;e.call(g,l[0],l[1])}},PR=(g,e)=>{let I;const t=[];for(;(I=g.exec(e))!==null;)t.push(I);return t},OR=at("HTMLFormElement"),qR=g=>g.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(I,t,C){return t.toUpperCase()+C}),AZ=(({hasOwnProperty:g})=>(e,I)=>g.call(e,I))(Object.prototype),$R=at("RegExp"),F0=(g,e)=>{const I=Object.getOwnPropertyDescriptors(g),t={};vo(I,(C,l)=>{let n;(n=e(C,l,g))!==!1&&(t[l]=n||C)}),Object.defineProperties(g,t)},_R=g=>{F0(g,(e,I)=>{if(VI(g)&&["arguments","caller","callee"].indexOf(I)!==-1)return!1;const t=g[I];if(VI(t)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+I+"'")})}})},gf=(g,e)=>{const I={},t=C=>{C.forEach(l=>{I[l]=!0})};return $l(g)?t(g):t(String(g).split(e)),I},ef=()=>{},If=(g,e)=>g!=null&&Number.isFinite(g=+g)?g:e,Ds="abcdefghijklmnopqrstuvwxyz",dZ="0123456789",K0={DIGIT:dZ,ALPHA:Ds,ALPHA_DIGIT:Ds+Ds.toUpperCase()+dZ},tf=(g=16,e=K0.ALPHA_DIGIT)=>{let I="";const{length:t}=e;for(;g--;)I+=e[Math.random()*t|0];return I};function Cf(g){return!!(g&&VI(g.append)&&g[Symbol.toStringTag]==="FormData"&&g[Symbol.iterator])}const lf=g=>{const e=new Array(10),I=(t,C)=>{if(ai(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[C]=t;const l=$l(t)?[]:{};return vo(t,(n,o)=>{const r=I(n,C+1);!mo(r)&&(l[o]=r)}),e[C]=void 0,l}}return t};return I(g,0)},nf=at("AsyncFunction"),of=g=>g&&(ai(g)||VI(g))&&VI(g.then)&&VI(g.catch),x0=((g,e)=>g?setImmediate:e?((I,t)=>(wC.addEventListener("message",({source:C,data:l})=>{C===wC&&l===I&&t.length&&t.shift()()},!1),C=>{t.push(C),wC.postMessage(I,"*")}))(`axios@${Math.random()}`,[]):I=>setTimeout(I))(typeof setImmediate=="function",VI(wC.postMessage)),rf=typeof queueMicrotask<"u"?queueMicrotask.bind(wC):typeof process<"u"&&process.nextTick||x0,w={isArray:$l,isArrayBuffer:Y0,isBuffer:WR,isFormData:HR,isArrayBufferView:VR,isString:RR,isNumber:H0,isBoolean:fR,isObject:ai,isPlainObject:zr,isReadableStream:NR,isRequest:FR,isResponse:KR,isHeaders:xR,isUndefined:mo,isDate:XR,isFile:JR,isBlob:kR,isRegExp:$R,isFunction:VI,isStream:YR,isURLSearchParams:wR,isTypedArray:DR,isFileList:vR,forEach:vo,merge:lA,extend:zR,trim:ER,stripBOM:MR,inherits:UR,toFlatObject:LR,kindOf:oi,kindOfTest:at,endsWith:QR,toArray:TR,forEachEntry:jR,matchAll:PR,isHTMLForm:OR,hasOwnProperty:AZ,hasOwnProp:AZ,reduceDescriptors:F0,freezeMethods:_R,toObjectSet:gf,toCamelCase:qR,noop:ef,toFiniteNumber:If,findKey:w0,global:wC,isContextDefined:N0,ALPHABET:K0,generateString:tf,isSpecCompliantForm:Cf,toJSONObject:lf,isAsyncFn:nf,isThenable:of,setImmediate:x0,asap:rf};function Bg(g,e,I,t,C){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=g,this.name="AxiosError",e&&(this.code=e),I&&(this.config=I),t&&(this.request=t),C&&(this.response=C,this.status=C.status?C.status:null)}w.inherits(Bg,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:w.toJSONObject(this.config),code:this.code,status:this.status}}});const E0=Bg.prototype,z0={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(g=>{z0[g]={value:g}});Object.defineProperties(Bg,z0);Object.defineProperty(E0,"isAxiosError",{value:!0});Bg.from=(g,e,I,t,C,l)=>{const n=Object.create(E0);return w.toFlatObject(g,n,function(r){return r!==Error.prototype},o=>o!=="isAxiosError"),Bg.call(n,g.message,e,I,t,C),n.cause=g,n.name=g.name,l&&Object.assign(n,l),n};const af=null;function nA(g){return w.isPlainObject(g)||w.isArray(g)}function M0(g){return w.endsWith(g,"[]")?g.slice(0,-2):g}function uZ(g,e,I){return g?g.concat(e).map(function(C,l){return C=M0(C),!I&&l?"["+C+"]":C}).join(I?".":""):e}function sf(g){return w.isArray(g)&&!g.some(nA)}const cf=w.toFlatObject(w,{},null,function(e){return/^is[A-Z]/.test(e)});function ii(g,e,I){if(!w.isObject(g))throw new TypeError("target must be an object");e=e||new FormData,I=w.toFlatObject(I,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Z,h){return!w.isUndefined(h[Z])});const t=I.metaTokens,C=I.visitor||i,l=I.dots,n=I.indexes,r=(I.Blob||typeof Blob<"u"&&Blob)&&w.isSpecCompliantForm(e);if(!w.isFunction(C))throw new TypeError("visitor must be a function");function a(G){if(G===null)return"";if(w.isDate(G))return G.toISOString();if(!r&&w.isBlob(G))throw new Bg("Blob is not supported. Use a Buffer instead.");return w.isArrayBuffer(G)||w.isTypedArray(G)?r&&typeof Blob=="function"?new Blob([G]):Buffer.from(G):G}function i(G,Z,h){let u=G;if(G&&!h&&typeof G=="object"){if(w.endsWith(Z,"{}"))Z=t?Z:Z.slice(0,-2),G=JSON.stringify(G);else if(w.isArray(G)&&sf(G)||(w.isFileList(G)||w.endsWith(Z,"[]"))&&(u=w.toArray(G)))return Z=M0(Z),u.forEach(function(m,B){!(w.isUndefined(m)||m===null)&&e.append(n===!0?uZ([Z],B,l):n===null?Z:Z+"[]",a(m))}),!1}return nA(G)?!0:(e.append(uZ(h,Z,l),a(G)),!1)}const c=[],A=Object.assign(cf,{defaultVisitor:i,convertValue:a,isVisitable:nA});function p(G,Z){if(!w.isUndefined(G)){if(c.indexOf(G)!==-1)throw Error("Circular reference detected in "+Z.join("."));c.push(G),w.forEach(G,function(u,b){(!(w.isUndefined(u)||u===null)&&C.call(e,u,w.isString(b)?b.trim():b,Z,A))===!0&&p(u,Z?Z.concat(b):[b])}),c.pop()}}if(!w.isObject(g))throw new TypeError("data must be an object");return p(g),e}function mZ(g){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(g).replace(/[!'()~]|%20|%00/g,function(t){return e[t]})}function Hd(g,e){this._pairs=[],g&&ii(g,this,e)}const U0=Hd.prototype;U0.append=function(e,I){this._pairs.push([e,I])};U0.toString=function(e){const I=e?function(t){return e.call(this,t,mZ)}:mZ;return this._pairs.map(function(C){return I(C[0])+"="+I(C[1])},"").join("&")};function Af(g){return encodeURIComponent(g).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function L0(g,e,I){if(!e)return g;const t=I&&I.encode||Af,C=I&&I.serialize;let l;if(C?l=C(e,I):l=w.isURLSearchParams(e)?e.toString():new Hd(e,I).toString(t),l){const n=g.indexOf("#");n!==-1&&(g=g.slice(0,n)),g+=(g.indexOf("?")===-1?"?":"&")+l}return g}class ZZ{constructor(){this.handlers=[]}use(e,I,t){return this.handlers.push({fulfilled:e,rejected:I,synchronous:t?t.synchronous:!1,runWhen:t?t.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){w.forEach(this.handlers,function(t){t!==null&&e(t)})}}const Q0={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},df=typeof URLSearchParams<"u"?URLSearchParams:Hd,uf=typeof FormData<"u"?FormData:null,mf=typeof Blob<"u"?Blob:null,Zf={isBrowser:!0,classes:{URLSearchParams:df,FormData:uf,Blob:mf},protocols:["http","https","file","blob","url","data"]},wd=typeof window<"u"&&typeof document<"u",oA=typeof navigator=="object"&&navigator||void 0,bf=wd&&(!oA||["ReactNative","NativeScript","NS"].indexOf(oA.product)<0),Gf=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",pf=wd&&window.location.href||"http://localhost",hf=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wd,hasStandardBrowserEnv:bf,hasStandardBrowserWebWorkerEnv:Gf,navigator:oA,origin:pf},Symbol.toStringTag,{value:"Module"})),cI={...hf,...Zf};function yf(g,e){return ii(g,new cI.classes.URLSearchParams,Object.assign({visitor:function(I,t,C,l){return cI.isNode&&w.isBuffer(I)?(this.append(t,I.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},e))}function Bf(g){return w.matchAll(/\w+|\[(\w*)]/g,g).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Sf(g){const e={},I=Object.keys(g);let t;const C=I.length;let l;for(t=0;t<C;t++)l=I[t],e[l]=g[l];return e}function T0(g){function e(I,t,C,l){let n=I[l++];if(n==="__proto__")return!0;const o=Number.isFinite(+n),r=l>=I.length;return n=!n&&w.isArray(C)?C.length:n,r?(w.hasOwnProp(C,n)?C[n]=[C[n],t]:C[n]=t,!o):((!C[n]||!w.isObject(C[n]))&&(C[n]=[]),e(I,t,C[n],l)&&w.isArray(C[n])&&(C[n]=Sf(C[n])),!o)}if(w.isFormData(g)&&w.isFunction(g.entries)){const I={};return w.forEachEntry(g,(t,C)=>{e(Bf(t),C,I,0)}),I}return null}function Wf(g,e,I){if(w.isString(g))try{return(e||JSON.parse)(g),w.trim(g)}catch(t){if(t.name!=="SyntaxError")throw t}return(I||JSON.stringify)(g)}const Yo={transitional:Q0,adapter:["xhr","http","fetch"],transformRequest:[function(e,I){const t=I.getContentType()||"",C=t.indexOf("application/json")>-1,l=w.isObject(e);if(l&&w.isHTMLForm(e)&&(e=new FormData(e)),w.isFormData(e))return C?JSON.stringify(T0(e)):e;if(w.isArrayBuffer(e)||w.isBuffer(e)||w.isStream(e)||w.isFile(e)||w.isBlob(e)||w.isReadableStream(e))return e;if(w.isArrayBufferView(e))return e.buffer;if(w.isURLSearchParams(e))return I.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(l){if(t.indexOf("application/x-www-form-urlencoded")>-1)return yf(e,this.formSerializer).toString();if((o=w.isFileList(e))||t.indexOf("multipart/form-data")>-1){const r=this.env&&this.env.FormData;return ii(o?{"files[]":e}:e,r&&new r,this.formSerializer)}}return l||C?(I.setContentType("application/json",!1),Wf(e)):e}],transformResponse:[function(e){const I=this.transitional||Yo.transitional,t=I&&I.forcedJSONParsing,C=this.responseType==="json";if(w.isResponse(e)||w.isReadableStream(e))return e;if(e&&w.isString(e)&&(t&&!this.responseType||C)){const n=!(I&&I.silentJSONParsing)&&C;try{return JSON.parse(e)}catch(o){if(n)throw o.name==="SyntaxError"?Bg.from(o,Bg.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:cI.classes.FormData,Blob:cI.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};w.forEach(["delete","get","head","post","put","patch"],g=>{Yo.headers[g]={}});const Vf=w.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Rf=g=>{const e={};let I,t,C;return g&&g.split(`
`).forEach(function(n){C=n.indexOf(":"),I=n.substring(0,C).trim().toLowerCase(),t=n.substring(C+1).trim(),!(!I||e[I]&&Vf[I])&&(I==="set-cookie"?e[I]?e[I].push(t):e[I]=[t]:e[I]=e[I]?e[I]+", "+t:t)}),e},bZ=Symbol("internals");function Zn(g){return g&&String(g).trim().toLowerCase()}function Mr(g){return g===!1||g==null?g:w.isArray(g)?g.map(Mr):String(g)}function ff(g){const e=Object.create(null),I=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let t;for(;t=I.exec(g);)e[t[1]]=t[2];return e}const Xf=g=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(g.trim());function js(g,e,I,t,C){if(w.isFunction(t))return t.call(this,e,I);if(C&&(e=I),!!w.isString(e)){if(w.isString(t))return e.indexOf(t)!==-1;if(w.isRegExp(t))return t.test(e)}}function Jf(g){return g.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,I,t)=>I.toUpperCase()+t)}function kf(g,e){const I=w.toCamelCase(" "+e);["get","set","has"].forEach(t=>{Object.defineProperty(g,t+I,{value:function(C,l,n){return this[t].call(this,e,C,l,n)},configurable:!0})})}class AI{constructor(e){e&&this.set(e)}set(e,I,t){const C=this;function l(o,r,a){const i=Zn(r);if(!i)throw new Error("header name must be a non-empty string");const c=w.findKey(C,i);(!c||C[c]===void 0||a===!0||a===void 0&&C[c]!==!1)&&(C[c||r]=Mr(o))}const n=(o,r)=>w.forEach(o,(a,i)=>l(a,i,r));if(w.isPlainObject(e)||e instanceof this.constructor)n(e,I);else if(w.isString(e)&&(e=e.trim())&&!Xf(e))n(Rf(e),I);else if(w.isHeaders(e))for(const[o,r]of e.entries())l(r,o,t);else e!=null&&l(I,e,t);return this}get(e,I){if(e=Zn(e),e){const t=w.findKey(this,e);if(t){const C=this[t];if(!I)return C;if(I===!0)return ff(C);if(w.isFunction(I))return I.call(this,C,t);if(w.isRegExp(I))return I.exec(C);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,I){if(e=Zn(e),e){const t=w.findKey(this,e);return!!(t&&this[t]!==void 0&&(!I||js(this,this[t],t,I)))}return!1}delete(e,I){const t=this;let C=!1;function l(n){if(n=Zn(n),n){const o=w.findKey(t,n);o&&(!I||js(t,t[o],o,I))&&(delete t[o],C=!0)}}return w.isArray(e)?e.forEach(l):l(e),C}clear(e){const I=Object.keys(this);let t=I.length,C=!1;for(;t--;){const l=I[t];(!e||js(this,this[l],l,e,!0))&&(delete this[l],C=!0)}return C}normalize(e){const I=this,t={};return w.forEach(this,(C,l)=>{const n=w.findKey(t,l);if(n){I[n]=Mr(C),delete I[l];return}const o=e?Jf(l):String(l).trim();o!==l&&delete I[l],I[o]=Mr(C),t[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const I=Object.create(null);return w.forEach(this,(t,C)=>{t!=null&&t!==!1&&(I[C]=e&&w.isArray(t)?t.join(", "):t)}),I}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,I])=>e+": "+I).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...I){const t=new this(e);return I.forEach(C=>t.set(C)),t}static accessor(e){const t=(this[bZ]=this[bZ]={accessors:{}}).accessors,C=this.prototype;function l(n){const o=Zn(n);t[o]||(kf(C,n),t[o]=!0)}return w.isArray(e)?e.forEach(l):l(e),this}}AI.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);w.reduceDescriptors(AI.prototype,({value:g},e)=>{let I=e[0].toUpperCase()+e.slice(1);return{get:()=>g,set(t){this[I]=t}}});w.freezeMethods(AI);function Ps(g,e){const I=this||Yo,t=e||I,C=AI.from(t.headers);let l=t.data;return w.forEach(g,function(o){l=o.call(I,l,C.normalize(),e?e.status:void 0)}),C.normalize(),l}function D0(g){return!!(g&&g.__CANCEL__)}function _l(g,e,I){Bg.call(this,g??"canceled",Bg.ERR_CANCELED,e,I),this.name="CanceledError"}w.inherits(_l,Bg,{__CANCEL__:!0});function j0(g,e,I){const t=I.config.validateStatus;!I.status||!t||t(I.status)?g(I):e(new Bg("Request failed with status code "+I.status,[Bg.ERR_BAD_REQUEST,Bg.ERR_BAD_RESPONSE][Math.floor(I.status/100)-4],I.config,I.request,I))}function vf(g){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(g);return e&&e[1]||""}function Yf(g,e){g=g||10;const I=new Array(g),t=new Array(g);let C=0,l=0,n;return e=e!==void 0?e:1e3,function(r){const a=Date.now(),i=t[l];n||(n=a),I[C]=r,t[C]=a;let c=l,A=0;for(;c!==C;)A+=I[c++],c=c%g;if(C=(C+1)%g,C===l&&(l=(l+1)%g),a-n<e)return;const p=i&&a-i;return p?Math.round(A*1e3/p):void 0}}function Hf(g,e){let I=0,t=1e3/e,C,l;const n=(a,i=Date.now())=>{I=i,C=null,l&&(clearTimeout(l),l=null),g.apply(null,a)};return[(...a)=>{const i=Date.now(),c=i-I;c>=t?n(a,i):(C=a,l||(l=setTimeout(()=>{l=null,n(C)},t-c)))},()=>C&&n(C)]}const ya=(g,e,I=3)=>{let t=0;const C=Yf(50,250);return Hf(l=>{const n=l.loaded,o=l.lengthComputable?l.total:void 0,r=n-t,a=C(r),i=n<=o;t=n;const c={loaded:n,total:o,progress:o?n/o:void 0,bytes:r,rate:a||void 0,estimated:a&&o&&i?(o-n)/a:void 0,event:l,lengthComputable:o!=null,[e?"download":"upload"]:!0};g(c)},I)},GZ=(g,e)=>{const I=g!=null;return[t=>e[0]({lengthComputable:I,total:g,loaded:t}),e[1]]},pZ=g=>(...e)=>w.asap(()=>g(...e)),wf=cI.hasStandardBrowserEnv?function(){const e=cI.navigator&&/(msie|trident)/i.test(cI.navigator.userAgent),I=document.createElement("a");let t;function C(l){let n=l;return e&&(I.setAttribute("href",n),n=I.href),I.setAttribute("href",n),{href:I.href,protocol:I.protocol?I.protocol.replace(/:$/,""):"",host:I.host,search:I.search?I.search.replace(/^\?/,""):"",hash:I.hash?I.hash.replace(/^#/,""):"",hostname:I.hostname,port:I.port,pathname:I.pathname.charAt(0)==="/"?I.pathname:"/"+I.pathname}}return t=C(window.location.href),function(n){const o=w.isString(n)?C(n):n;return o.protocol===t.protocol&&o.host===t.host}}():function(){return function(){return!0}}(),Nf=cI.hasStandardBrowserEnv?{write(g,e,I,t,C,l){const n=[g+"="+encodeURIComponent(e)];w.isNumber(I)&&n.push("expires="+new Date(I).toGMTString()),w.isString(t)&&n.push("path="+t),w.isString(C)&&n.push("domain="+C),l===!0&&n.push("secure"),document.cookie=n.join("; ")},read(g){const e=document.cookie.match(new RegExp("(^|;\\s*)("+g+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(g){this.write(g,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Ff(g){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(g)}function Kf(g,e){return e?g.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):g}function P0(g,e){return g&&!Ff(e)?Kf(g,e):e}const hZ=g=>g instanceof AI?{...g}:g;function TC(g,e){e=e||{};const I={};function t(a,i,c){return w.isPlainObject(a)&&w.isPlainObject(i)?w.merge.call({caseless:c},a,i):w.isPlainObject(i)?w.merge({},i):w.isArray(i)?i.slice():i}function C(a,i,c){if(w.isUndefined(i)){if(!w.isUndefined(a))return t(void 0,a,c)}else return t(a,i,c)}function l(a,i){if(!w.isUndefined(i))return t(void 0,i)}function n(a,i){if(w.isUndefined(i)){if(!w.isUndefined(a))return t(void 0,a)}else return t(void 0,i)}function o(a,i,c){if(c in e)return t(a,i);if(c in g)return t(void 0,a)}const r={url:l,method:l,data:l,baseURL:n,transformRequest:n,transformResponse:n,paramsSerializer:n,timeout:n,timeoutMessage:n,withCredentials:n,withXSRFToken:n,adapter:n,responseType:n,xsrfCookieName:n,xsrfHeaderName:n,onUploadProgress:n,onDownloadProgress:n,decompress:n,maxContentLength:n,maxBodyLength:n,beforeRedirect:n,transport:n,httpAgent:n,httpsAgent:n,cancelToken:n,socketPath:n,responseEncoding:n,validateStatus:o,headers:(a,i)=>C(hZ(a),hZ(i),!0)};return w.forEach(Object.keys(Object.assign({},g,e)),function(i){const c=r[i]||C,A=c(g[i],e[i],i);w.isUndefined(A)&&c!==o||(I[i]=A)}),I}const O0=g=>{const e=TC({},g);let{data:I,withXSRFToken:t,xsrfHeaderName:C,xsrfCookieName:l,headers:n,auth:o}=e;e.headers=n=AI.from(n),e.url=L0(P0(e.baseURL,e.url),g.params,g.paramsSerializer),o&&n.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let r;if(w.isFormData(I)){if(cI.hasStandardBrowserEnv||cI.hasStandardBrowserWebWorkerEnv)n.setContentType(void 0);else if((r=n.getContentType())!==!1){const[a,...i]=r?r.split(";").map(c=>c.trim()).filter(Boolean):[];n.setContentType([a||"multipart/form-data",...i].join("; "))}}if(cI.hasStandardBrowserEnv&&(t&&w.isFunction(t)&&(t=t(e)),t||t!==!1&&wf(e.url))){const a=C&&l&&Nf.read(l);a&&n.set(C,a)}return e},xf=typeof XMLHttpRequest<"u",Ef=xf&&function(g){return new Promise(function(I,t){const C=O0(g);let l=C.data;const n=AI.from(C.headers).normalize();let{responseType:o,onUploadProgress:r,onDownloadProgress:a}=C,i,c,A,p,G;function Z(){p&&p(),G&&G(),C.cancelToken&&C.cancelToken.unsubscribe(i),C.signal&&C.signal.removeEventListener("abort",i)}let h=new XMLHttpRequest;h.open(C.method.toUpperCase(),C.url,!0),h.timeout=C.timeout;function u(){if(!h)return;const m=AI.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),W={data:!o||o==="text"||o==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:m,config:g,request:h};j0(function(V){I(V),Z()},function(V){t(V),Z()},W),h=null}"onloadend"in h?h.onloadend=u:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(u)},h.onabort=function(){h&&(t(new Bg("Request aborted",Bg.ECONNABORTED,g,h)),h=null)},h.onerror=function(){t(new Bg("Network Error",Bg.ERR_NETWORK,g,h)),h=null},h.ontimeout=function(){let B=C.timeout?"timeout of "+C.timeout+"ms exceeded":"timeout exceeded";const W=C.transitional||Q0;C.timeoutErrorMessage&&(B=C.timeoutErrorMessage),t(new Bg(B,W.clarifyTimeoutError?Bg.ETIMEDOUT:Bg.ECONNABORTED,g,h)),h=null},l===void 0&&n.setContentType(null),"setRequestHeader"in h&&w.forEach(n.toJSON(),function(B,W){h.setRequestHeader(W,B)}),w.isUndefined(C.withCredentials)||(h.withCredentials=!!C.withCredentials),o&&o!=="json"&&(h.responseType=C.responseType),a&&([A,G]=ya(a,!0),h.addEventListener("progress",A)),r&&h.upload&&([c,p]=ya(r),h.upload.addEventListener("progress",c),h.upload.addEventListener("loadend",p)),(C.cancelToken||C.signal)&&(i=m=>{h&&(t(!m||m.type?new _l(null,g,h):m),h.abort(),h=null)},C.cancelToken&&C.cancelToken.subscribe(i),C.signal&&(C.signal.aborted?i():C.signal.addEventListener("abort",i)));const b=vf(C.url);if(b&&cI.protocols.indexOf(b)===-1){t(new Bg("Unsupported protocol "+b+":",Bg.ERR_BAD_REQUEST,g));return}h.send(l||null)})},zf=(g,e)=>{const{length:I}=g=g?g.filter(Boolean):[];if(e||I){let t=new AbortController,C;const l=function(a){if(!C){C=!0,o();const i=a instanceof Error?a:this.reason;t.abort(i instanceof Bg?i:new _l(i instanceof Error?i.message:i))}};let n=e&&setTimeout(()=>{n=null,l(new Bg(`timeout ${e} of ms exceeded`,Bg.ETIMEDOUT))},e);const o=()=>{g&&(n&&clearTimeout(n),n=null,g.forEach(a=>{a.unsubscribe?a.unsubscribe(l):a.removeEventListener("abort",l)}),g=null)};g.forEach(a=>a.addEventListener("abort",l));const{signal:r}=t;return r.unsubscribe=()=>w.asap(o),r}},Mf=function*(g,e){let I=g.byteLength;if(!e||I<e){yield g;return}let t=0,C;for(;t<I;)C=t+e,yield g.slice(t,C),t=C},Uf=async function*(g,e){for await(const I of Lf(g))yield*Mf(I,e)},Lf=async function*(g){if(g[Symbol.asyncIterator]){yield*g;return}const e=g.getReader();try{for(;;){const{done:I,value:t}=await e.read();if(I)break;yield t}}finally{await e.cancel()}},yZ=(g,e,I,t)=>{const C=Uf(g,e);let l=0,n,o=r=>{n||(n=!0,t&&t(r))};return new ReadableStream({async pull(r){try{const{done:a,value:i}=await C.next();if(a){o(),r.close();return}let c=i.byteLength;if(I){let A=l+=c;I(A)}r.enqueue(new Uint8Array(i))}catch(a){throw o(a),a}},cancel(r){return o(r),C.return()}},{highWaterMark:2})},si=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",q0=si&&typeof ReadableStream=="function",Qf=si&&(typeof TextEncoder=="function"?(g=>e=>g.encode(e))(new TextEncoder):async g=>new Uint8Array(await new Response(g).arrayBuffer())),$0=(g,...e)=>{try{return!!g(...e)}catch{return!1}},Tf=q0&&$0(()=>{let g=!1;const e=new Request(cI.origin,{body:new ReadableStream,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!e}),BZ=64*1024,rA=q0&&$0(()=>w.isReadableStream(new Response("").body)),Ba={stream:rA&&(g=>g.body)};si&&(g=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Ba[e]&&(Ba[e]=w.isFunction(g[e])?I=>I[e]():(I,t)=>{throw new Bg(`Response type '${e}' is not supported`,Bg.ERR_NOT_SUPPORT,t)})})})(new Response);const Df=async g=>{if(g==null)return 0;if(w.isBlob(g))return g.size;if(w.isSpecCompliantForm(g))return(await new Request(cI.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(w.isArrayBufferView(g)||w.isArrayBuffer(g))return g.byteLength;if(w.isURLSearchParams(g)&&(g=g+""),w.isString(g))return(await Qf(g)).byteLength},jf=async(g,e)=>{const I=w.toFiniteNumber(g.getContentLength());return I??Df(e)},Pf=si&&(async g=>{let{url:e,method:I,data:t,signal:C,cancelToken:l,timeout:n,onDownloadProgress:o,onUploadProgress:r,responseType:a,headers:i,withCredentials:c="same-origin",fetchOptions:A}=O0(g);a=a?(a+"").toLowerCase():"text";let p=zf([C,l&&l.toAbortSignal()],n),G;const Z=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let h;try{if(r&&Tf&&I!=="get"&&I!=="head"&&(h=await jf(i,t))!==0){let W=new Request(e,{method:"POST",body:t,duplex:"half"}),R;if(w.isFormData(t)&&(R=W.headers.get("content-type"))&&i.setContentType(R),W.body){const[V,S]=GZ(h,ya(pZ(r)));t=yZ(W.body,BZ,V,S)}}w.isString(c)||(c=c?"include":"omit");const u="credentials"in Request.prototype;G=new Request(e,{...A,signal:p,method:I.toUpperCase(),headers:i.normalize().toJSON(),body:t,duplex:"half",credentials:u?c:void 0});let b=await fetch(G);const m=rA&&(a==="stream"||a==="response");if(rA&&(o||m&&Z)){const W={};["status","statusText","headers"].forEach(y=>{W[y]=b[y]});const R=w.toFiniteNumber(b.headers.get("content-length")),[V,S]=o&&GZ(R,ya(pZ(o),!0))||[];b=new Response(yZ(b.body,BZ,V,()=>{S&&S(),Z&&Z()}),W)}a=a||"text";let B=await Ba[w.findKey(Ba,a)||"text"](b,g);return!m&&Z&&Z(),await new Promise((W,R)=>{j0(W,R,{data:B,headers:AI.from(b.headers),status:b.status,statusText:b.statusText,config:g,request:G})})}catch(u){throw Z&&Z(),u&&u.name==="TypeError"&&/fetch/i.test(u.message)?Object.assign(new Bg("Network Error",Bg.ERR_NETWORK,g,G),{cause:u.cause||u}):Bg.from(u,u&&u.code,g,G)}}),aA={http:af,xhr:Ef,fetch:Pf};w.forEach(aA,(g,e)=>{if(g){try{Object.defineProperty(g,"name",{value:e})}catch{}Object.defineProperty(g,"adapterName",{value:e})}});const SZ=g=>`- ${g}`,Of=g=>w.isFunction(g)||g===null||g===!1,_0={getAdapter:g=>{g=w.isArray(g)?g:[g];const{length:e}=g;let I,t;const C={};for(let l=0;l<e;l++){I=g[l];let n;if(t=I,!Of(I)&&(t=aA[(n=String(I)).toLowerCase()],t===void 0))throw new Bg(`Unknown adapter '${n}'`);if(t)break;C[n||"#"+l]=t}if(!t){const l=Object.entries(C).map(([o,r])=>`adapter ${o} `+(r===!1?"is not supported by the environment":"is not available in the build"));let n=e?l.length>1?`since :
`+l.map(SZ).join(`
`):" "+SZ(l[0]):"as no adapter specified";throw new Bg("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return t},adapters:aA};function Os(g){if(g.cancelToken&&g.cancelToken.throwIfRequested(),g.signal&&g.signal.aborted)throw new _l(null,g)}function WZ(g){return Os(g),g.headers=AI.from(g.headers),g.data=Ps.call(g,g.transformRequest),["post","put","patch"].indexOf(g.method)!==-1&&g.headers.setContentType("application/x-www-form-urlencoded",!1),_0.getAdapter(g.adapter||Yo.adapter)(g).then(function(t){return Os(g),t.data=Ps.call(g,g.transformResponse,t),t.headers=AI.from(t.headers),t},function(t){return D0(t)||(Os(g),t&&t.response&&(t.response.data=Ps.call(g,g.transformResponse,t.response),t.response.headers=AI.from(t.response.headers))),Promise.reject(t)})}const gh="1.7.7",Nd={};["object","boolean","number","function","string","symbol"].forEach((g,e)=>{Nd[g]=function(t){return typeof t===g||"a"+(e<1?"n ":" ")+g}});const VZ={};Nd.transitional=function(e,I,t){function C(l,n){return"[Axios v"+gh+"] Transitional option '"+l+"'"+n+(t?". "+t:"")}return(l,n,o)=>{if(e===!1)throw new Bg(C(n," has been removed"+(I?" in "+I:"")),Bg.ERR_DEPRECATED);return I&&!VZ[n]&&(VZ[n]=!0,console.warn(C(n," has been deprecated since v"+I+" and will be removed in the near future"))),e?e(l,n,o):!0}};function qf(g,e,I){if(typeof g!="object")throw new Bg("options must be an object",Bg.ERR_BAD_OPTION_VALUE);const t=Object.keys(g);let C=t.length;for(;C-- >0;){const l=t[C],n=e[l];if(n){const o=g[l],r=o===void 0||n(o,l,g);if(r!==!0)throw new Bg("option "+l+" must be "+r,Bg.ERR_BAD_OPTION_VALUE);continue}if(I!==!0)throw new Bg("Unknown option "+l,Bg.ERR_BAD_OPTION)}}const iA={assertOptions:qf,validators:Nd},Dt=iA.validators;class xC{constructor(e){this.defaults=e,this.interceptors={request:new ZZ,response:new ZZ}}async request(e,I){try{return await this._request(e,I)}catch(t){if(t instanceof Error){let C;Error.captureStackTrace?Error.captureStackTrace(C={}):C=new Error;const l=C.stack?C.stack.replace(/^.+\n/,""):"";try{t.stack?l&&!String(t.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(t.stack+=`
`+l):t.stack=l}catch{}}throw t}}_request(e,I){typeof e=="string"?(I=I||{},I.url=e):I=e||{},I=TC(this.defaults,I);const{transitional:t,paramsSerializer:C,headers:l}=I;t!==void 0&&iA.assertOptions(t,{silentJSONParsing:Dt.transitional(Dt.boolean),forcedJSONParsing:Dt.transitional(Dt.boolean),clarifyTimeoutError:Dt.transitional(Dt.boolean)},!1),C!=null&&(w.isFunction(C)?I.paramsSerializer={serialize:C}:iA.assertOptions(C,{encode:Dt.function,serialize:Dt.function},!0)),I.method=(I.method||this.defaults.method||"get").toLowerCase();let n=l&&w.merge(l.common,l[I.method]);l&&w.forEach(["delete","get","head","post","put","patch","common"],G=>{delete l[G]}),I.headers=AI.concat(n,l);const o=[];let r=!0;this.interceptors.request.forEach(function(Z){typeof Z.runWhen=="function"&&Z.runWhen(I)===!1||(r=r&&Z.synchronous,o.unshift(Z.fulfilled,Z.rejected))});const a=[];this.interceptors.response.forEach(function(Z){a.push(Z.fulfilled,Z.rejected)});let i,c=0,A;if(!r){const G=[WZ.bind(this),void 0];for(G.unshift.apply(G,o),G.push.apply(G,a),A=G.length,i=Promise.resolve(I);c<A;)i=i.then(G[c++],G[c++]);return i}A=o.length;let p=I;for(c=0;c<A;){const G=o[c++],Z=o[c++];try{p=G(p)}catch(h){Z.call(this,h);break}}try{i=WZ.call(this,p)}catch(G){return Promise.reject(G)}for(c=0,A=a.length;c<A;)i=i.then(a[c++],a[c++]);return i}getUri(e){e=TC(this.defaults,e);const I=P0(e.baseURL,e.url);return L0(I,e.params,e.paramsSerializer)}}w.forEach(["delete","get","head","options"],function(e){xC.prototype[e]=function(I,t){return this.request(TC(t||{},{method:e,url:I,data:(t||{}).data}))}});w.forEach(["post","put","patch"],function(e){function I(t){return function(l,n,o){return this.request(TC(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:l,data:n}))}}xC.prototype[e]=I(),xC.prototype[e+"Form"]=I(!0)});class Fd{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let I;this.promise=new Promise(function(l){I=l});const t=this;this.promise.then(C=>{if(!t._listeners)return;let l=t._listeners.length;for(;l-- >0;)t._listeners[l](C);t._listeners=null}),this.promise.then=C=>{let l;const n=new Promise(o=>{t.subscribe(o),l=o}).then(C);return n.cancel=function(){t.unsubscribe(l)},n},e(function(l,n,o){t.reason||(t.reason=new _l(l,n,o),I(t.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const I=this._listeners.indexOf(e);I!==-1&&this._listeners.splice(I,1)}toAbortSignal(){const e=new AbortController,I=t=>{e.abort(t)};return this.subscribe(I),e.signal.unsubscribe=()=>this.unsubscribe(I),e.signal}static source(){let e;return{token:new Fd(function(C){e=C}),cancel:e}}}function $f(g){return function(I){return g.apply(null,I)}}function _f(g){return w.isObject(g)&&g.isAxiosError===!0}const sA={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(sA).forEach(([g,e])=>{sA[e]=g});function eh(g){const e=new xC(g),I=v0(xC.prototype.request,e);return w.extend(I,xC.prototype,e,{allOwnKeys:!0}),w.extend(I,e,null,{allOwnKeys:!0}),I.create=function(C){return eh(TC(g,C))},I}const $g=eh(Yo);$g.Axios=xC;$g.CanceledError=_l;$g.CancelToken=Fd;$g.isCancel=D0;$g.VERSION=gh;$g.toFormData=ii;$g.AxiosError=Bg;$g.Cancel=$g.CanceledError;$g.all=function(e){return Promise.all(e)};$g.spread=$f;$g.isAxiosError=_f;$g.mergeConfig=TC;$g.AxiosHeaders=AI;$g.formToJSON=g=>T0(w.isHTMLForm(g)?new FormData(g):g);$g.getAdapter=_0.getAdapter;$g.HttpStatusCode=sA;$g.default=$g;const ci=$g.create({baseURL:"https://cadi.onrender.com/",headers:{"Content-Type":"application/json"}}),gX=async g=>{try{const e=await ci.post("/pagos/registrar/",g);return console.log("Pago registrado:",e.data),{data:e.data,error:null}}catch(e){return console.error("Error al registrar el pago:",e.message),{data:null,error:e.message}}},eX=async()=>{try{return{data:(await ci.get("/pagos/pendientes/")).data,error:null}}catch(g){return console.error("Error al listar los pagos:",g.message),{data:[],error:g.message}}},IX=async g=>{try{console.log("entra");const e=await ci.get("/pagos/curp/",{params:{curp:g}}),{alumno:I,pagos:t}=e.data;return console.log(I),{alumno:I,pagos:t||[]}}catch(e){return console.error("Error al listar los pagos por CURP:",e.message),{alumno:null,pagos:[],error:e.message}}},tX=async(g,e)=>{try{const{data:I,error:t}=await ci.patch(`/pagos/editar/${g}/`,e);if(t)throw new Error(t.message);return{data:I,error:null}}catch(I){return console.error("Error al editar el pago:",I.message),{data:null,error:I.message}}},Ho=()=>{const[g,e]=d.useState(!1),[I,t]=d.useState(null),[C,l]=d.useState([]),[n,o]=d.useState(null);return{loading:g,error:I,pagos:C,alumno:n,registroPago:async A=>{e(!0),t(null);try{await gX(A)}catch(p){t(p.message)}finally{e(!1)}},listaPagos:async()=>{try{const A=await eX();l(A.data||[])}catch(A){t(A.message)}finally{e(!1)}},listaPagosPorCurp:async A=>{e(!0),t(null);try{const{alumno:p,pagos:G}=await IX(A);o(p),l(G)}catch(p){t(p.message)}finally{e(!1)}},actualizarPago:async(A,p)=>{e(!0),t(null);try{await tX(A,p)}catch(G){t(G.message)}finally{e(!1)}}}},Kd=$g.create({baseURL:"https://cadi.onrender.com/",headers:{"Content-Type":"application/json"}}),CX=async(g,e,I)=>{try{return console.log(e),(await Kd.post("alumno/registrar/",{alumno:g,pago:e,inscripciones:I})).data}catch(t){throw console.error("Error:",t.response?t.response.data:t.message),t}},lX=async()=>{try{return(await Kd.get("/alumno/alumnos/")).data}catch(g){throw console.error("Error al listar alumnos:",g.message),new Error(g.message)}},nX=async g=>{try{const I=(await Kd.get("/alumno/buscarCurp/",{params:{curp:g}})).data;return console.log(I),I}catch(e){throw console.error("Error al buscar alumno por CURP:",e.message),new Error(e.message)}},xd=()=>{const[g,e]=d.useState([]),[I,t]=d.useState(!1),[C,l]=d.useState(null),n=async(a,i,c)=>{t(!0);try{await CX(a,i,c)}catch(A){console.log("Error:",A.response.data),l(A.message)}finally{t(!1)}},o=async()=>{try{const a=await lX();e(a)}catch(a){l(a.message)}finally{t(!1)}},r=async a=>{t(!0);try{return await nX(a)}catch(i){return l(i.message),null}finally{t(!1)}};return d.useEffect(()=>{o()},[]),{alumnos:g,listaAlumnos:o,registro:n,buscarAlumno:r,loading:I,error:C}},gn=$g.create({baseURL:"https://cadi.onrender.com/",headers:{"Content-Type":"application/json"}}),oX=async g=>{try{console.log("Datos enviados:",g);const e=await gn.post("/alumno/inscripcion/",g);return console.log("Datos recibidos:",e.data),{data:e.data,error:null}}catch(e){return console.error("Error:",e.message),{data:null,error:e.message}}},RZ=async()=>{try{return{data:(await gn.get("/alumno/listarInscripciones/")).data,error:null}}catch(g){return console.error("Error:",g.message),{data:[],error:g.message}}},rX=async g=>{try{return{data:(await gn.get("/alumno/inscripcionID/",{params:{id:g}})).data,error:null}}catch(e){return console.error("Error:",e.message),{data:null,error:e.message}}},aX=async g=>{try{if(!g)throw new Error("CURP no proporcionado");return{data:(await gn.get("/alumno/inscripcionCurp/",{params:{curp:g}})).data,error:null}}catch(e){return console.error("Error:",e.message),{data:null,error:e.message}}},iX=async(g,e,I)=>{try{const t=await gn.patch("/alumno/actualizarAcceso/",{curp:g,idClase:e,nuevoAcceso:I});return console.log("Datos actualizados:",t.data),{data:t.data,error:null}}catch(t){return console.error("Error:",t.message),{data:null,error:t.message}}},sX=async(g,e)=>{try{const I=await gn.delete("/alumno/eliminarInscripcion/",{data:{curp:g,idClase:e}});return console.log("Datos eliminados:",I.data),{data:I.data,error:null}}catch(I){return console.error("Error:",I.message),{data:null,error:I.message}}},wo=()=>{const[g,e]=d.useState(!1),[I,t]=d.useState(null),[C,l]=d.useState([]),[n,o]=d.useState(null),r=async Z=>{e(!0),t(null);try{const u=(await Promise.all(Z.map(async m=>await a(m.curp,m.idClase,m.horario)?null:m))).filter(m=>m!==null);if(u.length===0)throw new Error("El alumno ya está inscrito en todas las clases seleccionadas con los mismos horarios.");const b=await oX(u);if(b.error)throw new Error(b.error)}catch(h){t(h.message||"Error al registrar la inscripción"),console.log(h)}finally{e(!1)}},a=async(Z,h,u)=>{try{const{data:b,error:m}=await RZ();if(m)throw new Error(m.message);return b.find(W=>W.curp===Z&&W.idClase===h&&W.horario===u)||null}catch(b){return console.error("Error al verificar la inscripción:",b),null}},i=async()=>{e(!0),t(null);try{const Z=await RZ();if(Z.error)throw new Error(Z.error);l(Z.data||[])}catch(Z){t("Error al obtener las inscripciones"),console.log(Z)}finally{e(!1)}},c=async Z=>{e(!0),t(null);try{const h=await rX(Z);if(h.error)throw new Error(h.error);o(h.data||null)}catch(h){t("Error al obtener la inscripción"),console.log(h)}finally{e(!1)}},A=async Z=>{e(!0),t(null);try{const h=await aX(Z);if(h.error)throw new Error(h.error);o(h.data||null)}catch(h){t("Error al obtener la inscripción"),console.log(h)}finally{e(!1)}},p=async(Z,h,u)=>{e(!0),t(null);try{const b=await iX(Z,h,u);if(b.error)throw new Error(b.error);return await i(),b.data}catch(b){t("Error al actualizar la inscripción"),console.log(b)}finally{e(!1)}},G=async(Z,h)=>{e(!0),t(null);try{const u=await sX(Z,h);if(u.error)throw new Error(u.error);return await i(),u.data}catch(u){t("Error al eliminar la inscripción"),console.log(u)}finally{e(!1)}};return d.useEffect(()=>{i()},[]),{registroInscripcion:r,eliminarInscripcionPorCurp:G,listaInscripciones:i,listarInscripcionPorId:c,listarInscripcionPorCurp:A,actualizarAcceso:p,inscripciones:C,inscripcion:n,loading:g,error:I}},Ih=$g.create({baseURL:"https://cadi.onrender.com/",headers:{"Content-Type":"application/json"}}),cX=async g=>{try{return(await Ih.post("/clase/registrar/",{paquete:g})).data}catch(e){throw console.error("Error al registrar la clase:",e.message),new Error(e.message)}},AX=async()=>{try{return(await Ih.get("/clase/listarClases/")).data}catch(g){throw console.error("Error al obtener las clases:",g.message),new Error(g.message)}},Ai=()=>{const[g,e]=d.useState([]),[I,t]=d.useState(!1),[C,l]=d.useState(null),n=async r=>{t(!0),l(null);try{console.log(r),await cX(r)}catch(a){l("Error al registrar la clase"),console.log(a)}finally{t(!1)}},o=async()=>{t(!0),l(null);try{const r=await AX();e(r)}catch(r){l("Error al obtener las clases"),console.error(r)}finally{t(!1)}};return d.useEffect(()=>{o()},[]),{clases:g,registroClase:n,fetchClases:o,loading:I,error:C}},Zo={black:"#000",white:"#fff"},el={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Il={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},tl={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Cl={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},ll={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},bn={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},dX={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function Ut(g){let e="https://mui.com/production-error/?code="+g;for(let I=1;I<arguments.length;I+=1)e+="&args[]="+encodeURIComponent(arguments[I]);return"Minified MUI error #"+g+"; visit "+e+" for the full message."}const di="$$material";function bo(){return bo=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)({}).hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},bo.apply(null,arguments)}function th(g){var e=Object.create(null);return function(I){return e[I]===void 0&&(e[I]=g(I)),e[I]}}var uX=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,mX=th(function(g){return uX.test(g)||g.charCodeAt(0)===111&&g.charCodeAt(1)===110&&g.charCodeAt(2)<91}),ZX=!1;function bX(g){if(g.sheet)return g.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===g)return document.styleSheets[e]}function GX(g){var e=document.createElement("style");return e.setAttribute("data-emotion",g.key),g.nonce!==void 0&&e.setAttribute("nonce",g.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var pX=function(){function g(I){var t=this;this._insertTag=function(C){var l;t.tags.length===0?t.insertionPoint?l=t.insertionPoint.nextSibling:t.prepend?l=t.container.firstChild:l=t.before:l=t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(C,l),t.tags.push(C)},this.isSpeedy=I.speedy===void 0?!ZX:I.speedy,this.tags=[],this.ctr=0,this.nonce=I.nonce,this.key=I.key,this.container=I.container,this.prepend=I.prepend,this.insertionPoint=I.insertionPoint,this.before=null}var e=g.prototype;return e.hydrate=function(t){t.forEach(this._insertTag)},e.insert=function(t){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(GX(this));var C=this.tags[this.tags.length-1];if(this.isSpeedy){var l=bX(C);try{l.insertRule(t,l.cssRules.length)}catch{}}else C.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach(function(t){var C;return(C=t.parentNode)==null?void 0:C.removeChild(t)}),this.tags=[],this.ctr=0},g}(),Te="-ms-",Sa="-moz-",Fg="-webkit-",Ch="comm",Ed="rule",zd="decl",hX="@import",lh="@keyframes",yX="@layer",BX=Math.abs,ui=String.fromCharCode,SX=Object.assign;function WX(g,e){return Ke(g,0)^45?(((e<<2^Ke(g,0))<<2^Ke(g,1))<<2^Ke(g,2))<<2^Ke(g,3):0}function nh(g){return g.trim()}function VX(g,e){return(g=e.exec(g))?g[0]:g}function Kg(g,e,I){return g.replace(e,I)}function cA(g,e){return g.indexOf(e)}function Ke(g,e){return g.charCodeAt(e)|0}function Go(g,e,I){return g.slice(e,I)}function ut(g){return g.length}function Md(g){return g.length}function br(g,e){return e.push(g),g}function RX(g,e){return g.map(e).join("")}var mi=1,zl=1,oh=0,mI=0,Se=0,en="";function Zi(g,e,I,t,C,l,n){return{value:g,root:e,parent:I,type:t,props:C,children:l,line:mi,column:zl,length:n,return:""}}function Gn(g,e){return SX(Zi("",null,null,"",null,null,0),g,{length:-g.length},e)}function fX(){return Se}function XX(){return Se=mI>0?Ke(en,--mI):0,zl--,Se===10&&(zl=1,mi--),Se}function RI(){return Se=mI<oh?Ke(en,mI++):0,zl++,Se===10&&(zl=1,mi++),Se}function Bt(){return Ke(en,mI)}function Ur(){return mI}function No(g,e){return Go(en,g,e)}function po(g){switch(g){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function rh(g){return mi=zl=1,oh=ut(en=g),mI=0,[]}function ah(g){return en="",g}function Lr(g){return nh(No(mI-1,AA(g===91?g+2:g===40?g+1:g)))}function JX(g){for(;(Se=Bt())&&Se<33;)RI();return po(g)>2||po(Se)>3?"":" "}function kX(g,e){for(;--e&&RI()&&!(Se<48||Se>102||Se>57&&Se<65||Se>70&&Se<97););return No(g,Ur()+(e<6&&Bt()==32&&RI()==32))}function AA(g){for(;RI();)switch(Se){case g:return mI;case 34:case 39:g!==34&&g!==39&&AA(Se);break;case 40:g===41&&AA(g);break;case 92:RI();break}return mI}function vX(g,e){for(;RI()&&g+Se!==57;)if(g+Se===84&&Bt()===47)break;return"/*"+No(e,mI-1)+"*"+ui(g===47?g:RI())}function YX(g){for(;!po(Bt());)RI();return No(g,mI)}function HX(g){return ah(Qr("",null,null,null,[""],g=rh(g),0,[0],g))}function Qr(g,e,I,t,C,l,n,o,r){for(var a=0,i=0,c=n,A=0,p=0,G=0,Z=1,h=1,u=1,b=0,m="",B=C,W=l,R=t,V=m;h;)switch(G=b,b=RI()){case 40:if(G!=108&&Ke(V,c-1)==58){cA(V+=Kg(Lr(b),"&","&\f"),"&\f")!=-1&&(u=-1);break}case 34:case 39:case 91:V+=Lr(b);break;case 9:case 10:case 13:case 32:V+=JX(G);break;case 92:V+=kX(Ur()-1,7);continue;case 47:switch(Bt()){case 42:case 47:br(wX(vX(RI(),Ur()),e,I),r);break;default:V+="/"}break;case 123*Z:o[a++]=ut(V)*u;case 125*Z:case 59:case 0:switch(b){case 0:case 125:h=0;case 59+i:u==-1&&(V=Kg(V,/\f/g,"")),p>0&&ut(V)-c&&br(p>32?XZ(V+";",t,I,c-1):XZ(Kg(V," ","")+";",t,I,c-2),r);break;case 59:V+=";";default:if(br(R=fZ(V,e,I,a,i,C,o,m,B=[],W=[],c),l),b===123)if(i===0)Qr(V,e,R,R,B,l,c,o,W);else switch(A===99&&Ke(V,3)===110?100:A){case 100:case 108:case 109:case 115:Qr(g,R,R,t&&br(fZ(g,R,R,0,0,C,o,m,C,B=[],c),W),C,W,c,o,t?B:W);break;default:Qr(V,R,R,R,[""],W,0,o,W)}}a=i=p=0,Z=u=1,m=V="",c=n;break;case 58:c=1+ut(V),p=G;default:if(Z<1){if(b==123)--Z;else if(b==125&&Z++==0&&XX()==125)continue}switch(V+=ui(b),b*Z){case 38:u=i>0?1:(V+="\f",-1);break;case 44:o[a++]=(ut(V)-1)*u,u=1;break;case 64:Bt()===45&&(V+=Lr(RI())),A=Bt(),i=c=ut(m=V+=YX(Ur())),b++;break;case 45:G===45&&ut(V)==2&&(Z=0)}}return l}function fZ(g,e,I,t,C,l,n,o,r,a,i){for(var c=C-1,A=C===0?l:[""],p=Md(A),G=0,Z=0,h=0;G<t;++G)for(var u=0,b=Go(g,c+1,c=BX(Z=n[G])),m=g;u<p;++u)(m=nh(Z>0?A[u]+" "+b:Kg(b,/&\f/g,A[u])))&&(r[h++]=m);return Zi(g,e,I,C===0?Ed:o,r,a,i)}function wX(g,e,I){return Zi(g,e,I,Ch,ui(fX()),Go(g,2,-2),0)}function XZ(g,e,I,t){return Zi(g,e,I,zd,Go(g,0,t),Go(g,t+1,-1),t)}function Jl(g,e){for(var I="",t=Md(g),C=0;C<t;C++)I+=e(g[C],C,g,e)||"";return I}function NX(g,e,I,t){switch(g.type){case yX:if(g.children.length)break;case hX:case zd:return g.return=g.return||g.value;case Ch:return"";case lh:return g.return=g.value+"{"+Jl(g.children,t)+"}";case Ed:g.value=g.props.join(",")}return ut(I=Jl(g.children,t))?g.return=g.value+"{"+I+"}":""}function FX(g){var e=Md(g);return function(I,t,C,l){for(var n="",o=0;o<e;o++)n+=g[o](I,t,C,l)||"";return n}}function KX(g){return function(e){e.root||(e=e.return)&&g(e)}}var xX=function(e,I,t){for(var C=0,l=0;C=l,l=Bt(),C===38&&l===12&&(I[t]=1),!po(l);)RI();return No(e,mI)},EX=function(e,I){var t=-1,C=44;do switch(po(C)){case 0:C===38&&Bt()===12&&(I[t]=1),e[t]+=xX(mI-1,I,t);break;case 2:e[t]+=Lr(C);break;case 4:if(C===44){e[++t]=Bt()===58?"&\f":"",I[t]=e[t].length;break}default:e[t]+=ui(C)}while(C=RI());return e},zX=function(e,I){return ah(EX(rh(e),I))},JZ=new WeakMap,MX=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var I=e.value,t=e.parent,C=e.column===t.column&&e.line===t.line;t.type!=="rule";)if(t=t.parent,!t)return;if(!(e.props.length===1&&I.charCodeAt(0)!==58&&!JZ.get(t))&&!C){JZ.set(e,!0);for(var l=[],n=zX(I,l),o=t.props,r=0,a=0;r<n.length;r++)for(var i=0;i<o.length;i++,a++)e.props[a]=l[r]?n[r].replace(/&\f/g,o[i]):o[i]+" "+n[r]}}},UX=function(e){if(e.type==="decl"){var I=e.value;I.charCodeAt(0)===108&&I.charCodeAt(2)===98&&(e.return="",e.value="")}};function ih(g,e){switch(WX(g,e)){case 5103:return Fg+"print-"+g+g;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Fg+g+g;case 5349:case 4246:case 4810:case 6968:case 2756:return Fg+g+Sa+g+Te+g+g;case 6828:case 4268:return Fg+g+Te+g+g;case 6165:return Fg+g+Te+"flex-"+g+g;case 5187:return Fg+g+Kg(g,/(\w+).+(:[^]+)/,Fg+"box-$1$2"+Te+"flex-$1$2")+g;case 5443:return Fg+g+Te+"flex-item-"+Kg(g,/flex-|-self/,"")+g;case 4675:return Fg+g+Te+"flex-line-pack"+Kg(g,/align-content|flex-|-self/,"")+g;case 5548:return Fg+g+Te+Kg(g,"shrink","negative")+g;case 5292:return Fg+g+Te+Kg(g,"basis","preferred-size")+g;case 6060:return Fg+"box-"+Kg(g,"-grow","")+Fg+g+Te+Kg(g,"grow","positive")+g;case 4554:return Fg+Kg(g,/([^-])(transform)/g,"$1"+Fg+"$2")+g;case 6187:return Kg(Kg(Kg(g,/(zoom-|grab)/,Fg+"$1"),/(image-set)/,Fg+"$1"),g,"")+g;case 5495:case 3959:return Kg(g,/(image-set\([^]*)/,Fg+"$1$`$1");case 4968:return Kg(Kg(g,/(.+:)(flex-)?(.*)/,Fg+"box-pack:$3"+Te+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Fg+g+g;case 4095:case 3583:case 4068:case 2532:return Kg(g,/(.+)-inline(.+)/,Fg+"$1$2")+g;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ut(g)-1-e>6)switch(Ke(g,e+1)){case 109:if(Ke(g,e+4)!==45)break;case 102:return Kg(g,/(.+:)(.+)-([^]+)/,"$1"+Fg+"$2-$3$1"+Sa+(Ke(g,e+3)==108?"$3":"$2-$3"))+g;case 115:return~cA(g,"stretch")?ih(Kg(g,"stretch","fill-available"),e)+g:g}break;case 4949:if(Ke(g,e+1)!==115)break;case 6444:switch(Ke(g,ut(g)-3-(~cA(g,"!important")&&10))){case 107:return Kg(g,":",":"+Fg)+g;case 101:return Kg(g,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Fg+(Ke(g,14)===45?"inline-":"")+"box$3$1"+Fg+"$2$3$1"+Te+"$2box$3")+g}break;case 5936:switch(Ke(g,e+11)){case 114:return Fg+g+Te+Kg(g,/[svh]\w+-[tblr]{2}/,"tb")+g;case 108:return Fg+g+Te+Kg(g,/[svh]\w+-[tblr]{2}/,"tb-rl")+g;case 45:return Fg+g+Te+Kg(g,/[svh]\w+-[tblr]{2}/,"lr")+g}return Fg+g+Te+g+g}return g}var LX=function(e,I,t,C){if(e.length>-1&&!e.return)switch(e.type){case zd:e.return=ih(e.value,e.length);break;case lh:return Jl([Gn(e,{value:Kg(e.value,"@","@"+Fg)})],C);case Ed:if(e.length)return RX(e.props,function(l){switch(VX(l,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Jl([Gn(e,{props:[Kg(l,/:(read-\w+)/,":"+Sa+"$1")]})],C);case"::placeholder":return Jl([Gn(e,{props:[Kg(l,/:(plac\w+)/,":"+Fg+"input-$1")]}),Gn(e,{props:[Kg(l,/:(plac\w+)/,":"+Sa+"$1")]}),Gn(e,{props:[Kg(l,/:(plac\w+)/,Te+"input-$1")]})],C)}return""})}},QX=[LX],TX=function(e){var I=e.key;if(I==="css"){var t=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(t,function(Z){var h=Z.getAttribute("data-emotion");h.indexOf(" ")!==-1&&(document.head.appendChild(Z),Z.setAttribute("data-s",""))})}var C=e.stylisPlugins||QX,l={},n,o=[];n=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+I+' "]'),function(Z){for(var h=Z.getAttribute("data-emotion").split(" "),u=1;u<h.length;u++)l[h[u]]=!0;o.push(Z)});var r,a=[MX,UX];{var i,c=[NX,KX(function(Z){i.insert(Z)})],A=FX(a.concat(C,c)),p=function(h){return Jl(HX(h),A)};r=function(h,u,b,m){i=b,p(h?h+"{"+u.styles+"}":u.styles),m&&(G.inserted[u.name]=!0)}}var G={key:I,sheet:new pX({key:I,container:n,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:l,registered:{},insert:r};return G.sheet.hydrate(o),G},sh={exports:{}},Ug={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ye=typeof Symbol=="function"&&Symbol.for,Ud=Ye?Symbol.for("react.element"):60103,Ld=Ye?Symbol.for("react.portal"):60106,bi=Ye?Symbol.for("react.fragment"):60107,Gi=Ye?Symbol.for("react.strict_mode"):60108,pi=Ye?Symbol.for("react.profiler"):60114,hi=Ye?Symbol.for("react.provider"):60109,yi=Ye?Symbol.for("react.context"):60110,Qd=Ye?Symbol.for("react.async_mode"):60111,Bi=Ye?Symbol.for("react.concurrent_mode"):60111,Si=Ye?Symbol.for("react.forward_ref"):60112,Wi=Ye?Symbol.for("react.suspense"):60113,DX=Ye?Symbol.for("react.suspense_list"):60120,Vi=Ye?Symbol.for("react.memo"):60115,Ri=Ye?Symbol.for("react.lazy"):60116,jX=Ye?Symbol.for("react.block"):60121,PX=Ye?Symbol.for("react.fundamental"):60117,OX=Ye?Symbol.for("react.responder"):60118,qX=Ye?Symbol.for("react.scope"):60119;function YI(g){if(typeof g=="object"&&g!==null){var e=g.$$typeof;switch(e){case Ud:switch(g=g.type,g){case Qd:case Bi:case bi:case pi:case Gi:case Wi:return g;default:switch(g=g&&g.$$typeof,g){case yi:case Si:case Ri:case Vi:case hi:return g;default:return e}}case Ld:return e}}}function ch(g){return YI(g)===Bi}Ug.AsyncMode=Qd;Ug.ConcurrentMode=Bi;Ug.ContextConsumer=yi;Ug.ContextProvider=hi;Ug.Element=Ud;Ug.ForwardRef=Si;Ug.Fragment=bi;Ug.Lazy=Ri;Ug.Memo=Vi;Ug.Portal=Ld;Ug.Profiler=pi;Ug.StrictMode=Gi;Ug.Suspense=Wi;Ug.isAsyncMode=function(g){return ch(g)||YI(g)===Qd};Ug.isConcurrentMode=ch;Ug.isContextConsumer=function(g){return YI(g)===yi};Ug.isContextProvider=function(g){return YI(g)===hi};Ug.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===Ud};Ug.isForwardRef=function(g){return YI(g)===Si};Ug.isFragment=function(g){return YI(g)===bi};Ug.isLazy=function(g){return YI(g)===Ri};Ug.isMemo=function(g){return YI(g)===Vi};Ug.isPortal=function(g){return YI(g)===Ld};Ug.isProfiler=function(g){return YI(g)===pi};Ug.isStrictMode=function(g){return YI(g)===Gi};Ug.isSuspense=function(g){return YI(g)===Wi};Ug.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===bi||g===Bi||g===pi||g===Gi||g===Wi||g===DX||typeof g=="object"&&g!==null&&(g.$$typeof===Ri||g.$$typeof===Vi||g.$$typeof===hi||g.$$typeof===yi||g.$$typeof===Si||g.$$typeof===PX||g.$$typeof===OX||g.$$typeof===qX||g.$$typeof===jX)};Ug.typeOf=YI;sh.exports=Ug;var $X=sh.exports,Ah=$X,_X={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},gJ={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},dh={};dh[Ah.ForwardRef]=_X;dh[Ah.Memo]=gJ;var eJ=!0;function IJ(g,e,I){var t="";return I.split(" ").forEach(function(C){g[C]!==void 0?e.push(g[C]+";"):t+=C+" "}),t}var uh=function(e,I,t){var C=e.key+"-"+I.name;(t===!1||eJ===!1)&&e.registered[C]===void 0&&(e.registered[C]=I.styles)},mh=function(e,I,t){uh(e,I,t);var C=e.key+"-"+I.name;if(e.inserted[I.name]===void 0){var l=I;do e.insert(I===l?"."+C:"",l,e.sheet,!0),l=l.next;while(l!==void 0)}};function tJ(g){for(var e=0,I,t=0,C=g.length;C>=4;++t,C-=4)I=g.charCodeAt(t)&255|(g.charCodeAt(++t)&255)<<8|(g.charCodeAt(++t)&255)<<16|(g.charCodeAt(++t)&255)<<24,I=(I&65535)*1540483477+((I>>>16)*59797<<16),I^=I>>>24,e=(I&65535)*1540483477+((I>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(C){case 3:e^=(g.charCodeAt(t+2)&255)<<16;case 2:e^=(g.charCodeAt(t+1)&255)<<8;case 1:e^=g.charCodeAt(t)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var CJ={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},lJ=!1,nJ=/[A-Z]|^ms/g,oJ=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Zh=function(e){return e.charCodeAt(1)===45},kZ=function(e){return e!=null&&typeof e!="boolean"},qs=th(function(g){return Zh(g)?g:g.replace(nJ,"-$&").toLowerCase()}),vZ=function(e,I){switch(e){case"animation":case"animationName":if(typeof I=="string")return I.replace(oJ,function(t,C,l){return mt={name:C,styles:l,next:mt},C})}return CJ[e]!==1&&!Zh(e)&&typeof I=="number"&&I!==0?I+"px":I},rJ="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function ho(g,e,I){if(I==null)return"";var t=I;if(t.__emotion_styles!==void 0)return t;switch(typeof I){case"boolean":return"";case"object":{var C=I;if(C.anim===1)return mt={name:C.name,styles:C.styles,next:mt},C.name;var l=I;if(l.styles!==void 0){var n=l.next;if(n!==void 0)for(;n!==void 0;)mt={name:n.name,styles:n.styles,next:mt},n=n.next;var o=l.styles+";";return o}return aJ(g,e,I)}case"function":{if(g!==void 0){var r=mt,a=I(g);return mt=r,ho(g,e,a)}break}}var i=I;if(e==null)return i;var c=e[i];return c!==void 0?c:i}function aJ(g,e,I){var t="";if(Array.isArray(I))for(var C=0;C<I.length;C++)t+=ho(g,e,I[C])+";";else for(var l in I){var n=I[l];if(typeof n!="object"){var o=n;e!=null&&e[o]!==void 0?t+=l+"{"+e[o]+"}":kZ(o)&&(t+=qs(l)+":"+vZ(l,o)+";")}else{if(l==="NO_COMPONENT_SELECTOR"&&lJ)throw new Error(rJ);if(Array.isArray(n)&&typeof n[0]=="string"&&(e==null||e[n[0]]===void 0))for(var r=0;r<n.length;r++)kZ(n[r])&&(t+=qs(l)+":"+vZ(l,n[r])+";");else{var a=ho(g,e,n);switch(l){case"animation":case"animationName":{t+=qs(l)+":"+a+";";break}default:t+=l+"{"+a+"}"}}}}return t}var YZ=/label:\s*([^\s;\n{]+)\s*(;|$)/g,mt;function Td(g,e,I){if(g.length===1&&typeof g[0]=="object"&&g[0]!==null&&g[0].styles!==void 0)return g[0];var t=!0,C="";mt=void 0;var l=g[0];if(l==null||l.raw===void 0)t=!1,C+=ho(I,e,l);else{var n=l;C+=n[0]}for(var o=1;o<g.length;o++)if(C+=ho(I,e,g[o]),t){var r=l;C+=r[o]}YZ.lastIndex=0;for(var a="",i;(i=YZ.exec(C))!==null;)a+="-"+i[1];var c=tJ(C)+a;return{name:c,styles:C,next:mt}}var iJ=function(e){return e()},bh=jr.useInsertionEffect?jr.useInsertionEffect:!1,sJ=bh||iJ,HZ=bh||d.useLayoutEffect,Gh=d.createContext(typeof HTMLElement<"u"?TX({key:"css"}):null);Gh.Provider;var ph=function(e){return d.forwardRef(function(I,t){var C=d.useContext(Gh);return e(I,C,t)})},Dd=d.createContext({}),cJ=ph(function(g,e){var I=g.styles,t=Td([I],void 0,d.useContext(Dd)),C=d.useRef();return HZ(function(){var l=e.key+"-global",n=new e.sheet.constructor({key:l,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),o=!1,r=document.querySelector('style[data-emotion="'+l+" "+t.name+'"]');return e.sheet.tags.length&&(n.before=e.sheet.tags[0]),r!==null&&(o=!0,r.setAttribute("data-emotion",l),n.hydrate([r])),C.current=[n,o],function(){n.flush()}},[e]),HZ(function(){var l=C.current,n=l[0],o=l[1];if(o){l[1]=!1;return}if(t.next!==void 0&&mh(e,t.next,!0),n.tags.length){var r=n.tags[n.tags.length-1].nextElementSibling;n.before=r,n.flush()}e.insert("",t,n,!1)},[e,t.name]),null});function jd(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];return Td(e)}var Fo=function(){var e=jd.apply(void 0,arguments),I="animation-"+e.name;return{name:I,styles:"@keyframes "+I+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},AJ=mX,dJ=function(e){return e!=="theme"},wZ=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?AJ:dJ},NZ=function(e,I,t){var C;if(I){var l=I.shouldForwardProp;C=e.__emotion_forwardProp&&l?function(n){return e.__emotion_forwardProp(n)&&l(n)}:l}return typeof C!="function"&&t&&(C=e.__emotion_forwardProp),C},uJ=!1,mJ=function(e){var I=e.cache,t=e.serialized,C=e.isStringTag;return uh(I,t,C),sJ(function(){return mh(I,t,C)}),null},ZJ=function g(e,I){var t=e.__emotion_real===e,C=t&&e.__emotion_base||e,l,n;I!==void 0&&(l=I.label,n=I.target);var o=NZ(e,I,t),r=o||wZ(C),a=!r("as");return function(){var i=arguments,c=t&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(l!==void 0&&c.push("label:"+l+";"),i[0]==null||i[0].raw===void 0)c.push.apply(c,i);else{c.push(i[0][0]);for(var A=i.length,p=1;p<A;p++)c.push(i[p],i[0][p])}var G=ph(function(Z,h,u){var b=a&&Z.as||C,m="",B=[],W=Z;if(Z.theme==null){W={};for(var R in Z)W[R]=Z[R];W.theme=d.useContext(Dd)}typeof Z.className=="string"?m=IJ(h.registered,B,Z.className):Z.className!=null&&(m=Z.className+" ");var V=Td(c.concat(B),h.registered,W);m+=h.key+"-"+V.name,n!==void 0&&(m+=" "+n);var S=a&&o===void 0?wZ(b):r,y={};for(var f in Z)a&&f==="as"||S(f)&&(y[f]=Z[f]);return y.className=m,u&&(y.ref=u),d.createElement(d.Fragment,null,d.createElement(mJ,{cache:h,serialized:V,isStringTag:typeof b=="string"}),d.createElement(b,y))});return G.displayName=l!==void 0?l:"Styled("+(typeof C=="string"?C:C.displayName||C.name||"Component")+")",G.defaultProps=e.defaultProps,G.__emotion_real=G,G.__emotion_base=C,G.__emotion_styles=c,G.__emotion_forwardProp=o,Object.defineProperty(G,"toString",{value:function(){return n===void 0&&uJ?"NO_COMPONENT_SELECTOR":"."+n}}),G.withComponent=function(Z,h){return g(Z,bo({},I,h,{shouldForwardProp:NZ(G,h,!0)})).apply(void 0,c)},G}},bJ=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],dA=ZJ.bind();bJ.forEach(function(g){dA[g]=dA(g)});function GJ(g){return g==null||Object.keys(g).length===0}function pJ(g){const{styles:e,defaultTheme:I={}}=g,t=typeof e=="function"?C=>e(GJ(C)?I:C):e;return s.jsx(cJ,{styles:t})}/**
 * @mui/styled-engine v6.1.1
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function hJ(g,e){return dA(g,e)}const yJ=(g,e)=>{Array.isArray(g.__emotion_styles)&&(g.__emotion_styles=e(g.__emotion_styles))};function bt(g){if(typeof g!="object"||g===null)return!1;const e=Object.getPrototypeOf(g);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in g)&&!(Symbol.iterator in g)}function hh(g){if(!bt(g))return g;const e={};return Object.keys(g).forEach(I=>{e[I]=hh(g[I])}),e}function je(g,e,I={clone:!0}){const t=I.clone?{...g}:g;return bt(g)&&bt(e)&&Object.keys(e).forEach(C=>{bt(e[C])&&Object.prototype.hasOwnProperty.call(g,C)&&bt(g[C])?t[C]=je(g[C],e[C],I):I.clone?t[C]=bt(e[C])?hh(e[C]):e[C]:t[C]=e[C]}),t}const BJ=g=>{const e=Object.keys(g).map(I=>({key:I,val:g[I]}))||[];return e.sort((I,t)=>I.val-t.val),e.reduce((I,t)=>({...I,[t.key]:t.val}),{})};function SJ(g){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:I="px",step:t=5,...C}=g,l=BJ(e),n=Object.keys(l);function o(A){return`@media (min-width:${typeof e[A]=="number"?e[A]:A}${I})`}function r(A){return`@media (max-width:${(typeof e[A]=="number"?e[A]:A)-t/100}${I})`}function a(A,p){const G=n.indexOf(p);return`@media (min-width:${typeof e[A]=="number"?e[A]:A}${I}) and (max-width:${(G!==-1&&typeof e[n[G]]=="number"?e[n[G]]:p)-t/100}${I})`}function i(A){return n.indexOf(A)+1<n.length?a(A,n[n.indexOf(A)+1]):o(A)}function c(A){const p=n.indexOf(A);return p===0?o(n[1]):p===n.length-1?r(n[p]):a(A,n[n.indexOf(A)+1]).replace("@media","@media not all and")}return{keys:n,values:l,up:o,down:r,between:a,only:i,not:c,unit:I,...C}}function WJ(g,e){if(!g.containerQueries)return e;const I=Object.keys(e).filter(t=>t.startsWith("@container")).sort((t,C)=>{var n,o;const l=/min-width:\s*([0-9.]+)/;return+(((n=t.match(l))==null?void 0:n[1])||0)-+(((o=C.match(l))==null?void 0:o[1])||0)});return I.length?I.reduce((t,C)=>{const l=e[C];return delete t[C],t[C]=l,t},{...e}):e}function VJ(g,e){return e==="@"||e.startsWith("@")&&(g.some(I=>e.startsWith(`@${I}`))||!!e.match(/^@\d/))}function RJ(g,e){const I=e.match(/^@([^/]+)?\/?(.+)?$/);if(!I)return null;const[,t,C]=I,l=Number.isNaN(+t)?t||0:+t;return g.containerQueries(C).up(l)}function fJ(g){const e=(l,n)=>l.replace("@media",n?`@container ${n}`:"@container");function I(l,n){l.up=(...o)=>e(g.breakpoints.up(...o),n),l.down=(...o)=>e(g.breakpoints.down(...o),n),l.between=(...o)=>e(g.breakpoints.between(...o),n),l.only=(...o)=>e(g.breakpoints.only(...o),n),l.not=(...o)=>{const r=e(g.breakpoints.not(...o),n);return r.includes("not all and")?r.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):r}}const t={},C=l=>(I(t,l),t);return I(C),{...g,containerQueries:C}}const XJ={borderRadius:4};function Qn(g,e){return e?je(g,e,{clone:!1}):g}const fi={xs:0,sm:600,md:900,lg:1200,xl:1536},FZ={keys:["xs","sm","md","lg","xl"],up:g=>`@media (min-width:${fi[g]}px)`},JJ={containerQueries:g=>({up:e=>{let I=typeof e=="number"?e:fi[e]||e;return typeof I=="number"&&(I=`${I}px`),g?`@container ${g} (min-width:${I})`:`@container (min-width:${I})`}})};function DI(g,e,I){const t=g.theme||{};if(Array.isArray(e)){const l=t.breakpoints||FZ;return e.reduce((n,o,r)=>(n[l.up(l.keys[r])]=I(e[r]),n),{})}if(typeof e=="object"){const l=t.breakpoints||FZ;return Object.keys(e).reduce((n,o)=>{if(VJ(l.keys,o)){const r=RJ(t.containerQueries?t:JJ,o);r&&(n[r]=I(e[o],o))}else if(Object.keys(l.values||fi).includes(o)){const r=l.up(o);n[r]=I(e[o],o)}else{const r=o;n[r]=e[r]}return n},{})}return I(e)}function kJ(g={}){var I;return((I=g.keys)==null?void 0:I.reduce((t,C)=>{const l=g.up(C);return t[l]={},t},{}))||{}}function vJ(g,e){return g.reduce((I,t)=>{const C=I[t];return(!C||Object.keys(C).length===0)&&delete I[t],I},e)}function YJ(g,e){if(typeof g!="object")return{};const I={},t=Object.keys(e);return Array.isArray(g)?t.forEach((C,l)=>{l<g.length&&(I[C]=!0)}):t.forEach(C=>{g[C]!=null&&(I[C]=!0)}),I}function Xi({values:g,breakpoints:e,base:I}){const t=I||YJ(g,e),C=Object.keys(t);if(C.length===0)return g;let l;return C.reduce((n,o,r)=>(Array.isArray(g)?(n[o]=g[r]!=null?g[r]:g[l],l=r):typeof g=="object"?(n[o]=g[o]!=null?g[o]:g[l],l=o):n[o]=g,n),{})}function $(g){if(typeof g!="string")throw new Error(Ut(7));return g.charAt(0).toUpperCase()+g.slice(1)}function Ji(g,e,I=!0){if(!e||typeof e!="string")return null;if(g&&g.vars&&I){const t=`vars.${e}`.split(".").reduce((C,l)=>C&&C[l]?C[l]:null,g);if(t!=null)return t}return e.split(".").reduce((t,C)=>t&&t[C]!=null?t[C]:null,g)}function Wa(g,e,I,t=I){let C;return typeof g=="function"?C=g(I):Array.isArray(g)?C=g[I]||t:C=Ji(g,I)||t,e&&(C=e(C,t,g)),C}function Ge(g){const{prop:e,cssProperty:I=g.prop,themeKey:t,transform:C}=g,l=n=>{if(n[e]==null)return null;const o=n[e],r=n.theme,a=Ji(r,t)||{};return DI(n,o,c=>{let A=Wa(a,C,c);return c===A&&typeof c=="string"&&(A=Wa(a,C,`${e}${c==="default"?"":$(c)}`,c)),I===!1?A:{[I]:A}})};return l.propTypes={},l.filterProps=[e],l}function HJ(g){const e={};return I=>(e[I]===void 0&&(e[I]=g(I)),e[I])}const wJ={m:"margin",p:"padding"},NJ={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},KZ={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},FJ=HJ(g=>{if(g.length>2)if(KZ[g])g=KZ[g];else return[g];const[e,I]=g.split(""),t=wJ[e],C=NJ[I]||"";return Array.isArray(C)?C.map(l=>t+l):[t+C]}),Pd=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Od=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...Pd,...Od];function Ko(g,e,I,t){const C=Ji(g,e,!0)??I;return typeof C=="number"||typeof C=="string"?l=>typeof l=="string"?l:typeof C=="string"?`calc(${l} * ${C})`:C*l:Array.isArray(C)?l=>{if(typeof l=="string")return l;const n=Math.abs(l),o=C[n];return l>=0?o:typeof o=="number"?-o:`-${o}`}:typeof C=="function"?C:()=>{}}function qd(g){return Ko(g,"spacing",8)}function xo(g,e){return typeof e=="string"||e==null?e:g(e)}function KJ(g,e){return I=>g.reduce((t,C)=>(t[C]=xo(e,I),t),{})}function xJ(g,e,I,t){if(!e.includes(I))return null;const C=FJ(I),l=KJ(C,t),n=g[I];return DI(g,n,l)}function yh(g,e){const I=qd(g.theme);return Object.keys(g).map(t=>xJ(g,e,t,I)).reduce(Qn,{})}function de(g){return yh(g,Pd)}de.propTypes={};de.filterProps=Pd;function ue(g){return yh(g,Od)}ue.propTypes={};ue.filterProps=Od;function Bh(g=8,e=qd({spacing:g})){if(g.mui)return g;const I=(...t)=>(t.length===0?[1]:t).map(l=>{const n=e(l);return typeof n=="number"?`${n}px`:n}).join(" ");return I.mui=!0,I}function ki(...g){const e=g.reduce((t,C)=>(C.filterProps.forEach(l=>{t[l]=C}),t),{}),I=t=>Object.keys(t).reduce((C,l)=>e[l]?Qn(C,e[l](t)):C,{});return I.propTypes={},I.filterProps=g.reduce((t,C)=>t.concat(C.filterProps),[]),I}function MI(g){return typeof g!="number"?g:`${g}px solid`}function jI(g,e){return Ge({prop:g,themeKey:"borders",transform:e})}const EJ=jI("border",MI),zJ=jI("borderTop",MI),MJ=jI("borderRight",MI),UJ=jI("borderBottom",MI),LJ=jI("borderLeft",MI),QJ=jI("borderColor"),TJ=jI("borderTopColor"),DJ=jI("borderRightColor"),jJ=jI("borderBottomColor"),PJ=jI("borderLeftColor"),OJ=jI("outline",MI),qJ=jI("outlineColor"),vi=g=>{if(g.borderRadius!==void 0&&g.borderRadius!==null){const e=Ko(g.theme,"shape.borderRadius",4),I=t=>({borderRadius:xo(e,t)});return DI(g,g.borderRadius,I)}return null};vi.propTypes={};vi.filterProps=["borderRadius"];ki(EJ,zJ,MJ,UJ,LJ,QJ,TJ,DJ,jJ,PJ,vi,OJ,qJ);const Yi=g=>{if(g.gap!==void 0&&g.gap!==null){const e=Ko(g.theme,"spacing",8),I=t=>({gap:xo(e,t)});return DI(g,g.gap,I)}return null};Yi.propTypes={};Yi.filterProps=["gap"];const Hi=g=>{if(g.columnGap!==void 0&&g.columnGap!==null){const e=Ko(g.theme,"spacing",8),I=t=>({columnGap:xo(e,t)});return DI(g,g.columnGap,I)}return null};Hi.propTypes={};Hi.filterProps=["columnGap"];const wi=g=>{if(g.rowGap!==void 0&&g.rowGap!==null){const e=Ko(g.theme,"spacing",8),I=t=>({rowGap:xo(e,t)});return DI(g,g.rowGap,I)}return null};wi.propTypes={};wi.filterProps=["rowGap"];const $J=Ge({prop:"gridColumn"}),_J=Ge({prop:"gridRow"}),g2=Ge({prop:"gridAutoFlow"}),e2=Ge({prop:"gridAutoColumns"}),I2=Ge({prop:"gridAutoRows"}),t2=Ge({prop:"gridTemplateColumns"}),C2=Ge({prop:"gridTemplateRows"}),l2=Ge({prop:"gridTemplateAreas"}),n2=Ge({prop:"gridArea"});ki(Yi,Hi,wi,$J,_J,g2,e2,I2,t2,C2,l2,n2);function kl(g,e){return e==="grey"?e:g}const o2=Ge({prop:"color",themeKey:"palette",transform:kl}),r2=Ge({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:kl}),a2=Ge({prop:"backgroundColor",themeKey:"palette",transform:kl});ki(o2,r2,a2);function BI(g){return g<=1&&g!==0?`${g*100}%`:g}const i2=Ge({prop:"width",transform:BI}),$d=g=>{if(g.maxWidth!==void 0&&g.maxWidth!==null){const e=I=>{var C,l,n,o,r;const t=((n=(l=(C=g.theme)==null?void 0:C.breakpoints)==null?void 0:l.values)==null?void 0:n[I])||fi[I];return t?((r=(o=g.theme)==null?void 0:o.breakpoints)==null?void 0:r.unit)!=="px"?{maxWidth:`${t}${g.theme.breakpoints.unit}`}:{maxWidth:t}:{maxWidth:BI(I)}};return DI(g,g.maxWidth,e)}return null};$d.filterProps=["maxWidth"];const s2=Ge({prop:"minWidth",transform:BI}),c2=Ge({prop:"height",transform:BI}),A2=Ge({prop:"maxHeight",transform:BI}),d2=Ge({prop:"minHeight",transform:BI});Ge({prop:"size",cssProperty:"width",transform:BI});Ge({prop:"size",cssProperty:"height",transform:BI});const u2=Ge({prop:"boxSizing"});ki(i2,$d,s2,c2,A2,d2,u2);const Eo={border:{themeKey:"borders",transform:MI},borderTop:{themeKey:"borders",transform:MI},borderRight:{themeKey:"borders",transform:MI},borderBottom:{themeKey:"borders",transform:MI},borderLeft:{themeKey:"borders",transform:MI},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:MI},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:vi},color:{themeKey:"palette",transform:kl},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:kl},backgroundColor:{themeKey:"palette",transform:kl},p:{style:ue},pt:{style:ue},pr:{style:ue},pb:{style:ue},pl:{style:ue},px:{style:ue},py:{style:ue},padding:{style:ue},paddingTop:{style:ue},paddingRight:{style:ue},paddingBottom:{style:ue},paddingLeft:{style:ue},paddingX:{style:ue},paddingY:{style:ue},paddingInline:{style:ue},paddingInlineStart:{style:ue},paddingInlineEnd:{style:ue},paddingBlock:{style:ue},paddingBlockStart:{style:ue},paddingBlockEnd:{style:ue},m:{style:de},mt:{style:de},mr:{style:de},mb:{style:de},ml:{style:de},mx:{style:de},my:{style:de},margin:{style:de},marginTop:{style:de},marginRight:{style:de},marginBottom:{style:de},marginLeft:{style:de},marginX:{style:de},marginY:{style:de},marginInline:{style:de},marginInlineStart:{style:de},marginInlineEnd:{style:de},marginBlock:{style:de},marginBlockStart:{style:de},marginBlockEnd:{style:de},displayPrint:{cssProperty:!1,transform:g=>({"@media print":{display:g}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Yi},rowGap:{style:wi},columnGap:{style:Hi},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:BI},maxWidth:{style:$d},minWidth:{transform:BI},height:{transform:BI},maxHeight:{transform:BI},minHeight:{transform:BI},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function m2(...g){const e=g.reduce((t,C)=>t.concat(Object.keys(C)),[]),I=new Set(e);return g.every(t=>I.size===Object.keys(t).length)}function Z2(g,e){return typeof g=="function"?g(e):g}function b2(){function g(I,t,C,l){const n={[I]:t,theme:C},o=l[I];if(!o)return{[I]:t};const{cssProperty:r=I,themeKey:a,transform:i,style:c}=o;if(t==null)return null;if(a==="typography"&&t==="inherit")return{[I]:t};const A=Ji(C,a)||{};return c?c(n):DI(n,t,G=>{let Z=Wa(A,i,G);return G===Z&&typeof G=="string"&&(Z=Wa(A,i,`${I}${G==="default"?"":$(G)}`,G)),r===!1?Z:{[r]:Z}})}function e(I){const{sx:t,theme:C={}}=I||{};if(!t)return null;const l=C.unstable_sxConfig??Eo;function n(o){let r=o;if(typeof o=="function")r=o(C);else if(typeof o!="object")return o;if(!r)return null;const a=kJ(C.breakpoints),i=Object.keys(a);let c=a;return Object.keys(r).forEach(A=>{const p=Z2(r[A],C);if(p!=null)if(typeof p=="object")if(l[A])c=Qn(c,g(A,p,C,l));else{const G=DI({theme:C},p,Z=>({[A]:Z}));m2(G,p)?c[A]=e({sx:p,theme:C}):c=Qn(c,G)}else c=Qn(c,g(A,p,C,l))}),WJ(C,vJ(i,c))}return Array.isArray(t)?t.map(n):n(t)}return e}const zo=b2();zo.filterProps=["sx"];function G2(g,e){var t;const I=this;if(I.vars){if(!((t=I.colorSchemes)!=null&&t[g])||typeof I.getColorSchemeSelector!="function")return{};let C=I.getColorSchemeSelector(g);return C==="&"?e:((C.includes("data-")||C.includes("."))&&(C=`*:where(${C.replace(/\s*&$/,"")}) &`),{[C]:e})}return I.palette.mode===g?e:{}}function _d(g={},...e){const{breakpoints:I={},palette:t={},spacing:C,shape:l={},...n}=g,o=SJ(I),r=Bh(C);let a=je({breakpoints:o,direction:"ltr",components:{},palette:{mode:"light",...t},spacing:r,shape:{...XJ,...l}},n);return a=fJ(a),a.applyStyles=G2,a=e.reduce((i,c)=>je(i,c),a),a.unstable_sxConfig={...Eo,...n==null?void 0:n.unstable_sxConfig},a.unstable_sx=function(c){return zo({sx:c,theme:this})},a}function p2(g){return Object.keys(g).length===0}function h2(g=null){const e=d.useContext(Dd);return!e||p2(e)?g:e}const y2=_d();function gu(g=y2){return h2(g)}function B2({styles:g,themeId:e,defaultTheme:I={}}){const t=gu(I),C=typeof g=="function"?g(e&&t[e]||t):g;return s.jsx(pJ,{styles:C})}const S2=g=>{var t;const e={systemProps:{},otherProps:{}},I=((t=g==null?void 0:g.theme)==null?void 0:t.unstable_sxConfig)??Eo;return Object.keys(g).forEach(C=>{I[C]?e.systemProps[C]=g[C]:e.otherProps[C]=g[C]}),e};function Sh(g){const{sx:e,...I}=g,{systemProps:t,otherProps:C}=S2(I);let l;return Array.isArray(e)?l=[t,...e]:typeof e=="function"?l=(...n)=>{const o=e(...n);return bt(o)?{...t,...o}:t}:l={...t,...e},{...C,sx:l}}const xZ=g=>g,W2=()=>{let g=xZ;return{configure(e){g=e},generate(e){return g(e)},reset(){g=xZ}}},V2=W2();function Wh(g){var e,I,t="";if(typeof g=="string"||typeof g=="number")t+=g;else if(typeof g=="object")if(Array.isArray(g)){var C=g.length;for(e=0;e<C;e++)g[e]&&(I=Wh(g[e]))&&(t&&(t+=" "),t+=I)}else for(I in g)g[I]&&(t&&(t+=" "),t+=I);return t}function og(){for(var g,e,I=0,t="",C=arguments.length;I<C;I++)(g=arguments[I])&&(e=Wh(g))&&(t&&(t+=" "),t+=e);return t}const R2={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function pg(g,e,I="Mui"){const t=R2[e];return t?`${I}-${t}`:`${V2.generate(g)}-${e}`}function Gg(g,e,I="Mui"){const t={};return e.forEach(C=>{t[C]=pg(g,C,I)}),t}const f2=_d();function $s(g){return g!=="ownerState"&&g!=="theme"&&g!=="sx"&&g!=="as"}function uA(g,e,I){return k2(e)?I:e[g]||e}const Gr=Symbol("mui.processed_props");function pr(g,e,I){if(Gr in g)return g[Gr];const t={...g,theme:uA(e,g.theme,I)};return g[Gr]=t,t[Gr]=t,t}function X2(g){return g?(e,I)=>I[g]:null}function Tr(g,e){var t;const I=typeof g=="function"?g(e):g;if(Array.isArray(I))return I.flatMap(C=>Tr(C,e));if(Array.isArray(I==null?void 0:I.variants)){const{variants:C,...l}=I;let n=l,o;g:for(let r=0;r<C.length;r+=1){const a=C[r];if(typeof a.props=="function"){if(o??(o={...e,...e.ownerState,ownerState:e.ownerState}),!a.props(o))continue}else for(const i in a.props)if(e[i]!==a.props[i]&&((t=e.ownerState)==null?void 0:t[i])!==a.props[i])continue g;Array.isArray(n)||(n=[n]),typeof a.style=="function"?(o??(o={...e,...e.ownerState,ownerState:e.ownerState}),n.push(a.style(o))):n.push(a.style)}return n}return I}function J2(g={}){const{themeId:e,defaultTheme:I=f2,rootShouldForwardProp:t=$s,slotShouldForwardProp:C=$s}=g,l=o=>zo(pr(o,e,I));return l.__mui_systemSx=!0,(o,r={})=>{yJ(o,R=>R.filter(V=>!(V!=null&&V.__mui_systemSx)));const{name:a,slot:i,skipVariantsResolver:c,skipSx:A,overridesResolver:p=X2(Y2(i)),...G}=r,Z=c!==void 0?c:i&&i!=="Root"&&i!=="root"||!1,h=A||!1;let u,b=$s;i==="Root"||i==="root"?b=t:i?b=C:v2(o)&&(b=void 0);const m=hJ(o,{shouldForwardProp:b,label:u,...G}),B=R=>typeof R=="function"&&R.__emotion_real!==R||bt(R)?V=>Tr(R,pr(V,e,I)):R,W=(R,...V)=>{let S=B(R);const y=V?V.map(B):[];a&&p&&y.push(H=>{const M=uA(e,H.theme,I);if(!M.components||!M.components[a]||!M.components[a].styleOverrides)return null;const F=M.components[a].styleOverrides,x={},L=pr(H,e,I);for(const D in F)x[D]=Tr(F[D],L);return p(H,x)}),a&&!Z&&y.push(H=>{var x,L;const M=uA(e,H.theme,I),F=(L=(x=M==null?void 0:M.components)==null?void 0:x[a])==null?void 0:L.variants;return F?Tr({variants:F},pr(H,e,I)):null}),h||y.push(l);const f=y.length-V.length;if(Array.isArray(R)&&f>0){const H=new Array(f).fill("");S=[...R,...H],S.raw=[...R.raw,...H]}const k=m(S,...y);return o.muiName&&(k.muiName=o.muiName),k};return m.withConfig&&(W.withConfig=m.withConfig),W}}function k2(g){for(const e in g)return!1;return!0}function v2(g){return typeof g=="string"&&g.charCodeAt(0)>96}function Y2(g){return g&&g.charAt(0).toLowerCase()+g.slice(1)}function yo(g,e){const I={...e};for(const t in g)if(Object.prototype.hasOwnProperty.call(g,t)){const C=t;if(C==="components"||C==="slots")I[C]={...g[C],...I[C]};else if(C==="componentsProps"||C==="slotProps"){const l=g[C],n=e[C];if(!n)I[C]=l||{};else if(!l)I[C]=n;else{I[C]={...n};for(const o in l)if(Object.prototype.hasOwnProperty.call(l,o)){const r=o;I[C][r]=yo(l[r],n[r])}}}else I[C]===void 0&&(I[C]=g[C])}return I}function H2(g){const{theme:e,name:I,props:t}=g;return!e||!e.components||!e.components[I]||!e.components[I].defaultProps?t:yo(e.components[I].defaultProps,t)}function w2({props:g,name:e,defaultTheme:I,themeId:t}){let C=gu(I);return t&&(C=C[t]||C),H2({theme:C,name:e,props:g})}const dC=typeof window<"u"?d.useLayoutEffect:d.useEffect;function N2(g,e=Number.MIN_SAFE_INTEGER,I=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(g,I))}function eu(g,e=0,I=1){return N2(g,e,I)}function F2(g){g=g.slice(1);const e=new RegExp(`.{1,${g.length>=6?2:1}}`,"g");let I=g.match(e);return I&&I[0].length===1&&(I=I.map(t=>t+t)),I?`rgb${I.length===4?"a":""}(${I.map((t,C)=>C<3?parseInt(t,16):Math.round(parseInt(t,16)/255*1e3)/1e3).join(", ")})`:""}function uC(g){if(g.type)return g;if(g.charAt(0)==="#")return uC(F2(g));const e=g.indexOf("("),I=g.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(I))throw new Error(Ut(9,g));let t=g.substring(e+1,g.length-1),C;if(I==="color"){if(t=t.split(" "),C=t.shift(),t.length===4&&t[3].charAt(0)==="/"&&(t[3]=t[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(C))throw new Error(Ut(10,C))}else t=t.split(",");return t=t.map(l=>parseFloat(l)),{type:I,values:t,colorSpace:C}}const K2=g=>{const e=uC(g);return e.values.slice(0,3).map((I,t)=>e.type.includes("hsl")&&t!==0?`${I}%`:I).join(" ")},kn=(g,e)=>{try{return K2(g)}catch{return g}};function Ni(g){const{type:e,colorSpace:I}=g;let{values:t}=g;return e.includes("rgb")?t=t.map((C,l)=>l<3?parseInt(C,10):C):e.includes("hsl")&&(t[1]=`${t[1]}%`,t[2]=`${t[2]}%`),e.includes("color")?t=`${I} ${t.join(" ")}`:t=`${t.join(", ")}`,`${e}(${t})`}function Vh(g){g=uC(g);const{values:e}=g,I=e[0],t=e[1]/100,C=e[2]/100,l=t*Math.min(C,1-C),n=(a,i=(a+I/30)%12)=>C-l*Math.max(Math.min(i-3,9-i,1),-1);let o="rgb";const r=[Math.round(n(0)*255),Math.round(n(8)*255),Math.round(n(4)*255)];return g.type==="hsla"&&(o+="a",r.push(e[3])),Ni({type:o,values:r})}function mA(g){g=uC(g);let e=g.type==="hsl"||g.type==="hsla"?uC(Vh(g)).values:g.values;return e=e.map(I=>(g.type!=="color"&&(I/=255),I<=.03928?I/12.92:((I+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function x2(g,e){const I=mA(g),t=mA(e);return(Math.max(I,t)+.05)/(Math.min(I,t)+.05)}function Ze(g,e){return g=uC(g),e=eu(e),(g.type==="rgb"||g.type==="hsl")&&(g.type+="a"),g.type==="color"?g.values[3]=`/${e}`:g.values[3]=e,Ni(g)}function hr(g,e,I){try{return Ze(g,e)}catch{return g}}function Ml(g,e){if(g=uC(g),e=eu(e),g.type.includes("hsl"))g.values[2]*=1-e;else if(g.type.includes("rgb")||g.type.includes("color"))for(let I=0;I<3;I+=1)g.values[I]*=1-e;return Ni(g)}function Og(g,e,I){try{return Ml(g,e)}catch{return g}}function Ul(g,e){if(g=uC(g),e=eu(e),g.type.includes("hsl"))g.values[2]+=(100-g.values[2])*e;else if(g.type.includes("rgb"))for(let I=0;I<3;I+=1)g.values[I]+=(255-g.values[I])*e;else if(g.type.includes("color"))for(let I=0;I<3;I+=1)g.values[I]+=(1-g.values[I])*e;return Ni(g)}function qg(g,e,I){try{return Ul(g,e)}catch{return g}}function E2(g,e=.15){return mA(g)>.5?Ml(g,e):Ul(g,e)}function yr(g,e,I){try{return E2(g,e)}catch{return g}}function ZA(...g){return g.reduce((e,I)=>I==null?e:function(...C){e.apply(this,C),I.apply(this,C)},()=>{})}function Rh(g,e=166){let I;function t(...C){const l=()=>{g.apply(this,C)};clearTimeout(I),I=setTimeout(l,e)}return t.clear=()=>{clearTimeout(I)},t}function _s(g,e){var I,t,C;return d.isValidElement(g)&&e.indexOf(g.type.muiName??((C=(t=(I=g.type)==null?void 0:I._payload)==null?void 0:t.value)==null?void 0:C.muiName))!==-1}function fI(g){return g&&g.ownerDocument||document}function DC(g){return fI(g).defaultView||window}function bA(g,e){typeof g=="function"?g(e):g&&(g.current=e)}let EZ=0;function z2(g){const[e,I]=d.useState(g),t=g||e;return d.useEffect(()=>{e==null&&(EZ+=1,I(`mui-${EZ}`))},[e]),t}const M2={...jr},zZ=M2.useId;function Fi(g){if(zZ!==void 0){const e=zZ();return g??e}return z2(g)}function Va({controlled:g,default:e,name:I,state:t="value"}){const{current:C}=d.useRef(g!==void 0),[l,n]=d.useState(e),o=C?g:l,r=d.useCallback(a=>{C||n(a)},[]);return[o,r]}function Bl(g){const e=d.useRef(g);return dC(()=>{e.current=g}),d.useRef((...I)=>(0,e.current)(...I)).current}function ve(...g){return d.useMemo(()=>g.every(e=>e==null)?null:e=>{g.forEach(I=>{bA(I,e)})},g)}const MZ={};function fh(g,e){const I=d.useRef(MZ);return I.current===MZ&&(I.current=g(e)),I}const U2=[];function L2(g){d.useEffect(g,U2)}class Iu{constructor(){Cn(this,"currentId",null);Cn(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});Cn(this,"disposeEffect",()=>this.clear)}static create(){return new Iu}start(e,I){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,I()},e)}}function Xh(){const g=fh(Iu.create).current;return L2(g.disposeEffect),g}function UZ(g){try{return g.matches(":focus-visible")}catch{}return!1}function Jh(g){const e=g.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function Sg(g,e,I=void 0){const t={};for(const C in g){const l=g[C];let n="",o=!0;for(let r=0;r<l.length;r+=1){const a=l[r];a&&(n+=(o===!0?"":" ")+e(a),o=!1,I&&I[a]&&(n+=" "+I[a]))}t[C]=n}return t}function Q2(g){return typeof g=="string"}function kh(g,e,I){return g===void 0||Q2(g)?e:{...e,ownerState:{...e.ownerState,...I}}}function vh(g,e=[]){if(g===void 0)return{};const I={};return Object.keys(g).filter(t=>t.match(/^on[A-Z]/)&&typeof g[t]=="function"&&!e.includes(t)).forEach(t=>{I[t]=g[t]}),I}function LZ(g){if(g===void 0)return{};const e={};return Object.keys(g).filter(I=>!(I.match(/^on[A-Z]/)&&typeof g[I]=="function")).forEach(I=>{e[I]=g[I]}),e}function Yh(g){const{getSlotProps:e,additionalProps:I,externalSlotProps:t,externalForwardedProps:C,className:l}=g;if(!e){const p=og(I==null?void 0:I.className,l,C==null?void 0:C.className,t==null?void 0:t.className),G={...I==null?void 0:I.style,...C==null?void 0:C.style,...t==null?void 0:t.style},Z={...I,...C,...t};return p.length>0&&(Z.className=p),Object.keys(G).length>0&&(Z.style=G),{props:Z,internalRef:void 0}}const n=vh({...C,...t}),o=LZ(t),r=LZ(C),a=e(n),i=og(a==null?void 0:a.className,I==null?void 0:I.className,l,C==null?void 0:C.className,t==null?void 0:t.className),c={...a==null?void 0:a.style,...I==null?void 0:I.style,...C==null?void 0:C.style,...t==null?void 0:t.style},A={...a,...I,...r,...o};return i.length>0&&(A.className=i),Object.keys(c).length>0&&(A.style=c),{props:A,internalRef:a.ref}}function Hh(g,e,I){return typeof g=="function"?g(e,I):g}function QZ(g){var c;const{elementType:e,externalSlotProps:I,ownerState:t,skipResolvingSlotProps:C=!1,...l}=g,n=C?{}:Hh(I,t),{props:o,internalRef:r}=Yh({...l,externalSlotProps:n}),a=ve(r,n==null?void 0:n.ref,(c=g.additionalProps)==null?void 0:c.ref);return kh(e,{...o,ref:a},t)}function Mo(g){return!g||!d.isValidElement(g)?null:g.props.propertyIsEnumerable("ref")?g.props.ref:g.ref}const T2=d.createContext(),D2=()=>d.useContext(T2)??!1,j2=d.createContext(void 0);function P2(g){const{theme:e,name:I,props:t}=g;if(!e||!e.components||!e.components[I])return t;const C=e.components[I];return C.defaultProps?yo(C.defaultProps,t):!C.styleOverrides&&!C.variants?yo(C,t):t}function O2({props:g,name:e}){const I=d.useContext(j2);return P2({props:g,name:e,theme:{components:I}})}function q2(g=""){function e(...t){if(!t.length)return"";const C=t[0];return typeof C=="string"&&!C.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${g?`${g}-`:""}${C}${e(...t.slice(1))})`:`, ${C}`}return(t,...C)=>`var(--${g?`${g}-`:""}${t}${e(...C)})`}const TZ=(g,e,I,t=[])=>{let C=g;e.forEach((l,n)=>{n===e.length-1?Array.isArray(C)?C[Number(l)]=I:C&&typeof C=="object"&&(C[l]=I):C&&typeof C=="object"&&(C[l]||(C[l]=t.includes(l)?[]:{}),C=C[l])})},$2=(g,e,I)=>{function t(C,l=[],n=[]){Object.entries(C).forEach(([o,r])=>{(!I||I&&!I([...l,o]))&&r!=null&&(typeof r=="object"&&Object.keys(r).length>0?t(r,[...l,o],Array.isArray(r)?[...n,o]:n):e([...l,o],r,n))})}t(g)},_2=(g,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(t=>g.includes(t))||g[g.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function gc(g,e){const{prefix:I,shouldSkipGeneratingVar:t}=e||{},C={},l={},n={};return $2(g,(o,r,a)=>{if((typeof r=="string"||typeof r=="number")&&(!t||!t(o,r))){const i=`--${I?`${I}-`:""}${o.join("-")}`,c=_2(o,r);Object.assign(C,{[i]:c}),TZ(l,o,`var(${i})`,a),TZ(n,o,`var(${i}, ${c})`,a)}},o=>o[0]==="vars"),{css:C,vars:l,varsWithDefaults:n}}function gk(g,e={}){const{getSelector:I=h,disableCssColorScheme:t,colorSchemeSelector:C}=e,{colorSchemes:l={},components:n,defaultColorScheme:o="light",...r}=g,{vars:a,css:i,varsWithDefaults:c}=gc(r,e);let A=c;const p={},{[o]:G,...Z}=l;if(Object.entries(Z||{}).forEach(([m,B])=>{const{vars:W,css:R,varsWithDefaults:V}=gc(B,e);A=je(A,V),p[m]={css:R,vars:W}}),G){const{css:m,vars:B,varsWithDefaults:W}=gc(G,e);A=je(A,W),p[o]={css:m,vars:B}}function h(m,B){var R,V;let W=C;if(C==="class"&&(W=".%s"),C==="data"&&(W="[data-%s]"),C!=null&&C.startsWith("data-")&&!C.includes("%s")&&(W=`[${C}="%s"]`),m){if(W==="media")return g.defaultColorScheme===m?":root":{[`@media (prefers-color-scheme: ${((V=(R=l[m])==null?void 0:R.palette)==null?void 0:V.mode)||m})`]:{":root":B}};if(W)return g.defaultColorScheme===m?`:root, ${W.replace("%s",String(m))}`:W.replace("%s",String(m))}return":root"}return{vars:A,generateThemeVars:()=>{let m={...a};return Object.entries(p).forEach(([,{vars:B}])=>{m=je(m,B)}),m},generateStyleSheets:()=>{var S,y;const m=[],B=g.defaultColorScheme||"light";function W(f,k){Object.keys(k).length&&m.push(typeof f=="string"?{[f]:{...k}}:f)}W(I(void 0,{...i}),i);const{[B]:R,...V}=p;if(R){const{css:f}=R,k=(y=(S=l[B])==null?void 0:S.palette)==null?void 0:y.mode,H=!t&&k?{colorScheme:k,...f}:{...f};W(I(B,{...H}),H)}return Object.entries(V).forEach(([f,{css:k}])=>{var F,x;const H=(x=(F=l[f])==null?void 0:F.palette)==null?void 0:x.mode,M=!t&&H?{colorScheme:H,...k}:{...k};W(I(f,{...M}),M)}),m}}}function ek(g){return function(I){return g==="media"?`@media (prefers-color-scheme: ${I})`:g?g.startsWith("data-")&&!g.includes("%s")?`[${g}="${I}"] &`:g==="class"?`.${I} &`:g==="data"?`[data-${I}] &`:`${g.replace("%s",I)} &`:"&"}}const DZ={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Zo.white,default:Zo.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},ec={text:{primary:Zo.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Zo.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function jZ(g,e,I,t){const C=t.light||t,l=t.dark||t*1.5;g[e]||(g.hasOwnProperty(I)?g[e]=g[I]:e==="light"?g.light=Ul(g.main,C):e==="dark"&&(g.dark=Ml(g.main,l)))}function Ik(g="light"){return g==="dark"?{main:tl[200],light:tl[50],dark:tl[400]}:{main:tl[700],light:tl[400],dark:tl[800]}}function tk(g="light"){return g==="dark"?{main:Il[200],light:Il[50],dark:Il[400]}:{main:Il[500],light:Il[300],dark:Il[700]}}function Ck(g="light"){return g==="dark"?{main:el[500],light:el[300],dark:el[700]}:{main:el[700],light:el[400],dark:el[800]}}function lk(g="light"){return g==="dark"?{main:Cl[400],light:Cl[300],dark:Cl[700]}:{main:Cl[700],light:Cl[500],dark:Cl[900]}}function nk(g="light"){return g==="dark"?{main:ll[400],light:ll[300],dark:ll[700]}:{main:ll[800],light:ll[500],dark:ll[900]}}function ok(g="light"){return g==="dark"?{main:bn[400],light:bn[300],dark:bn[700]}:{main:"#ed6c02",light:bn[500],dark:bn[900]}}function tu(g){const{mode:e="light",contrastThreshold:I=3,tonalOffset:t=.2,...C}=g,l=g.primary||Ik(e),n=g.secondary||tk(e),o=g.error||Ck(e),r=g.info||lk(e),a=g.success||nk(e),i=g.warning||ok(e);function c(Z){return x2(Z,ec.text.primary)>=I?ec.text.primary:DZ.text.primary}const A=({color:Z,name:h,mainShade:u=500,lightShade:b=300,darkShade:m=700})=>{if(Z={...Z},!Z.main&&Z[u]&&(Z.main=Z[u]),!Z.hasOwnProperty("main"))throw new Error(Ut(11,h?` (${h})`:"",u));if(typeof Z.main!="string")throw new Error(Ut(12,h?` (${h})`:"",JSON.stringify(Z.main)));return jZ(Z,"light",b,t),jZ(Z,"dark",m,t),Z.contrastText||(Z.contrastText=c(Z.main)),Z},p={dark:ec,light:DZ};return je({common:{...Zo},mode:e,primary:A({color:l,name:"primary"}),secondary:A({color:n,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:A({color:o,name:"error"}),warning:A({color:i,name:"warning"}),info:A({color:r,name:"info"}),success:A({color:a,name:"success"}),grey:dX,contrastThreshold:I,getContrastText:c,augmentColor:A,tonalOffset:t,...p[e]},C)}function rk(g){const e={};return Object.entries(g).forEach(t=>{const[C,l]=t;typeof l=="object"&&(e[C]=`${l.fontStyle?`${l.fontStyle} `:""}${l.fontVariant?`${l.fontVariant} `:""}${l.fontWeight?`${l.fontWeight} `:""}${l.fontStretch?`${l.fontStretch} `:""}${l.fontSize||""}${l.lineHeight?`/${l.lineHeight} `:""}${l.fontFamily||""}`)}),e}function ak(g,e){return{toolbar:{minHeight:56,[g.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[g.up("sm")]:{minHeight:64}},...e}}function ik(g){return Math.round(g*1e5)/1e5}const PZ={textTransform:"uppercase"},OZ='"Roboto", "Helvetica", "Arial", sans-serif';function sk(g,e){const{fontFamily:I=OZ,fontSize:t=14,fontWeightLight:C=300,fontWeightRegular:l=400,fontWeightMedium:n=500,fontWeightBold:o=700,htmlFontSize:r=16,allVariants:a,pxToRem:i,...c}=typeof e=="function"?e(g):e,A=t/14,p=i||(h=>`${h/r*A}rem`),G=(h,u,b,m,B)=>({fontFamily:I,fontWeight:h,fontSize:p(u),lineHeight:b,...I===OZ?{letterSpacing:`${ik(m/u)}em`}:{},...B,...a}),Z={h1:G(C,96,1.167,-1.5),h2:G(C,60,1.2,-.5),h3:G(l,48,1.167,0),h4:G(l,34,1.235,.25),h5:G(l,24,1.334,0),h6:G(n,20,1.6,.15),subtitle1:G(l,16,1.75,.15),subtitle2:G(n,14,1.57,.1),body1:G(l,16,1.5,.15),body2:G(l,14,1.43,.15),button:G(n,14,1.75,.4,PZ),caption:G(l,12,1.66,.4),overline:G(l,12,2.66,1,PZ),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return je({htmlFontSize:r,pxToRem:p,fontFamily:I,fontSize:t,fontWeightLight:C,fontWeightRegular:l,fontWeightMedium:n,fontWeightBold:o,...Z},c,{clone:!1})}const ck=.2,Ak=.14,dk=.12;function le(...g){return[`${g[0]}px ${g[1]}px ${g[2]}px ${g[3]}px rgba(0,0,0,${ck})`,`${g[4]}px ${g[5]}px ${g[6]}px ${g[7]}px rgba(0,0,0,${Ak})`,`${g[8]}px ${g[9]}px ${g[10]}px ${g[11]}px rgba(0,0,0,${dk})`].join(",")}const uk=["none",le(0,2,1,-1,0,1,1,0,0,1,3,0),le(0,3,1,-2,0,2,2,0,0,1,5,0),le(0,3,3,-2,0,3,4,0,0,1,8,0),le(0,2,4,-1,0,4,5,0,0,1,10,0),le(0,3,5,-1,0,5,8,0,0,1,14,0),le(0,3,5,-1,0,6,10,0,0,1,18,0),le(0,4,5,-2,0,7,10,1,0,2,16,1),le(0,5,5,-3,0,8,10,1,0,3,14,2),le(0,5,6,-3,0,9,12,1,0,3,16,2),le(0,6,6,-3,0,10,14,1,0,4,18,3),le(0,6,7,-4,0,11,15,1,0,4,20,3),le(0,7,8,-4,0,12,17,2,0,5,22,4),le(0,7,8,-4,0,13,19,2,0,5,24,4),le(0,7,9,-4,0,14,21,2,0,5,26,4),le(0,8,9,-5,0,15,22,2,0,6,28,5),le(0,8,10,-5,0,16,24,2,0,6,30,5),le(0,8,11,-5,0,17,26,2,0,6,32,5),le(0,9,11,-5,0,18,28,2,0,7,34,6),le(0,9,12,-6,0,19,29,2,0,7,36,6),le(0,10,13,-6,0,20,31,3,0,8,38,7),le(0,10,13,-6,0,21,33,3,0,8,40,7),le(0,10,14,-6,0,22,35,3,0,8,42,7),le(0,11,14,-7,0,23,36,3,0,9,44,8),le(0,11,15,-7,0,24,38,3,0,9,46,8)],mk={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Zk={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function qZ(g){return`${Math.round(g)}ms`}function bk(g){if(!g)return 0;const e=g/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function Gk(g){const e={...mk,...g.easing},I={...Zk,...g.duration};return{getAutoHeightDuration:bk,create:(C=["all"],l={})=>{const{duration:n=I.standard,easing:o=e.easeInOut,delay:r=0,...a}=l;return(Array.isArray(C)?C:[C]).map(i=>`${i} ${typeof n=="string"?n:qZ(n)} ${o} ${typeof r=="string"?r:qZ(r)}`).join(",")},...g,easing:e,duration:I}}const pk={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function GA(g={},...e){const{breakpoints:I,mixins:t={},spacing:C,palette:l={},transitions:n={},typography:o={},shape:r,...a}=g;if(g.vars)throw new Error(Ut(20));const i=tu(l),c=_d(g);let A=je(c,{mixins:ak(c.breakpoints,t),palette:i,shadows:uk.slice(),typography:sk(i,o),transitions:Gk(n),zIndex:{...pk}});return A=je(A,a),A=e.reduce((p,G)=>je(p,G),A),A.unstable_sxConfig={...Eo,...a==null?void 0:a.unstable_sxConfig},A.unstable_sx=function(G){return zo({sx:G,theme:this})},A}function pA(g){let e;return g<1?e=5.11916*g**2:e=4.5*Math.log(g+1)+2,Math.round(e*10)/1e3}const hk=[...Array(25)].map((g,e)=>{if(e===0)return"none";const I=pA(e);return`linear-gradient(rgba(255 255 255 / ${I}), rgba(255 255 255 / ${I}))`});function wh(g){return{inputPlaceholder:g==="dark"?.5:.42,inputUnderline:g==="dark"?.7:.42,switchTrackDisabled:g==="dark"?.2:.12,switchTrack:g==="dark"?.3:.38}}function Nh(g){return g==="dark"?hk:[]}function yk(g){const{palette:e={mode:"light"},opacity:I,overlays:t,...C}=g,l=tu(e);return{palette:l,opacity:{...wh(l.mode),...I},overlays:t||Nh(l.mode),...C}}function Bk(g){var e;return!!g[0].match(/(cssVarPrefix|colorSchemeSelector|typography|mixins|breakpoints|direction|transitions)/)||!!g[0].match(/sxConfig$/)||g[0]==="palette"&&!!((e=g[1])!=null&&e.match(/(mode|contrastThreshold|tonalOffset)/))}const Sk=g=>[...[...Array(25)].map((e,I)=>`--${g?`${g}-`:""}overlays-${I}`),`--${g?`${g}-`:""}palette-AppBar-darkBg`,`--${g?`${g}-`:""}palette-AppBar-darkColor`],Wk=g=>(e,I)=>{const t=g.colorSchemeSelector;let C=t;if(t==="class"&&(C=".%s"),t==="data"&&(C="[data-%s]"),t!=null&&t.startsWith("data-")&&!t.includes("%s")&&(C=`[${t}="%s"]`),g.defaultColorScheme===e){if(e==="dark"){const l={};return Sk(g.cssVarPrefix).forEach(n=>{l[n]=I[n],delete I[n]}),C==="media"?{":root":I,"@media (prefers-color-scheme: dark)":{":root":l}}:C?{[C.replace("%s",e)]:l,[`:root, ${C.replace("%s",e)}`]:I}:{":root":{...I,...l}}}if(C&&C!=="media")return`:root, ${C.replace("%s",String(e))}`}else if(e){if(C==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{":root":I}};if(C)return C.replace("%s",String(e))}return":root"};function Vk(g){return bt(g)||typeof g>"u"||typeof g=="string"||typeof g=="boolean"||typeof g=="number"||Array.isArray(g)}function Rk(g={}){const e={...g};function I(t){const C=Object.entries(t);for(let l=0;l<C.length;l++){const[n,o]=C[l];!Vk(o)||n.startsWith("unstable_")?delete t[n]:bt(o)&&(t[n]={...o},I(t[n]))}}return I(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function fk(g,e){e.forEach(I=>{g[I]||(g[I]={})})}function N(g,e,I){!g[e]&&I&&(g[e]=I)}function vn(g){return!g||!g.startsWith("hsl")?g:Vh(g)}function Jt(g,e){`${e}Channel`in g||(g[`${e}Channel`]=kn(vn(g[e]),`MUI: Can't create \`palette.${e}Channel\` because \`palette.${e}\` is not one of these formats: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color().
To suppress this warning, you need to explicitly provide the \`palette.${e}Channel\` as a string (in rgb format, for example "12 12 12") or undefined if you want to remove the channel token.`))}function Xk(g){return typeof g=="number"?`${g}px`:typeof g=="string"||typeof g=="function"||Array.isArray(g)?g:"8px"}const ct=g=>{try{return g()}catch{}},Jk=(g="mui")=>q2(g);function Ic(g,e,I,t){if(!e)return;e=e===!0?{}:e;const C=t==="dark"?"dark":"light";if(!I){g[t]=yk({...e,palette:{mode:C,...e==null?void 0:e.palette}});return}const{palette:l,...n}=GA({...I,palette:{mode:C,...e==null?void 0:e.palette}});return g[t]={...e,palette:l,opacity:{...wh(C),...e==null?void 0:e.opacity},overlays:(e==null?void 0:e.overlays)||Nh(C)},n}function kk(g={},...e){const{colorSchemes:I={light:!0},defaultColorScheme:t,disableCssColorScheme:C=!1,cssVarPrefix:l="mui",shouldSkipGeneratingVar:n=Bk,colorSchemeSelector:o=I.light&&I.dark?"media":void 0,...r}=g,a=Object.keys(I)[0],i=t||(I.light&&a!=="light"?"light":a),c=Jk(l),{[i]:A,light:p,dark:G,...Z}=I,h={...Z};let u=A;if((i==="dark"&&!("dark"in I)||i==="light"&&!("light"in I))&&(u=!0),!u)throw new Error(Ut(21,i));const b=Ic(h,u,r,i);p&&!h.light&&Ic(h,p,void 0,"light"),G&&!h.dark&&Ic(h,G,void 0,"dark");let m={defaultColorScheme:i,...b,cssVarPrefix:l,colorSchemeSelector:o,getCssVar:c,colorSchemes:h,font:{...rk(b.typography),...b.font},spacing:Xk(r.spacing)};Object.keys(m.colorSchemes).forEach(S=>{const y=m.colorSchemes[S].palette,f=k=>{const H=k.split("-"),M=H[1],F=H[2];return c(k,y[M][F])};if(y.mode==="light"&&(N(y.common,"background","#fff"),N(y.common,"onBackground","#000")),y.mode==="dark"&&(N(y.common,"background","#000"),N(y.common,"onBackground","#fff")),fk(y,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),y.mode==="light"){N(y.Alert,"errorColor",Og(y.error.light,.6)),N(y.Alert,"infoColor",Og(y.info.light,.6)),N(y.Alert,"successColor",Og(y.success.light,.6)),N(y.Alert,"warningColor",Og(y.warning.light,.6)),N(y.Alert,"errorFilledBg",f("palette-error-main")),N(y.Alert,"infoFilledBg",f("palette-info-main")),N(y.Alert,"successFilledBg",f("palette-success-main")),N(y.Alert,"warningFilledBg",f("palette-warning-main")),N(y.Alert,"errorFilledColor",ct(()=>y.getContrastText(y.error.main))),N(y.Alert,"infoFilledColor",ct(()=>y.getContrastText(y.info.main))),N(y.Alert,"successFilledColor",ct(()=>y.getContrastText(y.success.main))),N(y.Alert,"warningFilledColor",ct(()=>y.getContrastText(y.warning.main))),N(y.Alert,"errorStandardBg",qg(y.error.light,.9)),N(y.Alert,"infoStandardBg",qg(y.info.light,.9)),N(y.Alert,"successStandardBg",qg(y.success.light,.9)),N(y.Alert,"warningStandardBg",qg(y.warning.light,.9)),N(y.Alert,"errorIconColor",f("palette-error-main")),N(y.Alert,"infoIconColor",f("palette-info-main")),N(y.Alert,"successIconColor",f("palette-success-main")),N(y.Alert,"warningIconColor",f("palette-warning-main")),N(y.AppBar,"defaultBg",f("palette-grey-100")),N(y.Avatar,"defaultBg",f("palette-grey-400")),N(y.Button,"inheritContainedBg",f("palette-grey-300")),N(y.Button,"inheritContainedHoverBg",f("palette-grey-A100")),N(y.Chip,"defaultBorder",f("palette-grey-400")),N(y.Chip,"defaultAvatarColor",f("palette-grey-700")),N(y.Chip,"defaultIconColor",f("palette-grey-700")),N(y.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),N(y.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),N(y.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),N(y.LinearProgress,"primaryBg",qg(y.primary.main,.62)),N(y.LinearProgress,"secondaryBg",qg(y.secondary.main,.62)),N(y.LinearProgress,"errorBg",qg(y.error.main,.62)),N(y.LinearProgress,"infoBg",qg(y.info.main,.62)),N(y.LinearProgress,"successBg",qg(y.success.main,.62)),N(y.LinearProgress,"warningBg",qg(y.warning.main,.62)),N(y.Skeleton,"bg",`rgba(${f("palette-text-primaryChannel")} / 0.11)`),N(y.Slider,"primaryTrack",qg(y.primary.main,.62)),N(y.Slider,"secondaryTrack",qg(y.secondary.main,.62)),N(y.Slider,"errorTrack",qg(y.error.main,.62)),N(y.Slider,"infoTrack",qg(y.info.main,.62)),N(y.Slider,"successTrack",qg(y.success.main,.62)),N(y.Slider,"warningTrack",qg(y.warning.main,.62));const k=yr(y.background.default,.8);N(y.SnackbarContent,"bg",k),N(y.SnackbarContent,"color",ct(()=>y.getContrastText(k))),N(y.SpeedDialAction,"fabHoverBg",yr(y.background.paper,.15)),N(y.StepConnector,"border",f("palette-grey-400")),N(y.StepContent,"border",f("palette-grey-400")),N(y.Switch,"defaultColor",f("palette-common-white")),N(y.Switch,"defaultDisabledColor",f("palette-grey-100")),N(y.Switch,"primaryDisabledColor",qg(y.primary.main,.62)),N(y.Switch,"secondaryDisabledColor",qg(y.secondary.main,.62)),N(y.Switch,"errorDisabledColor",qg(y.error.main,.62)),N(y.Switch,"infoDisabledColor",qg(y.info.main,.62)),N(y.Switch,"successDisabledColor",qg(y.success.main,.62)),N(y.Switch,"warningDisabledColor",qg(y.warning.main,.62)),N(y.TableCell,"border",qg(hr(y.divider,1),.88)),N(y.Tooltip,"bg",hr(y.grey[700],.92))}if(y.mode==="dark"){N(y.Alert,"errorColor",qg(y.error.light,.6)),N(y.Alert,"infoColor",qg(y.info.light,.6)),N(y.Alert,"successColor",qg(y.success.light,.6)),N(y.Alert,"warningColor",qg(y.warning.light,.6)),N(y.Alert,"errorFilledBg",f("palette-error-dark")),N(y.Alert,"infoFilledBg",f("palette-info-dark")),N(y.Alert,"successFilledBg",f("palette-success-dark")),N(y.Alert,"warningFilledBg",f("palette-warning-dark")),N(y.Alert,"errorFilledColor",ct(()=>y.getContrastText(y.error.dark))),N(y.Alert,"infoFilledColor",ct(()=>y.getContrastText(y.info.dark))),N(y.Alert,"successFilledColor",ct(()=>y.getContrastText(y.success.dark))),N(y.Alert,"warningFilledColor",ct(()=>y.getContrastText(y.warning.dark))),N(y.Alert,"errorStandardBg",Og(y.error.light,.9)),N(y.Alert,"infoStandardBg",Og(y.info.light,.9)),N(y.Alert,"successStandardBg",Og(y.success.light,.9)),N(y.Alert,"warningStandardBg",Og(y.warning.light,.9)),N(y.Alert,"errorIconColor",f("palette-error-main")),N(y.Alert,"infoIconColor",f("palette-info-main")),N(y.Alert,"successIconColor",f("palette-success-main")),N(y.Alert,"warningIconColor",f("palette-warning-main")),N(y.AppBar,"defaultBg",f("palette-grey-900")),N(y.AppBar,"darkBg",f("palette-background-paper")),N(y.AppBar,"darkColor",f("palette-text-primary")),N(y.Avatar,"defaultBg",f("palette-grey-600")),N(y.Button,"inheritContainedBg",f("palette-grey-800")),N(y.Button,"inheritContainedHoverBg",f("palette-grey-700")),N(y.Chip,"defaultBorder",f("palette-grey-700")),N(y.Chip,"defaultAvatarColor",f("palette-grey-300")),N(y.Chip,"defaultIconColor",f("palette-grey-300")),N(y.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),N(y.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),N(y.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),N(y.LinearProgress,"primaryBg",Og(y.primary.main,.5)),N(y.LinearProgress,"secondaryBg",Og(y.secondary.main,.5)),N(y.LinearProgress,"errorBg",Og(y.error.main,.5)),N(y.LinearProgress,"infoBg",Og(y.info.main,.5)),N(y.LinearProgress,"successBg",Og(y.success.main,.5)),N(y.LinearProgress,"warningBg",Og(y.warning.main,.5)),N(y.Skeleton,"bg",`rgba(${f("palette-text-primaryChannel")} / 0.13)`),N(y.Slider,"primaryTrack",Og(y.primary.main,.5)),N(y.Slider,"secondaryTrack",Og(y.secondary.main,.5)),N(y.Slider,"errorTrack",Og(y.error.main,.5)),N(y.Slider,"infoTrack",Og(y.info.main,.5)),N(y.Slider,"successTrack",Og(y.success.main,.5)),N(y.Slider,"warningTrack",Og(y.warning.main,.5));const k=yr(y.background.default,.98);N(y.SnackbarContent,"bg",k),N(y.SnackbarContent,"color",ct(()=>y.getContrastText(k))),N(y.SpeedDialAction,"fabHoverBg",yr(y.background.paper,.15)),N(y.StepConnector,"border",f("palette-grey-600")),N(y.StepContent,"border",f("palette-grey-600")),N(y.Switch,"defaultColor",f("palette-grey-300")),N(y.Switch,"defaultDisabledColor",f("palette-grey-600")),N(y.Switch,"primaryDisabledColor",Og(y.primary.main,.55)),N(y.Switch,"secondaryDisabledColor",Og(y.secondary.main,.55)),N(y.Switch,"errorDisabledColor",Og(y.error.main,.55)),N(y.Switch,"infoDisabledColor",Og(y.info.main,.55)),N(y.Switch,"successDisabledColor",Og(y.success.main,.55)),N(y.Switch,"warningDisabledColor",Og(y.warning.main,.55)),N(y.TableCell,"border",Og(hr(y.divider,1),.68)),N(y.Tooltip,"bg",hr(y.grey[700],.92))}Jt(y.background,"default"),Jt(y.background,"paper"),Jt(y.common,"background"),Jt(y.common,"onBackground"),Jt(y,"divider"),Object.keys(y).forEach(k=>{const H=y[k];H&&typeof H=="object"&&(H.main&&N(y[k],"mainChannel",kn(vn(H.main))),H.light&&N(y[k],"lightChannel",kn(vn(H.light))),H.dark&&N(y[k],"darkChannel",kn(vn(H.dark))),H.contrastText&&N(y[k],"contrastTextChannel",kn(vn(H.contrastText))),k==="text"&&(Jt(y[k],"primary"),Jt(y[k],"secondary")),k==="action"&&(H.active&&Jt(y[k],"active"),H.selected&&Jt(y[k],"selected")))})}),m=e.reduce((S,y)=>je(S,y),m);const B={prefix:l,disableCssColorScheme:C,shouldSkipGeneratingVar:n,getSelector:Wk(m)},{vars:W,generateThemeVars:R,generateStyleSheets:V}=gk(m,B);return m.vars=W,Object.entries(m.colorSchemes[m.defaultColorScheme]).forEach(([S,y])=>{m[S]=y}),m.generateThemeVars=R,m.generateStyleSheets=V,m.generateSpacing=function(){return Bh(r.spacing,qd(this))},m.getColorSchemeSelector=ek(o),m.spacing=m.generateSpacing(),m.shouldSkipGeneratingVar=n,m.unstable_sxConfig={...Eo,...r==null?void 0:r.unstable_sxConfig},m.unstable_sx=function(y){return zo({sx:y,theme:this})},m.toRuntimeSource=Rk,m}function $Z(g,e,I){g.colorSchemes&&I&&(g.colorSchemes[e]={...I!==!0&&I,palette:tu({...I===!0?{}:I.palette,mode:e})})}function vk(g={},...e){const{palette:I,cssVariables:t=!1,colorSchemes:C=I?void 0:{light:!0},defaultColorScheme:l=I==null?void 0:I.mode,...n}=g,o=l||"light",r=C==null?void 0:C[o],a={...C,...I?{[o]:{...typeof r!="boolean"&&r,palette:I}}:void 0};if(t===!1){if(!("colorSchemes"in g))return GA(g,...e);let i=I;"palette"in g||a[o]&&(a[o]!==!0?i=a[o].palette:o==="dark"&&(i={mode:"dark"}));const c=GA({...g,palette:i},...e);return c.defaultColorScheme=o,c.colorSchemes=a,c.palette.mode==="light"&&(c.colorSchemes.light={...a.light!==!0&&a.light,palette:c.palette},$Z(c,"dark",a.dark)),c.palette.mode==="dark"&&(c.colorSchemes.dark={...a.dark!==!0&&a.dark,palette:c.palette},$Z(c,"light",a.light)),c}return!I&&!("light"in a)&&o==="light"&&(a.light=!0),kk({...n,colorSchemes:a,defaultColorScheme:o,...typeof t!="boolean"&&t},...e)}const Ki=vk();function Uo(){const g=gu(Ki);return g[di]||g}function Fh({props:g,name:e}){return w2({props:g,name:e,defaultTheme:Ki,themeId:di})}function Kh(g){return g!=="ownerState"&&g!=="theme"&&g!=="sx"&&g!=="as"}const qe=g=>Kh(g)&&g!=="classes",j=J2({themeId:di,defaultTheme:Ki,rootShouldForwardProp:qe});function Yk(g){return s.jsx(B2,{...g,defaultTheme:Ki,themeId:di})}function Hk(g){return function(I){return s.jsx(Yk,{styles:typeof g=="function"?t=>g({theme:t,...I}):g})}}function wk(){return Sh}const _Z={theme:void 0};function Hg(g){let e,I;return t=>{let C=e;return(C===void 0||t.theme!==I)&&(_Z.theme=t.theme,C=g(_Z),e=C,I=t.theme),C}}function fg(g){return O2(g)}function Nk(g){return pg("MuiSvgIcon",g)}Gg("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Fk=g=>{const{color:e,fontSize:I,classes:t}=g,C={root:["root",e!=="inherit"&&`color${$(e)}`,`fontSize${$(I)}`]};return Sg(C,Nk,t)},Kk=j("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.color!=="inherit"&&e[`color${$(I.color)}`],e[`fontSize${$(I.fontSize)}`]]}})(Hg(({theme:g})=>{var e,I,t,C,l,n,o,r,a,i,c,A,p,G;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(C=(e=g.transitions)==null?void 0:e.create)==null?void 0:C.call(e,"fill",{duration:(t=(I=(g.vars??g).transitions)==null?void 0:I.duration)==null?void 0:t.shorter}),variants:[{props:Z=>!Z.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((n=(l=g.typography)==null?void 0:l.pxToRem)==null?void 0:n.call(l,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((r=(o=g.typography)==null?void 0:o.pxToRem)==null?void 0:r.call(o,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((i=(a=g.typography)==null?void 0:a.pxToRem)==null?void 0:i.call(a,35))||"2.1875rem"}},...Object.entries((g.vars??g).palette).filter(([,Z])=>Z&&Z.main).map(([Z])=>{var h,u;return{props:{color:Z},style:{color:(u=(h=(g.vars??g).palette)==null?void 0:h[Z])==null?void 0:u.main}}}),{props:{color:"action"},style:{color:(A=(c=(g.vars??g).palette)==null?void 0:c.action)==null?void 0:A.active}},{props:{color:"disabled"},style:{color:(G=(p=(g.vars??g).palette)==null?void 0:p.action)==null?void 0:G.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),Ra=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiSvgIcon"}),{children:C,className:l,color:n="inherit",component:o="svg",fontSize:r="medium",htmlColor:a,inheritViewBox:i=!1,titleAccess:c,viewBox:A="0 0 24 24",...p}=t,G=d.isValidElement(C)&&C.type==="svg",Z={...t,color:n,component:o,fontSize:r,instanceFontSize:e.fontSize,inheritViewBox:i,viewBox:A,hasSvgAsChild:G},h={};i||(h.viewBox=A);const u=Fk(Z);return s.jsxs(Kk,{as:o,className:og(u.root,l),focusable:"false",color:a,"aria-hidden":c?void 0:!0,role:c?"img":void 0,ref:I,...h,...p,...G&&C.props,ownerState:Z,children:[G?C.props.children:C,c?s.jsx("title",{children:c}):null]})});Ra&&(Ra.muiName="SvgIcon");function te(g,e){function I(t,C){return s.jsx(Ra,{"data-testid":`${e}Icon`,ref:C,...t,children:g})}return I.muiName=Ra.muiName,d.memo(d.forwardRef(I))}var Tg={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cu=Symbol.for("react.element"),lu=Symbol.for("react.portal"),xi=Symbol.for("react.fragment"),Ei=Symbol.for("react.strict_mode"),zi=Symbol.for("react.profiler"),Mi=Symbol.for("react.provider"),Ui=Symbol.for("react.context"),xk=Symbol.for("react.server_context"),Li=Symbol.for("react.forward_ref"),Qi=Symbol.for("react.suspense"),Ti=Symbol.for("react.suspense_list"),Di=Symbol.for("react.memo"),ji=Symbol.for("react.lazy"),Ek=Symbol.for("react.offscreen"),xh;xh=Symbol.for("react.module.reference");function PI(g){if(typeof g=="object"&&g!==null){var e=g.$$typeof;switch(e){case Cu:switch(g=g.type,g){case xi:case zi:case Ei:case Qi:case Ti:return g;default:switch(g=g&&g.$$typeof,g){case xk:case Ui:case Li:case ji:case Di:case Mi:return g;default:return e}}case lu:return e}}}Tg.ContextConsumer=Ui;Tg.ContextProvider=Mi;Tg.Element=Cu;Tg.ForwardRef=Li;Tg.Fragment=xi;Tg.Lazy=ji;Tg.Memo=Di;Tg.Portal=lu;Tg.Profiler=zi;Tg.StrictMode=Ei;Tg.Suspense=Qi;Tg.SuspenseList=Ti;Tg.isAsyncMode=function(){return!1};Tg.isConcurrentMode=function(){return!1};Tg.isContextConsumer=function(g){return PI(g)===Ui};Tg.isContextProvider=function(g){return PI(g)===Mi};Tg.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===Cu};Tg.isForwardRef=function(g){return PI(g)===Li};Tg.isFragment=function(g){return PI(g)===xi};Tg.isLazy=function(g){return PI(g)===ji};Tg.isMemo=function(g){return PI(g)===Di};Tg.isPortal=function(g){return PI(g)===lu};Tg.isProfiler=function(g){return PI(g)===zi};Tg.isStrictMode=function(g){return PI(g)===Ei};Tg.isSuspense=function(g){return PI(g)===Qi};Tg.isSuspenseList=function(g){return PI(g)===Ti};Tg.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===xi||g===zi||g===Ei||g===Qi||g===Ti||g===Ek||typeof g=="object"&&g!==null&&(g.$$typeof===ji||g.$$typeof===Di||g.$$typeof===Mi||g.$$typeof===Ui||g.$$typeof===Li||g.$$typeof===xh||g.getModuleId!==void 0)};Tg.typeOf=PI;function nu(g,e){if(g==null)return{};var I={};for(var t in g)if({}.hasOwnProperty.call(g,t)){if(e.includes(t))continue;I[t]=g[t]}return I}function hA(g,e){return hA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(I,t){return I.__proto__=t,I},hA(g,e)}function Eh(g,e){g.prototype=Object.create(e.prototype),g.prototype.constructor=g,hA(g,e)}const gb={disabled:!1},fa=tt.createContext(null);var zk=function(e){return e.scrollTop},Yn="unmounted",RC="exited",fC="entering",al="entered",yA="exiting",Wt=function(g){Eh(e,g);function e(t,C){var l;l=g.call(this,t,C)||this;var n=C,o=n&&!n.isMounting?t.enter:t.appear,r;return l.appearStatus=null,t.in?o?(r=RC,l.appearStatus=fC):r=al:t.unmountOnExit||t.mountOnEnter?r=Yn:r=RC,l.state={status:r},l.nextCallback=null,l}e.getDerivedStateFromProps=function(C,l){var n=C.in;return n&&l.status===Yn?{status:RC}:null};var I=e.prototype;return I.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},I.componentDidUpdate=function(C){var l=null;if(C!==this.props){var n=this.state.status;this.props.in?n!==fC&&n!==al&&(l=fC):(n===fC||n===al)&&(l=yA)}this.updateStatus(!1,l)},I.componentWillUnmount=function(){this.cancelNextCallback()},I.getTimeouts=function(){var C=this.props.timeout,l,n,o;return l=n=o=C,C!=null&&typeof C!="number"&&(l=C.exit,n=C.enter,o=C.appear!==void 0?C.appear:n),{exit:l,enter:n,appear:o}},I.updateStatus=function(C,l){if(C===void 0&&(C=!1),l!==null)if(this.cancelNextCallback(),l===fC){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:Xn.findDOMNode(this);n&&zk(n)}this.performEnter(C)}else this.performExit();else this.props.unmountOnExit&&this.state.status===RC&&this.setState({status:Yn})},I.performEnter=function(C){var l=this,n=this.props.enter,o=this.context?this.context.isMounting:C,r=this.props.nodeRef?[o]:[Xn.findDOMNode(this),o],a=r[0],i=r[1],c=this.getTimeouts(),A=o?c.appear:c.enter;if(!C&&!n||gb.disabled){this.safeSetState({status:al},function(){l.props.onEntered(a)});return}this.props.onEnter(a,i),this.safeSetState({status:fC},function(){l.props.onEntering(a,i),l.onTransitionEnd(A,function(){l.safeSetState({status:al},function(){l.props.onEntered(a,i)})})})},I.performExit=function(){var C=this,l=this.props.exit,n=this.getTimeouts(),o=this.props.nodeRef?void 0:Xn.findDOMNode(this);if(!l||gb.disabled){this.safeSetState({status:RC},function(){C.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:yA},function(){C.props.onExiting(o),C.onTransitionEnd(n.exit,function(){C.safeSetState({status:RC},function(){C.props.onExited(o)})})})},I.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},I.safeSetState=function(C,l){l=this.setNextCallback(l),this.setState(C,l)},I.setNextCallback=function(C){var l=this,n=!0;return this.nextCallback=function(o){n&&(n=!1,l.nextCallback=null,C(o))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},I.onTransitionEnd=function(C,l){this.setNextCallback(l);var n=this.props.nodeRef?this.props.nodeRef.current:Xn.findDOMNode(this),o=C==null&&!this.props.addEndListener;if(!n||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var r=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],a=r[0],i=r[1];this.props.addEndListener(a,i)}C!=null&&setTimeout(this.nextCallback,C)},I.render=function(){var C=this.state.status;if(C===Yn)return null;var l=this.props,n=l.children;l.in,l.mountOnEnter,l.unmountOnExit,l.appear,l.enter,l.exit,l.timeout,l.addEndListener,l.onEnter,l.onEntering,l.onEntered,l.onExit,l.onExiting,l.onExited,l.nodeRef;var o=nu(l,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return tt.createElement(fa.Provider,{value:null},typeof n=="function"?n(C,o):tt.cloneElement(tt.Children.only(n),o))},e}(tt.Component);Wt.contextType=fa;Wt.propTypes={};function nl(){}Wt.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:nl,onEntering:nl,onEntered:nl,onExit:nl,onExiting:nl,onExited:nl};Wt.UNMOUNTED=Yn;Wt.EXITED=RC;Wt.ENTERING=fC;Wt.ENTERED=al;Wt.EXITING=yA;function Mk(g){if(g===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}function ou(g,e){var I=function(l){return e&&d.isValidElement(l)?e(l):l},t=Object.create(null);return g&&d.Children.map(g,function(C){return C}).forEach(function(C){t[C.key]=I(C)}),t}function Uk(g,e){g=g||{},e=e||{};function I(i){return i in e?e[i]:g[i]}var t=Object.create(null),C=[];for(var l in g)l in e?C.length&&(t[l]=C,C=[]):C.push(l);var n,o={};for(var r in e){if(t[r])for(n=0;n<t[r].length;n++){var a=t[r][n];o[t[r][n]]=I(a)}o[r]=I(r)}for(n=0;n<C.length;n++)o[C[n]]=I(C[n]);return o}function NC(g,e,I){return I[e]!=null?I[e]:g.props[e]}function Lk(g,e){return ou(g.children,function(I){return d.cloneElement(I,{onExited:e.bind(null,I),in:!0,appear:NC(I,"appear",g),enter:NC(I,"enter",g),exit:NC(I,"exit",g)})})}function Qk(g,e,I){var t=ou(g.children),C=Uk(e,t);return Object.keys(C).forEach(function(l){var n=C[l];if(d.isValidElement(n)){var o=l in e,r=l in t,a=e[l],i=d.isValidElement(a)&&!a.props.in;r&&(!o||i)?C[l]=d.cloneElement(n,{onExited:I.bind(null,n),in:!0,exit:NC(n,"exit",g),enter:NC(n,"enter",g)}):!r&&o&&!i?C[l]=d.cloneElement(n,{in:!1}):r&&o&&d.isValidElement(a)&&(C[l]=d.cloneElement(n,{onExited:I.bind(null,n),in:a.props.in,exit:NC(n,"exit",g),enter:NC(n,"enter",g)}))}}),C}var Tk=Object.values||function(g){return Object.keys(g).map(function(e){return g[e]})},Dk={component:"div",childFactory:function(e){return e}},ru=function(g){Eh(e,g);function e(t,C){var l;l=g.call(this,t,C)||this;var n=l.handleExited.bind(Mk(l));return l.state={contextValue:{isMounting:!0},handleExited:n,firstRender:!0},l}var I=e.prototype;return I.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},I.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(C,l){var n=l.children,o=l.handleExited,r=l.firstRender;return{children:r?Lk(C,o):Qk(C,n,o),firstRender:!1}},I.handleExited=function(C,l){var n=ou(this.props.children);C.key in n||(C.props.onExited&&C.props.onExited(l),this.mounted&&this.setState(function(o){var r=bo({},o.children);return delete r[C.key],{children:r}}))},I.render=function(){var C=this.props,l=C.component,n=C.childFactory,o=nu(C,["component","childFactory"]),r=this.state.contextValue,a=Tk(this.state.children).map(n);return delete o.appear,delete o.enter,delete o.exit,l===null?tt.createElement(fa.Provider,{value:r},a):tt.createElement(fa.Provider,{value:r},tt.createElement(l,o,a))},e}(tt.Component);ru.propTypes={};ru.defaultProps=Dk;const zh=g=>g.scrollTop;function Xa(g,e){const{timeout:I,easing:t,style:C={}}=g;return{duration:C.transitionDuration??(typeof I=="number"?I:I[e.mode]||0),easing:C.transitionTimingFunction??(typeof t=="object"?t[e.mode]:t),delay:C.transitionDelay}}function jk(g){return pg("MuiPaper",g)}Gg("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Pk=g=>{const{square:e,elevation:I,variant:t,classes:C}=g,l={root:["root",t,!e&&"rounded",t==="elevation"&&`elevation${I}`]};return Sg(l,jk,C)},Ok=j("div",{name:"MuiPaper",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,e[I.variant],!I.square&&e.rounded,I.variant==="elevation"&&e[`elevation${I.elevation}`]]}})(Hg(({theme:g})=>({backgroundColor:(g.vars||g).palette.background.paper,color:(g.vars||g).palette.text.primary,transition:g.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:g.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(g.vars||g).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),Vt=d.forwardRef(function(e,I){var p;const t=fg({props:e,name:"MuiPaper"}),C=Uo(),{className:l,component:n="div",elevation:o=1,square:r=!1,variant:a="elevation",...i}=t,c={...t,component:n,elevation:o,square:r,variant:a},A=Pk(c);return s.jsx(Ok,{as:n,ownerState:c,className:og(A.root,l),ref:I,...i,style:{...a==="elevation"&&{"--Paper-shadow":(C.vars||C).shadows[o],...C.vars&&{"--Paper-overlay":(p=C.vars.overlays)==null?void 0:p[o]},...!C.vars&&C.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Ze("#fff",pA(o))}, ${Ze("#fff",pA(o))})`}},...i.style}})});function oI(g,e){const{className:I,elementType:t,ownerState:C,externalForwardedProps:l,getSlotOwnerState:n,internalForwardedProps:o,...r}=e,{component:a,slots:i={[g]:void 0},slotProps:c={[g]:void 0},...A}=l,p=i[g]||t,G=Hh(c[g],C),{props:{component:Z,...h},internalRef:u}=Yh({className:I,...r,externalForwardedProps:g==="root"?A:void 0,externalSlotProps:G}),b=ve(u,G==null?void 0:G.ref,e.ref),m=n?n(h):{},B={...C,...m},W=g==="root"?Z||a:Z,R=kh(p,{...g==="root"&&!a&&!i[g]&&o,...g!=="root"&&!i[g]&&o,...h,...W&&{as:W},ref:b},B);return Object.keys(m).forEach(V=>{delete R[V]}),[p,R]}class Ja{constructor(){Cn(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new Ja}static use(){const e=fh(Ja.create).current,[I,t]=d.useState(!1);return e.shouldMount=I,e.setShouldMount=t,d.useEffect(e.mountEffect,[I]),e}mount(){return this.mounted||(this.mounted=$k(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...e){this.mount().then(()=>{var I;return(I=this.ref.current)==null?void 0:I.start(...e)})}stop(...e){this.mount().then(()=>{var I;return(I=this.ref.current)==null?void 0:I.stop(...e)})}pulsate(...e){this.mount().then(()=>{var I;return(I=this.ref.current)==null?void 0:I.pulsate(...e)})}}function qk(){return Ja.use()}function $k(){let g,e;const I=new Promise((t,C)=>{g=t,e=C});return I.resolve=g,I.reject=e,I}function _k(g){const{className:e,classes:I,pulsate:t=!1,rippleX:C,rippleY:l,rippleSize:n,in:o,onExited:r,timeout:a}=g,[i,c]=d.useState(!1),A=og(e,I.ripple,I.rippleVisible,t&&I.ripplePulsate),p={width:n,height:n,top:-(n/2)+l,left:-(n/2)+C},G=og(I.child,i&&I.childLeaving,t&&I.childPulsate);return!o&&!i&&c(!0),d.useEffect(()=>{if(!o&&r!=null){const Z=setTimeout(r,a);return()=>{clearTimeout(Z)}}},[r,o,a]),s.jsx("span",{className:A,style:p,children:s.jsx("span",{className:G})})}const xI=Gg("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),BA=550,gv=80,ev=Fo`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,Iv=Fo`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,tv=Fo`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,Cv=j("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),lv=j(_k,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${xI.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${ev};
    animation-duration: ${BA}ms;
    animation-timing-function: ${({theme:g})=>g.transitions.easing.easeInOut};
  }

  &.${xI.ripplePulsate} {
    animation-duration: ${({theme:g})=>g.transitions.duration.shorter}ms;
  }

  & .${xI.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${xI.childLeaving} {
    opacity: 0;
    animation-name: ${Iv};
    animation-duration: ${BA}ms;
    animation-timing-function: ${({theme:g})=>g.transitions.easing.easeInOut};
  }

  & .${xI.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${tv};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:g})=>g.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,nv=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiTouchRipple"}),{center:C=!1,classes:l={},className:n,...o}=t,[r,a]=d.useState([]),i=d.useRef(0),c=d.useRef(null);d.useEffect(()=>{c.current&&(c.current(),c.current=null)},[r]);const A=d.useRef(!1),p=Xh(),G=d.useRef(null),Z=d.useRef(null),h=d.useCallback(B=>{const{pulsate:W,rippleX:R,rippleY:V,rippleSize:S,cb:y}=B;a(f=>[...f,s.jsx(lv,{classes:{ripple:og(l.ripple,xI.ripple),rippleVisible:og(l.rippleVisible,xI.rippleVisible),ripplePulsate:og(l.ripplePulsate,xI.ripplePulsate),child:og(l.child,xI.child),childLeaving:og(l.childLeaving,xI.childLeaving),childPulsate:og(l.childPulsate,xI.childPulsate)},timeout:BA,pulsate:W,rippleX:R,rippleY:V,rippleSize:S},i.current)]),i.current+=1,c.current=y},[l]),u=d.useCallback((B={},W={},R=()=>{})=>{const{pulsate:V=!1,center:S=C||W.pulsate,fakeElement:y=!1}=W;if((B==null?void 0:B.type)==="mousedown"&&A.current){A.current=!1;return}(B==null?void 0:B.type)==="touchstart"&&(A.current=!0);const f=y?null:Z.current,k=f?f.getBoundingClientRect():{width:0,height:0,left:0,top:0};let H,M,F;if(S||B===void 0||B.clientX===0&&B.clientY===0||!B.clientX&&!B.touches)H=Math.round(k.width/2),M=Math.round(k.height/2);else{const{clientX:x,clientY:L}=B.touches&&B.touches.length>0?B.touches[0]:B;H=Math.round(x-k.left),M=Math.round(L-k.top)}if(S)F=Math.sqrt((2*k.width**2+k.height**2)/3),F%2===0&&(F+=1);else{const x=Math.max(Math.abs((f?f.clientWidth:0)-H),H)*2+2,L=Math.max(Math.abs((f?f.clientHeight:0)-M),M)*2+2;F=Math.sqrt(x**2+L**2)}B!=null&&B.touches?G.current===null&&(G.current=()=>{h({pulsate:V,rippleX:H,rippleY:M,rippleSize:F,cb:R})},p.start(gv,()=>{G.current&&(G.current(),G.current=null)})):h({pulsate:V,rippleX:H,rippleY:M,rippleSize:F,cb:R})},[C,h,p]),b=d.useCallback(()=>{u({},{pulsate:!0})},[u]),m=d.useCallback((B,W)=>{if(p.clear(),(B==null?void 0:B.type)==="touchend"&&G.current){G.current(),G.current=null,p.start(0,()=>{m(B,W)});return}G.current=null,a(R=>R.length>0?R.slice(1):R),c.current=W},[p]);return d.useImperativeHandle(I,()=>({pulsate:b,start:u,stop:m}),[b,u,m]),s.jsx(Cv,{className:og(xI.root,l.root,n),ref:Z,...o,children:s.jsx(ru,{component:null,exit:!0,children:r})})});function ov(g){return pg("MuiButtonBase",g)}const rv=Gg("MuiButtonBase",["root","disabled","focusVisible"]),av=g=>{const{disabled:e,focusVisible:I,focusVisibleClassName:t,classes:C}=g,n=Sg({root:["root",e&&"disabled",I&&"focusVisible"]},ov,C);return I&&t&&(n.root+=` ${t}`),n},iv=j("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(g,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${rv.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Pi=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiButtonBase"}),{action:C,centerRipple:l=!1,children:n,className:o,component:r="button",disabled:a=!1,disableRipple:i=!1,disableTouchRipple:c=!1,focusRipple:A=!1,focusVisibleClassName:p,LinkComponent:G="a",onBlur:Z,onClick:h,onContextMenu:u,onDragLeave:b,onFocus:m,onFocusVisible:B,onKeyDown:W,onKeyUp:R,onMouseDown:V,onMouseLeave:S,onMouseUp:y,onTouchEnd:f,onTouchMove:k,onTouchStart:H,tabIndex:M=0,TouchRippleProps:F,touchRippleRef:x,type:L,...D}=t,Y=d.useRef(null),K=qk(),O=ve(K.ref,x),[lg,ag]=d.useState(!1);a&&lg&&ag(!1),d.useImperativeHandle(C,()=>({focusVisible:()=>{ag(!0),Y.current.focus()}}),[]);const ig=K.shouldMount&&!i&&!a;d.useEffect(()=>{lg&&A&&!i&&K.pulsate()},[i,A,lg,K]);function sg(U,mg,wg=c){return Bl(Zg=>(mg&&mg(Zg),wg||K[U](Zg),!0))}const eg=sg("start",V),q=sg("stop",u),E=sg("stop",b),Q=sg("stop",y),Cg=sg("stop",U=>{lg&&U.preventDefault(),S&&S(U)}),Ig=sg("start",H),cg=sg("stop",f),hg=sg("stop",k),se=sg("stop",U=>{UZ(U.target)||ag(!1),Z&&Z(U)},!1),Ag=Bl(U=>{Y.current||(Y.current=U.currentTarget),UZ(U.target)&&(ag(!0),B&&B(U)),m&&m(U)}),Jg=()=>{const U=Y.current;return r&&r!=="button"&&!(U.tagName==="A"&&U.href)},Ve=Bl(U=>{A&&!U.repeat&&lg&&U.key===" "&&K.stop(U,()=>{K.start(U)}),U.target===U.currentTarget&&Jg()&&U.key===" "&&U.preventDefault(),W&&W(U),U.target===U.currentTarget&&Jg()&&U.key==="Enter"&&!a&&(U.preventDefault(),h&&h(U))}),Me=Bl(U=>{A&&U.key===" "&&lg&&!U.defaultPrevented&&K.stop(U,()=>{K.pulsate(U)}),R&&R(U),h&&U.target===U.currentTarget&&Jg()&&U.key===" "&&!U.defaultPrevented&&h(U)});let jg=r;jg==="button"&&(D.href||D.to)&&(jg=G);const ce={};jg==="button"?(ce.type=L===void 0?"button":L,ce.disabled=a):(!D.href&&!D.to&&(ce.role="button"),a&&(ce["aria-disabled"]=a));const CI=ve(I,Y),xg={...t,centerRipple:l,component:r,disabled:a,disableRipple:i,disableTouchRipple:c,focusRipple:A,tabIndex:M,focusVisible:lg},ZI=av(xg);return s.jsxs(iv,{as:jg,className:og(ZI.root,o),ownerState:xg,onBlur:se,onClick:h,onContextMenu:q,onFocus:Ag,onKeyDown:Ve,onKeyUp:Me,onMouseDown:eg,onMouseLeave:Cg,onMouseUp:Q,onDragLeave:E,onTouchEnd:cg,onTouchMove:hg,onTouchStart:Ig,ref:CI,tabIndex:a?-1:M,type:L,...ce,...D,children:[n,ig?s.jsx(nv,{ref:O,center:l,...F}):null]})});function sv(g){return typeof g.main=="string"}function cv(g,e=[]){if(!sv(g))return!1;for(const I of e)if(!g.hasOwnProperty(I)||typeof g[I]!="string")return!1;return!0}function Pe(g=[]){return([,e])=>e&&cv(e,g)}function Av(g){return pg("MuiAlert",g)}const eb=Gg("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);function dv(g){return pg("MuiIconButton",g)}const uv=Gg("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),mv=g=>{const{classes:e,disabled:I,color:t,edge:C,size:l}=g,n={root:["root",I&&"disabled",t!=="default"&&`color${$(t)}`,C&&`edge${$(C)}`,`size${$(l)}`]};return Sg(n,dv,e)},Zv=j(Pi,{name:"MuiIconButton",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.color!=="default"&&e[`color${$(I.color)}`],I.edge&&e[`edge${$(I.edge)}`],e[`size${$(I.size)}`]]}})(Hg(({theme:g})=>({textAlign:"center",flex:"0 0 auto",fontSize:g.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(g.vars||g).palette.action.active,transition:g.transitions.create("background-color",{duration:g.transitions.duration.shortest}),variants:[{props:{disableRipple:!1},style:{"&:hover":{backgroundColor:g.vars?`rgba(${g.vars.palette.action.activeChannel} / ${g.vars.palette.action.hoverOpacity})`:Ze(g.palette.action.active,g.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),Hg(({theme:g})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(g.palette).filter(Pe()).map(([e])=>({props:{color:e},style:{color:(g.vars||g).palette[e].main}})),...Object.entries(g.palette).filter(Pe()).map(([e])=>({props:{color:e,disableRipple:!1},style:{"&:hover":{backgroundColor:g.vars?`rgba(${(g.vars||g).palette[e].mainChannel} / ${g.vars.palette.action.hoverOpacity})`:Ze((g.vars||g).palette[e].main,g.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}})),{props:{size:"small"},style:{padding:5,fontSize:g.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:g.typography.pxToRem(28)}}],[`&.${uv.disabled}`]:{backgroundColor:"transparent",color:(g.vars||g).palette.action.disabled}}))),au=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiIconButton"}),{edge:C=!1,children:l,className:n,color:o="default",disabled:r=!1,disableFocusRipple:a=!1,disableRipple:i=!1,size:c="medium",...A}=t,p={...t,edge:C,color:o,disabled:r,disableFocusRipple:a,disableRipple:i,size:c},G=mv(p);return s.jsx(Zv,{className:og(G.root,n),centerRipple:!0,focusRipple:!a,disabled:r,disableRipple:i,ref:I,...A,ownerState:p,children:l})}),bv=te(s.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),Gv=te(s.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),pv=te(s.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),hv=te(s.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),yv=te(s.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Bv=g=>{const{variant:e,color:I,severity:t,classes:C}=g,l={root:["root",`color${$(I||t)}`,`${e}${$(I||t)}`,`${e}`],icon:["icon"],message:["message"],action:["action"]};return Sg(l,Av,C)},Sv=j(Vt,{name:"MuiAlert",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,e[I.variant],e[`${I.variant}${$(I.color||I.severity)}`]]}})(Hg(({theme:g})=>{const e=g.palette.mode==="light"?Ml:Ul,I=g.palette.mode==="light"?Ul:Ml;return{...g.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(g.palette).filter(Pe(["light"])).map(([t])=>({props:{colorSeverity:t,variant:"standard"},style:{color:g.vars?g.vars.palette.Alert[`${t}Color`]:e(g.palette[t].light,.6),backgroundColor:g.vars?g.vars.palette.Alert[`${t}StandardBg`]:I(g.palette[t].light,.9),[`& .${eb.icon}`]:g.vars?{color:g.vars.palette.Alert[`${t}IconColor`]}:{color:g.palette[t].main}}})),...Object.entries(g.palette).filter(Pe(["light"])).map(([t])=>({props:{colorSeverity:t,variant:"outlined"},style:{color:g.vars?g.vars.palette.Alert[`${t}Color`]:e(g.palette[t].light,.6),border:`1px solid ${(g.vars||g).palette[t].light}`,[`& .${eb.icon}`]:g.vars?{color:g.vars.palette.Alert[`${t}IconColor`]}:{color:g.palette[t].main}}})),...Object.entries(g.palette).filter(Pe(["dark"])).map(([t])=>({props:{colorSeverity:t,variant:"filled"},style:{fontWeight:g.typography.fontWeightMedium,...g.vars?{color:g.vars.palette.Alert[`${t}FilledColor`],backgroundColor:g.vars.palette.Alert[`${t}FilledBg`]}:{backgroundColor:g.palette.mode==="dark"?g.palette[t].dark:g.palette[t].main,color:g.palette.getContrastText(g.palette[t].main)}}}))]}})),Wv=j("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(g,e)=>e.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),Vv=j("div",{name:"MuiAlert",slot:"Message",overridesResolver:(g,e)=>e.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),Ib=j("div",{name:"MuiAlert",slot:"Action",overridesResolver:(g,e)=>e.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),tb={success:s.jsx(bv,{fontSize:"inherit"}),warning:s.jsx(Gv,{fontSize:"inherit"}),error:s.jsx(pv,{fontSize:"inherit"}),info:s.jsx(hv,{fontSize:"inherit"})},nt=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiAlert"}),{action:C,children:l,className:n,closeText:o="Close",color:r,components:a={},componentsProps:i={},icon:c,iconMapping:A=tb,onClose:p,role:G="alert",severity:Z="success",slotProps:h={},slots:u={},variant:b="standard",...m}=t,B={...t,color:r,severity:Z,variant:b,colorSeverity:r||Z},W=Bv(B),R={slots:{closeButton:a.CloseButton,closeIcon:a.CloseIcon,...u},slotProps:{...i,...h}},[V,S]=oI("closeButton",{elementType:au,externalForwardedProps:R,ownerState:B}),[y,f]=oI("closeIcon",{elementType:yv,externalForwardedProps:R,ownerState:B});return s.jsxs(Sv,{role:G,elevation:0,ownerState:B,className:og(W.root,n),ref:I,...m,children:[c!==!1?s.jsx(Wv,{ownerState:B,className:W.icon,children:c||A[Z]||tb[Z]}):null,s.jsx(Vv,{ownerState:B,className:W.message,children:l}),C!=null?s.jsx(Ib,{ownerState:B,className:W.action,children:C}):null,C==null&&p?s.jsx(Ib,{ownerState:B,className:W.action,children:s.jsx(V,{size:"small","aria-label":o,title:o,color:"inherit",onClick:p,...S,children:s.jsx(y,{fontSize:"small",...f})})}):null]})});function Rv(g){return pg("MuiTypography",g)}Gg("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const fv={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},Xv=wk(),Jv=g=>{const{align:e,gutterBottom:I,noWrap:t,paragraph:C,variant:l,classes:n}=g,o={root:["root",l,g.align!=="inherit"&&`align${$(e)}`,I&&"gutterBottom",t&&"noWrap",C&&"paragraph"]};return Sg(o,Rv,n)},kv=j("span",{name:"MuiTypography",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.variant&&e[I.variant],I.align!=="inherit"&&e[`align${$(I.align)}`],I.noWrap&&e.noWrap,I.gutterBottom&&e.gutterBottom,I.paragraph&&e.paragraph]}})(Hg(({theme:g})=>{var e;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(g.typography).filter(([I,t])=>I!=="inherit"&&t&&typeof t=="object").map(([I,t])=>({props:{variant:I},style:t})),...Object.entries(g.palette).filter(Pe()).map(([I])=>({props:{color:I},style:{color:(g.vars||g).palette[I].main}})),...Object.entries(((e=g.palette)==null?void 0:e.text)||{}).filter(([,I])=>typeof I=="string").map(([I])=>({props:{color:`text${$(I)}`},style:{color:(g.vars||g).palette.text[I]}})),{props:({ownerState:I})=>I.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:I})=>I.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:I})=>I.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:I})=>I.paragraph,style:{marginBottom:16}}]}})),Cb={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},gI=d.forwardRef(function(e,I){const{color:t,...C}=fg({props:e,name:"MuiTypography"}),l=!fv[t],n=Xv({...C,...l&&{color:t}}),{align:o="inherit",className:r,component:a,gutterBottom:i=!1,noWrap:c=!1,paragraph:A=!1,variant:p="body1",variantMapping:G=Cb,...Z}=n,h={...n,align:o,color:t,className:r,component:a,gutterBottom:i,noWrap:c,paragraph:A,variant:p,variantMapping:G},u=a||(A?"p":G[p]||Cb[p])||"span",b=Jv(h);return s.jsx(kv,{as:u,ref:I,className:og(b.root,r),...Z,ownerState:h,style:{...o!=="inherit"&&{"--Typography-textAlign":o},...Z.style}})});function vv(g){return typeof g=="function"?g():g}const Yv=d.forwardRef(function(e,I){const{children:t,container:C,disablePortal:l=!1}=e,[n,o]=d.useState(null),r=ve(Mo(t),I);if(dC(()=>{l||o(vv(C)||document.body)},[C,l]),dC(()=>{if(n&&!l)return bA(I,n),()=>{bA(I,null)}},[I,n,l]),l){if(d.isValidElement(t)){const a={ref:r};return d.cloneElement(t,a)}return s.jsx(d.Fragment,{children:t})}return s.jsx(d.Fragment,{children:n&&ei.createPortal(t,n)})});function Br(g){return parseInt(g,10)||0}const Hv={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function wv(g){return g==null||Object.keys(g).length===0||g.outerHeightStyle===0&&!g.overflowing}const Nv=d.forwardRef(function(e,I){const{onChange:t,maxRows:C,minRows:l=1,style:n,value:o,...r}=e,{current:a}=d.useRef(o!=null),i=d.useRef(null),c=ve(I,i),A=d.useRef(null),p=d.useRef(null),G=d.useCallback(()=>{const u=i.current,m=DC(u).getComputedStyle(u);if(m.width==="0px")return{outerHeightStyle:0,overflowing:!1};const B=p.current;B.style.width=m.width,B.value=u.value||e.placeholder||"x",B.value.slice(-1)===`
`&&(B.value+=" ");const W=m.boxSizing,R=Br(m.paddingBottom)+Br(m.paddingTop),V=Br(m.borderBottomWidth)+Br(m.borderTopWidth),S=B.scrollHeight;B.value="x";const y=B.scrollHeight;let f=S;l&&(f=Math.max(Number(l)*y,f)),C&&(f=Math.min(Number(C)*y,f)),f=Math.max(f,y);const k=f+(W==="border-box"?R+V:0),H=Math.abs(f-S)<=1;return{outerHeightStyle:k,overflowing:H}},[C,l,e.placeholder]),Z=d.useCallback(()=>{const u=G();if(wv(u))return;const b=u.outerHeightStyle,m=i.current;A.current!==b&&(A.current=b,m.style.height=`${b}px`),m.style.overflow=u.overflowing?"hidden":""},[G]);dC(()=>{const u=()=>{Z()};let b;const m=Rh(u),B=i.current,W=DC(B);W.addEventListener("resize",m);let R;return typeof ResizeObserver<"u"&&(R=new ResizeObserver(u),R.observe(B)),()=>{m.clear(),cancelAnimationFrame(b),W.removeEventListener("resize",m),R&&R.disconnect()}},[G,Z]),dC(()=>{Z()});const h=u=>{a||Z(),t&&t(u)};return s.jsxs(d.Fragment,{children:[s.jsx("textarea",{value:o,onChange:h,ref:c,rows:l,style:n,...r}),s.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:p,tabIndex:-1,style:{...Hv.shadow,...n,paddingTop:0,paddingBottom:0}})]})});function SA(g){return typeof g=="string"}function hC({props:g,states:e,muiFormControl:I}){return e.reduce((t,C)=>(t[C]=g[C],I&&typeof g[C]>"u"&&(t[C]=I[C]),t),{})}const iu=d.createContext(void 0);function Rt(){return d.useContext(iu)}function lb(g){return g!=null&&!(Array.isArray(g)&&g.length===0)}function ka(g,e=!1){return g&&(lb(g.value)&&g.value!==""||e&&lb(g.defaultValue)&&g.defaultValue!=="")}function Fv(g){return g.startAdornment}function Kv(g){return pg("MuiInputBase",g)}const Ll=Gg("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var nb;const Oi=(g,e)=>{const{ownerState:I}=g;return[e.root,I.formControl&&e.formControl,I.startAdornment&&e.adornedStart,I.endAdornment&&e.adornedEnd,I.error&&e.error,I.size==="small"&&e.sizeSmall,I.multiline&&e.multiline,I.color&&e[`color${$(I.color)}`],I.fullWidth&&e.fullWidth,I.hiddenLabel&&e.hiddenLabel]},qi=(g,e)=>{const{ownerState:I}=g;return[e.input,I.size==="small"&&e.inputSizeSmall,I.multiline&&e.inputMultiline,I.type==="search"&&e.inputTypeSearch,I.startAdornment&&e.inputAdornedStart,I.endAdornment&&e.inputAdornedEnd,I.hiddenLabel&&e.inputHiddenLabel]},xv=g=>{const{classes:e,color:I,disabled:t,error:C,endAdornment:l,focused:n,formControl:o,fullWidth:r,hiddenLabel:a,multiline:i,readOnly:c,size:A,startAdornment:p,type:G}=g,Z={root:["root",`color${$(I)}`,t&&"disabled",C&&"error",r&&"fullWidth",n&&"focused",o&&"formControl",A&&A!=="medium"&&`size${$(A)}`,i&&"multiline",p&&"adornedStart",l&&"adornedEnd",a&&"hiddenLabel",c&&"readOnly"],input:["input",t&&"disabled",G==="search"&&"inputTypeSearch",i&&"inputMultiline",A==="small"&&"inputSizeSmall",a&&"inputHiddenLabel",p&&"inputAdornedStart",l&&"inputAdornedEnd",c&&"readOnly"]};return Sg(Z,Kv,e)},$i=j("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Oi})(Hg(({theme:g})=>({...g.typography.body1,color:(g.vars||g).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Ll.disabled}`]:{color:(g.vars||g).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:e})=>e.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:e,size:I})=>e.multiline&&I==="small",style:{paddingTop:1}},{props:({ownerState:e})=>e.fullWidth,style:{width:"100%"}}]}))),_i=j("input",{name:"MuiInputBase",slot:"Input",overridesResolver:qi})(Hg(({theme:g})=>{const e=g.palette.mode==="light",I={color:"currentColor",...g.vars?{opacity:g.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5},transition:g.transitions.create("opacity",{duration:g.transitions.duration.shorter})},t={opacity:"0 !important"},C=g.vars?{opacity:g.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":I,"&::-moz-placeholder":I,"&::-ms-input-placeholder":I,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Ll.formControl} &`]:{"&::-webkit-input-placeholder":t,"&::-moz-placeholder":t,"&::-ms-input-placeholder":t,"&:focus::-webkit-input-placeholder":C,"&:focus::-moz-placeholder":C,"&:focus::-ms-input-placeholder":C},[`&.${Ll.disabled}`]:{opacity:1,WebkitTextFillColor:(g.vars||g).palette.text.disabled},variants:[{props:({ownerState:l})=>!l.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:l})=>l.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),ob=Hk({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),Ev=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiInputBase"}),{"aria-describedby":C,autoComplete:l,autoFocus:n,className:o,color:r,components:a={},componentsProps:i={},defaultValue:c,disabled:A,disableInjectingGlobalStyles:p,endAdornment:G,error:Z,fullWidth:h=!1,id:u,inputComponent:b="input",inputProps:m={},inputRef:B,margin:W,maxRows:R,minRows:V,multiline:S=!1,name:y,onBlur:f,onChange:k,onClick:H,onFocus:M,onKeyDown:F,onKeyUp:x,placeholder:L,readOnly:D,renderSuffix:Y,rows:K,size:O,slotProps:lg={},slots:ag={},startAdornment:ig,type:sg="text",value:eg,...q}=t,E=m.value!=null?m.value:eg,{current:Q}=d.useRef(E!=null),Cg=d.useRef(),Ig=d.useCallback(kg=>{},[]),cg=ve(Cg,B,m.ref,Ig),[hg,se]=d.useState(!1),Ag=Rt(),Jg=hC({props:t,muiFormControl:Ag,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Jg.focused=Ag?Ag.focused:hg,d.useEffect(()=>{!Ag&&A&&hg&&(se(!1),f&&f())},[Ag,A,hg,f]);const Ve=Ag&&Ag.onFilled,Me=Ag&&Ag.onEmpty,jg=d.useCallback(kg=>{ka(kg)?Ve&&Ve():Me&&Me()},[Ve,Me]);dC(()=>{Q&&jg({value:E})},[E,jg,Q]);const ce=kg=>{M&&M(kg),m.onFocus&&m.onFocus(kg),Ag&&Ag.onFocus?Ag.onFocus(kg):se(!0)},CI=kg=>{f&&f(kg),m.onBlur&&m.onBlur(kg),Ag&&Ag.onBlur?Ag.onBlur(kg):se(!1)},xg=(kg,...OI)=>{if(!Q){const NI=kg.target||Cg.current;if(NI==null)throw new Error(Ut(1));jg({value:NI.value})}m.onChange&&m.onChange(kg,...OI),k&&k(kg,...OI)};d.useEffect(()=>{jg(Cg.current)},[]);const ZI=kg=>{Cg.current&&kg.currentTarget===kg.target&&Cg.current.focus(),H&&H(kg)};let U=b,mg=m;S&&U==="input"&&(K?mg={type:void 0,minRows:K,maxRows:K,...mg}:mg={type:void 0,maxRows:R,minRows:V,...mg},U=Nv);const wg=kg=>{jg(kg.animationName==="mui-auto-fill-cancel"?Cg.current:{value:"x"})};d.useEffect(()=>{Ag&&Ag.setAdornedStart(!!ig)},[Ag,ig]);const Zg={...t,color:Jg.color||"primary",disabled:Jg.disabled,endAdornment:G,error:Jg.error,focused:Jg.focused,formControl:Ag,fullWidth:h,hiddenLabel:Jg.hiddenLabel,multiline:S,size:Jg.size,startAdornment:ig,type:sg},_g=xv(Zg),lI=ag.root||a.Root||$i,bI=lg.root||i.root||{},pe=ag.input||a.Input||_i;return mg={...mg,...lg.input??i.input},s.jsxs(d.Fragment,{children:[!p&&typeof ob=="function"&&(nb||(nb=s.jsx(ob,{}))),s.jsxs(lI,{...bI,ref:I,onClick:ZI,...q,...!SA(lI)&&{ownerState:{...Zg,...bI.ownerState}},className:og(_g.root,bI.className,o,D&&"MuiInputBase-readOnly"),children:[ig,s.jsx(iu.Provider,{value:null,children:s.jsx(pe,{"aria-invalid":Jg.error,"aria-describedby":C,autoComplete:l,autoFocus:n,defaultValue:c,disabled:Jg.disabled,id:u,onAnimationStart:wg,name:y,placeholder:L,readOnly:D,required:Jg.required,rows:K,value:E,onKeyDown:F,onKeyUp:x,type:sg,...mg,...!SA(pe)&&{as:U,ownerState:{...Zg,...mg.ownerState}},ref:cg,className:og(_g.input,mg.className,D&&"MuiInputBase-readOnly"),onBlur:CI,onChange:xg,onFocus:ce})}),G,Y?Y({...Jg,startAdornment:ig}):null]})]})}),su=Ev;function zv(g){return pg("MuiInput",g)}const pn={...Ll,...Gg("MuiInput",["root","underline","input"])};function Mv(g){return pg("MuiOutlinedInput",g)}const At={...Ll,...Gg("MuiOutlinedInput",["root","notchedOutline","input"])};function Uv(g){return pg("MuiFilledInput",g)}const BC={...Ll,...Gg("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},Lv=te(s.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Qv={entering:{opacity:1},entered:{opacity:1}},Mh=d.forwardRef(function(e,I){const t=Uo(),C={enter:t.transitions.duration.enteringScreen,exit:t.transitions.duration.leavingScreen},{addEndListener:l,appear:n=!0,children:o,easing:r,in:a,onEnter:i,onEntered:c,onEntering:A,onExit:p,onExited:G,onExiting:Z,style:h,timeout:u=C,TransitionComponent:b=Wt,...m}=e,B=d.useRef(null),W=ve(B,Mo(o),I),R=F=>x=>{if(F){const L=B.current;x===void 0?F(L):F(L,x)}},V=R(A),S=R((F,x)=>{zh(F);const L=Xa({style:h,timeout:u,easing:r},{mode:"enter"});F.style.webkitTransition=t.transitions.create("opacity",L),F.style.transition=t.transitions.create("opacity",L),i&&i(F,x)}),y=R(c),f=R(Z),k=R(F=>{const x=Xa({style:h,timeout:u,easing:r},{mode:"exit"});F.style.webkitTransition=t.transitions.create("opacity",x),F.style.transition=t.transitions.create("opacity",x),p&&p(F)}),H=R(G),M=F=>{l&&l(B.current,F)};return s.jsx(b,{appear:n,in:a,nodeRef:B,onEnter:S,onEntered:y,onEntering:V,onExit:k,onExited:H,onExiting:f,addEndListener:M,timeout:u,...m,children:(F,x)=>d.cloneElement(o,{style:{opacity:0,visibility:F==="exited"&&!a?"hidden":void 0,...Qv[F],...h,...o.props.style},ref:W,...x})})});function Tv(g){return pg("MuiBackdrop",g)}Gg("MuiBackdrop",["root","invisible"]);const Dv=g=>{const{ownerState:e,...I}=g;return I},jv=g=>{const{classes:e,invisible:I}=g;return Sg({root:["root",I&&"invisible"]},Tv,e)},Pv=j("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),Uh=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiBackdrop"}),{children:C,className:l,component:n="div",invisible:o=!1,open:r,components:a={},componentsProps:i={},slotProps:c={},slots:A={},TransitionComponent:p,transitionDuration:G,...Z}=t,h={...t,component:n,invisible:o},u=jv(h),b={transition:p,root:a.Root,...A},m={...i,...c},B={slots:b,slotProps:m},[W,R]=oI("root",{elementType:Pv,externalForwardedProps:B,className:og(u.root,l),ownerState:h}),[V,S]=oI("transition",{elementType:Mh,externalForwardedProps:B,ownerState:h}),y=Dv(S);return s.jsx(V,{in:r,timeout:G,...Z,...y,children:s.jsx(W,{"aria-hidden":!0,...R,classes:u,ref:I,children:C})})});function Ov(g){return pg("MuiButton",g)}const ol=Gg("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),qv=d.createContext({}),$v=d.createContext(void 0),_v=g=>{const{color:e,disableElevation:I,fullWidth:t,size:C,variant:l,classes:n}=g,o={root:["root",l,`${l}${$(e)}`,`size${$(C)}`,`${l}Size${$(C)}`,`color${$(e)}`,I&&"disableElevation",t&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${$(C)}`],endIcon:["icon","endIcon",`iconSize${$(C)}`]},r=Sg(o,Ov,n);return{...n,...r}},Lh=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],gY=j(Pi,{shouldForwardProp:g=>qe(g)||g==="classes",name:"MuiButton",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,e[I.variant],e[`${I.variant}${$(I.color)}`],e[`size${$(I.size)}`],e[`${I.variant}Size${$(I.size)}`],I.color==="inherit"&&e.colorInherit,I.disableElevation&&e.disableElevation,I.fullWidth&&e.fullWidth]}})(Hg(({theme:g})=>{var t,C;const e=g.palette.mode==="light"?g.palette.grey[300]:g.palette.grey[800],I=g.palette.mode==="light"?g.palette.grey.A100:g.palette.grey[700];return{...g.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(g.vars||g).shape.borderRadius,transition:g.transitions.create(["background-color","box-shadow","border-color","color"],{duration:g.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${ol.disabled}`]:{color:(g.vars||g).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(g.vars||g).shadows[2],"&:hover":{boxShadow:(g.vars||g).shadows[4],"@media (hover: none)":{boxShadow:(g.vars||g).shadows[2]}},"&:active":{boxShadow:(g.vars||g).shadows[8]},[`&.${ol.focusVisible}`]:{boxShadow:(g.vars||g).shadows[6]},[`&.${ol.disabled}`]:{color:(g.vars||g).palette.action.disabled,boxShadow:(g.vars||g).shadows[0],backgroundColor:(g.vars||g).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${ol.disabled}`]:{border:`1px solid ${(g.vars||g).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(g.palette).filter(Pe(["dark","contrastText"])).map(([l])=>({props:{color:l},style:{"--variant-textColor":(g.vars||g).palette[l].main,"--variant-outlinedColor":(g.vars||g).palette[l].main,"--variant-outlinedBorder":g.vars?`rgba(${g.vars.palette[l].mainChannel} / 0.5)`:Ze(g.palette[l].main,.5),"--variant-containedColor":(g.vars||g).palette[l].contrastText,"--variant-containedBg":(g.vars||g).palette[l].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(g.vars||g).palette[l].dark,"--variant-textBg":g.vars?`rgba(${g.vars.palette[l].mainChannel} / ${g.vars.palette.action.hoverOpacity})`:Ze(g.palette[l].main,g.palette.action.hoverOpacity),"--variant-outlinedBorder":(g.vars||g).palette[l].main,"--variant-outlinedBg":g.vars?`rgba(${g.vars.palette[l].mainChannel} / ${g.vars.palette.action.hoverOpacity})`:Ze(g.palette[l].main,g.palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{"--variant-containedColor":g.vars?g.vars.palette.text.primary:(C=(t=g.palette).getContrastText)==null?void 0:C.call(t,e),"--variant-containedBg":g.vars?g.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":g.vars?g.vars.palette.Button.inheritContainedHoverBg:I,"--variant-textBg":g.vars?`rgba(${g.vars.palette.text.primaryChannel} / ${g.vars.palette.action.hoverOpacity})`:Ze(g.palette.text.primary,g.palette.action.hoverOpacity),"--variant-outlinedBg":g.vars?`rgba(${g.vars.palette.text.primaryChannel} / ${g.vars.palette.action.hoverOpacity})`:Ze(g.palette.text.primary,g.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:g.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:g.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:g.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:g.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:g.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:g.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${ol.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${ol.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}}]}})),eY=j("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.startIcon,e[`iconSize${$(I.size)}`]]}})({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},...Lh]}),IY=j("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.endIcon,e[`iconSize${$(I.size)}`]]}})({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},...Lh]}),Je=d.forwardRef(function(e,I){const t=d.useContext(qv),C=d.useContext($v),l=yo(t,e),n=fg({props:l,name:"MuiButton"}),{children:o,color:r="primary",component:a="button",className:i,disabled:c=!1,disableElevation:A=!1,disableFocusRipple:p=!1,endIcon:G,focusVisibleClassName:Z,fullWidth:h=!1,size:u="medium",startIcon:b,type:m,variant:B="text",...W}=n,R={...n,color:r,component:a,disabled:c,disableElevation:A,disableFocusRipple:p,fullWidth:h,size:u,type:m,variant:B},V=_v(R),S=b&&s.jsx(eY,{className:V.startIcon,ownerState:R,children:b}),y=G&&s.jsx(IY,{className:V.endIcon,ownerState:R,children:G}),f=C||"";return s.jsxs(gY,{ownerState:R,className:og(t.className,V.root,i,f),component:a,disabled:c,focusRipple:!p,focusVisibleClassName:og(V.focusVisible,Z),ref:I,type:m,...W,classes:V,children:[S,o,y]})});function tY(g){return pg("PrivateSwitchBase",g)}Gg("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const CY=g=>{const{classes:e,checked:I,disabled:t,edge:C}=g,l={root:["root",I&&"checked",t&&"disabled",C&&`edge${$(C)}`],input:["input"]};return Sg(l,tY,e)},lY=j(Pi)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:g,ownerState:e})=>g==="start"&&e.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:g,ownerState:e})=>g==="end"&&e.size!=="small",style:{marginRight:-12}}]}),nY=j("input",{shouldForwardProp:qe})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Qh=d.forwardRef(function(e,I){const{autoFocus:t,checked:C,checkedIcon:l,className:n,defaultChecked:o,disabled:r,disableFocusRipple:a=!1,edge:i=!1,icon:c,id:A,inputProps:p,inputRef:G,name:Z,onBlur:h,onChange:u,onFocus:b,readOnly:m,required:B=!1,tabIndex:W,type:R,value:V,...S}=e,[y,f]=Va({controlled:C,default:!!o,name:"SwitchBase",state:"checked"}),k=Rt(),H=K=>{b&&b(K),k&&k.onFocus&&k.onFocus(K)},M=K=>{h&&h(K),k&&k.onBlur&&k.onBlur(K)},F=K=>{if(K.nativeEvent.defaultPrevented)return;const O=K.target.checked;f(O),u&&u(K,O)};let x=r;k&&typeof x>"u"&&(x=k.disabled);const L=R==="checkbox"||R==="radio",D={...e,checked:y,disabled:x,disableFocusRipple:a,edge:i},Y=CY(D);return s.jsxs(lY,{component:"span",className:og(Y.root,n),centerRipple:!0,focusRipple:!a,disabled:x,tabIndex:null,role:void 0,onFocus:H,onBlur:M,ownerState:D,ref:I,...S,children:[s.jsx(nY,{autoFocus:t,checked:C,defaultChecked:o,className:Y.input,disabled:x,id:L?A:void 0,name:Z,onChange:F,readOnly:m,ref:G,required:B,ownerState:D,tabIndex:W,type:R,...R==="checkbox"&&V===void 0?{}:{value:V},...p}),y?l:c]})}),oY=te(s.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),rY=te(s.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),aY=te(s.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function iY(g){return pg("MuiCheckbox",g)}const tc=Gg("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),sY=g=>{const{classes:e,indeterminate:I,color:t,size:C}=g,l={root:["root",I&&"indeterminate",`color${$(t)}`,`size${$(C)}`]},n=Sg(l,iY,e);return{...e,...n}},cY=j(Qh,{shouldForwardProp:g=>qe(g)||g==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.indeterminate&&e.indeterminate,e[`size${$(I.size)}`],I.color!=="default"&&e[`color${$(I.color)}`]]}})(Hg(({theme:g})=>({color:(g.vars||g).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:g.vars?`rgba(${g.vars.palette.action.activeChannel} / ${g.vars.palette.action.hoverOpacity})`:Ze(g.palette.action.active,g.palette.action.hoverOpacity)}}},...Object.entries(g.palette).filter(Pe()).map(([e])=>({props:{color:e,disableRipple:!1},style:{"&:hover":{backgroundColor:g.vars?`rgba(${g.vars.palette[e].mainChannel} / ${g.vars.palette.action.hoverOpacity})`:Ze(g.palette[e].main,g.palette.action.hoverOpacity)}}})),...Object.entries(g.palette).filter(Pe()).map(([e])=>({props:{color:e},style:{[`&.${tc.checked}, &.${tc.indeterminate}`]:{color:(g.vars||g).palette[e].main},[`&.${tc.disabled}`]:{color:(g.vars||g).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),AY=s.jsx(rY,{}),dY=s.jsx(oY,{}),uY=s.jsx(aY,{}),mY=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiCheckbox"}),{checkedIcon:C=AY,color:l="primary",icon:n=dY,indeterminate:o=!1,indeterminateIcon:r=uY,inputProps:a,size:i="medium",disableRipple:c=!1,className:A,...p}=t,G=o?r:n,Z=o?r:C,h={...t,disableRipple:c,color:l,indeterminate:o,size:i},u=sY(h);return s.jsx(cY,{type:"checkbox",inputProps:{"data-indeterminate":o,...a},icon:d.cloneElement(G,{fontSize:G.props.fontSize??i}),checkedIcon:d.cloneElement(Z,{fontSize:Z.props.fontSize??i}),ownerState:h,ref:I,className:og(u.root,A),...p,classes:u})});function ZY(g){return pg("MuiCircularProgress",g)}Gg("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const jt=44,WA=Fo`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,VA=Fo`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`,bY=typeof WA!="string"?jd`
        animation: ${WA} 1.4s linear infinite;
      `:null,GY=typeof VA!="string"?jd`
        animation: ${VA} 1.4s ease-in-out infinite;
      `:null,pY=g=>{const{classes:e,variant:I,color:t,disableShrink:C}=g,l={root:["root",I,`color${$(t)}`],svg:["svg"],circle:["circle",`circle${$(I)}`,C&&"circleDisableShrink"]};return Sg(l,ZY,e)},hY=j("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,e[I.variant],e[`color${$(I.color)}`]]}})(Hg(({theme:g})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:g.transitions.create("transform")}},{props:{variant:"indeterminate"},style:bY||{animation:`${WA} 1.4s linear infinite`}},...Object.entries(g.palette).filter(Pe()).map(([e])=>({props:{color:e},style:{color:(g.vars||g).palette[e].main}}))]}))),yY=j("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(g,e)=>e.svg})({display:"block"}),BY=j("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.circle,e[`circle${$(I.variant)}`],I.disableShrink&&e.circleDisableShrink]}})(Hg(({theme:g})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:g.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:GY||{animation:`${VA} 1.4s ease-in-out infinite`}}]}))),JI=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiCircularProgress"}),{className:C,color:l="primary",disableShrink:n=!1,size:o=40,style:r,thickness:a=3.6,value:i=0,variant:c="indeterminate",...A}=t,p={...t,color:l,disableShrink:n,size:o,thickness:a,value:i,variant:c},G=pY(p),Z={},h={},u={};if(c==="determinate"){const b=2*Math.PI*((jt-a)/2);Z.strokeDasharray=b.toFixed(3),u["aria-valuenow"]=Math.round(i),Z.strokeDashoffset=`${((100-i)/100*b).toFixed(3)}px`,h.transform="rotate(-90deg)"}return s.jsx(hY,{className:og(G.root,C),style:{width:o,height:o,...h,...r},ownerState:p,ref:I,role:"progressbar",...u,...A,children:s.jsx(yY,{className:G.svg,ownerState:p,viewBox:`${jt/2} ${jt/2} ${jt} ${jt}`,children:s.jsx(BY,{className:G.circle,style:Z,ownerState:p,cx:jt,cy:jt,r:(jt-a)/2,fill:"none",strokeWidth:a})})})});function SY(g){const e=fI(g);return e.body===g?DC(g).innerWidth>e.documentElement.clientWidth:g.scrollHeight>g.clientHeight}function Tn(g,e){e?g.setAttribute("aria-hidden","true"):g.removeAttribute("aria-hidden")}function rb(g){return parseInt(DC(g).getComputedStyle(g).paddingRight,10)||0}function WY(g){const I=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(g.tagName),t=g.tagName==="INPUT"&&g.getAttribute("type")==="hidden";return I||t}function ab(g,e,I,t,C){const l=[e,I,...t];[].forEach.call(g.children,n=>{const o=!l.includes(n),r=!WY(n);o&&r&&Tn(n,C)})}function Cc(g,e){let I=-1;return g.some((t,C)=>e(t)?(I=C,!0):!1),I}function VY(g,e){const I=[],t=g.container;if(!e.disableScrollLock){if(SY(t)){const n=Jh(fI(t));I.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight=`${rb(t)+n}px`;const o=fI(t).querySelectorAll(".mui-fixed");[].forEach.call(o,r=>{I.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${rb(r)+n}px`})}let l;if(t.parentNode instanceof DocumentFragment)l=fI(t).body;else{const n=t.parentElement,o=DC(t);l=(n==null?void 0:n.nodeName)==="HTML"&&o.getComputedStyle(n).overflowY==="scroll"?n:t}I.push({value:l.style.overflow,property:"overflow",el:l},{value:l.style.overflowX,property:"overflow-x",el:l},{value:l.style.overflowY,property:"overflow-y",el:l}),l.style.overflow="hidden"}return()=>{I.forEach(({value:l,el:n,property:o})=>{l?n.style.setProperty(o,l):n.style.removeProperty(o)})}}function RY(g){const e=[];return[].forEach.call(g.children,I=>{I.getAttribute("aria-hidden")==="true"&&e.push(I)}),e}class fY{constructor(){this.modals=[],this.containers=[]}add(e,I){let t=this.modals.indexOf(e);if(t!==-1)return t;t=this.modals.length,this.modals.push(e),e.modalRef&&Tn(e.modalRef,!1);const C=RY(I);ab(I,e.mount,e.modalRef,C,!0);const l=Cc(this.containers,n=>n.container===I);return l!==-1?(this.containers[l].modals.push(e),t):(this.containers.push({modals:[e],container:I,restore:null,hiddenSiblings:C}),t)}mount(e,I){const t=Cc(this.containers,l=>l.modals.includes(e)),C=this.containers[t];C.restore||(C.restore=VY(C,I))}remove(e,I=!0){const t=this.modals.indexOf(e);if(t===-1)return t;const C=Cc(this.containers,n=>n.modals.includes(e)),l=this.containers[C];if(l.modals.splice(l.modals.indexOf(e),1),this.modals.splice(t,1),l.modals.length===0)l.restore&&l.restore(),e.modalRef&&Tn(e.modalRef,I),ab(l.container,e.mount,e.modalRef,l.hiddenSiblings,!1),this.containers.splice(C,1);else{const n=l.modals[l.modals.length-1];n.modalRef&&Tn(n.modalRef,!1)}return t}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const XY=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function JY(g){const e=parseInt(g.getAttribute("tabindex")||"",10);return Number.isNaN(e)?g.contentEditable==="true"||(g.nodeName==="AUDIO"||g.nodeName==="VIDEO"||g.nodeName==="DETAILS")&&g.getAttribute("tabindex")===null?0:g.tabIndex:e}function kY(g){if(g.tagName!=="INPUT"||g.type!=="radio"||!g.name)return!1;const e=t=>g.ownerDocument.querySelector(`input[type="radio"]${t}`);let I=e(`[name="${g.name}"]:checked`);return I||(I=e(`[name="${g.name}"]`)),I!==g}function vY(g){return!(g.disabled||g.tagName==="INPUT"&&g.type==="hidden"||kY(g))}function YY(g){const e=[],I=[];return Array.from(g.querySelectorAll(XY)).forEach((t,C)=>{const l=JY(t);l===-1||!vY(t)||(l===0?e.push(t):I.push({documentOrder:C,tabIndex:l,node:t}))}),I.sort((t,C)=>t.tabIndex===C.tabIndex?t.documentOrder-C.documentOrder:t.tabIndex-C.tabIndex).map(t=>t.node).concat(e)}function HY(){return!0}function wY(g){const{children:e,disableAutoFocus:I=!1,disableEnforceFocus:t=!1,disableRestoreFocus:C=!1,getTabbable:l=YY,isEnabled:n=HY,open:o}=g,r=d.useRef(!1),a=d.useRef(null),i=d.useRef(null),c=d.useRef(null),A=d.useRef(null),p=d.useRef(!1),G=d.useRef(null),Z=ve(Mo(e),G),h=d.useRef(null);d.useEffect(()=>{!o||!G.current||(p.current=!I)},[I,o]),d.useEffect(()=>{if(!o||!G.current)return;const m=fI(G.current);return G.current.contains(m.activeElement)||(G.current.hasAttribute("tabIndex")||G.current.setAttribute("tabIndex","-1"),p.current&&G.current.focus()),()=>{C||(c.current&&c.current.focus&&(r.current=!0,c.current.focus()),c.current=null)}},[o]),d.useEffect(()=>{if(!o||!G.current)return;const m=fI(G.current),B=V=>{h.current=V,!(t||!n()||V.key!=="Tab")&&m.activeElement===G.current&&V.shiftKey&&(r.current=!0,i.current&&i.current.focus())},W=()=>{var y,f;const V=G.current;if(V===null)return;if(!m.hasFocus()||!n()||r.current){r.current=!1;return}if(V.contains(m.activeElement)||t&&m.activeElement!==a.current&&m.activeElement!==i.current)return;if(m.activeElement!==A.current)A.current=null;else if(A.current!==null)return;if(!p.current)return;let S=[];if((m.activeElement===a.current||m.activeElement===i.current)&&(S=l(G.current)),S.length>0){const k=!!((y=h.current)!=null&&y.shiftKey&&((f=h.current)==null?void 0:f.key)==="Tab"),H=S[0],M=S[S.length-1];typeof H!="string"&&typeof M!="string"&&(k?M.focus():H.focus())}else V.focus()};m.addEventListener("focusin",W),m.addEventListener("keydown",B,!0);const R=setInterval(()=>{m.activeElement&&m.activeElement.tagName==="BODY"&&W()},50);return()=>{clearInterval(R),m.removeEventListener("focusin",W),m.removeEventListener("keydown",B,!0)}},[I,t,C,n,o,l]);const u=m=>{c.current===null&&(c.current=m.relatedTarget),p.current=!0,A.current=m.target;const B=e.props.onFocus;B&&B(m)},b=m=>{c.current===null&&(c.current=m.relatedTarget),p.current=!0};return s.jsxs(d.Fragment,{children:[s.jsx("div",{tabIndex:o?0:-1,onFocus:b,ref:a,"data-testid":"sentinelStart"}),d.cloneElement(e,{ref:Z,onFocus:u}),s.jsx("div",{tabIndex:o?0:-1,onFocus:b,ref:i,"data-testid":"sentinelEnd"})]})}function NY(g){return typeof g=="function"?g():g}function FY(g){return g?g.props.hasOwnProperty("in"):!1}const KY=new fY;function xY(g){const{container:e,disableEscapeKeyDown:I=!1,disableScrollLock:t=!1,manager:C=KY,closeAfterTransition:l=!1,onTransitionEnter:n,onTransitionExited:o,children:r,onClose:a,open:i,rootRef:c}=g,A=d.useRef({}),p=d.useRef(null),G=d.useRef(null),Z=ve(G,c),[h,u]=d.useState(!i),b=FY(r);let m=!0;(g["aria-hidden"]==="false"||g["aria-hidden"]===!1)&&(m=!1);const B=()=>fI(p.current),W=()=>(A.current.modalRef=G.current,A.current.mount=p.current,A.current),R=()=>{C.mount(W(),{disableScrollLock:t}),G.current&&(G.current.scrollTop=0)},V=Bl(()=>{const L=NY(e)||B().body;C.add(W(),L),G.current&&R()}),S=d.useCallback(()=>C.isTopModal(W()),[C]),y=Bl(L=>{p.current=L,L&&(i&&S()?R():G.current&&Tn(G.current,m))}),f=d.useCallback(()=>{C.remove(W(),m)},[m,C]);d.useEffect(()=>()=>{f()},[f]),d.useEffect(()=>{i?V():(!b||!l)&&f()},[i,f,b,l,V]);const k=L=>D=>{var Y;(Y=L.onKeyDown)==null||Y.call(L,D),!(D.key!=="Escape"||D.which===229||!S())&&(I||(D.stopPropagation(),a&&a(D,"escapeKeyDown")))},H=L=>D=>{var Y;(Y=L.onClick)==null||Y.call(L,D),D.target===D.currentTarget&&a&&a(D,"backdropClick")};return{getRootProps:(L={})=>{const D=vh(g);delete D.onTransitionEnter,delete D.onTransitionExited;const Y={...D,...L};return{role:"presentation",...Y,onKeyDown:k(Y),ref:Z}},getBackdropProps:(L={})=>{const D=L;return{"aria-hidden":!0,...D,onClick:H(D),open:i}},getTransitionProps:()=>{const L=()=>{u(!1),n&&n()},D=()=>{u(!0),o&&o(),l&&f()};return{onEnter:ZA(L,r==null?void 0:r.props.onEnter),onExited:ZA(D,r==null?void 0:r.props.onExited)}},rootRef:Z,portalRef:y,isTopModal:S,exited:h,hasTransition:b}}function EY(g){return pg("MuiModal",g)}Gg("MuiModal",["root","hidden","backdrop"]);const zY=g=>{const{open:e,exited:I,classes:t}=g;return Sg({root:["root",!e&&I&&"hidden"],backdrop:["backdrop"]},EY,t)},MY=j("div",{name:"MuiModal",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,!I.open&&I.exited&&e.hidden]}})(Hg(({theme:g})=>({position:"fixed",zIndex:(g.vars||g).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),UY=j(Uh,{name:"MuiModal",slot:"Backdrop",overridesResolver:(g,e)=>e.backdrop})({zIndex:-1}),cu=d.forwardRef(function(e,I){const t=fg({name:"MuiModal",props:e}),{BackdropComponent:C=UY,BackdropProps:l,classes:n,className:o,closeAfterTransition:r=!1,children:a,container:i,component:c,components:A={},componentsProps:p={},disableAutoFocus:G=!1,disableEnforceFocus:Z=!1,disableEscapeKeyDown:h=!1,disablePortal:u=!1,disableRestoreFocus:b=!1,disableScrollLock:m=!1,hideBackdrop:B=!1,keepMounted:W=!1,onBackdropClick:R,onClose:V,onTransitionEnter:S,onTransitionExited:y,open:f,slotProps:k={},slots:H={},theme:M,...F}=t,x={...t,closeAfterTransition:r,disableAutoFocus:G,disableEnforceFocus:Z,disableEscapeKeyDown:h,disablePortal:u,disableRestoreFocus:b,disableScrollLock:m,hideBackdrop:B,keepMounted:W},{getRootProps:L,getBackdropProps:D,getTransitionProps:Y,portalRef:K,isTopModal:O,exited:lg,hasTransition:ag}=xY({...x,rootRef:I}),ig={...x,exited:lg},sg=zY(ig),eg={};if(a.props.tabIndex===void 0&&(eg.tabIndex="-1"),ag){const{onEnter:hg,onExited:se}=Y();eg.onEnter=hg,eg.onExited=se}const q={...F,slots:{root:A.Root,backdrop:A.Backdrop,...H},slotProps:{...p,...k}},[E,Q]=oI("root",{elementType:MY,externalForwardedProps:q,getSlotProps:L,additionalProps:{ref:I,as:c},ownerState:ig,className:og(o,sg==null?void 0:sg.root,!ig.open&&ig.exited&&(sg==null?void 0:sg.hidden))}),[Cg,Ig]=oI("backdrop",{elementType:C,externalForwardedProps:q,additionalProps:l,getSlotProps:hg=>D({...hg,onClick:se=>{R&&R(se),hg!=null&&hg.onClick&&hg.onClick(se)}}),className:og(l==null?void 0:l.className,sg==null?void 0:sg.backdrop),ownerState:ig}),cg=ve(l==null?void 0:l.ref,Ig.ref);return!W&&!f&&(!ag||lg)?null:s.jsx(Yv,{ref:K,container:i,disablePortal:u,children:s.jsxs(E,{...Q,children:[!B&&C?s.jsx(Cg,{...Ig,ref:cg}):null,s.jsx(wY,{disableEnforceFocus:Z,disableAutoFocus:G,disableRestoreFocus:b,isEnabled:O,open:f,children:d.cloneElement(a,eg)})]})})});function LY(g){return pg("MuiDialog",g)}const lc=Gg("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),Th=d.createContext({}),QY=j(Uh,{name:"MuiDialog",slot:"Backdrop",overrides:(g,e)=>e.backdrop})({zIndex:-1}),TY=g=>{const{classes:e,scroll:I,maxWidth:t,fullWidth:C,fullScreen:l}=g,n={root:["root"],container:["container",`scroll${$(I)}`],paper:["paper",`paperScroll${$(I)}`,`paperWidth${$(String(t))}`,C&&"paperFullWidth",l&&"paperFullScreen"]};return Sg(n,LY,e)},DY=j(cu,{name:"MuiDialog",slot:"Root",overridesResolver:(g,e)=>e.root})({"@media print":{position:"absolute !important"}}),jY=j("div",{name:"MuiDialog",slot:"Container",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.container,e[`scroll${$(I.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),PY=j(Vt,{name:"MuiDialog",slot:"Paper",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.paper,e[`scrollPaper${$(I.scroll)}`],e[`paperWidth${$(String(I.maxWidth))}`],I.fullWidth&&e.paperFullWidth,I.fullScreen&&e.paperFullScreen]}})(Hg(({theme:g})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:g.breakpoints.unit==="px"?Math.max(g.breakpoints.values.xs,444):`max(${g.breakpoints.values.xs}${g.breakpoints.unit}, 444px)`,[`&.${lc.paperScrollBody}`]:{[g.breakpoints.down(Math.max(g.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(g.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${g.breakpoints.values[e]}${g.breakpoints.unit}`,[`&.${lc.paperScrollBody}`]:{[g.breakpoints.down(g.breakpoints.values[e]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${lc.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),ib=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiDialog"}),C=Uo(),l={enter:C.transitions.duration.enteringScreen,exit:C.transitions.duration.leavingScreen},{"aria-describedby":n,"aria-labelledby":o,BackdropComponent:r,BackdropProps:a,children:i,className:c,disableEscapeKeyDown:A=!1,fullScreen:p=!1,fullWidth:G=!1,maxWidth:Z="sm",onBackdropClick:h,onClick:u,onClose:b,open:m,PaperComponent:B=Vt,PaperProps:W={},scroll:R="paper",TransitionComponent:V=Mh,transitionDuration:S=l,TransitionProps:y,...f}=t,k={...t,disableEscapeKeyDown:A,fullScreen:p,fullWidth:G,maxWidth:Z,scroll:R},H=TY(k),M=d.useRef(),F=Y=>{M.current=Y.target===Y.currentTarget},x=Y=>{u&&u(Y),M.current&&(M.current=null,h&&h(Y),b&&b(Y,"backdropClick"))},L=Fi(o),D=d.useMemo(()=>({titleId:L}),[L]);return s.jsx(DY,{className:og(H.root,c),closeAfterTransition:!0,components:{Backdrop:QY},componentsProps:{backdrop:{transitionDuration:S,as:r,...a}},disableEscapeKeyDown:A,onClose:b,open:m,ref:I,onClick:x,ownerState:k,...f,children:s.jsx(V,{appear:!0,in:m,timeout:S,role:"presentation",...y,children:s.jsx(jY,{className:og(H.container),onMouseDown:F,ownerState:k,children:s.jsx(PY,{as:B,elevation:24,role:"dialog","aria-describedby":n,"aria-labelledby":L,...W,className:og(H.paper,W.className),ownerState:k,children:s.jsx(Th.Provider,{value:D,children:i})})})})})});function OY(g){return pg("MuiDialogActions",g)}Gg("MuiDialogActions",["root","spacing"]);const qY=g=>{const{classes:e,disableSpacing:I}=g;return Sg({root:["root",!I&&"spacing"]},OY,e)},$Y=j("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,!I.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:g})=>!g.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),sb=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiDialogActions"}),{className:C,disableSpacing:l=!1,...n}=t,o={...t,disableSpacing:l},r=qY(o);return s.jsx($Y,{className:og(r.root,C),ownerState:o,ref:I,...n})});function _Y(g){return pg("MuiDialogContent",g)}Gg("MuiDialogContent",["root","dividers"]);function gH(g){return pg("MuiDialogTitle",g)}const eH=Gg("MuiDialogTitle",["root"]),IH=g=>{const{classes:e,dividers:I}=g;return Sg({root:["root",I&&"dividers"]},_Y,e)},tH=j("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.dividers&&e.dividers]}})(Hg(({theme:g})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(g.vars||g).palette.divider}`,borderBottom:`1px solid ${(g.vars||g).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${eH.root} + &`]:{paddingTop:0}}}]}))),cb=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiDialogContent"}),{className:C,dividers:l=!1,...n}=t,o={...t,dividers:l},r=IH(o);return s.jsx(tH,{className:og(r.root,C),ownerState:o,ref:I,...n})}),CH=g=>{const{classes:e}=g;return Sg({root:["root"]},gH,e)},lH=j(gI,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(g,e)=>e.root})({padding:"16px 24px",flex:"0 0 auto"}),Ab=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiDialogTitle"}),{className:C,id:l,...n}=t,o=t,r=CH(o),{titleId:a=l}=d.useContext(Th);return s.jsx(lH,{component:"h2",className:og(r.root,C),ownerState:o,ref:I,variant:"h6",id:l??a,...n})}),db=Gg("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),nH=g=>{const{classes:e,disableUnderline:I,startAdornment:t,endAdornment:C,size:l,hiddenLabel:n,multiline:o}=g,r={root:["root",!I&&"underline",t&&"adornedStart",C&&"adornedEnd",l==="small"&&`size${$(l)}`,n&&"hiddenLabel",o&&"multiline"],input:["input"]},a=Sg(r,Uv,e);return{...e,...a}},oH=j($i,{shouldForwardProp:g=>qe(g)||g==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[...Oi(g,e),!I.disableUnderline&&e.underline]}})(Hg(({theme:g})=>{const e=g.palette.mode==="light",I=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",t=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",C=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",l=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:g.vars?g.vars.palette.FilledInput.bg:t,borderTopLeftRadius:(g.vars||g).shape.borderRadius,borderTopRightRadius:(g.vars||g).shape.borderRadius,transition:g.transitions.create("background-color",{duration:g.transitions.duration.shorter,easing:g.transitions.easing.easeOut}),"&:hover":{backgroundColor:g.vars?g.vars.palette.FilledInput.hoverBg:C,"@media (hover: none)":{backgroundColor:g.vars?g.vars.palette.FilledInput.bg:t}},[`&.${BC.focused}`]:{backgroundColor:g.vars?g.vars.palette.FilledInput.bg:t},[`&.${BC.disabled}`]:{backgroundColor:g.vars?g.vars.palette.FilledInput.disabledBg:l},variants:[{props:({ownerState:n})=>!n.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:g.transitions.create("transform",{duration:g.transitions.duration.shorter,easing:g.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${BC.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${BC.error}`]:{"&::before, &::after":{borderBottomColor:(g.vars||g).palette.error.main}},"&::before":{borderBottom:`1px solid ${g.vars?`rgba(${g.vars.palette.common.onBackgroundChannel} / ${g.vars.opacity.inputUnderline})`:I}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:g.transitions.create("border-bottom-color",{duration:g.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${BC.disabled}, .${BC.error}):before`]:{borderBottom:`1px solid ${(g.vars||g).palette.text.primary}`},[`&.${BC.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(g.palette).filter(Pe()).map(([n])=>{var o;return{props:{disableUnderline:!1,color:n},style:{"&::after":{borderBottom:`2px solid ${(o=(g.vars||g).palette[n])==null?void 0:o.main}`}}}}),{props:({ownerState:n})=>n.startAdornment,style:{paddingLeft:12}},{props:({ownerState:n})=>n.endAdornment,style:{paddingRight:12}},{props:({ownerState:n})=>n.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:n,size:o})=>n.multiline&&o==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:n})=>n.multiline&&n.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:n})=>n.multiline&&n.hiddenLabel&&n.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),rH=j(_i,{name:"MuiFilledInput",slot:"Input",overridesResolver:qi})(Hg(({theme:g})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!g.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:g.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:g.palette.mode==="light"?null:"#fff",caretColor:g.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...g.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[g.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:e})=>e.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}},{props:({ownerState:e})=>e.hiddenLabel&&e.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:e})=>e.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),va=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiFilledInput"}),{disableUnderline:C=!1,components:l={},componentsProps:n,fullWidth:o=!1,hiddenLabel:r,inputComponent:a="input",multiline:i=!1,slotProps:c,slots:A={},type:p="text",...G}=t,Z={...t,disableUnderline:C,fullWidth:o,inputComponent:a,multiline:i,type:p},h=nH(t),u={root:{ownerState:Z},input:{ownerState:Z}},b=c??n?je(u,c??n):u,m=A.root??l.Root??oH,B=A.input??l.Input??rH;return s.jsx(su,{slots:{root:m,input:B},componentsProps:b,fullWidth:o,inputComponent:a,multiline:i,ref:I,type:p,...G,classes:h})});va&&(va.muiName="Input");function aH(g){return pg("MuiFormControl",g)}Gg("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const iH=g=>{const{classes:e,margin:I,fullWidth:t}=g,C={root:["root",I!=="none"&&`margin${$(I)}`,t&&"fullWidth"]};return Sg(C,aH,e)},sH=j("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:g},e)=>({...e.root,...e[`margin${$(g.margin)}`],...g.fullWidth&&e.fullWidth})})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),RA=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiFormControl"}),{children:C,className:l,color:n="primary",component:o="div",disabled:r=!1,error:a=!1,focused:i,fullWidth:c=!1,hiddenLabel:A=!1,margin:p="none",required:G=!1,size:Z="medium",variant:h="outlined",...u}=t,b={...t,color:n,component:o,disabled:r,error:a,fullWidth:c,hiddenLabel:A,margin:p,required:G,size:Z,variant:h},m=iH(b),[B,W]=d.useState(()=>{let M=!1;return C&&d.Children.forEach(C,F=>{if(!_s(F,["Input","Select"]))return;const x=_s(F,["Select"])?F.props.input:F;x&&Fv(x.props)&&(M=!0)}),M}),[R,V]=d.useState(()=>{let M=!1;return C&&d.Children.forEach(C,F=>{_s(F,["Input","Select"])&&(ka(F.props,!0)||ka(F.props.inputProps,!0))&&(M=!0)}),M}),[S,y]=d.useState(!1);r&&S&&y(!1);const f=i!==void 0&&!r?i:S;let k;d.useRef(!1);const H=d.useMemo(()=>({adornedStart:B,setAdornedStart:W,color:n,disabled:r,error:a,filled:R,focused:f,fullWidth:c,hiddenLabel:A,size:Z,onBlur:()=>{y(!1)},onEmpty:()=>{V(!1)},onFilled:()=>{V(!0)},onFocus:()=>{y(!0)},registerEffect:k,required:G,variant:h}),[B,n,r,a,R,f,c,A,k,G,Z,h]);return s.jsx(iu.Provider,{value:H,children:s.jsx(sH,{as:o,ownerState:b,className:og(m.root,l),ref:I,...u,children:C})})});function cH(g){return pg("MuiFormControlLabel",g)}const Hn=Gg("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),AH=g=>{const{classes:e,disabled:I,labelPlacement:t,error:C,required:l}=g,n={root:["root",I&&"disabled",`labelPlacement${$(t)}`,C&&"error",l&&"required"],label:["label",I&&"disabled"],asterisk:["asterisk",C&&"error"]};return Sg(n,cH,e)},dH=j("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[{[`& .${Hn.label}`]:e.label},e.root,e[`labelPlacement${$(I.labelPlacement)}`]]}})(Hg(({theme:g})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${Hn.disabled}`]:{cursor:"default"},[`& .${Hn.label}`]:{[`&.${Hn.disabled}`]:{color:(g.vars||g).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:e})=>e==="start"||e==="top"||e==="bottom",style:{marginLeft:16}}]}))),uH=j("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(g,e)=>e.asterisk})(Hg(({theme:g})=>({[`&.${Hn.error}`]:{color:(g.vars||g).palette.error.main}}))),nc=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiFormControlLabel"}),{checked:C,className:l,componentsProps:n={},control:o,disabled:r,disableTypography:a,inputRef:i,label:c,labelPlacement:A="end",name:p,onChange:G,required:Z,slots:h={},slotProps:u={},value:b,...m}=t,B=Rt(),W=r??o.props.disabled??(B==null?void 0:B.disabled),R=Z??o.props.required,V={disabled:W,required:R};["checked","name","onChange","value","inputRef"].forEach(x=>{typeof o.props[x]>"u"&&typeof t[x]<"u"&&(V[x]=t[x])});const S=hC({props:t,muiFormControl:B,states:["error"]}),y={...t,disabled:W,labelPlacement:A,required:R,error:S.error},f=AH(y),k={slots:h,slotProps:{...n,...u}},[H,M]=oI("typography",{elementType:gI,externalForwardedProps:k,ownerState:y});let F=c;return F!=null&&F.type!==gI&&!a&&(F=s.jsx(H,{component:"span",...M,className:og(f.label,M==null?void 0:M.className),children:F})),s.jsxs(dH,{className:og(f.root,l),ownerState:y,ref:I,...m,children:[d.cloneElement(o,V),R?s.jsxs("div",{children:[F,s.jsxs(uH,{ownerState:y,"aria-hidden":!0,className:f.asterisk,children:[" ","*"]})]}):F]})});function mH(g){return pg("MuiFormGroup",g)}Gg("MuiFormGroup",["root","row","error"]);const ZH=g=>{const{classes:e,row:I,error:t}=g;return Sg({root:["root",I&&"row",t&&"error"]},mH,e)},bH=j("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.row&&e.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),Dh=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiFormGroup"}),{className:C,row:l=!1,...n}=t,o=Rt(),r=hC({props:t,muiFormControl:o,states:["error"]}),a={...t,row:l,error:r.error},i=ZH(a);return s.jsx(bH,{className:og(i.root,C),ownerState:a,ref:I,...n})});function GH(g){return pg("MuiFormHelperText",g)}const ub=Gg("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var mb;const pH=g=>{const{classes:e,contained:I,size:t,disabled:C,error:l,filled:n,focused:o,required:r}=g,a={root:["root",C&&"disabled",l&&"error",t&&`size${$(t)}`,I&&"contained",o&&"focused",n&&"filled",r&&"required"]};return Sg(a,GH,e)},hH=j("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.size&&e[`size${$(I.size)}`],I.contained&&e.contained,I.filled&&e.filled]}})(Hg(({theme:g})=>({color:(g.vars||g).palette.text.secondary,...g.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${ub.disabled}`]:{color:(g.vars||g).palette.text.disabled},[`&.${ub.error}`]:{color:(g.vars||g).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:e})=>e.contained,style:{marginLeft:14,marginRight:14}}]}))),yH=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiFormHelperText"}),{children:C,className:l,component:n="p",disabled:o,error:r,filled:a,focused:i,margin:c,required:A,variant:p,...G}=t,Z=Rt(),h=hC({props:t,muiFormControl:Z,states:["variant","size","disabled","error","filled","focused","required"]}),u={...t,component:n,contained:h.variant==="filled"||h.variant==="outlined",variant:h.variant,size:h.size,disabled:h.disabled,error:h.error,filled:h.filled,focused:h.focused,required:h.required};delete u.ownerState;const b=pH(u);return s.jsx(hH,{as:n,className:og(b.root,l),ref:I,...G,ownerState:u,children:C===" "?mb||(mb=s.jsx("span",{className:"notranslate",children:"​"})):C})});function BH(g){return pg("MuiFormLabel",g)}const Dn=Gg("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),SH=g=>{const{classes:e,color:I,focused:t,disabled:C,error:l,filled:n,required:o}=g,r={root:["root",`color${$(I)}`,C&&"disabled",l&&"error",n&&"filled",t&&"focused",o&&"required"],asterisk:["asterisk",l&&"error"]};return Sg(r,BH,e)},WH=j("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:g},e)=>({...e.root,...g.color==="secondary"&&e.colorSecondary,...g.filled&&e.filled})})(Hg(({theme:g})=>({color:(g.vars||g).palette.text.secondary,...g.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(g.palette).filter(Pe()).map(([e])=>({props:{color:e},style:{[`&.${Dn.focused}`]:{color:(g.vars||g).palette[e].main}}})),{props:{},style:{[`&.${Dn.disabled}`]:{color:(g.vars||g).palette.text.disabled},[`&.${Dn.error}`]:{color:(g.vars||g).palette.error.main}}}]}))),VH=j("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(g,e)=>e.asterisk})(Hg(({theme:g})=>({[`&.${Dn.error}`]:{color:(g.vars||g).palette.error.main}}))),RH=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiFormLabel"}),{children:C,className:l,color:n,component:o="label",disabled:r,error:a,filled:i,focused:c,required:A,...p}=t,G=Rt(),Z=hC({props:t,muiFormControl:G,states:["color","required","focused","disabled","error","filled"]}),h={...t,color:Z.color||"primary",component:o,disabled:Z.disabled,error:Z.error,filled:Z.filled,focused:Z.focused,required:Z.required},u=SH(h);return s.jsxs(WH,{as:o,ownerState:h,className:og(u.root,l),ref:I,...p,children:[C,Z.required&&s.jsxs(VH,{ownerState:h,"aria-hidden":!0,className:u.asterisk,children:[" ","*"]})]})}),Zb=d.createContext();function fH(g){return pg("MuiGrid",g)}const XH=[0,1,2,3,4,5,6,7,8,9,10],JH=["column-reverse","column","row-reverse","row"],kH=["nowrap","wrap-reverse","wrap"],hn=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],Bo=Gg("MuiGrid",["root","container","item","zeroMinWidth",...XH.map(g=>`spacing-xs-${g}`),...JH.map(g=>`direction-xs-${g}`),...kH.map(g=>`wrap-xs-${g}`),...hn.map(g=>`grid-xs-${g}`),...hn.map(g=>`grid-sm-${g}`),...hn.map(g=>`grid-md-${g}`),...hn.map(g=>`grid-lg-${g}`),...hn.map(g=>`grid-xl-${g}`)]);function vH({theme:g,ownerState:e}){let I;return g.breakpoints.keys.reduce((t,C)=>{let l={};if(e[C]&&(I=e[C]),!I)return t;if(I===!0)l={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(I==="auto")l={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const n=Xi({values:e.columns,breakpoints:g.breakpoints.values}),o=typeof n=="object"?n[C]:n;if(o==null)return t;const r=`${Math.round(I/o*1e8)/1e6}%`;let a={};if(e.container&&e.item&&e.columnSpacing!==0){const i=g.spacing(e.columnSpacing);if(i!=="0px"){const c=`calc(${r} + ${i})`;a={flexBasis:c,maxWidth:c}}}l={flexBasis:r,flexGrow:0,maxWidth:r,...a}}return g.breakpoints.values[C]===0?Object.assign(t,l):t[g.breakpoints.up(C)]=l,t},{})}function YH({theme:g,ownerState:e}){const I=Xi({values:e.direction,breakpoints:g.breakpoints.values});return DI({theme:g},I,t=>{const C={flexDirection:t};return t.startsWith("column")&&(C[`& > .${Bo.item}`]={maxWidth:"none"}),C})}function jh({breakpoints:g,values:e}){let I="";Object.keys(e).forEach(C=>{I===""&&e[C]!==0&&(I=C)});const t=Object.keys(g).sort((C,l)=>g[C]-g[l]);return t.slice(0,t.indexOf(I))}function HH({theme:g,ownerState:e}){const{container:I,rowSpacing:t}=e;let C={};if(I&&t!==0){const l=Xi({values:t,breakpoints:g.breakpoints.values});let n;typeof l=="object"&&(n=jh({breakpoints:g.breakpoints.values,values:l})),C=DI({theme:g},l,(o,r)=>{const a=g.spacing(o);return a!=="0px"?{marginTop:g.spacing(-o),[`& > .${Bo.item}`]:{paddingTop:a}}:n!=null&&n.includes(r)?{}:{marginTop:0,[`& > .${Bo.item}`]:{paddingTop:0}}})}return C}function wH({theme:g,ownerState:e}){const{container:I,columnSpacing:t}=e;let C={};if(I&&t!==0){const l=Xi({values:t,breakpoints:g.breakpoints.values});let n;typeof l=="object"&&(n=jh({breakpoints:g.breakpoints.values,values:l})),C=DI({theme:g},l,(o,r)=>{const a=g.spacing(o);if(a!=="0px"){const i=g.spacing(-o);return{width:`calc(100% + ${a})`,marginLeft:i,[`& > .${Bo.item}`]:{paddingLeft:a}}}return n!=null&&n.includes(r)?{}:{width:"100%",marginLeft:0,[`& > .${Bo.item}`]:{paddingLeft:0}}})}return C}function NH(g,e,I={}){if(!g||g<=0)return[];if(typeof g=="string"&&!Number.isNaN(Number(g))||typeof g=="number")return[I[`spacing-xs-${String(g)}`]];const t=[];return e.forEach(C=>{const l=g[C];Number(l)>0&&t.push(I[`spacing-${C}-${String(l)}`])}),t}const FH=j("div",{name:"MuiGrid",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g,{container:t,direction:C,item:l,spacing:n,wrap:o,zeroMinWidth:r,breakpoints:a}=I;let i=[];t&&(i=NH(n,a,e));const c=[];return a.forEach(A=>{const p=I[A];p&&c.push(e[`grid-${A}-${String(p)}`])}),[e.root,t&&e.container,l&&e.item,r&&e.zeroMinWidth,...i,C!=="row"&&e[`direction-xs-${String(C)}`],o!=="wrap"&&e[`wrap-xs-${String(o)}`],...c]}})(({ownerState:g})=>({boxSizing:"border-box",...g.container&&{display:"flex",flexWrap:"wrap",width:"100%"},...g.item&&{margin:0},...g.zeroMinWidth&&{minWidth:0},...g.wrap!=="wrap"&&{flexWrap:g.wrap}}),YH,HH,wH,vH);function KH(g,e){if(!g||g<=0)return[];if(typeof g=="string"&&!Number.isNaN(Number(g))||typeof g=="number")return[`spacing-xs-${String(g)}`];const I=[];return e.forEach(t=>{const C=g[t];if(Number(C)>0){const l=`spacing-${t}-${String(C)}`;I.push(l)}}),I}const xH=g=>{const{classes:e,container:I,direction:t,item:C,spacing:l,wrap:n,zeroMinWidth:o,breakpoints:r}=g;let a=[];I&&(a=KH(l,r));const i=[];r.forEach(A=>{const p=g[A];p&&i.push(`grid-${A}-${String(p)}`)});const c={root:["root",I&&"container",C&&"item",o&&"zeroMinWidth",...a,t!=="row"&&`direction-xs-${String(t)}`,n!=="wrap"&&`wrap-xs-${String(n)}`,...i]};return Sg(c,fH,e)},tg=d.forwardRef(function(e,I){const t=Fh({props:e,name:"MuiGrid"}),{breakpoints:C}=Uo(),l=Sh(t),{className:n,columns:o,columnSpacing:r,component:a="div",container:i=!1,direction:c="row",item:A=!1,rowSpacing:p,spacing:G=0,wrap:Z="wrap",zeroMinWidth:h=!1,...u}=l,b=p||G,m=r||G,B=d.useContext(Zb),W=i?o||12:B,R={},V={...u};C.keys.forEach(f=>{u[f]!=null&&(R[f]=u[f],delete V[f])});const S={...l,columns:W,container:i,direction:c,item:A,rowSpacing:b,columnSpacing:m,wrap:Z,zeroMinWidth:h,spacing:G,...R,breakpoints:C.keys},y=xH(S);return s.jsx(Zb.Provider,{value:W,children:s.jsx(FH,{ownerState:S,className:og(y.root,n),as:a,ref:I,...V})})});function fA(g){return`scale(${g}, ${g**2})`}const EH={entering:{opacity:1,transform:fA(1)},entered:{opacity:1,transform:"none"}},oc=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),XA=d.forwardRef(function(e,I){const{addEndListener:t,appear:C=!0,children:l,easing:n,in:o,onEnter:r,onEntered:a,onEntering:i,onExit:c,onExited:A,onExiting:p,style:G,timeout:Z="auto",TransitionComponent:h=Wt,...u}=e,b=Xh(),m=d.useRef(),B=Uo(),W=d.useRef(null),R=ve(W,Mo(l),I),V=x=>L=>{if(x){const D=W.current;L===void 0?x(D):x(D,L)}},S=V(i),y=V((x,L)=>{zh(x);const{duration:D,delay:Y,easing:K}=Xa({style:G,timeout:Z,easing:n},{mode:"enter"});let O;Z==="auto"?(O=B.transitions.getAutoHeightDuration(x.clientHeight),m.current=O):O=D,x.style.transition=[B.transitions.create("opacity",{duration:O,delay:Y}),B.transitions.create("transform",{duration:oc?O:O*.666,delay:Y,easing:K})].join(","),r&&r(x,L)}),f=V(a),k=V(p),H=V(x=>{const{duration:L,delay:D,easing:Y}=Xa({style:G,timeout:Z,easing:n},{mode:"exit"});let K;Z==="auto"?(K=B.transitions.getAutoHeightDuration(x.clientHeight),m.current=K):K=L,x.style.transition=[B.transitions.create("opacity",{duration:K,delay:D}),B.transitions.create("transform",{duration:oc?K:K*.666,delay:oc?D:D||K*.333,easing:Y})].join(","),x.style.opacity=0,x.style.transform=fA(.75),c&&c(x)}),M=V(A),F=x=>{Z==="auto"&&b.start(m.current||0,x),t&&t(W.current,x)};return s.jsx(h,{appear:C,in:o,nodeRef:W,onEnter:y,onEntered:f,onEntering:S,onExit:H,onExited:M,onExiting:k,addEndListener:F,timeout:Z==="auto"?null:Z,...u,children:(x,L)=>d.cloneElement(l,{style:{opacity:0,transform:fA(.75),visibility:x==="exited"&&!o?"hidden":void 0,...EH[x],...G,...l.props.style},ref:R,...L})})});XA&&(XA.muiSupportAuto=!0);const zH=g=>{const{classes:e,disableUnderline:I}=g,C=Sg({root:["root",!I&&"underline"],input:["input"]},zv,e);return{...e,...C}},MH=j($i,{shouldForwardProp:g=>qe(g)||g==="classes",name:"MuiInput",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[...Oi(g,e),!I.disableUnderline&&e.underline]}})(Hg(({theme:g})=>{let I=g.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return g.vars&&(I=`rgba(${g.vars.palette.common.onBackgroundChannel} / ${g.vars.opacity.inputUnderline})`),{position:"relative",variants:[{props:({ownerState:t})=>t.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:t})=>!t.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:g.transitions.create("transform",{duration:g.transitions.duration.shorter,easing:g.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${pn.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${pn.error}`]:{"&::before, &::after":{borderBottomColor:(g.vars||g).palette.error.main}},"&::before":{borderBottom:`1px solid ${I}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:g.transitions.create("border-bottom-color",{duration:g.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${pn.disabled}, .${pn.error}):before`]:{borderBottom:`2px solid ${(g.vars||g).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${I}`}},[`&.${pn.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(g.palette).filter(Pe()).map(([t])=>({props:{color:t,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(g.vars||g).palette[t].main}`}}}))]}})),UH=j(_i,{name:"MuiInput",slot:"Input",overridesResolver:qi})({}),Ya=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiInput"}),{disableUnderline:C=!1,components:l={},componentsProps:n,fullWidth:o=!1,inputComponent:r="input",multiline:a=!1,slotProps:i,slots:c={},type:A="text",...p}=t,G=zH(t),h={root:{ownerState:{disableUnderline:C}}},u=i??n?je(i??n,h):h,b=c.root??l.Root??MH,m=c.input??l.Input??UH;return s.jsx(su,{slots:{root:b,input:m},slotProps:u,fullWidth:o,inputComponent:r,multiline:a,ref:I,type:A,...p,classes:G})});Ya&&(Ya.muiName="Input");function LH(g){return pg("MuiInputLabel",g)}Gg("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const QH=g=>{const{classes:e,formControl:I,size:t,shrink:C,disableAnimation:l,variant:n,required:o}=g,r={root:["root",I&&"formControl",!l&&"animated",C&&"shrink",t&&t!=="normal"&&`size${$(t)}`,n],asterisk:[o&&"asterisk"]},a=Sg(r,LH,e);return{...e,...a}},TH=j(RH,{shouldForwardProp:g=>qe(g)||g==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[{[`& .${Dn.asterisk}`]:e.asterisk},e.root,I.formControl&&e.formControl,I.size==="small"&&e.sizeSmall,I.shrink&&e.shrink,!I.disableAnimation&&e.animated,I.focused&&e.focused,e[I.variant]]}})(Hg(({theme:g})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:e})=>e.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:e})=>e.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:e})=>!e.disableAnimation,style:{transition:g.transitions.create(["color","transform","max-width"],{duration:g.transitions.duration.shorter,easing:g.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:e,ownerState:I})=>e==="filled"&&I.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:e,ownerState:I,size:t})=>e==="filled"&&I.shrink&&t==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:e,ownerState:I})=>e==="outlined"&&I.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),JA=d.forwardRef(function(e,I){const t=fg({name:"MuiInputLabel",props:e}),{disableAnimation:C=!1,margin:l,shrink:n,variant:o,className:r,...a}=t,i=Rt();let c=n;typeof c>"u"&&i&&(c=i.filled||i.focused||i.adornedStart);const A=hC({props:t,muiFormControl:i,states:["size","variant","required","focused"]}),p={...t,disableAnimation:C,formControl:i,shrink:c,size:A.size,variant:A.variant,required:A.required,focused:A.focused},G=QH(p);return s.jsx(TH,{"data-shrink":c,ref:I,className:og(G.root,r),...a,ownerState:p,classes:G})}),kA=d.createContext({});function DH(g){return pg("MuiList",g)}Gg("MuiList",["root","padding","dense","subheader"]);const jH=g=>{const{classes:e,disablePadding:I,dense:t,subheader:C}=g;return Sg({root:["root",!I&&"padding",t&&"dense",C&&"subheader"]},DH,e)},PH=j("ul",{name:"MuiList",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,!I.disablePadding&&e.padding,I.dense&&e.dense,I.subheader&&e.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:g})=>!g.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:g})=>g.subheader,style:{paddingTop:0}}]}),OH=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiList"}),{children:C,className:l,component:n="ul",dense:o=!1,disablePadding:r=!1,subheader:a,...i}=t,c=d.useMemo(()=>({dense:o}),[o]),A={...t,component:n,dense:o,disablePadding:r},p=jH(A);return s.jsx(kA.Provider,{value:c,children:s.jsxs(PH,{as:n,className:og(p.root,l),ref:I,ownerState:A,...i,children:[a,C]})})}),bb=Gg("MuiListItemIcon",["root","alignItemsFlexStart"]),Gb=Gg("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function rc(g,e,I){return g===e?g.firstChild:e&&e.nextElementSibling?e.nextElementSibling:I?null:g.firstChild}function pb(g,e,I){return g===e?I?g.firstChild:g.lastChild:e&&e.previousElementSibling?e.previousElementSibling:I?null:g.lastChild}function Ph(g,e){if(e===void 0)return!0;let I=g.innerText;return I===void 0&&(I=g.textContent),I=I.trim().toLowerCase(),I.length===0?!1:e.repeating?I[0]===e.keys[0]:I.startsWith(e.keys.join(""))}function yn(g,e,I,t,C,l){let n=!1,o=C(g,e,e?I:!1);for(;o;){if(o===g.firstChild){if(n)return!1;n=!0}const r=t?!1:o.disabled||o.getAttribute("aria-disabled")==="true";if(!o.hasAttribute("tabindex")||!Ph(o,l)||r)o=C(g,o,I);else return o.focus(),!0}return!1}const qH=d.forwardRef(function(e,I){const{actions:t,autoFocus:C=!1,autoFocusItem:l=!1,children:n,className:o,disabledItemsFocusable:r=!1,disableListWrap:a=!1,onKeyDown:i,variant:c="selectedMenu",...A}=e,p=d.useRef(null),G=d.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});dC(()=>{C&&p.current.focus()},[C]),d.useImperativeHandle(t,()=>({adjustStyleForScrollbar:(m,{direction:B})=>{const W=!p.current.style.width;if(m.clientHeight<p.current.clientHeight&&W){const R=`${Jh(fI(m))}px`;p.current.style[B==="rtl"?"paddingLeft":"paddingRight"]=R,p.current.style.width=`calc(100% + ${R})`}return p.current}}),[]);const Z=m=>{const B=p.current,W=m.key;if(m.ctrlKey||m.metaKey||m.altKey){i&&i(m);return}const V=fI(B).activeElement;if(W==="ArrowDown")m.preventDefault(),yn(B,V,a,r,rc);else if(W==="ArrowUp")m.preventDefault(),yn(B,V,a,r,pb);else if(W==="Home")m.preventDefault(),yn(B,null,a,r,rc);else if(W==="End")m.preventDefault(),yn(B,null,a,r,pb);else if(W.length===1){const S=G.current,y=W.toLowerCase(),f=performance.now();S.keys.length>0&&(f-S.lastTime>500?(S.keys=[],S.repeating=!0,S.previousKeyMatched=!0):S.repeating&&y!==S.keys[0]&&(S.repeating=!1)),S.lastTime=f,S.keys.push(y);const k=V&&!S.repeating&&Ph(V,S);S.previousKeyMatched&&(k||yn(B,V,!1,r,rc,S))?m.preventDefault():S.previousKeyMatched=!1}i&&i(m)},h=ve(p,I);let u=-1;d.Children.forEach(n,(m,B)=>{if(!d.isValidElement(m)){u===B&&(u+=1,u>=n.length&&(u=-1));return}m.props.disabled||(c==="selectedMenu"&&m.props.selected||u===-1)&&(u=B),u===B&&(m.props.disabled||m.props.muiSkipListHighlight||m.type.muiSkipListHighlight)&&(u+=1,u>=n.length&&(u=-1))});const b=d.Children.map(n,(m,B)=>{if(B===u){const W={};return l&&(W.autoFocus=!0),m.props.tabIndex===void 0&&c==="selectedMenu"&&(W.tabIndex=0),d.cloneElement(m,W)}return m});return s.jsx(OH,{role:"menu",ref:h,className:o,onKeyDown:Z,tabIndex:C?0:-1,...A,children:b})});function $H(g){return pg("MuiPopover",g)}Gg("MuiPopover",["root","paper"]);function hb(g,e){let I=0;return typeof e=="number"?I=e:e==="center"?I=g.height/2:e==="bottom"&&(I=g.height),I}function yb(g,e){let I=0;return typeof e=="number"?I=e:e==="center"?I=g.width/2:e==="right"&&(I=g.width),I}function Bb(g){return[g.horizontal,g.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function ac(g){return typeof g=="function"?g():g}const _H=g=>{const{classes:e}=g;return Sg({root:["root"],paper:["paper"]},$H,e)},g1=j(cu,{name:"MuiPopover",slot:"Root",overridesResolver:(g,e)=>e.root})({}),Oh=j(Vt,{name:"MuiPopover",slot:"Paper",overridesResolver:(g,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),e1=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiPopover"}),{action:C,anchorEl:l,anchorOrigin:n={vertical:"top",horizontal:"left"},anchorPosition:o,anchorReference:r="anchorEl",children:a,className:i,container:c,elevation:A=8,marginThreshold:p=16,open:G,PaperProps:Z={},slots:h={},slotProps:u={},transformOrigin:b={vertical:"top",horizontal:"left"},TransitionComponent:m=XA,transitionDuration:B="auto",TransitionProps:{onEntering:W,...R}={},disableScrollLock:V=!1,...S}=t,y=(u==null?void 0:u.paper)??Z,f=d.useRef(),k={...t,anchorOrigin:n,anchorReference:r,elevation:A,marginThreshold:p,externalPaperSlotProps:y,transformOrigin:b,TransitionComponent:m,transitionDuration:B,TransitionProps:R},H=_H(k),M=d.useCallback(()=>{if(r==="anchorPosition")return o;const Ig=ac(l),hg=(Ig&&Ig.nodeType===1?Ig:fI(f.current).body).getBoundingClientRect();return{top:hg.top+hb(hg,n.vertical),left:hg.left+yb(hg,n.horizontal)}},[l,n.horizontal,n.vertical,o,r]),F=d.useCallback(Ig=>({vertical:hb(Ig,b.vertical),horizontal:yb(Ig,b.horizontal)}),[b.horizontal,b.vertical]),x=d.useCallback(Ig=>{const cg={width:Ig.offsetWidth,height:Ig.offsetHeight},hg=F(cg);if(r==="none")return{top:null,left:null,transformOrigin:Bb(hg)};const se=M();let Ag=se.top-hg.vertical,Jg=se.left-hg.horizontal;const Ve=Ag+cg.height,Me=Jg+cg.width,jg=DC(ac(l)),ce=jg.innerHeight-p,CI=jg.innerWidth-p;if(p!==null&&Ag<p){const xg=Ag-p;Ag-=xg,hg.vertical+=xg}else if(p!==null&&Ve>ce){const xg=Ve-ce;Ag-=xg,hg.vertical+=xg}if(p!==null&&Jg<p){const xg=Jg-p;Jg-=xg,hg.horizontal+=xg}else if(Me>CI){const xg=Me-CI;Jg-=xg,hg.horizontal+=xg}return{top:`${Math.round(Ag)}px`,left:`${Math.round(Jg)}px`,transformOrigin:Bb(hg)}},[l,r,M,F,p]),[L,D]=d.useState(G),Y=d.useCallback(()=>{const Ig=f.current;if(!Ig)return;const cg=x(Ig);cg.top!==null&&Ig.style.setProperty("top",cg.top),cg.left!==null&&(Ig.style.left=cg.left),Ig.style.transformOrigin=cg.transformOrigin,D(!0)},[x]);d.useEffect(()=>(V&&window.addEventListener("scroll",Y),()=>window.removeEventListener("scroll",Y)),[l,V,Y]);const K=(Ig,cg)=>{W&&W(Ig,cg),Y()},O=()=>{D(!1)};d.useEffect(()=>{G&&Y()}),d.useImperativeHandle(C,()=>G?{updatePosition:()=>{Y()}}:null,[G,Y]),d.useEffect(()=>{if(!G)return;const Ig=Rh(()=>{Y()}),cg=DC(l);return cg.addEventListener("resize",Ig),()=>{Ig.clear(),cg.removeEventListener("resize",Ig)}},[l,G,Y]);let lg=B;B==="auto"&&!m.muiSupportAuto&&(lg=void 0);const ag=c||(l?fI(ac(l)).body:void 0),ig={slots:h,slotProps:{...u,paper:y}},[sg,eg]=oI("paper",{elementType:Oh,externalForwardedProps:ig,additionalProps:{elevation:A,className:og(H.paper,y==null?void 0:y.className),style:L?y.style:{...y.style,opacity:0}},ownerState:k}),[q,{slotProps:E,...Q}]=oI("root",{elementType:g1,externalForwardedProps:ig,additionalProps:{slotProps:{backdrop:{invisible:!0}},container:ag,open:G},ownerState:k,className:og(H.root,i)}),Cg=ve(f,eg.ref);return s.jsx(q,{...Q,...!SA(q)&&{slotProps:E,disableScrollLock:V},...S,ref:I,children:s.jsx(m,{appear:!0,in:G,onEntering:K,onExited:O,timeout:lg,...R,children:s.jsx(sg,{...eg,ref:Cg,children:a})})})});function I1(g){return pg("MuiMenu",g)}Gg("MuiMenu",["root","paper","list"]);const t1={vertical:"top",horizontal:"right"},C1={vertical:"top",horizontal:"left"},l1=g=>{const{classes:e}=g;return Sg({root:["root"],paper:["paper"],list:["list"]},I1,e)},n1=j(e1,{shouldForwardProp:g=>qe(g)||g==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(g,e)=>e.root})({}),o1=j(Oh,{name:"MuiMenu",slot:"Paper",overridesResolver:(g,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),r1=j(qH,{name:"MuiMenu",slot:"List",overridesResolver:(g,e)=>e.list})({outline:0}),a1=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiMenu"}),{autoFocus:C=!0,children:l,className:n,disableAutoFocusItem:o=!1,MenuListProps:r={},onClose:a,open:i,PaperProps:c={},PopoverClasses:A,transitionDuration:p="auto",TransitionProps:{onEntering:G,...Z}={},variant:h="selectedMenu",slots:u={},slotProps:b={},...m}=t,B=D2(),W={...t,autoFocus:C,disableAutoFocusItem:o,MenuListProps:r,onEntering:G,PaperProps:c,transitionDuration:p,TransitionProps:Z,variant:h},R=l1(W),V=C&&!o&&i,S=d.useRef(null),y=(L,D)=>{S.current&&S.current.adjustStyleForScrollbar(L,{direction:B?"rtl":"ltr"}),G&&G(L,D)},f=L=>{L.key==="Tab"&&(L.preventDefault(),a&&a(L,"tabKeyDown"))};let k=-1;d.Children.map(l,(L,D)=>{d.isValidElement(L)&&(L.props.disabled||(h==="selectedMenu"&&L.props.selected||k===-1)&&(k=D))});const H=u.paper??o1,M=b.paper??c,F=QZ({elementType:u.root,externalSlotProps:b.root,ownerState:W,className:[R.root,n]}),x=QZ({elementType:H,externalSlotProps:M,ownerState:W,className:R.paper});return s.jsx(n1,{onClose:a,anchorOrigin:{vertical:"bottom",horizontal:B?"right":"left"},transformOrigin:B?t1:C1,slots:{paper:H,root:u.root},slotProps:{root:F,paper:x},open:i,ref:I,transitionDuration:p,TransitionProps:{onEntering:y,...Z},ownerState:W,...m,classes:A,children:s.jsx(r1,{onKeyDown:f,actions:S,autoFocus:C&&(k===-1||o),autoFocusItem:V,variant:h,...r,className:og(R.list,r.className),children:l})})});function i1(g){return pg("MuiMenuItem",g)}const Bn=Gg("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),s1=(g,e)=>{const{ownerState:I}=g;return[e.root,I.dense&&e.dense,I.divider&&e.divider,!I.disableGutters&&e.gutters]},c1=g=>{const{disabled:e,dense:I,divider:t,disableGutters:C,selected:l,classes:n}=g,r=Sg({root:["root",I&&"dense",e&&"disabled",!C&&"gutters",t&&"divider",l&&"selected"]},i1,n);return{...n,...r}},A1=j(Pi,{shouldForwardProp:g=>qe(g)||g==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:s1})(Hg(({theme:g})=>({...g.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(g.vars||g).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Bn.selected}`]:{backgroundColor:g.vars?`rgba(${g.vars.palette.primary.mainChannel} / ${g.vars.palette.action.selectedOpacity})`:Ze(g.palette.primary.main,g.palette.action.selectedOpacity),[`&.${Bn.focusVisible}`]:{backgroundColor:g.vars?`rgba(${g.vars.palette.primary.mainChannel} / calc(${g.vars.palette.action.selectedOpacity} + ${g.vars.palette.action.focusOpacity}))`:Ze(g.palette.primary.main,g.palette.action.selectedOpacity+g.palette.action.focusOpacity)}},[`&.${Bn.selected}:hover`]:{backgroundColor:g.vars?`rgba(${g.vars.palette.primary.mainChannel} / calc(${g.vars.palette.action.selectedOpacity} + ${g.vars.palette.action.hoverOpacity}))`:Ze(g.palette.primary.main,g.palette.action.selectedOpacity+g.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:g.vars?`rgba(${g.vars.palette.primary.mainChannel} / ${g.vars.palette.action.selectedOpacity})`:Ze(g.palette.primary.main,g.palette.action.selectedOpacity)}},[`&.${Bn.focusVisible}`]:{backgroundColor:(g.vars||g).palette.action.focus},[`&.${Bn.disabled}`]:{opacity:(g.vars||g).palette.action.disabledOpacity},[`& + .${db.root}`]:{marginTop:g.spacing(1),marginBottom:g.spacing(1)},[`& + .${db.inset}`]:{marginLeft:52},[`& .${Gb.root}`]:{marginTop:0,marginBottom:0},[`& .${Gb.inset}`]:{paddingLeft:36},[`& .${bb.root}`]:{minWidth:36},variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(g.vars||g).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>!e.dense,style:{[g.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:e})=>e.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...g.typography.body2,[`& .${bb.root} svg`]:{fontSize:"1.25rem"}}}]}))),Ql=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiMenuItem"}),{autoFocus:C=!1,component:l="li",dense:n=!1,divider:o=!1,disableGutters:r=!1,focusVisibleClassName:a,role:i="menuitem",tabIndex:c,className:A,...p}=t,G=d.useContext(kA),Z=d.useMemo(()=>({dense:n||G.dense||!1,disableGutters:r}),[G.dense,n,r]),h=d.useRef(null);dC(()=>{C&&h.current&&h.current.focus()},[C]);const u={...t,dense:Z.dense,divider:o,disableGutters:r},b=c1(t),m=ve(h,I);let B;return t.disabled||(B=c!==void 0?c:-1),s.jsx(kA.Provider,{value:Z,children:s.jsx(A1,{ref:m,role:i,tabIndex:B,component:l,focusVisibleClassName:og(b.focusVisible,a),className:og(b.root,A),...p,ownerState:u,classes:b})})});function d1(g){return pg("MuiNativeSelect",g)}const Au=Gg("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),u1=g=>{const{classes:e,variant:I,disabled:t,multiple:C,open:l,error:n}=g,o={select:["select",I,t&&"disabled",C&&"multiple",n&&"error"],icon:["icon",`icon${$(I)}`,l&&"iconOpen",t&&"disabled"]};return Sg(o,d1,e)},qh=j("select")(({theme:g})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${Au.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(g.vars||g).palette.background.paper},variants:[{props:({ownerState:e})=>e.variant!=="filled"&&e.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(g.vars||g).shape.borderRadius,"&:focus":{borderRadius:(g.vars||g).shape.borderRadius},"&&&":{paddingRight:32}}}]})),m1=j(qh,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:qe,overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.select,e[I.variant],I.error&&e.error,{[`&.${Au.multiple}`]:e.multiple}]}})({}),$h=j("svg")(({theme:g})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(g.vars||g).palette.action.active,[`&.${Au.disabled}`]:{color:(g.vars||g).palette.action.disabled},variants:[{props:({ownerState:e})=>e.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),Z1=j($h,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.icon,I.variant&&e[`icon${$(I.variant)}`],I.open&&e.iconOpen]}})({}),b1=d.forwardRef(function(e,I){const{className:t,disabled:C,error:l,IconComponent:n,inputRef:o,variant:r="standard",...a}=e,i={...e,disabled:C,variant:r,error:l},c=u1(i);return s.jsxs(d.Fragment,{children:[s.jsx(m1,{ownerState:i,className:og(c.select,t),disabled:C,ref:o||I,...a}),e.multiple?null:s.jsx(Z1,{as:n,ownerState:i,className:c.icon})]})});var Sb;const G1=j("fieldset",{shouldForwardProp:qe})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),p1=j("legend",{shouldForwardProp:qe})(Hg(({theme:g})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:e})=>!e.withLabel,style:{padding:0,lineHeight:"11px",transition:g.transitions.create("width",{duration:150,easing:g.transitions.easing.easeOut})}},{props:({ownerState:e})=>e.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:g.transitions.create("max-width",{duration:50,easing:g.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:e})=>e.withLabel&&e.notched,style:{maxWidth:"100%",transition:g.transitions.create("max-width",{duration:100,easing:g.transitions.easing.easeOut,delay:50})}}]})));function h1(g){const{children:e,classes:I,className:t,label:C,notched:l,...n}=g,o=C!=null&&C!=="",r={...g,notched:l,withLabel:o};return s.jsx(G1,{"aria-hidden":!0,className:t,ownerState:r,...n,children:s.jsx(p1,{ownerState:r,children:o?s.jsx("span",{children:C}):Sb||(Sb=s.jsx("span",{className:"notranslate",children:"​"}))})})}const y1=g=>{const{classes:e}=g,t=Sg({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Mv,e);return{...e,...t}},B1=j($i,{shouldForwardProp:g=>qe(g)||g==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:Oi})(Hg(({theme:g})=>{const e=g.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(g.vars||g).shape.borderRadius,[`&:hover .${At.notchedOutline}`]:{borderColor:(g.vars||g).palette.text.primary},[`&.${At.focused} .${At.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(g.palette).filter(Pe()).map(([I])=>({props:{color:I},style:{[`&.${At.focused} .${At.notchedOutline}`]:{borderColor:(g.vars||g).palette[I].main}}})),{props:{},style:{"@media (hover: none)":{[`&:hover .${At.notchedOutline}`]:{borderColor:g.vars?`rgba(${g.vars.palette.common.onBackgroundChannel} / 0.23)`:e}},[`&.${At.error} .${At.notchedOutline}`]:{borderColor:(g.vars||g).palette.error.main},[`&.${At.disabled} .${At.notchedOutline}`]:{borderColor:(g.vars||g).palette.action.disabled}}},{props:({ownerState:I})=>I.startAdornment,style:{paddingLeft:14}},{props:({ownerState:I})=>I.endAdornment,style:{paddingRight:14}},{props:({ownerState:I})=>I.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:I,size:t})=>I.multiline&&t==="small",style:{padding:"8.5px 14px"}}]}})),S1=j(h1,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(g,e)=>e.notchedOutline})(Hg(({theme:g})=>{const e=g.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:g.vars?`rgba(${g.vars.palette.common.onBackgroundChannel} / 0.23)`:e}})),W1=j(_i,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:qi})(Hg(({theme:g})=>({padding:"16.5px 14px",...!g.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:g.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:g.palette.mode==="light"?null:"#fff",caretColor:g.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...g.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[g.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:e})=>e.multiline,style:{padding:0}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}}]}))),Ha=d.forwardRef(function(e,I){var t;const C=fg({props:e,name:"MuiOutlinedInput"}),{components:l={},fullWidth:n=!1,inputComponent:o="input",label:r,multiline:a=!1,notched:i,slots:c={},type:A="text",...p}=C,G=y1(C),Z=Rt(),h=hC({props:C,muiFormControl:Z,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),u={...C,color:h.color||"primary",disabled:h.disabled,error:h.error,focused:h.focused,formControl:Z,fullWidth:n,hiddenLabel:h.hiddenLabel,multiline:a,size:h.size,type:A},b=c.root??l.Root??B1,m=c.input??l.Input??W1;return s.jsx(su,{slots:{root:b,input:m},renderSuffix:B=>s.jsx(S1,{ownerState:u,className:G.notchedOutline,label:r!=null&&r!==""&&h.required?t||(t=s.jsxs(d.Fragment,{children:[r," ","*"]})):r,notched:typeof i<"u"?i:!!(B.startAdornment||B.filled||B.focused)}),fullWidth:n,inputComponent:o,multiline:a,ref:I,type:A,...p,classes:{...G,notchedOutline:null}})});Ha&&(Ha.muiName="Input");const V1=te(s.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),R1=te(s.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),f1=j("span",{shouldForwardProp:qe})({position:"relative",display:"flex"}),X1=j(V1)({transform:"scale(1)"}),J1=j(R1)(Hg(({theme:g})=>({left:0,position:"absolute",transform:"scale(0)",transition:g.transitions.create("transform",{easing:g.transitions.easing.easeIn,duration:g.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:g.transitions.create("transform",{easing:g.transitions.easing.easeOut,duration:g.transitions.duration.shortest})}}]})));function _h(g){const{checked:e=!1,classes:I={},fontSize:t}=g,C={...g,checked:e};return s.jsxs(f1,{className:I.root,ownerState:C,children:[s.jsx(X1,{fontSize:t,className:I.background,ownerState:C}),s.jsx(J1,{fontSize:t,className:I.dot,ownerState:C})]})}const gy=d.createContext(void 0);function k1(){return d.useContext(gy)}function v1(g){return pg("MuiRadio",g)}const Wb=Gg("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),Y1=g=>{const{classes:e,color:I,size:t}=g,C={root:["root",`color${$(I)}`,t!=="medium"&&`size${$(t)}`]};return{...e,...Sg(C,v1,e)}},H1=j(Qh,{shouldForwardProp:g=>qe(g)||g==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.size!=="medium"&&e[`size${$(I.size)}`],e[`color${$(I.color)}`]]}})(Hg(({theme:g})=>({color:(g.vars||g).palette.text.secondary,[`&.${Wb.disabled}`]:{color:(g.vars||g).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:g.vars?`rgba(${g.vars.palette.action.activeChannel} / ${g.vars.palette.action.hoverOpacity})`:Ze(g.palette.action.active,g.palette.action.hoverOpacity)}}},...Object.entries(g.palette).filter(Pe()).map(([e])=>({props:{color:e,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:g.vars?`rgba(${g.vars.palette[e].mainChannel} / ${g.vars.palette.action.hoverOpacity})`:Ze(g.palette[e].main,g.palette.action.hoverOpacity)}}})),...Object.entries(g.palette).filter(Pe()).map(([e])=>({props:{color:e,disabled:!1},style:{[`&.${Wb.checked}`]:{color:(g.vars||g).palette[e].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function w1(g,e){return typeof e=="object"&&e!==null?g===e:String(g)===String(e)}const Vb=s.jsx(_h,{checked:!0}),Rb=s.jsx(_h,{}),fb=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiRadio"}),{checked:C,checkedIcon:l=Vb,color:n="primary",icon:o=Rb,name:r,onChange:a,size:i="medium",className:c,disabled:A,disableRipple:p=!1,...G}=t,Z=Rt();let h=A;Z&&typeof h>"u"&&(h=Z.disabled),h??(h=!1);const u={...t,disabled:h,disableRipple:p,color:n,size:i},b=Y1(u),m=k1();let B=C;const W=ZA(a,m&&m.onChange);let R=r;return m&&(typeof B>"u"&&(B=w1(m.value,t.value)),typeof R>"u"&&(R=m.name)),s.jsx(H1,{type:"radio",icon:d.cloneElement(o,{fontSize:Rb.props.fontSize??i}),checkedIcon:d.cloneElement(l,{fontSize:Vb.props.fontSize??i}),disabled:h,ownerState:u,classes:b,name:R,checked:B,onChange:W,ref:I,className:og(b.root,c),...G})});function N1(g){return pg("MuiRadioGroup",g)}Gg("MuiRadioGroup",["root","row","error"]);const F1=g=>{const{classes:e,row:I,error:t}=g;return Sg({root:["root",I&&"row",t&&"error"]},N1,e)},K1=d.forwardRef(function(e,I){const{actions:t,children:C,className:l,defaultValue:n,name:o,onChange:r,value:a,...i}=e,c=d.useRef(null),A=F1(e),[p,G]=Va({controlled:a,default:n,name:"RadioGroup"});d.useImperativeHandle(t,()=>({focus:()=>{let b=c.current.querySelector("input:not(:disabled):checked");b||(b=c.current.querySelector("input:not(:disabled)")),b&&b.focus()}}),[]);const Z=ve(I,c),h=Fi(o),u=d.useMemo(()=>({name:h,onChange(b){G(b.target.value),r&&r(b,b.target.value)},value:p}),[h,r,G,p]);return s.jsx(gy.Provider,{value:u,children:s.jsx(Dh,{role:"radiogroup",ref:Z,className:og(A.root,l),...i,children:C})})});function x1(g){return pg("MuiSelect",g)}const Sn=Gg("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var Xb;const E1=j(qh,{name:"MuiSelect",slot:"Select",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[{[`&.${Sn.select}`]:e.select},{[`&.${Sn.select}`]:e[I.variant]},{[`&.${Sn.error}`]:e.error},{[`&.${Sn.multiple}`]:e.multiple}]}})({[`&.${Sn.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),z1=j($h,{name:"MuiSelect",slot:"Icon",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.icon,I.variant&&e[`icon${$(I.variant)}`],I.open&&e.iconOpen]}})({}),M1=j("input",{shouldForwardProp:g=>Kh(g)&&g!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(g,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function Jb(g,e){return typeof e=="object"&&e!==null?g===e:String(g)===String(e)}function U1(g){return g==null||typeof g=="string"&&!g.trim()}const L1=g=>{const{classes:e,variant:I,disabled:t,multiple:C,open:l,error:n}=g,o={select:["select",I,t&&"disabled",C&&"multiple",n&&"error"],icon:["icon",`icon${$(I)}`,l&&"iconOpen",t&&"disabled"],nativeInput:["nativeInput"]};return Sg(o,x1,e)},Q1=d.forwardRef(function(e,I){var NI;const{"aria-describedby":t,"aria-label":C,autoFocus:l,autoWidth:n,children:o,className:r,defaultOpen:a,defaultValue:i,disabled:c,displayEmpty:A,error:p=!1,IconComponent:G,inputRef:Z,labelId:h,MenuProps:u={},multiple:b,name:m,onBlur:B,onChange:W,onClose:R,onFocus:V,onOpen:S,open:y,readOnly:f,renderValue:k,SelectDisplayProps:H={},tabIndex:M,type:F,value:x,variant:L="standard",...D}=e,[Y,K]=Va({controlled:x,default:i,name:"Select"}),[O,lg]=Va({controlled:y,default:a,name:"Select"}),ag=d.useRef(null),ig=d.useRef(null),[sg,eg]=d.useState(null),{current:q}=d.useRef(y!=null),[E,Q]=d.useState(),Cg=ve(I,Z),Ig=d.useCallback(ug=>{ig.current=ug,ug&&eg(ug)},[]),cg=sg==null?void 0:sg.parentNode;d.useImperativeHandle(Cg,()=>({focus:()=>{ig.current.focus()},node:ag.current,value:Y}),[Y]),d.useEffect(()=>{a&&O&&sg&&!q&&(Q(n?null:cg.clientWidth),ig.current.focus())},[sg,n]),d.useEffect(()=>{l&&ig.current.focus()},[l]),d.useEffect(()=>{if(!h)return;const ug=fI(ig.current).getElementById(h);if(ug){const Yg=()=>{getSelection().isCollapsed&&ig.current.focus()};return ug.addEventListener("click",Yg),()=>{ug.removeEventListener("click",Yg)}}},[h]);const hg=(ug,Yg)=>{ug?S&&S(Yg):R&&R(Yg),q||(Q(n?null:cg.clientWidth),lg(ug))},se=ug=>{ug.button===0&&(ug.preventDefault(),ig.current.focus(),hg(!0,ug))},Ag=ug=>{hg(!1,ug)},Jg=d.Children.toArray(o),Ve=ug=>{const Yg=Jg.find(he=>he.props.value===ug.target.value);Yg!==void 0&&(K(Yg.props.value),W&&W(ug,Yg))},Me=ug=>Yg=>{let he;if(Yg.currentTarget.hasAttribute("tabindex")){if(b){he=Array.isArray(Y)?Y.slice():[];const ft=Y.indexOf(ug.props.value);ft===-1?he.push(ug.props.value):he.splice(ft,1)}else he=ug.props.value;if(ug.props.onClick&&ug.props.onClick(Yg),Y!==he&&(K(he),W)){const ft=Yg.nativeEvent||Yg,In=new ft.constructor(ft.type,ft);Object.defineProperty(In,"target",{writable:!0,value:{value:he,name:m}}),W(In,ug)}b||hg(!1,Yg)}},jg=ug=>{f||[" ","ArrowUp","ArrowDown","Enter"].includes(ug.key)&&(ug.preventDefault(),hg(!0,ug))},ce=sg!==null&&O,CI=ug=>{!ce&&B&&(Object.defineProperty(ug,"target",{writable:!0,value:{value:Y,name:m}}),B(ug))};delete D["aria-invalid"];let xg,ZI;const U=[];let mg=!1;(ka({value:Y})||A)&&(k?xg=k(Y):mg=!0);const wg=Jg.map(ug=>{if(!d.isValidElement(ug))return null;let Yg;if(b){if(!Array.isArray(Y))throw new Error(Ut(2));Yg=Y.some(he=>Jb(he,ug.props.value)),Yg&&mg&&U.push(ug.props.children)}else Yg=Jb(Y,ug.props.value),Yg&&mg&&(ZI=ug.props.children);return d.cloneElement(ug,{"aria-selected":Yg?"true":"false",onClick:Me(ug),onKeyUp:he=>{he.key===" "&&he.preventDefault(),ug.props.onKeyUp&&ug.props.onKeyUp(he)},role:"option",selected:Yg,value:void 0,"data-value":ug.props.value})});mg&&(b?U.length===0?xg=null:xg=U.reduce((ug,Yg,he)=>(ug.push(Yg),he<U.length-1&&ug.push(", "),ug),[]):xg=ZI);let Zg=E;!n&&q&&sg&&(Zg=cg.clientWidth);let _g;typeof M<"u"?_g=M:_g=c?null:0;const lI=H.id||(m?`mui-component-select-${m}`:void 0),bI={...e,variant:L,value:Y,open:ce,error:p},pe=L1(bI),kg={...u.PaperProps,...(NI=u.slotProps)==null?void 0:NI.paper},OI=Fi();return s.jsxs(d.Fragment,{children:[s.jsx(E1,{as:"div",ref:Ig,tabIndex:_g,role:"combobox","aria-controls":OI,"aria-disabled":c?"true":void 0,"aria-expanded":ce?"true":"false","aria-haspopup":"listbox","aria-label":C,"aria-labelledby":[h,lI].filter(Boolean).join(" ")||void 0,"aria-describedby":t,onKeyDown:jg,onMouseDown:c||f?null:se,onBlur:CI,onFocus:V,...H,ownerState:bI,className:og(H.className,pe.select,r),id:lI,children:U1(xg)?Xb||(Xb=s.jsx("span",{className:"notranslate",children:"​"})):xg}),s.jsx(M1,{"aria-invalid":p,value:Array.isArray(Y)?Y.join(","):Y,name:m,ref:ag,"aria-hidden":!0,onChange:Ve,tabIndex:-1,disabled:c,className:pe.nativeInput,autoFocus:l,...D,ownerState:bI}),s.jsx(z1,{as:G,className:pe.icon,ownerState:bI}),s.jsx(a1,{id:`menu-${m||""}`,anchorEl:cg,open:ce,onClose:Ag,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...u,MenuListProps:{"aria-labelledby":h,role:"listbox","aria-multiselectable":b?"true":void 0,disableListWrap:!0,id:OI,...u.MenuListProps},slotProps:{...u.slotProps,paper:{...kg,style:{minWidth:Zg,...kg!=null?kg.style:null}}},children:wg})]})}),T1=g=>{const{classes:e}=g;return e},du={name:"MuiSelect",overridesResolver:(g,e)=>e.root,shouldForwardProp:g=>qe(g)&&g!=="variant",slot:"Root"},D1=j(Ya,du)(""),j1=j(Ha,du)(""),P1=j(va,du)(""),wa=d.forwardRef(function(e,I){const t=Fh({name:"MuiSelect",props:e}),{autoWidth:C=!1,children:l,classes:n={},className:o,defaultOpen:r=!1,displayEmpty:a=!1,IconComponent:i=Lv,id:c,input:A,inputProps:p,label:G,labelId:Z,MenuProps:h,multiple:u=!1,native:b=!1,onClose:m,onOpen:B,open:W,renderValue:R,SelectDisplayProps:V,variant:S="outlined",...y}=t,f=b?b1:Q1,k=Rt(),H=hC({props:t,muiFormControl:k,states:["variant","error"]}),M=H.variant||S,F={...t,variant:M,classes:n},x=T1(F),{root:L,...D}=x,Y=A||{standard:s.jsx(D1,{ownerState:F}),outlined:s.jsx(j1,{label:G,ownerState:F}),filled:s.jsx(P1,{ownerState:F})}[M],K=ve(I,Mo(Y));return s.jsx(d.Fragment,{children:d.cloneElement(Y,{inputComponent:f,inputProps:{children:l,error:H.error,IconComponent:i,variant:M,type:void 0,multiple:u,...b?{id:c}:{autoWidth:C,defaultOpen:r,displayEmpty:a,labelId:Z,MenuProps:h,onClose:m,onOpen:B,open:W,renderValue:R,SelectDisplayProps:{id:c,...V}},...p,classes:p?je(D,p.classes):D,...A?A.props.inputProps:{}},...(u&&b||a)&&M==="outlined"?{notched:!0}:{},ref:K,className:og(Y.props.className,o,x.root),...!A&&{variant:M},...y})})});wa.muiName="Select";const ey=d.createContext();function O1(g){return pg("MuiTable",g)}Gg("MuiTable",["root","stickyHeader"]);const q1=g=>{const{classes:e,stickyHeader:I}=g;return Sg({root:["root",I&&"stickyHeader"]},O1,e)},$1=j("table",{name:"MuiTable",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.stickyHeader&&e.stickyHeader]}})(Hg(({theme:g})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...g.typography.body2,padding:g.spacing(2),color:(g.vars||g).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:e})=>e.stickyHeader,style:{borderCollapse:"separate"}}]}))),kb="table",Tl=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiTable"}),{className:C,component:l=kb,padding:n="normal",size:o="medium",stickyHeader:r=!1,...a}=t,i={...t,component:l,padding:n,size:o,stickyHeader:r},c=q1(i),A=d.useMemo(()=>({padding:n,size:o,stickyHeader:r}),[n,o,r]);return s.jsx(ey.Provider,{value:A,children:s.jsx($1,{as:l,role:l===kb?null:"table",ref:I,className:og(c.root,C),ownerState:i,...a})})}),gs=d.createContext();function _1(g){return pg("MuiTableBody",g)}Gg("MuiTableBody",["root"]);const gw=g=>{const{classes:e}=g;return Sg({root:["root"]},_1,e)},ew=j("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(g,e)=>e.root})({display:"table-row-group"}),Iw={variant:"body"},vb="tbody",Lo=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiTableBody"}),{className:C,component:l=vb,...n}=t,o={...t,component:l},r=gw(o);return s.jsx(gs.Provider,{value:Iw,children:s.jsx(ew,{className:og(r.root,C),as:l,ref:I,role:l===vb?null:"rowgroup",ownerState:o,...n})})});function tw(g){return pg("MuiTableCell",g)}const Cw=Gg("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),lw=g=>{const{classes:e,variant:I,align:t,padding:C,size:l,stickyHeader:n}=g,o={root:["root",I,n&&"stickyHeader",t!=="inherit"&&`align${$(t)}`,C!=="normal"&&`padding${$(C)}`,`size${$(l)}`]};return Sg(o,tw,e)},nw=j("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,e[I.variant],e[`size${$(I.size)}`],I.padding!=="normal"&&e[`padding${$(I.padding)}`],I.align!=="inherit"&&e[`align${$(I.align)}`],I.stickyHeader&&e.stickyHeader]}})(Hg(({theme:g})=>({...g.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:g.vars?`1px solid ${g.vars.palette.TableCell.border}`:`1px solid
    ${g.palette.mode==="light"?Ul(Ze(g.palette.divider,1),.88):Ml(Ze(g.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(g.vars||g).palette.text.primary,lineHeight:g.typography.pxToRem(24),fontWeight:g.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(g.vars||g).palette.text.primary}},{props:{variant:"footer"},style:{color:(g.vars||g).palette.text.secondary,lineHeight:g.typography.pxToRem(21),fontSize:g.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${Cw.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:e})=>e.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(g.vars||g).palette.background.default}}]}))),rg=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiTableCell"}),{align:C="inherit",className:l,component:n,padding:o,scope:r,size:a,sortDirection:i,variant:c,...A}=t,p=d.useContext(ey),G=d.useContext(gs),Z=G&&G.variant==="head";let h;n?h=n:h=Z?"th":"td";let u=r;h==="td"?u=void 0:!u&&Z&&(u="col");const b=c||G&&G.variant,m={...t,align:C,component:h,padding:o||(p&&p.padding?p.padding:"normal"),size:a||(p&&p.size?p.size:"medium"),sortDirection:i,stickyHeader:b==="head"&&p&&p.stickyHeader,variant:b},B=lw(m);let W=null;return i&&(W=i==="asc"?"ascending":"descending"),s.jsx(nw,{as:h,ref:I,className:og(B.root,l),"aria-sort":W,scope:u,ownerState:m,...A})});function ow(g){return pg("MuiTableContainer",g)}Gg("MuiTableContainer",["root"]);const rw=g=>{const{classes:e}=g;return Sg({root:["root"]},ow,e)},aw=j("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(g,e)=>e.root})({width:"100%",overflowX:"auto"}),Qo=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiTableContainer"}),{className:C,component:l="div",...n}=t,o={...t,component:l},r=rw(o);return s.jsx(aw,{ref:I,as:l,className:og(r.root,C),ownerState:o,...n})});function iw(g){return pg("MuiTableHead",g)}Gg("MuiTableHead",["root"]);const sw=g=>{const{classes:e}=g;return Sg({root:["root"]},iw,e)},cw=j("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(g,e)=>e.root})({display:"table-header-group"}),Aw={variant:"head"},Yb="thead",To=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiTableHead"}),{className:C,component:l=Yb,...n}=t,o={...t,component:l},r=sw(o);return s.jsx(gs.Provider,{value:Aw,children:s.jsx(cw,{as:l,className:og(r.root,C),ref:I,role:l===Yb?null:"rowgroup",ownerState:o,...n})})});function dw(g){return pg("MuiTableRow",g)}const Hb=Gg("MuiTableRow",["root","selected","hover","head","footer"]),uw=g=>{const{classes:e,selected:I,hover:t,head:C,footer:l}=g;return Sg({root:["root",I&&"selected",t&&"hover",C&&"head",l&&"footer"]},dw,e)},mw=j("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(g,e)=>{const{ownerState:I}=g;return[e.root,I.head&&e.head,I.footer&&e.footer]}})(Hg(({theme:g})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${Hb.hover}:hover`]:{backgroundColor:(g.vars||g).palette.action.hover},[`&.${Hb.selected}`]:{backgroundColor:g.vars?`rgba(${g.vars.palette.primary.mainChannel} / ${g.vars.palette.action.selectedOpacity})`:Ze(g.palette.primary.main,g.palette.action.selectedOpacity),"&:hover":{backgroundColor:g.vars?`rgba(${g.vars.palette.primary.mainChannel} / calc(${g.vars.palette.action.selectedOpacity} + ${g.vars.palette.action.hoverOpacity}))`:Ze(g.palette.primary.main,g.palette.action.selectedOpacity+g.palette.action.hoverOpacity)}}}))),wb="tr",dI=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiTableRow"}),{className:C,component:l=wb,hover:n=!1,selected:o=!1,...r}=t,a=d.useContext(gs),i={...t,component:l,hover:n,selected:o,head:a&&a.variant==="head",footer:a&&a.variant==="footer"},c=uw(i);return s.jsx(mw,{as:l,ref:I,className:og(c.root,C),role:l===wb?null:"row",ownerState:i,...r})});function Zw(g){return pg("MuiTextField",g)}Gg("MuiTextField",["root"]);const bw={standard:Ya,filled:va,outlined:Ha},Gw=g=>{const{classes:e}=g;return Sg({root:["root"]},Zw,e)},pw=j(RA,{name:"MuiTextField",slot:"Root",overridesResolver:(g,e)=>e.root})({}),vg=d.forwardRef(function(e,I){const t=fg({props:e,name:"MuiTextField"}),{autoComplete:C,autoFocus:l=!1,children:n,className:o,color:r="primary",defaultValue:a,disabled:i=!1,error:c=!1,FormHelperTextProps:A,fullWidth:p=!1,helperText:G,id:Z,InputLabelProps:h,inputProps:u,InputProps:b,inputRef:m,label:B,maxRows:W,minRows:R,multiline:V=!1,name:S,onBlur:y,onChange:f,onFocus:k,placeholder:H,required:M=!1,rows:F,select:x=!1,SelectProps:L,slots:D={},slotProps:Y={},type:K,value:O,variant:lg="outlined",...ag}=t,ig={...t,autoFocus:l,color:r,disabled:i,error:c,fullWidth:p,multiline:V,required:M,select:x,variant:lg},sg=Gw(ig),eg=Fi(Z),q=G&&eg?`${eg}-helper-text`:void 0,E=B&&eg?`${eg}-label`:void 0,Q=bw[lg],Cg={slots:D,slotProps:{input:b,inputLabel:h,htmlInput:u,formHelperText:A,select:L,...Y}},Ig={},cg=Cg.slotProps.inputLabel;lg==="outlined"&&(cg&&typeof cg.shrink<"u"&&(Ig.notched=cg.shrink),Ig.label=B),x&&((!L||!L.native)&&(Ig.id=void 0),Ig["aria-describedby"]=void 0);const[hg,se]=oI("input",{elementType:Q,externalForwardedProps:Cg,additionalProps:Ig,ownerState:ig}),[Ag,Jg]=oI("inputLabel",{elementType:JA,externalForwardedProps:Cg,ownerState:ig}),[Ve,Me]=oI("htmlInput",{elementType:"input",externalForwardedProps:Cg,ownerState:ig}),[jg,ce]=oI("formHelperText",{elementType:yH,externalForwardedProps:Cg,ownerState:ig}),[CI,xg]=oI("select",{elementType:wa,externalForwardedProps:Cg,ownerState:ig}),ZI=s.jsx(hg,{"aria-describedby":q,autoComplete:C,autoFocus:l,defaultValue:a,fullWidth:p,multiline:V,name:S,rows:F,maxRows:W,minRows:R,type:K,value:O,id:eg,inputRef:m,onBlur:y,onChange:f,onFocus:k,placeholder:H,inputProps:Me,slots:{input:D.htmlInput?Ve:void 0},...se});return s.jsxs(pw,{className:og(sg.root,o),disabled:i,error:c,fullWidth:p,ref:I,required:M,color:r,variant:lg,ownerState:ig,...ag,children:[B!=null&&B!==""&&s.jsx(Ag,{htmlFor:eg,id:E,...Jg,children:B}),x?s.jsx(CI,{"aria-describedby":q,id:eg,labelId:E,value:O,input:ZI,...xg,children:n}):ZI,G&&s.jsx(jg,{id:q,...ce,children:G})]})}),uu=te(s.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),hw=()=>{const[g,e]=d.useState(""),[I,t]=d.useState(""),[C,l]=d.useState(""),[n,o]=d.useState(""),[r,a]=d.useState(""),[i,c]=d.useState(""),[A,p]=d.useState(""),[G,Z]=d.useState(""),[h,u]=d.useState(""),[b,m]=d.useState(""),[B,W]=d.useState(500),[R,V]=d.useState(""),[S,y]=d.useState(0),[f,k]=d.useState(!1),[H,M]=d.useState([]),[F,x]=d.useState([]),[L,D]=d.useState([]),[Y,K]=d.useState("");d.useState("");const[O,lg]=d.useState(0),[ag,ig]=d.useState([]),{pagos:sg,registroPago:eg,loadingPago:q,errorPago:E}=Ho(),{clases:Q,registroClase:Cg,loadingClase:Ig,errorClase:cg}=Ai(),{registro:hg,buscarAlumno:se,loading:Ag,error:Jg}=xd();rt();const Ve=()=>{const U=new Date,mg=U.getFullYear(),wg=String(U.getMonth()+1).padStart(2,"0"),Zg=String(U.getDate()).padStart(2,"0");return`${mg}-${wg}-${Zg}`},Me=U=>{const mg=new Date(U);return mg.setMonth(mg.getMonth()+1),mg.toISOString().split("T")[0]},jg=()=>{ig(U=>[...U,{idClase:"",horario:""}])},ce=(U,mg,wg)=>{const Zg=[...ag];Zg[U][mg]=wg,ig(Zg)},CI=()=>{const U=ag.reduce((mg,wg)=>{const Zg=Q.find(_g=>_g.idClase===wg.idClase);return mg+(Zg?Zg.costo:0)},0);lg(U+Number(B))};d.useEffect(()=>{console.log("dd"),CI()},[ag,B]),d.useEffect(()=>{const U=Ve();if(m(U),V(Me(U)),!f&&h){const mg=Q.find(wg=>wg.idClase===h);mg&&(y(mg.costo),x(mg.dias),D(mg.horario||[]),K(mg.turno))}else if(f&&H.length>0){const mg=H.reduce((wg,Zg)=>{const _g=Q.find(lI=>lI.idClase===Zg);return wg+(_g?_g.costo:0)},B);console.log(`Costo Total del Paquete: ${mg}`),lg(mg)}},[h,f,Q,B,H]),d.useEffect(()=>{var mg;console.log(Q);const U=f?H.reduce((wg,Zg)=>{const _g=Q.find(lI=>lI.idClase===Zg);return wg+(_g?_g.costo:0)},B):B+(((mg=Q.find(wg=>wg.idClase===h))==null?void 0:mg.costo)||0);lg(U)},[f,H,B,h,Q]);const xg=async U=>{if(U.preventDefault(),!ag.every(wg=>wg.idClase&&wg.horario)){alert("Por favor, asegúrate de que todas las clases tengan una clase y un horario seleccionados.");return}try{const wg=B+ag.reduce((pe,kg)=>{const OI=Q.find(NI=>NI.idClase===kg.idClase);return pe+(OI?OI.costo:0)},0),Zg={curp:g,nombre:I,apellidos:C,tutor:n,correo:r,telefono:i,fechaNacimiento:A},_g=ag.map(pe=>({idClase:pe.idClase,fechaInscripcion:b,acceso:!0,horario:pe.horario})),lI={fecha_pago:Ve(),pago_realizado:Ve(),monto:wg,estatus:"completado",proximo_pago:R,motivo:"Inscripción y primera mensualidad"};console.log("Datos a enviar:",{montoTotal:wg});const bI=await hg(Zg,lI,_g)}catch(wg){console.error("Error en el registro:",wg),Z("")}},ZI=U=>{ig(mg=>mg.filter((wg,Zg)=>Zg!==U))};return s.jsxs("div",{className:"form-container",children:[s.jsx(gI,{variant:"h4",gutterBottom:!0,className:"title",children:"Registro de Alumno"}),s.jsx("form",{onSubmit:xg,children:s.jsxs(tg,{container:!0,spacing:2,children:[s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"CURP",value:g,onChange:U=>e(U.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Nombre",value:I,onChange:U=>t(U.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Apellidos",value:C,onChange:U=>l(U.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Nombre del Tutor",value:n,onChange:U=>o(U.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Correo",type:"email",value:r,onChange:U=>a(U.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Teléfono",value:i,onChange:U=>c(U.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Fecha de Nacimiento",type:"date",value:A,onChange:U=>p(U.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Fecha de Inscripción",type:"date",value:b,onChange:U=>m(U.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Próxima Fecha de Pago",type:"date",value:R,onChange:U=>V(U.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Costo Inscripción",type:"number",value:B,onChange:U=>W(Number(U.target.value)),required:!0,fullWidth:!0,className:"text-field"})}),ag.map((U,mg)=>{var wg;return s.jsxs(tg,{item:!0,xs:10,container:!0,spacing:2,alignItems:"center",children:[s.jsx(tg,{item:!0,xs:6,children:s.jsxs(RA,{fullWidth:!0,children:[s.jsx(JA,{children:"Clase"}),s.jsx(wa,{value:U.idClase,onChange:Zg=>ce(mg,"idClase",Zg.target.value),MenuProps:{PaperProps:{style:{maxHeight:200,overflowY:"auto"}}},children:Q.map(Zg=>s.jsxs(Ql,{value:Zg.idClase,disabled:ag.some(_g=>_g.idClase===Zg.idClase&&_g.idClase!==U.idClase),children:[Zg.nombre," - $",Zg.costo]},Zg.idClase))})]})}),s.jsx(tg,{item:!0,xs:4,children:s.jsxs(RA,{fullWidth:!0,children:[s.jsx(JA,{children:"Horario"}),s.jsx(wa,{value:U.horario,onChange:Zg=>ce(mg,"horario",Zg.target.value),disabled:!U.idClase,children:U.idClase&&((wg=Q.find(Zg=>Zg.idClase===U.idClase))==null?void 0:wg.horario.map(Zg=>s.jsx(Ql,{value:Zg,children:Zg},Zg)))})]})}),s.jsx(tg,{item:!0,xs:2,children:s.jsx(Je,{variant:"outlined",color:"secondary",onClick:()=>ZI(mg),startIcon:s.jsx(uu,{}),sx:{color:"red",borderColor:"red"}})})]},mg)}),s.jsx(tg,{item:!0,xs:12,children:s.jsx(Je,{variant:"contained",color:"primary",onClick:jg,children:"Agregar Clase"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Total",type:"number",value:O,disabled:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,children:s.jsx(Je,{type:"submit",variant:"contained",color:"primary",disabled:Ag||q,children:Ag||q?s.jsx(JI,{size:24}):"Registrar"})})]})}),G&&s.jsx(nt,{severity:"success",children:G}),Jg&&s.jsx(nt,{severity:"error",children:"El alumno ya está registrado. No se puede registrar nuevamente."}),E&&s.jsx(nt,{severity:"error",children:E.message})]})},yw=te(s.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),Bw=te(s.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddBox"),Sw=te(s.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m0 4c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3m6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1z"}),"AssignmentInd"),Ww=te([s.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),s.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt"),Vw=te(s.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Rw=te(s.jsx("path",{d:"M19 19V5c0-1.1-.9-2-2-2H7c-1.1 0-2 .9-2 2v14H3v2h18v-2zm-2 0H7V5h10zm-4-8h2v2h-2z"}),"DoorFrontOutlined"),fw=te(s.jsx("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download"),Xw=te(s.jsx("path",{fillRule:"evenodd",d:"m9 17 3-2.94c-.39-.04-.68-.06-1-.06-2.67 0-8 1.34-8 4v2h9zm2-5c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m4.47 8.5L12 17l1.4-1.41 2.07 2.08 5.13-5.17 1.4 1.41z"}),"HowToReg"),Jw=te(s.jsx("path",{d:"M3 13h2v-2H3zm0 4h2v-2H3zm0-8h2V7H3zm4 4h14v-2H7zm0 4h14v-2H7zM7 7v2h14V7z"}),"List"),kw=te(s.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),vw=te(s.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3zm-3-7V3.5L18.5 9z"}),"NoteAdd"),Yw=te(s.jsx("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd"),Hw=te(s.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School"),ww=()=>{const{alumnos:g,loading:e,error:I,listaAlumnos:t}=xd(),C=rt();if(d.useEffect(()=>{t()},[]),e)return s.jsx(JI,{});if(I)return s.jsx(nt,{severity:"error",children:I});const l=()=>{C("/registroAlumno")},n=o=>{console.log(o)};return s.jsxs("div",{className:"table-container-wrapper",children:[s.jsxs(Qo,{component:Vt,className:"table-container",children:[s.jsx("div",{className:"table-header",children:s.jsx(Tl,{"aria-label":"lista de alumnos",children:s.jsx(To,{children:s.jsxs(dI,{children:[s.jsx(rg,{className:"table-head-cell",children:"ID"}),s.jsx(rg,{className:"table-head-cell",children:"Nombre"}),s.jsx(rg,{className:"table-head-cell",children:"Apellidos"}),s.jsx(rg,{className:"table-head-cell",children:"Tutor"}),s.jsx(rg,{className:"table-head-cell",children:"Correo"}),s.jsx(rg,{className:"table-head-cell",children:"Teléfono"}),s.jsx(rg,{className:"table-head-cell",children:"Fecha de Nacimiento"})]})})})}),s.jsx("div",{className:"table-body-wrapper",children:s.jsx(Tl,{children:s.jsx(Lo,{children:g.map(o=>s.jsxs(dI,{className:"table-row",onClick:()=>n(o),children:[s.jsx(rg,{className:"table-cell",children:o.curp}),s.jsx(rg,{className:"table-cell",children:o.nombre}),s.jsx(rg,{className:"table-cell",children:o.apellidos}),s.jsx(rg,{className:"table-cell",children:o.tutor}),s.jsx(rg,{className:"table-cell",children:o.correo}),s.jsx(rg,{className:"table-cell",children:o.telefono}),s.jsx(rg,{className:"table-cell",children:o.fechaNacimiento})]},o.curp))})})})]}),s.jsx(Je,{variant:"contained",className:"registrar-alumno",startIcon:s.jsx(yw,{}),onClick:l,children:"Nuevo Registro"})]})},Nw=()=>{const[g,e]=d.useState(""),[I,t]=d.useState(""),[C,l]=d.useState(""),[n,o]=d.useState(""),{registroInscripcion:r,loading:a,error:i}=wo(),c=A=>{A.preventDefault(),r({curp:g,idClase:I,fechaInscripcion:C,acceso:n})};return s.jsxs("div",{className:"form-container",children:[s.jsx(gI,{variant:"h4",gutterBottom:!0,className:"title",children:"Registro de Inscripción"}),s.jsx("form",{onSubmit:c,children:s.jsxs(tg,{container:!0,spacing:2,children:[s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"CURP",value:g,onChange:A=>e(A.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"ID de Clase",value:I,onChange:A=>t(A.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Fecha de Inscripción",type:"date",value:C,onChange:A=>l(A.target.value),required:!0,fullWidth:!0,InputLabelProps:{shrink:!0},className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Acceso",value:n,onChange:A=>o(A.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,className:"buttonContainer",children:s.jsx(Je,{type:"submit",variant:"contained",color:"primary",className:"button",disabled:a,children:a?s.jsx(JI,{size:24,className:"spinner"}):"Registrar"})}),i&&s.jsx(tg,{item:!0,xs:12,children:s.jsx(nt,{severity:"error",className:"alert",children:i})})]})})]})},Fw=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"],Kw=()=>{const[g,e]=d.useState(""),[I,t]=d.useState(""),[C,l]=d.useState(""),[n,o]=d.useState([]),[r,a]=d.useState([{inicio:"",fin:""}]),[i,c]=d.useState(""),{registroClase:A,loading:p,error:G}=Ai(),Z=B=>{B.preventDefault();const W=`${g}-${i}`,R=r.map(V=>`${V.inicio}-${V.fin}`).filter(V=>V.includes("-"));A({nombre:W,descripcion:I,costo:C,dias:n,horario:R})},h=B=>{const{value:W,checked:R}=B.target;o(V=>R?[...V,W]:V.filter(S=>S!==W))},u=(B,W,R)=>{const V=[...r];V[B][W]=R,a(V)},b=()=>{a([...r,{inicio:"",fin:""}])},m=B=>{const W=r.filter((R,V)=>V!==B);a(W)};return s.jsxs("div",{className:"form-container",children:[s.jsx(gI,{variant:"h4",gutterBottom:!0,className:"title",children:"Registro de Clase"}),s.jsx("form",{onSubmit:Z,children:s.jsxs(tg,{container:!0,spacing:2,children:[s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Nombre",value:g,onChange:B=>e(B.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Descripción",value:I,onChange:B=>t(B.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Costo",type:"number",step:"0.01",value:C,onChange:B=>l(B.target.value),required:!0,fullWidth:!0,className:"text-field"})}),s.jsxs(tg,{item:!0,xs:12,sm:6,children:[s.jsx(gI,{variant:"subtitle1",gutterBottom:!0,children:"Turno"}),s.jsxs(K1,{row:!0,value:i,onChange:B=>c(B.target.value),children:[s.jsx(nc,{value:"Matutino",control:s.jsx(fb,{}),label:"Matutino"}),s.jsx(nc,{value:"Vespertino",control:s.jsx(fb,{}),label:"Vespertino"})]})]}),s.jsxs(tg,{item:!0,xs:12,sm:6,children:[s.jsx(gI,{variant:"subtitle1",gutterBottom:!0,children:"Días de la clase"}),s.jsx(Dh,{row:!0,children:Fw.map(B=>s.jsx(nc,{control:s.jsx(mY,{checked:n.includes(B),onChange:h,value:B}),label:B},B))})]}),s.jsxs(tg,{item:!0,xs:12,sm:6,children:[s.jsx(gI,{variant:"subtitle1",gutterBottom:!0,children:"Horarios"}),r.map((B,W)=>s.jsxs(tg,{container:!0,spacing:2,children:[s.jsx(tg,{item:!0,xs:5,children:s.jsx(vg,{label:"Hora de Inicio",type:"time",value:B.inicio,onChange:R=>u(W,"inicio",R.target.value),required:!0,fullWidth:!0,InputLabelProps:{shrink:!0},className:"text-field"})}),s.jsx(tg,{item:!0,xs:5,children:s.jsx(vg,{label:"Hora de Fin",type:"time",value:B.fin,onChange:R=>u(W,"fin",R.target.value),required:!0,fullWidth:!0,InputLabelProps:{shrink:!0},className:"text-field"})}),s.jsx(tg,{item:!0,xs:2,children:W>0&&s.jsx(Je,{variant:"contained",color:"secondary",onClick:()=>m(W),children:"Eliminar"})}),s.jsx(tg,{item:!0,xs:12,children:s.jsx("div",{style:{height:"20px"}})})]},W)),s.jsx(Je,{variant:"outlined",color:"primary",onClick:b,children:"Añadir Horario"})]}),s.jsx(tg,{item:!0,xs:12,className:"buttonContainer",children:s.jsx(Je,{type:"submit",variant:"contained",color:"primary",className:"button",disabled:p,children:p?s.jsx(JI,{size:24,className:"spinner"}):"Registrar"})}),G&&s.jsx(tg,{item:!0,xs:12,children:s.jsx(nt,{severity:"error",className:"alert",children:G})})]})})]})},es=$g.create({baseURL:"https://cadi.onrender.com/",headers:{"Content-Type":"application/json"}}),xw=async(g,e)=>{try{console.log(e);const I=await es.post("alumno/asistencia/",{curp:g,ids_inscripciones:e});return console.log(I.data),I.data}catch(I){throw console.error("Error:",I.response?I.response.data:I.message),I}},Ew=async()=>{try{return(await es.get("/alumno/inscripcionesAcceso/")).data}catch(g){throw console.error("Error:",g.response?g.response.data:g.message),g}},zw=async(g,e)=>{try{const I=new FormData;return I.append("curp",g),I.append("foto",e),(await es.post("alumno/enviarFoto/",I,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(I){throw console.error("Error:",I.response?I.response.data:I.message),I}},Mw=async g=>{try{const e=await es.get("/alumno/foto/",{params:{curp:g}});return console.log(e.data),e.data}catch(e){throw console.error("Error al obtener la foto del alumno:",e.response?e.response.data:e.message),e}},Iy=()=>{const[g,e]=d.useState([]),[I,t]=d.useState(!1),[C,l]=d.useState(null),[n,o]=d.useState(""),r=async(A,p)=>{t(!0),l(null);try{return await xw(A,p)}catch(G){throw l(G),G}finally{t(!1)}},a=async()=>{t(!0),l(null);try{const A=await Ew();e(A)}catch(A){l(A)}finally{t(!1)}},i=async(A,p)=>{t(!0),l(null);try{return await zw(A,p)}catch(G){throw l(G),G}finally{t(!1)}},c=async A=>{t(!0),l(null);try{const p=await Mw(A);return o(p),p}catch(p){throw l(p),p}finally{t(!1)}};return d.useEffect(()=>{a()},[]),{registrarAsistencia:r,registrarFoto:i,obtenerFoto:c,fotoUrl:n,inscripciones:g,loading:I,error:C}},Uw=()=>{const[g,e]=d.useState(""),{inscripciones:I,registrarAsistencia:t,loading:C,error:l}=Iy(),[n,o]=d.useState(null),[r,a]=d.useState(!1),[i,c]=d.useState(!1),[A,p]=d.useState(""),G=u=>{o(u),a(!0)},Z=async()=>{if(n){const{curp:u}=n,b={curp:u,ids_inscripciones:[n.idInscripcion]};try{const m=await t(b.curp,b.ids_inscripciones);p(m[0].mensaje),a(!1),c(!0)}catch(m){console.error("Error al registrar asistencia:",m)}}};if(C)return s.jsx(JI,{});if(l)return s.jsx(nt,{severity:"error",children:l.message});const h=g.trim()===""?I:I.filter(u=>{var b;return(b=u.nombre_alumno)==null?void 0:b.toLowerCase().includes(g.toLowerCase())});return s.jsxs("div",{className:"table-container-wrapper",children:[s.jsx(gI,{variant:"h4",align:"center",gutterBottom:!0,children:"Registro de Asistencia"}),s.jsx("div",{className:"search-container",children:s.jsx(vg,{label:"Buscar por Nombre del Alumno",variant:"outlined",fullWidth:!0,value:g,onChange:u=>e(u.target.value),style:{marginBottom:"20px"}})}),s.jsx(Qo,{component:Vt,className:"table-container",children:s.jsxs(Tl,{"aria-label":"lista de inscripciones",className:"table",children:[s.jsx(To,{className:"table-head",children:s.jsxs(dI,{children:[s.jsx(rg,{className:"table-head-cell",children:"ID"}),s.jsx(rg,{className:"table-head-cell",children:"CURP"}),s.jsx(rg,{className:"table-head-cell",children:"Clase"}),s.jsx(rg,{className:"table-head-cell",children:"Nombre del Alumno"}),s.jsx(rg,{className:"table-head-cell",children:"Apellidos"}),s.jsx(rg,{className:"table-head-cell",children:"Horario"})]})}),s.jsx(Lo,{children:h.length>0?h.map(u=>s.jsxs(dI,{className:"table-row",onClick:()=>G(u),children:[s.jsx(rg,{className:"table-cell",children:u.idInscripcion||"-"}),s.jsx(rg,{className:"table-cell",children:u.curp||"-"}),s.jsx(rg,{className:"table-cell",children:u.nombre_clase||"-"}),s.jsx(rg,{className:"table-cell",children:u.nombre_alumno||"-"}),s.jsx(rg,{className:"table-cell",children:u.apellidos_alumno||"-"}),s.jsx(rg,{className:"table-cell",children:u.horario||"-"})]},u.idInscripcion)):s.jsx(dI,{children:s.jsx(rg,{colSpan:6,align:"center",children:"No se encontraron inscripciones."})})})]})}),s.jsxs(ib,{open:r,onClose:()=>a(!1),className:"modal-dialog",children:[s.jsx(Ab,{className:"modal-title",children:"Registrar Asistencia"}),s.jsx(cb,{className:"modal-content",children:n&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["ID de Inscripción: ",n.idInscripcion]}),s.jsxs("p",{children:["CURP: ",n.curp]}),s.jsxs("p",{children:["Nombre del Alumno: ",n.nombre_alumno]}),s.jsxs("p",{children:["Clase: ",n.nombre_clase]})]})}),s.jsxs(sb,{className:"modal-actions",children:[s.jsx(Je,{onClick:Z,color:"primary",variant:"contained",children:"Registrar Asistencia"}),s.jsx(Je,{onClick:()=>a(!1),color:"secondary",variant:"outlined",children:"Cancelar"})]})]}),s.jsxs(ib,{open:i,onClose:()=>c(!1),className:"modal-dialog",children:[s.jsx(Ab,{className:"modal-title",children:"Resultado de Registro"}),s.jsx(cb,{className:"modal-content",children:A&&s.jsx("p",{className:"result-message",children:A})}),s.jsx(sb,{className:"modal-actions",children:s.jsxs("div",{style:{display:"flex",justifyContent:"center",width:"100%"},children:[" ",s.jsx(Je,{onClick:()=>c(!1),color:"primary",variant:"contained",children:"Aceptar"})]})})]})]})},Lw=()=>{const{idPago:g,curp:e,monto:I}=Jd(),[t,C]=d.useState(new Date().toISOString().split("T")[0]);d.useState([]);const{registroPago:l,listarPagosPorCurp:n,loading:o,error:r}=Ho();d.useEffect(()=>{console.log("CURP desde los parámetros:",e),console.log("ID de Clase desde los parámetros:",g),console.log("ID de Clase desde los parámetros:",I)},[e,g,I]);const a=async i=>{i.preventDefault();try{await l({idPago:g}),alert("Pago registrado exitosamente")}catch(c){alert(`Error al registrar el pago: ${c.message}`)}};return s.jsxs("div",{className:"form-container",children:[s.jsx(gI,{variant:"h4",gutterBottom:!0,className:"title",children:"Registro de Pago"}),s.jsx("form",{onSubmit:a,children:s.jsxs(tg,{container:!0,spacing:2,children:[s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"CURP",value:e,required:!0,fullWidth:!0,className:"text-field",disabled:!0})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Monto",type:"number",value:I,required:!0,fullWidth:!0,className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:6,children:s.jsx(vg,{label:"Fecha",type:"date",value:t,onChange:i=>C(i.target.value),required:!0,fullWidth:!0,InputLabelProps:{shrink:!0},className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,className:"buttonContainer",children:s.jsx(Je,{type:"submit",variant:"contained",color:"primary",className:"button",disabled:o,children:o?s.jsx(JI,{size:24,className:"spinner"}):"Registrar Pago"})}),r&&s.jsx(tg,{item:!0,xs:12,children:s.jsx(nt,{severity:"error",className:"alert",children:r.message})})]})})]})},mu=$g.create({baseURL:"https://cadi.onrender.com/",headers:{"Content-Type":"application/json"}}),Qw=async(g,e,I,t)=>{try{return console.log(t),{data:(await mu.post("/clase/registrarPaquete/",{paquete:g,clasesSeleccionadas:e,listaPagos:I,datosInscripciones:t})).data,error:null}}catch(C){return console.error("Error:",C.message),{data:null,error:C.message}}},Tw=async()=>{try{return{data:(await mu.get("/clase/listarPaquetes/")).data,error:null}}catch(g){return console.error("Error:",g.message),{data:[],error:g.message}}},Dw=async(g,e)=>{try{return{data:(await mu.delete("/clase/eliminarClasePaquete/",{data:{idClase:g,curp:e}})).data,error:null}}catch(I){return console.error("Error:",I.message),{data:null,error:I.message}}},Zu=()=>{const[g,e]=d.useState(!1),[I,t]=d.useState(null),[C,l]=d.useState(!1),[n,o]=d.useState([]),r=async(c,A,p,G)=>{e(!0),t(null);try{const Z=await Qw(c,A,p,G);l(!0)}catch(Z){t(Z.message||"Error desconocido"),l(!1),console.error("Error al registrar el paquete:",Z)}finally{e(!1)}},a=async()=>{e(!0),t(null);try{const c=await Tw();o(c.data||[])}catch(c){t(c.message||"Error desconocido"),console.error("Error al cargar paquetes:",c)}finally{e(!1)}},i=async(c,A)=>{e(!0),t(null);try{await Dw(c,A),l(!0)}catch(p){t(p.message||"Error desconocido"),l(!1),console.error("Error al eliminar la clase del paquete:",p)}finally{e(!1)}};return d.useEffect(()=>{a()},[]),{registroPaquete:r,cargarPaquetes:a,eliminarClasePaquete:i,paquetes:n,loading:g,error:I,success:C}},jw=()=>{const[g,e]=d.useState(""),{idClase:I,curp:t}=Jd(),[C,l]=d.useState(""),[n,o]=d.useState(0),[r,a]=d.useState([]),[i,c]=d.useState(""),[A,p]=d.useState([]),{registroPaquete:G,loading:Z,error:h,success:u}=Zu(),{listarInscripcionPorId:b,registroInscripcion:m,inscripcion:B,loading:W,error:R}=wo(),{clases:V,loading:S,error:y}=Ai(),{listaPagosPorCurp:f,registroPago:k,alumno:H,loading:M,pagos:F}=Ho(),[x,L]=d.useState(null),[D,Y]=d.useState(""),[K,O]=d.useState("");d.useEffect(()=>{if(F&&F.length>0){const E=F.sort((Q,Cg)=>new Date(Cg.fecha_pago)-new Date(Q.fecha_pago))[0];E&&E.fecha_pago&&L(E)}},[F]),d.useEffect(()=>{(async()=>{t&&await f(t),I&&await b(I)})()},[t,I]),d.useEffect(()=>{if(F&&F.length>0){const E=F.sort((Q,Cg)=>new Date(Cg.fecha_pago)-new Date(Q.fecha_pago))[0];console.log("Último pago encontrado:",E),L(E)}},[F]),d.useEffect(()=>{if(B&&V){const E=V.find(Q=>Q.idClase===B.idClase);E&&(e(E.nombre||""),o(E.costo||0),console.log(E.costo),a([{idClase:E.idClase||"",horario:B.horario||"",fechaPago:(x==null?void 0:x.fecha_pago)||"",costo:E.costo||0}]))}},[B,V,x]),d.useEffect(()=>{var E;if(r.length>0){const Q=r.map(Ig=>{const cg=q(Ig.idClase).join(", ");return`Clase: ${Ig.idClase}, Horarios: ${cg}`}).join(" | "),Cg=((E=r[0])==null?void 0:E.horario)||"";l(`${Q} | Horario de Inscripción: ${Cg}`)}},[r]),d.useEffect(()=>{const E=r.reduce((Q,Cg)=>{const Ig=V.find(cg=>cg.idClase===Cg.idClase);return Q+((Ig==null?void 0:Ig.costo)||0)},0);o(E)},[r,V]);const lg=E=>{const Q=new Date(E);return Q.setMonth(Q.getMonth()+1),Q.toISOString().split("T")[0]},ag=async E=>{E.preventDefault(),Y(""),O("");try{const Q=[],Cg={nombre:"ejemplo",precio_total:n,curp:H.curp};if(H&&r.length>0){for(const cg of r)if(cg.fechaPago){const hg=lg(cg.fechaPago),se={curp:H.curp,monto:cg.costo,fecha_pago:cg.fechaPago,pago_realizado:"2024-02-01",proximo_pago:hg,estatus:"pendiente",motivo:"Paquete",idClase:cg.idClase};Q.push(se)}const Ig=r.map(cg=>({curp:H.curp,idClase:cg.idClase,fechaInscripcion:new Date().toISOString().split("T")[0],acceso:!0,horario:cg.horario}));console.log("inscripcion",Q),await G(Cg,r,Q,Ig),Y("Paquete y pagos registrados exitosamente.")}else{console.error("No se encontró información del alumno o no se han seleccionado clases."),O("No se encontró información del alumno o no se han seleccionado clases.");return}}catch(Q){console.error("Error al registrar el paquete o los pagos:",Q),O("Error al registrar el paquete o los pagos.")}},ig=()=>{a([...r,{idClase:"",horario:"",fechaPago:(x==null?void 0:x.fecha_pago)||""}])},sg=E=>{const Q=r.filter((Cg,Ig)=>Ig!==E);a(Q)},eg=(E,Q,Cg)=>{const Ig=[...r];if(Ig[E][Q]=Cg,Q==="idClase"){const cg=V.find(hg=>hg.idClase===Cg);console.log("clase:",cg),Ig[E].costo=(cg==null?void 0:cg.costo)||0,Ig[E].horario="",Ig[E].fechaPago=(x==null?void 0:x.fecha_pago)||""}a(Ig)},q=E=>{const Q=V==null?void 0:V.find(Cg=>Cg.idClase===E);return Q?Q.horario||[]:[]};return d.useEffect(()=>{V&&p(V.filter(E=>{var Q;return(((Q=E.nombre)==null?void 0:Q.toLowerCase())||"").includes(i.toLowerCase())}))},[V,i]),S||W||M?s.jsx(JI,{}):s.jsxs("div",{className:"form-container",children:[s.jsx("h2",{className:"title",children:"Registrar Paquete"}),s.jsxs("div",{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Nombre del Alumno:"})," ",(H==null?void 0:H.nombre)||"No disponible"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"CURP:"})," ",(H==null?void 0:H.curp)||"No disponible"]})]}),D&&s.jsx("p",{className:"success-message",children:D}),K&&s.jsx("p",{className:"error-message",children:K}),s.jsx("form",{onSubmit:ag,children:s.jsxs(tg,{container:!0,children:[r.map((E,Q)=>s.jsxs(tg,{container:!0,spacing:2,style:{marginTop:"20px"},children:[s.jsx(tg,{item:!0,xs:12,sm:4,children:s.jsx(vg,{select:!0,fullWidth:!0,label:"Clase",value:E.idClase||"",onChange:Cg=>eg(Q,"idClase",Cg.target.value),variant:"outlined",className:"text-field",disabled:S,children:A.map(Cg=>s.jsx(Ql,{value:Cg.idClase,children:Cg.nombre},Cg.idClase))})}),s.jsx(tg,{item:!0,xs:12,sm:2.5,children:s.jsx(vg,{select:!0,fullWidth:!0,label:"Horario",value:E.horario||"",onChange:Cg=>eg(Q,"horario",Cg.target.value),variant:"outlined",className:"text-field",disabled:S,children:q(E.idClase).map((Cg,Ig)=>s.jsx(Ql,{value:Cg,children:Cg},Ig))})}),s.jsx(tg,{item:!0,xs:12,sm:2.5,children:s.jsx(vg,{fullWidth:!0,label:"Fecha de Pago",type:"date",value:E.fechaPago||"",onChange:Cg=>eg(Q,"fechaPago",Cg.target.value),InputLabelProps:{shrink:!0},variant:"outlined",className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:2,children:s.jsx(vg,{fullWidth:!0,label:"Costo",value:E.costo||0,InputProps:{readOnly:!0},variant:"outlined",className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,sm:1,children:s.jsx(au,{"aria-label":"eliminar",onClick:()=>sg(Q),children:s.jsx(uu,{})})})]},Q)),s.jsx(tg,{item:!0,xs:12,style:{marginTop:"20px"},children:s.jsx(vg,{fullWidth:!0,label:"Monto del Pago",type:"number",value:n||"",onChange:E=>o(E.target.value),variant:"outlined",className:"text-field"})}),s.jsx(tg,{item:!0,xs:12,className:"buttonContainer",style:{textAlign:"center",marginTop:"20px"},children:s.jsx("button",{type:"button",className:"button",onClick:ig,children:"Agregar Clase"})}),s.jsx(tg,{item:!0,xs:12,className:"buttonContainer",style:{textAlign:"center",marginTop:"20px"},children:s.jsx("button",{type:"submit",className:"button",disabled:Z,children:Z?s.jsx(JI,{size:24,className:"spinner"}):"Registrar Paquete"})})]})})]})},Pw=()=>{const[g,e]=d.useState(""),{inscripciones:I,loading:t,error:C,listaInscripciones:l}=wo(),n=rt();if(d.useEffect(()=>{l(),console.log(o.acceso)},[]),t)return s.jsx(JI,{});if(C)return s.jsx(nt,{severity:"error",children:C});const o=g.trim()===""?I:I.filter(a=>{var i;return(i=a.curp)==null?void 0:i.toLowerCase().includes(g.toLowerCase())}),r=a=>{n(`/crearPaquete/${a.idInscripcion}/${a.horario}/${a.curp}`)};return s.jsxs("div",{className:"table-container-wrapper",children:[s.jsx("div",{className:"search-container",children:s.jsx(vg,{label:"Buscar por CURP",variant:"outlined",fullWidth:!0,value:g,onChange:a=>e(a.target.value),style:{marginBottom:"20px"}})}),s.jsx(Qo,{component:Vt,className:"table-container",children:s.jsxs(Tl,{"aria-label":"lista de inscripciones",className:"table",children:[s.jsx(To,{className:"table-head",children:s.jsxs(dI,{children:[s.jsx(rg,{className:"table-head-cell",children:"ID"}),s.jsx(rg,{className:"table-head-cell",children:"CURP"}),s.jsx(rg,{className:"table-head-cell",children:"ID Clase"}),s.jsx(rg,{className:"table-head-cell",children:"Fecha de Inscripción"}),s.jsx(rg,{className:"table-head-cell",children:"Acceso"})]})}),s.jsx(Lo,{children:o.length>0?o.map(a=>s.jsxs(dI,{className:"table-row",onClick:()=>r(a),children:[s.jsx(rg,{className:"table-cell",children:a.idInscripcion||"-"}),s.jsx(rg,{className:"table-cell",children:a.curp||"-"}),s.jsx(rg,{className:"table-cell",children:a.idClase||"-"}),s.jsx(rg,{className:"table-cell",children:a.fechaInscripcion||"-"}),s.jsx(rg,{className:"table-cell",children:a.acceso||"-"})]},a.idInscripcion)):s.jsx(dI,{children:s.jsx(rg,{colSpan:5,align:"center",children:"No se encontraron inscripciones."})})})]})})]})},Ow=()=>{const[g,e]=d.useState(""),{pagos:I,loading:t,error:C,listaPagos:l}=Ho(),n=rt();if(d.useEffect(()=>{l()},[l]),t)return s.jsx(JI,{});if(C)return s.jsx(nt,{severity:"error",children:C});const o=g.trim()===""?I:I.filter(a=>{var i;return(i=a.alumno.curp)==null?void 0:i.toLowerCase().includes(g.toLowerCase())}),r=(a,i,c)=>{localStorage.setItem("curp",a),localStorage.setItem("idPago",i),n(`/pagos/${a}/${i}/${c}`)};return s.jsxs("div",{className:"table-container-wrapper",children:[s.jsx("h2",{children:"Lista de Pagos"}),s.jsx("div",{className:"search-container",children:s.jsx(vg,{label:"Buscar por CURP",variant:"outlined",fullWidth:!0,value:g,onChange:a=>e(a.target.value),style:{marginBottom:"20px"}})}),s.jsx(Qo,{component:Vt,className:"table-container",children:s.jsxs(Tl,{"aria-label":"lista de pagos",className:"table",children:[s.jsx(To,{className:"table-head",children:s.jsxs(dI,{children:[s.jsx(rg,{className:"table-head-cell",children:"CURP"}),s.jsx(rg,{className:"table-head-cell",children:"Nombre"}),s.jsx(rg,{className:"table-head-cell",children:"Clase"}),s.jsx(rg,{className:"table-head-cell",children:"Monto"}),s.jsx(rg,{className:"table-head-cell",children:"Próximo Pago"})]})}),s.jsx(Lo,{children:o.length>0?o.map(a=>s.jsxs(dI,{className:"table-row",onClick:()=>r(a.alumno.curp,a.idPago,a.monto),hover:!0,children:[s.jsx(rg,{className:"table-cell",children:a.alumno.curp}),s.jsx(rg,{className:"table-cell",children:a.alumno.nombre}),s.jsx(rg,{className:"table-cell",children:a.clase.nombre}),s.jsx(rg,{className:"table-cell",children:a.monto}),s.jsx(rg,{className:"table-cell",children:a.proximo_pago})]},a.idPago)):s.jsx(dI,{children:s.jsx(rg,{colSpan:5,align:"center",children:"No se encontraron pagos."})})})]})})]})},qw=()=>{const[g,e]=d.useState(""),{paquetes:I,loading:t,error:C,cargarPaquetes:l}=Zu(),n=rt();if(d.useEffect(()=>{l()},[]),t)return s.jsx(JI,{});if(C)return s.jsx(nt,{severity:"error",children:C});const o=g.trim()===""?I:I.filter(a=>{var i;return((i=a.curp)==null?void 0:i.toLowerCase())===g.toLowerCase()}),r=a=>{console.log("Datos del paquete seleccionado:",a),n(`/editarPaquete/${a.curp}`)};return s.jsxs("div",{className:"table-container-wrapper",children:[s.jsx("h2",{children:"Paquetes Registrados"}),s.jsx("div",{className:"search-container",children:s.jsx(vg,{label:"Buscar por CURP",variant:"outlined",fullWidth:!0,value:g,onChange:a=>e(a.target.value),style:{marginBottom:"20px"}})}),s.jsx(Qo,{component:Vt,className:"table-container",children:s.jsxs(Tl,{"aria-label":"lista de paquetes",className:"table",children:[s.jsx(To,{className:"table-head",children:s.jsxs(dI,{children:[s.jsx(rg,{className:"table-head-cell table-head-cell-id",children:"ID"}),s.jsx(rg,{className:"table-head-cell table-head-cell-nombre",children:"Nombre"}),s.jsx(rg,{className:"table-head-cell table-head-cell-precio",children:"Precio Total"}),s.jsx(rg,{className:"table-head-cell table-head-cell-curp",children:"CURP"})]})}),s.jsx(Lo,{children:o.length>0?o.map(a=>s.jsxs(dI,{className:"table-row",onClick:()=>r(a),children:[s.jsx(rg,{className:"table-cell table-cell-id",children:a.idPaquete}),s.jsx(rg,{className:"table-cell table-cell-nombre",children:a.nombre}),s.jsx(rg,{className:"table-cell table-cell-precio",children:a.precio_total}),s.jsx(rg,{className:"table-cell table-cell-curp",children:a.curp})]},a.idPaquete)):s.jsx(dI,{children:s.jsx(rg,{colSpan:4,align:"center",children:"No se encontraron paquetes."})})})]})})]})},$w=()=>{d.useState("");const{curp:g}=Jd();d.useState("");const[e,I]=d.useState(0),[t,C]=d.useState([]),{registroPaquete:l,eliminarClasePaquete:n,loading:o,error:r,success:a}=Zu(),{listarInscripcionPorCurp:i,actualizarAcceso:c,eliminarInscripcionPorCurp:A,registroInscripcion:p,inscripciones:G,loading:Z,error:h}=wo(),{clases:u,loading:b,error:m}=Ai(),{listaPagosPorCurp:B,registroPago:W,alumno:R,loading:V,pagos:S}=Ho(),[y,f]=d.useState(null),[k,H]=d.useState(""),[M,F]=d.useState(""),[x,L]=d.useState(u||[]),[D,Y]=d.useState([]);d.useEffect(()=>{(async()=>{g&&(await B(g),await i(g))})()},[g]),d.useEffect(()=>{if(S&&S.length>0){const eg=S.sort((q,E)=>new Date(E.fecha_pago)-new Date(q.fecha_pago))[0];f(eg)}},[S]),d.useEffect(()=>{if(G&&u){const q=G.filter(E=>E.acceso&&E.curp===g).map(E=>{const Q=u.find(Cg=>Cg.idClase===E.idClase);return{idClase:(Q==null?void 0:Q.idClase)||"",horario:E.horario||"",fechaPago:(y==null?void 0:y.fecha_pago)||""}});C(q)}},[G,u,y]),d.useEffect(()=>{u&&L(u)},[u]),d.useEffect(()=>{var eg;t.length>0&&(t.map(q=>{const E=sg(q.idClase).join(", ");return`Clase: ${q.idClase}, Horarios: ${E}`}).join(" | "),(eg=t[0])!=null&&eg.horario)},[t]),d.useEffect(()=>{const eg=t.reduce((q,E)=>{const Q=u.find(Cg=>Cg.idClase===E.idClase);return q+((Q==null?void 0:Q.costo)||0)},0);I(eg)},[t,u]);const K=eg=>{const q=new Date(eg);return q.setMonth(q.getMonth()+1),q.toISOString().split("T")[0]},O=async eg=>{eg.preventDefault(),H(""),F("");try{const q={nombre:"ejemplo",precio_total:e,curp:R.curp};if(await n(D,g),await A(g,D),await l(q,t),R&&t.length>0){for(const Q of t)if(Q.fechaPago){const Cg=K(Q.fechaPago),Ig={curp:R.curp,monto:parseFloat(e)/t.length,fecha_pago:Q.fechaPago,pago_realizado:"2024-02-01",proximo_pago:Cg,estatus:"pendiente",motivo:"Paquete"};await W(Ig)}const E=t.map(Q=>({curp:R.curp,idClase:Q.idClase,fechaInscripcion:new Date().toISOString().split("T")[0],acceso:!0,horario:Q.horario}));await p(E),H("Paquete y pagos registrados exitosamente.")}else{F("No se encontró información del alumno o no se han seleccionado clases.");return}}catch{F("Error al registrar el paquete o los pagos.")}},lg=()=>{C([...t,{idClase:"",horario:"",fechaPago:(y==null?void 0:y.fecha_pago)||""}])},ag=eg=>{const q=t[eg];q.idClase?(console.log(`Clase eliminada: ${q.idClase}`),Y(Q=>[...Q,q.idClase])):console.log("No se puede eliminar una clase sin idClase.");const E=t.filter((Q,Cg)=>Cg!==eg);C(E)},ig=(eg,q,E)=>{const Q=[...t];Q[eg][q]=E,q==="idClase"&&(Q[eg].horario="",Q[eg].fechaPago=(y==null?void 0:y.fecha_pago)||""),C(Q)},sg=eg=>{const q=u==null?void 0:u.find(E=>E.idClase===eg);return q?q.horario||[]:[]};return b||Z||V?s.jsx(JI,{}):s.jsxs("div",{className:"form-container",children:[s.jsx("h2",{className:"title",children:"Registrar Paquete"}),s.jsxs("div",{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Nombre del Alumno:"})," ",(R==null?void 0:R.nombre)||"No disponible"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"CURP:"})," ",(R==null?void 0:R.curp)||"No disponible"]})]}),k&&s.jsx("p",{className:"success-message",children:k}),M&&s.jsx("p",{className:"error-message",children:M}),s.jsxs("form",{onSubmit:O,children:[s.jsx(tg,{container:!0,children:t.map((eg,q)=>s.jsxs(tg,{container:!0,spacing:2,style:{marginTop:"20px"},children:[s.jsx(tg,{item:!0,xs:12,sm:5,children:s.jsx(vg,{select:!0,fullWidth:!0,label:"Clase",value:eg.idClase,onChange:E=>ig(q,"idClase",E.target.value),children:x.map(E=>s.jsx(Ql,{value:E.idClase,children:E.nombre},E.idClase))})}),s.jsx(tg,{item:!0,xs:12,sm:5,children:s.jsx(vg,{select:!0,fullWidth:!0,label:"Horario",value:eg.horario,onChange:E=>ig(q,"horario",E.target.value),disabled:!eg.idClase,children:sg(eg.idClase).map(E=>s.jsx(Ql,{value:E,children:E},E))})}),s.jsx(tg,{item:!0,xs:12,sm:2,children:s.jsx(au,{color:"secondary","aria-label":"Eliminar",onClick:()=>ag(q),children:s.jsx(uu,{})})})]},q))}),s.jsx(tg,{item:!0,xs:12,className:"buttonContainer",style:{textAlign:"center",marginTop:"20px"},children:s.jsx("button",{type:"button",className:"button",onClick:lg,children:"Agregar Clase"})}),s.jsx("div",{style:{marginTop:"20px"},children:s.jsxs("p",{children:[s.jsx("strong",{children:"Precio Total:"})," $",e]})}),s.jsx(tg,{item:!0,xs:12,className:"buttonContainer",style:{textAlign:"center",marginTop:"20px"},children:s.jsx("button",{type:"submit",className:"button",disabled:o,children:o?s.jsx(JI,{size:24,className:"spinner"}):"Guardar Paquete"})})]})]})};var Is={},ty={L:1,M:0,Q:3,H:2},Cy={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},_w=Cy;function ly(g){this.mode=_w.MODE_8BIT_BYTE,this.data=g}ly.prototype={getLength:function(g){return this.data.length},write:function(g){for(var e=0;e<this.data.length;e++)g.put(this.data.charCodeAt(e),8)}};var gN=ly,Sr=ty;function Gt(g,e){this.totalCount=g,this.dataCount=e}Gt.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];Gt.getRSBlocks=function(g,e){var I=Gt.getRsBlockTable(g,e);if(I==null)throw new Error("bad rs block @ typeNumber:"+g+"/errorCorrectLevel:"+e);for(var t=I.length/3,C=new Array,l=0;l<t;l++)for(var n=I[l*3+0],o=I[l*3+1],r=I[l*3+2],a=0;a<n;a++)C.push(new Gt(o,r));return C};Gt.getRsBlockTable=function(g,e){switch(e){case Sr.L:return Gt.RS_BLOCK_TABLE[(g-1)*4+0];case Sr.M:return Gt.RS_BLOCK_TABLE[(g-1)*4+1];case Sr.Q:return Gt.RS_BLOCK_TABLE[(g-1)*4+2];case Sr.H:return Gt.RS_BLOCK_TABLE[(g-1)*4+3];default:return}};var eN=Gt;function ny(){this.buffer=new Array,this.length=0}ny.prototype={get:function(g){var e=Math.floor(g/8);return(this.buffer[e]>>>7-g%8&1)==1},put:function(g,e){for(var I=0;I<e;I++)this.putBit((g>>>e-I-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(g){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),g&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var IN=ny,It={glog:function(g){if(g<1)throw new Error("glog("+g+")");return It.LOG_TABLE[g]},gexp:function(g){for(;g<0;)g+=255;for(;g>=256;)g-=255;return It.EXP_TABLE[g]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var xe=0;xe<8;xe++)It.EXP_TABLE[xe]=1<<xe;for(var xe=8;xe<256;xe++)It.EXP_TABLE[xe]=It.EXP_TABLE[xe-4]^It.EXP_TABLE[xe-5]^It.EXP_TABLE[xe-6]^It.EXP_TABLE[xe-8];for(var xe=0;xe<255;xe++)It.LOG_TABLE[It.EXP_TABLE[xe]]=xe;var oy=It,SC=oy;function Dr(g,e){if(g.length==null)throw new Error(g.length+"/"+e);for(var I=0;I<g.length&&g[I]==0;)I++;this.num=new Array(g.length-I+e);for(var t=0;t<g.length-I;t++)this.num[t]=g[t+I]}Dr.prototype={get:function(g){return this.num[g]},getLength:function(){return this.num.length},multiply:function(g){for(var e=new Array(this.getLength()+g.getLength()-1),I=0;I<this.getLength();I++)for(var t=0;t<g.getLength();t++)e[I+t]^=SC.gexp(SC.glog(this.get(I))+SC.glog(g.get(t)));return new Dr(e,0)},mod:function(g){if(this.getLength()-g.getLength()<0)return this;for(var e=SC.glog(this.get(0))-SC.glog(g.get(0)),I=new Array(this.getLength()),t=0;t<this.getLength();t++)I[t]=this.get(t);for(var t=0;t<g.getLength();t++)I[t]^=SC.gexp(SC.glog(g.get(t))+e);return new Dr(I,0).mod(g)}};var ry=Dr,FI=Cy,Nb=ry,tN=oy,Pt={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},Ne={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(g){for(var e=g<<10;Ne.getBCHDigit(e)-Ne.getBCHDigit(Ne.G15)>=0;)e^=Ne.G15<<Ne.getBCHDigit(e)-Ne.getBCHDigit(Ne.G15);return(g<<10|e)^Ne.G15_MASK},getBCHTypeNumber:function(g){for(var e=g<<12;Ne.getBCHDigit(e)-Ne.getBCHDigit(Ne.G18)>=0;)e^=Ne.G18<<Ne.getBCHDigit(e)-Ne.getBCHDigit(Ne.G18);return g<<12|e},getBCHDigit:function(g){for(var e=0;g!=0;)e++,g>>>=1;return e},getPatternPosition:function(g){return Ne.PATTERN_POSITION_TABLE[g-1]},getMask:function(g,e,I){switch(g){case Pt.PATTERN000:return(e+I)%2==0;case Pt.PATTERN001:return e%2==0;case Pt.PATTERN010:return I%3==0;case Pt.PATTERN011:return(e+I)%3==0;case Pt.PATTERN100:return(Math.floor(e/2)+Math.floor(I/3))%2==0;case Pt.PATTERN101:return e*I%2+e*I%3==0;case Pt.PATTERN110:return(e*I%2+e*I%3)%2==0;case Pt.PATTERN111:return(e*I%3+(e+I)%2)%2==0;default:throw new Error("bad maskPattern:"+g)}},getErrorCorrectPolynomial:function(g){for(var e=new Nb([1],0),I=0;I<g;I++)e=e.multiply(new Nb([1,tN.gexp(I)],0));return e},getLengthInBits:function(g,e){if(1<=e&&e<10)switch(g){case FI.MODE_NUMBER:return 10;case FI.MODE_ALPHA_NUM:return 9;case FI.MODE_8BIT_BYTE:return 8;case FI.MODE_KANJI:return 8;default:throw new Error("mode:"+g)}else if(e<27)switch(g){case FI.MODE_NUMBER:return 12;case FI.MODE_ALPHA_NUM:return 11;case FI.MODE_8BIT_BYTE:return 16;case FI.MODE_KANJI:return 10;default:throw new Error("mode:"+g)}else if(e<41)switch(g){case FI.MODE_NUMBER:return 14;case FI.MODE_ALPHA_NUM:return 13;case FI.MODE_8BIT_BYTE:return 16;case FI.MODE_KANJI:return 12;default:throw new Error("mode:"+g)}else throw new Error("type:"+e)},getLostPoint:function(g){for(var e=g.getModuleCount(),I=0,t=0;t<e;t++)for(var C=0;C<e;C++){for(var l=0,n=g.isDark(t,C),o=-1;o<=1;o++)if(!(t+o<0||e<=t+o))for(var r=-1;r<=1;r++)C+r<0||e<=C+r||o==0&&r==0||n==g.isDark(t+o,C+r)&&l++;l>5&&(I+=3+l-5)}for(var t=0;t<e-1;t++)for(var C=0;C<e-1;C++){var a=0;g.isDark(t,C)&&a++,g.isDark(t+1,C)&&a++,g.isDark(t,C+1)&&a++,g.isDark(t+1,C+1)&&a++,(a==0||a==4)&&(I+=3)}for(var t=0;t<e;t++)for(var C=0;C<e-6;C++)g.isDark(t,C)&&!g.isDark(t,C+1)&&g.isDark(t,C+2)&&g.isDark(t,C+3)&&g.isDark(t,C+4)&&!g.isDark(t,C+5)&&g.isDark(t,C+6)&&(I+=40);for(var C=0;C<e;C++)for(var t=0;t<e-6;t++)g.isDark(t,C)&&!g.isDark(t+1,C)&&g.isDark(t+2,C)&&g.isDark(t+3,C)&&g.isDark(t+4,C)&&!g.isDark(t+5,C)&&g.isDark(t+6,C)&&(I+=40);for(var i=0,C=0;C<e;C++)for(var t=0;t<e;t++)g.isDark(t,C)&&i++;var c=Math.abs(100*i/e/e-50)/5;return I+=c*10,I}},CN=Ne,lN=gN,ay=eN,iy=IN,yC=CN,nN=ry;function pt(g,e){this.typeNumber=g,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var HI=pt.prototype;HI.addData=function(g){var e=new lN(g);this.dataList.push(e),this.dataCache=null};HI.isDark=function(g,e){if(g<0||this.moduleCount<=g||e<0||this.moduleCount<=e)throw new Error(g+","+e);return this.modules[g][e]};HI.getModuleCount=function(){return this.moduleCount};HI.make=function(){if(this.typeNumber<1){var g=1;for(g=1;g<40;g++){for(var e=ay.getRSBlocks(g,this.errorCorrectLevel),I=new iy,t=0,C=0;C<e.length;C++)t+=e[C].dataCount;for(var C=0;C<this.dataList.length;C++){var l=this.dataList[C];I.put(l.mode,4),I.put(l.getLength(),yC.getLengthInBits(l.mode,g)),l.write(I)}if(I.getLengthInBits()<=t*8)break}this.typeNumber=g}this.makeImpl(!1,this.getBestMaskPattern())};HI.makeImpl=function(g,e){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var I=0;I<this.moduleCount;I++){this.modules[I]=new Array(this.moduleCount);for(var t=0;t<this.moduleCount;t++)this.modules[I][t]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(g,e),this.typeNumber>=7&&this.setupTypeNumber(g),this.dataCache==null&&(this.dataCache=pt.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)};HI.setupPositionProbePattern=function(g,e){for(var I=-1;I<=7;I++)if(!(g+I<=-1||this.moduleCount<=g+I))for(var t=-1;t<=7;t++)e+t<=-1||this.moduleCount<=e+t||(0<=I&&I<=6&&(t==0||t==6)||0<=t&&t<=6&&(I==0||I==6)||2<=I&&I<=4&&2<=t&&t<=4?this.modules[g+I][e+t]=!0:this.modules[g+I][e+t]=!1)};HI.getBestMaskPattern=function(){for(var g=0,e=0,I=0;I<8;I++){this.makeImpl(!0,I);var t=yC.getLostPoint(this);(I==0||g>t)&&(g=t,e=I)}return e};HI.createMovieClip=function(g,e,I){var t=g.createEmptyMovieClip(e,I),C=1;this.make();for(var l=0;l<this.modules.length;l++)for(var n=l*C,o=0;o<this.modules[l].length;o++){var r=o*C,a=this.modules[l][o];a&&(t.beginFill(0,100),t.moveTo(r,n),t.lineTo(r+C,n),t.lineTo(r+C,n+C),t.lineTo(r,n+C),t.endFill())}return t};HI.setupTimingPattern=function(){for(var g=8;g<this.moduleCount-8;g++)this.modules[g][6]==null&&(this.modules[g][6]=g%2==0);for(var e=8;e<this.moduleCount-8;e++)this.modules[6][e]==null&&(this.modules[6][e]=e%2==0)};HI.setupPositionAdjustPattern=function(){for(var g=yC.getPatternPosition(this.typeNumber),e=0;e<g.length;e++)for(var I=0;I<g.length;I++){var t=g[e],C=g[I];if(this.modules[t][C]==null)for(var l=-2;l<=2;l++)for(var n=-2;n<=2;n++)l==-2||l==2||n==-2||n==2||l==0&&n==0?this.modules[t+l][C+n]=!0:this.modules[t+l][C+n]=!1}};HI.setupTypeNumber=function(g){for(var e=yC.getBCHTypeNumber(this.typeNumber),I=0;I<18;I++){var t=!g&&(e>>I&1)==1;this.modules[Math.floor(I/3)][I%3+this.moduleCount-8-3]=t}for(var I=0;I<18;I++){var t=!g&&(e>>I&1)==1;this.modules[I%3+this.moduleCount-8-3][Math.floor(I/3)]=t}};HI.setupTypeInfo=function(g,e){for(var I=this.errorCorrectLevel<<3|e,t=yC.getBCHTypeInfo(I),C=0;C<15;C++){var l=!g&&(t>>C&1)==1;C<6?this.modules[C][8]=l:C<8?this.modules[C+1][8]=l:this.modules[this.moduleCount-15+C][8]=l}for(var C=0;C<15;C++){var l=!g&&(t>>C&1)==1;C<8?this.modules[8][this.moduleCount-C-1]=l:C<9?this.modules[8][15-C-1+1]=l:this.modules[8][15-C-1]=l}this.modules[this.moduleCount-8][8]=!g};HI.mapData=function(g,e){for(var I=-1,t=this.moduleCount-1,C=7,l=0,n=this.moduleCount-1;n>0;n-=2)for(n==6&&n--;;){for(var o=0;o<2;o++)if(this.modules[t][n-o]==null){var r=!1;l<g.length&&(r=(g[l]>>>C&1)==1);var a=yC.getMask(e,t,n-o);a&&(r=!r),this.modules[t][n-o]=r,C--,C==-1&&(l++,C=7)}if(t+=I,t<0||this.moduleCount<=t){t-=I,I=-I;break}}};pt.PAD0=236;pt.PAD1=17;pt.createData=function(g,e,I){for(var t=ay.getRSBlocks(g,e),C=new iy,l=0;l<I.length;l++){var n=I[l];C.put(n.mode,4),C.put(n.getLength(),yC.getLengthInBits(n.mode,g)),n.write(C)}for(var o=0,l=0;l<t.length;l++)o+=t[l].dataCount;if(C.getLengthInBits()>o*8)throw new Error("code length overflow. ("+C.getLengthInBits()+">"+o*8+")");for(C.getLengthInBits()+4<=o*8&&C.put(0,4);C.getLengthInBits()%8!=0;)C.putBit(!1);for(;!(C.getLengthInBits()>=o*8||(C.put(pt.PAD0,8),C.getLengthInBits()>=o*8));)C.put(pt.PAD1,8);return pt.createBytes(C,t)};pt.createBytes=function(g,e){for(var I=0,t=0,C=0,l=new Array(e.length),n=new Array(e.length),o=0;o<e.length;o++){var r=e[o].dataCount,a=e[o].totalCount-r;t=Math.max(t,r),C=Math.max(C,a),l[o]=new Array(r);for(var i=0;i<l[o].length;i++)l[o][i]=255&g.buffer[i+I];I+=r;var c=yC.getErrorCorrectPolynomial(a),A=new nN(l[o],c.getLength()-1),p=A.mod(c);n[o]=new Array(c.getLength()-1);for(var i=0;i<n[o].length;i++){var G=i+p.getLength()-n[o].length;n[o][i]=G>=0?p.get(G):0}}for(var Z=0,i=0;i<e.length;i++)Z+=e[i].totalCount;for(var h=new Array(Z),u=0,i=0;i<t;i++)for(var o=0;o<e.length;o++)i<l[o].length&&(h[u++]=l[o][i]);for(var i=0;i<C;i++)for(var o=0;o<e.length;o++)i<n[o].length&&(h[u++]=n[o][i]);return h};var oN=pt,bu={};Object.defineProperty(bu,"__esModule",{value:!0});var rN=Object.assign||function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},aN=kd,KI=cy(aN),sy=d,Wr=cy(sy);function cy(g){return g&&g.__esModule?g:{default:g}}function iN(g,e){var I={};for(var t in g)e.indexOf(t)>=0||Object.prototype.hasOwnProperty.call(g,t)&&(I[t]=g[t]);return I}var sN={bgColor:KI.default.oneOfType([KI.default.object,KI.default.string]).isRequired,bgD:KI.default.string.isRequired,fgColor:KI.default.oneOfType([KI.default.object,KI.default.string]).isRequired,fgD:KI.default.string.isRequired,size:KI.default.number.isRequired,title:KI.default.string,viewBoxSize:KI.default.number.isRequired,xmlns:KI.default.string},Gu=(0,sy.forwardRef)(function(g,e){var I=g.bgColor,t=g.bgD,C=g.fgD,l=g.fgColor,n=g.size,o=g.title,r=g.viewBoxSize,a=g.xmlns,i=a===void 0?"http://www.w3.org/2000/svg":a,c=iN(g,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return Wr.default.createElement("svg",rN({},c,{height:n,ref:e,viewBox:"0 0 "+r+" "+r,width:n,xmlns:i}),o?Wr.default.createElement("title",null,o):null,Wr.default.createElement("path",{d:t,fill:I}),Wr.default.createElement("path",{d:C,fill:l}))});Gu.displayName="QRCodeSvg";Gu.propTypes=sN;bu.default=Gu;Object.defineProperty(Is,"__esModule",{value:!0});Is.QRCode=void 0;var cN=Object.assign||function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},AN=kd,kt=Do(AN),dN=ty,uN=Do(dN),mN=oN,ZN=Do(mN),Ay=d,bN=Do(Ay),GN=bu,pN=Do(GN);function Do(g){return g&&g.__esModule?g:{default:g}}function hN(g,e){var I={};for(var t in g)e.indexOf(t)>=0||Object.prototype.hasOwnProperty.call(g,t)&&(I[t]=g[t]);return I}var yN={bgColor:kt.default.oneOfType([kt.default.object,kt.default.string]),fgColor:kt.default.oneOfType([kt.default.object,kt.default.string]),level:kt.default.string,size:kt.default.number,value:kt.default.string.isRequired},ts=(0,Ay.forwardRef)(function(g,e){var I=g.bgColor,t=I===void 0?"#FFFFFF":I,C=g.fgColor,l=C===void 0?"#000000":C,n=g.level,o=n===void 0?"L":n,r=g.size,a=r===void 0?256:r,i=g.value,c=hN(g,["bgColor","fgColor","level","size","value"]),A=new ZN.default(-1,uN.default[o]);A.addData(i),A.make();var p=A.modules;return bN.default.createElement(pN.default,cN({},c,{bgColor:t,bgD:p.map(function(G,Z){return G.map(function(h,u){return h?"":"M "+u+" "+Z+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:l,fgD:p.map(function(G,Z){return G.map(function(h,u){return h?"M "+u+" "+Z+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:e,size:a,viewBoxSize:p.length}))});Is.QRCode=ts;ts.displayName="QRCode";ts.propTypes=yN;var BN=Is.default=ts;function SN(g,e){if(g.match(/^[a-z]+:\/\//i))return g;if(g.match(/^\/\//))return window.location.protocol+g;if(g.match(/^[a-z]+:/i))return g;const I=document.implementation.createHTMLDocument(),t=I.createElement("base"),C=I.createElement("a");return I.head.appendChild(t),I.body.appendChild(C),e&&(t.href=e),C.href=g,C.href}const WN=(()=>{let g=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(g+=1,`u${e()}${g}`)})();function Kt(g){const e=[];for(let I=0,t=g.length;I<t;I++)e.push(g[I]);return e}function Na(g,e){const t=(g.ownerDocument.defaultView||window).getComputedStyle(g).getPropertyValue(e);return t?parseFloat(t.replace("px","")):0}function VN(g){const e=Na(g,"border-left-width"),I=Na(g,"border-right-width");return g.clientWidth+e+I}function RN(g){const e=Na(g,"border-top-width"),I=Na(g,"border-bottom-width");return g.clientHeight+e+I}function dy(g,e={}){const I=e.width||VN(g),t=e.height||RN(g);return{width:I,height:t}}function fN(){let g,e;try{e=process}catch{}const I=e&&e.env?e.env.devicePixelRatio:null;return I&&(g=parseInt(I,10),Number.isNaN(g)&&(g=1)),g||window.devicePixelRatio||1}const pI=16384;function XN(g){(g.width>pI||g.height>pI)&&(g.width>pI&&g.height>pI?g.width>g.height?(g.height*=pI/g.width,g.width=pI):(g.width*=pI/g.height,g.height=pI):g.width>pI?(g.height*=pI/g.width,g.width=pI):(g.width*=pI/g.height,g.height=pI))}function Fa(g){return new Promise((e,I)=>{const t=new Image;t.decode=()=>e(t),t.onload=()=>e(t),t.onerror=I,t.crossOrigin="anonymous",t.decoding="async",t.src=g})}async function JN(g){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(g)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function kN(g,e,I){const t="http://www.w3.org/2000/svg",C=document.createElementNS(t,"svg"),l=document.createElementNS(t,"foreignObject");return C.setAttribute("width",`${e}`),C.setAttribute("height",`${I}`),C.setAttribute("viewBox",`0 0 ${e} ${I}`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("externalResourcesRequired","true"),C.appendChild(l),l.appendChild(g),JN(C)}const uI=(g,e)=>{if(g instanceof e)return!0;const I=Object.getPrototypeOf(g);return I===null?!1:I.constructor.name===e.name||uI(I,e)};function vN(g){const e=g.getPropertyValue("content");return`${g.cssText} content: '${e.replace(/'|"/g,"")}';`}function YN(g){return Kt(g).map(e=>{const I=g.getPropertyValue(e),t=g.getPropertyPriority(e);return`${e}: ${I}${t?" !important":""};`}).join(" ")}function HN(g,e,I){const t=`.${g}:${e}`,C=I.cssText?vN(I):YN(I);return document.createTextNode(`${t}{${C}}`)}function Fb(g,e,I){const t=window.getComputedStyle(g,I),C=t.getPropertyValue("content");if(C===""||C==="none")return;const l=WN();try{e.className=`${e.className} ${l}`}catch{return}const n=document.createElement("style");n.appendChild(HN(l,I,t)),e.appendChild(n)}function wN(g,e){Fb(g,e,":before"),Fb(g,e,":after")}const Kb="application/font-woff",xb="image/jpeg",NN={woff:Kb,woff2:Kb,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:xb,jpeg:xb,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function FN(g){const e=/\.([^./]*?)$/g.exec(g);return e?e[1]:""}function pu(g){const e=FN(g).toLowerCase();return NN[e]||""}function KN(g){return g.split(/,/)[1]}function vA(g){return g.search(/^(data:)/)!==-1}function xN(g,e){return`data:${e};base64,${g}`}async function uy(g,e,I){const t=await fetch(g,e);if(t.status===404)throw new Error(`Resource "${t.url}" not found`);const C=await t.blob();return new Promise((l,n)=>{const o=new FileReader;o.onerror=n,o.onloadend=()=>{try{l(I({res:t,result:o.result}))}catch(r){n(r)}},o.readAsDataURL(C)})}const ic={};function EN(g,e,I){let t=g.replace(/\?.*/,"");return I&&(t=g),/ttf|otf|eot|woff2?/i.test(t)&&(t=t.replace(/.*\//,"")),e?`[${e}]${t}`:t}async function hu(g,e,I){const t=EN(g,e,I.includeQueryParams);if(ic[t]!=null)return ic[t];I.cacheBust&&(g+=(/\?/.test(g)?"&":"?")+new Date().getTime());let C;try{const l=await uy(g,I.fetchRequestInit,({res:n,result:o})=>(e||(e=n.headers.get("Content-Type")||""),KN(o)));C=xN(l,e)}catch(l){C=I.imagePlaceholder||"";let n=`Failed to fetch resource: ${g}`;l&&(n=typeof l=="string"?l:l.message),n&&console.warn(n)}return ic[t]=C,C}async function zN(g){const e=g.toDataURL();return e==="data:,"?g.cloneNode(!1):Fa(e)}async function MN(g,e){if(g.currentSrc){const l=document.createElement("canvas"),n=l.getContext("2d");l.width=g.clientWidth,l.height=g.clientHeight,n==null||n.drawImage(g,0,0,l.width,l.height);const o=l.toDataURL();return Fa(o)}const I=g.poster,t=pu(I),C=await hu(I,t,e);return Fa(C)}async function UN(g){var e;try{if(!((e=g==null?void 0:g.contentDocument)===null||e===void 0)&&e.body)return await Cs(g.contentDocument.body,{},!0)}catch{}return g.cloneNode(!1)}async function LN(g,e){return uI(g,HTMLCanvasElement)?zN(g):uI(g,HTMLVideoElement)?MN(g,e):uI(g,HTMLIFrameElement)?UN(g):g.cloneNode(!1)}const QN=g=>g.tagName!=null&&g.tagName.toUpperCase()==="SLOT";async function TN(g,e,I){var t,C;let l=[];return QN(g)&&g.assignedNodes?l=Kt(g.assignedNodes()):uI(g,HTMLIFrameElement)&&(!((t=g.contentDocument)===null||t===void 0)&&t.body)?l=Kt(g.contentDocument.body.childNodes):l=Kt(((C=g.shadowRoot)!==null&&C!==void 0?C:g).childNodes),l.length===0||uI(g,HTMLVideoElement)||await l.reduce((n,o)=>n.then(()=>Cs(o,I)).then(r=>{r&&e.appendChild(r)}),Promise.resolve()),e}function DN(g,e){const I=e.style;if(!I)return;const t=window.getComputedStyle(g);t.cssText?(I.cssText=t.cssText,I.transformOrigin=t.transformOrigin):Kt(t).forEach(C=>{let l=t.getPropertyValue(C);C==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),uI(g,HTMLIFrameElement)&&C==="display"&&l==="inline"&&(l="block"),C==="d"&&e.getAttribute("d")&&(l=`path(${e.getAttribute("d")})`),I.setProperty(C,l,t.getPropertyPriority(C))})}function jN(g,e){uI(g,HTMLTextAreaElement)&&(e.innerHTML=g.value),uI(g,HTMLInputElement)&&e.setAttribute("value",g.value)}function PN(g,e){if(uI(g,HTMLSelectElement)){const I=e,t=Array.from(I.children).find(C=>g.value===C.getAttribute("value"));t&&t.setAttribute("selected","")}}function ON(g,e){return uI(e,Element)&&(DN(g,e),wN(g,e),jN(g,e),PN(g,e)),e}async function qN(g,e){const I=g.querySelectorAll?g.querySelectorAll("use"):[];if(I.length===0)return g;const t={};for(let l=0;l<I.length;l++){const o=I[l].getAttribute("xlink:href");if(o){const r=g.querySelector(o),a=document.querySelector(o);!r&&a&&!t[o]&&(t[o]=await Cs(a,e,!0))}}const C=Object.values(t);if(C.length){const l="http://www.w3.org/1999/xhtml",n=document.createElementNS(l,"svg");n.setAttribute("xmlns",l),n.style.position="absolute",n.style.width="0",n.style.height="0",n.style.overflow="hidden",n.style.display="none";const o=document.createElementNS(l,"defs");n.appendChild(o);for(let r=0;r<C.length;r++)o.appendChild(C[r]);g.appendChild(n)}return g}async function Cs(g,e,I){return!I&&e.filter&&!e.filter(g)?null:Promise.resolve(g).then(t=>LN(t,e)).then(t=>TN(g,t,e)).then(t=>ON(g,t)).then(t=>qN(t,e))}const my=/url\((['"]?)([^'"]+?)\1\)/g,$N=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,_N=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function gF(g){const e=g.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function eF(g){const e=[];return g.replace(my,(I,t,C)=>(e.push(C),I)),e.filter(I=>!vA(I))}async function IF(g,e,I,t,C){try{const l=I?SN(e,I):e,n=pu(e);let o;return C||(o=await hu(l,n,t)),g.replace(gF(e),`$1${o}$3`)}catch{}return g}function tF(g,{preferredFontFormat:e}){return e?g.replace(_N,I=>{for(;;){const[t,,C]=$N.exec(I)||[];if(!C)return"";if(C===e)return`src: ${t};`}}):g}function Zy(g){return g.search(my)!==-1}async function by(g,e,I){if(!Zy(g))return g;const t=tF(g,I);return eF(t).reduce((l,n)=>l.then(o=>IF(o,n,e,I)),Promise.resolve(t))}async function Vr(g,e,I){var t;const C=(t=e.style)===null||t===void 0?void 0:t.getPropertyValue(g);if(C){const l=await by(C,null,I);return e.style.setProperty(g,l,e.style.getPropertyPriority(g)),!0}return!1}async function CF(g,e){await Vr("background",g,e)||await Vr("background-image",g,e),await Vr("mask",g,e)||await Vr("mask-image",g,e)}async function lF(g,e){const I=uI(g,HTMLImageElement);if(!(I&&!vA(g.src))&&!(uI(g,SVGImageElement)&&!vA(g.href.baseVal)))return;const t=I?g.src:g.href.baseVal,C=await hu(t,pu(t),e);await new Promise((l,n)=>{g.onload=l,g.onerror=n;const o=g;o.decode&&(o.decode=l),o.loading==="lazy"&&(o.loading="eager"),I?(g.srcset="",g.src=C):g.href.baseVal=C})}async function nF(g,e){const t=Kt(g.childNodes).map(C=>Gy(C,e));await Promise.all(t).then(()=>g)}async function Gy(g,e){uI(g,Element)&&(await CF(g,e),await lF(g,e),await nF(g,e))}function oF(g,e){const{style:I}=g;e.backgroundColor&&(I.backgroundColor=e.backgroundColor),e.width&&(I.width=`${e.width}px`),e.height&&(I.height=`${e.height}px`);const t=e.style;return t!=null&&Object.keys(t).forEach(C=>{I[C]=t[C]}),g}const Eb={};async function zb(g){let e=Eb[g];if(e!=null)return e;const t=await(await fetch(g)).text();return e={url:g,cssText:t},Eb[g]=e,e}async function Mb(g,e){let I=g.cssText;const t=/url\(["']?([^"')]+)["']?\)/g,l=(I.match(/url\([^)]+\)/g)||[]).map(async n=>{let o=n.replace(t,"$1");return o.startsWith("https://")||(o=new URL(o,g.url).href),uy(o,e.fetchRequestInit,({result:r})=>(I=I.replace(n,`url(${r})`),[n,r]))});return Promise.all(l).then(()=>I)}function Ub(g){if(g==null)return[];const e=[],I=/(\/\*[\s\S]*?\*\/)/gi;let t=g.replace(I,"");const C=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const r=C.exec(t);if(r===null)break;e.push(r[0])}t=t.replace(C,"");const l=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,n="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",o=new RegExp(n,"gi");for(;;){let r=l.exec(t);if(r===null){if(r=o.exec(t),r===null)break;l.lastIndex=o.lastIndex}else o.lastIndex=l.lastIndex;e.push(r[0])}return e}async function rF(g,e){const I=[],t=[];return g.forEach(C=>{if("cssRules"in C)try{Kt(C.cssRules||[]).forEach((l,n)=>{if(l.type===CSSRule.IMPORT_RULE){let o=n+1;const r=l.href,a=zb(r).then(i=>Mb(i,e)).then(i=>Ub(i).forEach(c=>{try{C.insertRule(c,c.startsWith("@import")?o+=1:C.cssRules.length)}catch(A){console.error("Error inserting rule from remote css",{rule:c,error:A})}})).catch(i=>{console.error("Error loading remote css",i.toString())});t.push(a)}})}catch(l){const n=g.find(o=>o.href==null)||document.styleSheets[0];C.href!=null&&t.push(zb(C.href).then(o=>Mb(o,e)).then(o=>Ub(o).forEach(r=>{n.insertRule(r,C.cssRules.length)})).catch(o=>{console.error("Error loading remote stylesheet",o)})),console.error("Error inlining remote css file",l)}}),Promise.all(t).then(()=>(g.forEach(C=>{if("cssRules"in C)try{Kt(C.cssRules||[]).forEach(l=>{I.push(l)})}catch(l){console.error(`Error while reading CSS rules from ${C.href}`,l)}}),I))}function aF(g){return g.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>Zy(e.style.getPropertyValue("src")))}async function iF(g,e){if(g.ownerDocument==null)throw new Error("Provided element is not within a Document");const I=Kt(g.ownerDocument.styleSheets),t=await rF(I,e);return aF(t)}async function sF(g,e){const I=await iF(g,e);return(await Promise.all(I.map(C=>{const l=C.parentStyleSheet?C.parentStyleSheet.href:null;return by(C.cssText,l,e)}))).join(`
`)}async function cF(g,e){const I=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await sF(g,e);if(I){const t=document.createElement("style"),C=document.createTextNode(I);t.appendChild(C),g.firstChild?g.insertBefore(t,g.firstChild):g.appendChild(t)}}async function AF(g,e={}){const{width:I,height:t}=dy(g,e),C=await Cs(g,e,!0);return await cF(C,e),await Gy(C,e),oF(C,e),await kN(C,I,t)}async function dF(g,e={}){const{width:I,height:t}=dy(g,e),C=await AF(g,e),l=await Fa(C),n=document.createElement("canvas"),o=n.getContext("2d"),r=e.pixelRatio||fN(),a=e.canvasWidth||I,i=e.canvasHeight||t;return n.width=a*r,n.height=i*r,e.skipAutoScale||XN(n),n.style.width=`${a}`,n.style.height=`${i}`,e.backgroundColor&&(o.fillStyle=e.backgroundColor,o.fillRect(0,0,n.width,n.height)),o.drawImage(l,0,0,n.width,n.height),n}async function uF(g,e={}){return(await dF(g,e)).toDataURL()}const mF=()=>{const{username:g}=ko(),{inscripcion:e,listarInscripcionPorCurp:I,loading:t,error:C}=wo(),{buscarAlumno:l,loading:n,error:o}=xd(),{obtenerFoto:r,registrarFoto:a,fotoUrl:i,loading:c,error:A}=Iy(),[p,G]=d.useState(null),[Z,h]=d.useState(null),[u,b]=d.useState(!1),[m,B]=d.useState(null),W=g;if(d.useEffect(()=>{W&&r(W)},[W]),d.useEffect(()=>{W&&(I(W),l(W).then(k=>{h(k)}))},[W]),d.useEffect(()=>{if(e&&e.length>0&&Z){const k=e.map(M=>M.idInscripcion);G(JSON.stringify({curp:W,inscripciones:k}))}},[e,Z]),d.useEffect(()=>{A&&b(!0)},[A]),t||n||c)return s.jsx("p",{children:"Cargando..."});if(C||o){const k=(C==null?void 0:C.message)||(o==null?void 0:o.message)||"Ocurrió un error inesperado.";return s.jsxs("p",{children:["Error: ",k]})}const R=Z?`${Z.nombre} ${Z.apellidos}`:"Nombre no disponible",V=()=>{const k=document.getElementById("cred_container");uF(k).then(H=>{const M=document.createElement("a");M.download="credencial.png",M.href=H,M.click()}).catch(H=>{console.error("Error al generar la imagen:",H)})},S=()=>{b(!1),B(null)},y=k=>{const H=k.target.files[0];H&&B(H)},f=async()=>{if(m){const k=m;try{const H=await a(W,k);console.log("Foto guardada con éxito:",H),S()}catch(H){console.error("Error al subir la foto:",H)}}};return s.jsxs("div",{children:[s.jsxs("div",{id:"cred_container",children:[s.jsx("span",{className:"cred_data",id:"cred_logo",children:s.jsx("p",{children:"CADI Minatitlán"})}),s.jsx("span",{className:"cred_data",id:"cred_imagen",children:i?s.jsx("img",{src:i,alt:"Foto del alumno"}):s.jsx("img",{src:"/public/Insecto_soleador.png",alt:"Foto no disponible"})}),s.jsx("span",{className:"cred_data",id:"cred_nombre",children:R}),s.jsx("span",{className:"cred_data",id:"cred_qr",children:p?s.jsx(BN,{value:p,size:128}):s.jsx("p",{children:"No se encontraron inscripciones para la CURP proporcionada."})}),s.jsx("span",{className:"cred_decoracion",id:"cred_rect_sup"}),s.jsx("span",{className:"cred_decoracion",id:"cred_rect_rojo"}),s.jsx("span",{className:"cred_decoracion",id:"cred_linea_roja"}),s.jsx("span",{className:"cred_decoracion",id:"cred_triangulo_fondo"})]}),s.jsx(Je,{variant:"contained",color:"primary",onClick:V,startIcon:s.jsx(fw,{}),style:{marginTop:"20px"},children:"Descargar Credencial"}),s.jsx(cu,{open:u,onClose:()=>{},"aria-labelledby":"modal-title","aria-describedby":"modal-description",children:s.jsxs("div",{className:"modal-container",children:[s.jsx(gI,{id:"modal-title",className:"modal-title",component:"h2",children:"Subir Foto"}),s.jsx(gI,{id:"modal-description",className:"modal-description",children:"Necesitas una fotografía para tu credencial."}),s.jsx("div",{className:"input-file-container",children:s.jsxs(Je,{variant:"contained",color:"primary",component:"label",className:"upload-button",children:["Subir Archivo",s.jsx("input",{type:"file",accept:"image/*",onChange:y,hidden:!0})]})}),m&&s.jsx("div",{children:s.jsx("img",{src:m,alt:"Previsualización",className:"preview-image"})}),s.jsxs("div",{className:"modal-actions",children:[s.jsx(Je,{onClick:f,color:"primary",className:"modal-button",children:"Subir Foto"}),s.jsx(Je,{onClick:S,color:"secondary",className:"modal-button",children:"Cerrar"})]})]})})]})};function So(g){"@babel/helpers - typeof";return So=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},So(g)}function ZF(g,e){if(So(g)!="object"||!g)return g;var I=g[Symbol.toPrimitive];if(I!==void 0){var t=I.call(g,e||"default");if(So(t)!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(g)}function bF(g){var e=ZF(g,"string");return So(e)=="symbol"?e:e+""}function GF(g,e,I){return(e=bF(e))in g?Object.defineProperty(g,e,{value:I,enumerable:!0,configurable:!0,writable:!0}):g[e]=I,g}function pF(g){if(Array.isArray(g))return g}function hF(g,e){var I=g==null?null:typeof Symbol<"u"&&g[Symbol.iterator]||g["@@iterator"];if(I!=null){var t,C,l,n,o=[],r=!0,a=!1;try{if(l=(I=I.call(g)).next,e!==0)for(;!(r=(t=l.call(I)).done)&&(o.push(t.value),o.length!==e);r=!0);}catch(i){a=!0,C=i}finally{try{if(!r&&I.return!=null&&(n=I.return(),Object(n)!==n))return}finally{if(a)throw C}}return o}}function Lb(g,e){(e==null||e>g.length)&&(e=g.length);for(var I=0,t=Array(e);I<e;I++)t[I]=g[I];return t}function yF(g,e){if(g){if(typeof g=="string")return Lb(g,e);var I={}.toString.call(g).slice(8,-1);return I==="Object"&&g.constructor&&(I=g.constructor.name),I==="Map"||I==="Set"?Array.from(g):I==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I)?Lb(g,e):void 0}}function BF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SF(g,e){return pF(g)||hF(g,e)||yF(g,e)||BF()}function WF(g,e){if(g==null)return{};var I,t,C=nu(g,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(g);for(t=0;t<l.length;t++)I=l[t],e.includes(I)||{}.propertyIsEnumerable.call(g,I)&&(C[I]=g[I])}return C}var py={exports:{}},Dg={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var He=typeof Symbol=="function"&&Symbol.for,yu=He?Symbol.for("react.element"):60103,Bu=He?Symbol.for("react.portal"):60106,ls=He?Symbol.for("react.fragment"):60107,ns=He?Symbol.for("react.strict_mode"):60108,os=He?Symbol.for("react.profiler"):60114,rs=He?Symbol.for("react.provider"):60109,as=He?Symbol.for("react.context"):60110,Su=He?Symbol.for("react.async_mode"):60111,is=He?Symbol.for("react.concurrent_mode"):60111,ss=He?Symbol.for("react.forward_ref"):60112,cs=He?Symbol.for("react.suspense"):60113,VF=He?Symbol.for("react.suspense_list"):60120,As=He?Symbol.for("react.memo"):60115,ds=He?Symbol.for("react.lazy"):60116,RF=He?Symbol.for("react.block"):60121,fF=He?Symbol.for("react.fundamental"):60117,XF=He?Symbol.for("react.responder"):60118,JF=He?Symbol.for("react.scope"):60119;function wI(g){if(typeof g=="object"&&g!==null){var e=g.$$typeof;switch(e){case yu:switch(g=g.type,g){case Su:case is:case ls:case os:case ns:case cs:return g;default:switch(g=g&&g.$$typeof,g){case as:case ss:case ds:case As:case rs:return g;default:return e}}case Bu:return e}}}function hy(g){return wI(g)===is}Dg.AsyncMode=Su;Dg.ConcurrentMode=is;Dg.ContextConsumer=as;Dg.ContextProvider=rs;Dg.Element=yu;Dg.ForwardRef=ss;Dg.Fragment=ls;Dg.Lazy=ds;Dg.Memo=As;Dg.Portal=Bu;Dg.Profiler=os;Dg.StrictMode=ns;Dg.Suspense=cs;Dg.isAsyncMode=function(g){return hy(g)||wI(g)===Su};Dg.isConcurrentMode=hy;Dg.isContextConsumer=function(g){return wI(g)===as};Dg.isContextProvider=function(g){return wI(g)===rs};Dg.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===yu};Dg.isForwardRef=function(g){return wI(g)===ss};Dg.isFragment=function(g){return wI(g)===ls};Dg.isLazy=function(g){return wI(g)===ds};Dg.isMemo=function(g){return wI(g)===As};Dg.isPortal=function(g){return wI(g)===Bu};Dg.isProfiler=function(g){return wI(g)===os};Dg.isStrictMode=function(g){return wI(g)===ns};Dg.isSuspense=function(g){return wI(g)===cs};Dg.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===ls||g===is||g===os||g===ns||g===cs||g===VF||typeof g=="object"&&g!==null&&(g.$$typeof===ds||g.$$typeof===As||g.$$typeof===rs||g.$$typeof===as||g.$$typeof===ss||g.$$typeof===fF||g.$$typeof===XF||g.$$typeof===JF||g.$$typeof===RF)};Dg.typeOf=wI;/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Qb=Object.getOwnPropertySymbols,kF=Object.prototype.hasOwnProperty,vF=Object.prototype.propertyIsEnumerable;function YF(g){if(g==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(g)}function HF(){try{if(!Object.assign)return!1;var g=new String("abc");if(g[5]="de",Object.getOwnPropertyNames(g)[0]==="5")return!1;for(var e={},I=0;I<10;I++)e["_"+String.fromCharCode(I)]=I;var t=Object.getOwnPropertyNames(e).map(function(l){return e[l]});if(t.join("")!=="0123456789")return!1;var C={};return"abcdefghijklmnopqrst".split("").forEach(function(l){C[l]=l}),Object.keys(Object.assign({},C)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}HF();var wF="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",NF=wF;Function.call.bind(Object.prototype.hasOwnProperty);var FF=NF;function yy(){}function By(){}By.resetWarningCache=yy;var KF=function(){function g(t,C,l,n,o,r){if(r!==FF){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}g.isRequired=g;function e(){return g}var I={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:e,element:g,elementType:g,instanceOf:e,node:g,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:By,resetWarningCache:yy};return I.PropTypes=I,I};py.exports=KF();var rl=py.exports;function xF(g,e){var I=atob(g);return I}function EF(g,e,I){var t=xF(g),C=t.indexOf(`
`,10)+1,l=t.substring(C)+"",n=new Blob([l],{type:"application/javascript"});return URL.createObjectURL(n)}function zF(g,e,I){var t;return function(l){return t=t||EF(g),new Worker(t,l)}}var MF=zF("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg=="),UF=["constraints","onError","onLoad","onScan","resolution","qrArea"];function Tb(g,e){var I=Object.keys(g);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(g);e&&(t=t.filter(function(C){return Object.getOwnPropertyDescriptor(g,C).enumerable})),I.push.apply(I,t)}return I}function Db(g){for(var e=1;e<arguments.length;e++){var I=arguments[e]!=null?arguments[e]:{};e%2?Tb(Object(I),!0).forEach(function(t){GF(g,t,I[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(I)):Tb(Object(I)).forEach(function(t){Object.defineProperty(g,t,Object.getOwnPropertyDescriptor(I,t))})}return g}var LF=function(){return new MF},jb=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().forEach(function(I){e.removeTrack(I),I.stop()}),e.getAudioTracks().forEach(function(I){e.removeTrack(I),I.stop()})):e.stop())},Wu=function(e){var I=e.constraints,t=e.onError,C=e.onLoad,l=e.onScan,n=e.resolution,o=e.qrArea,r=WF(e,UF),a=d.useRef(null),i=d.useRef(null),c=d.useRef(document.createElement("canvas")),A=d.useRef(null),p=d.useRef(),G=d.useState(null),Z=SF(G,2),h=Z[0],u=Z[1],b=d.useRef(!1),m=d.useRef();d.useEffect(function(){m.current=LF();var V=m.current;return V.onmessage=function(S){l&&l(S.data?Db(Db({},S.data),{},{canvas:c.current}):null),b.current=!1},function(){V.terminate()}},[l]);var B=JSON.stringify(o),W=d.useCallback(function(){var V=JSON.parse(B),S=m.current,y=i.current&&i.current.readyState===i.current.HAVE_ENOUGH_DATA;if(!b.current&&y){b.current=!0;var f=i.current.videoWidth,k=i.current.videoHeight,H=f>k?f:k,M=Math.floor(n/H*100)/100;k=Math.floor(M*k),f=Math.floor(M*f),c.current.width=f,c.current.height=k,A.current=c.current.getContext("2d"),A.current.drawImage(i.current,0,0,f,k);var F;V&&V.length===2&&V[0]>0&&V[1]>0?F=A.current.getImageData(Math.floor((f-V[0])/2),Math.floor((k-V[1])/2),V[0],V[1]):F=A.current.getImageData(0,0,f,k),S.postMessage(F)}p.current=requestAnimationFrame(W)},[n,B]),R=JSON.stringify(I);return d.useEffect(function(){var V=JSON.parse(R),S=!0;return navigator.mediaDevices.getUserMedia(V).then(function(y){if(!S)jb(y);else{a.current=y;try{i.current&&(i.current.srcObject=y,i.current.setAttribute("playsinline",!0))}catch{u(window.URL.createObjectURL(y))}C&&C(),p.current=requestAnimationFrame(W)}}).catch(function(y){return S?t(y):null}),function(){cancelAnimationFrame(p.current),S=!1,jb(a.current),h&&window.URL.revokeObjectURL(h)}},[W,R,t,C,h]),d.createElement("video",bo({autoPlay:!0,playsInline:!0,src:h,ref:i},r))};Wu.propTypes={constraints:rl.object,onError:rl.func.isRequired,onLoad:rl.func,onScan:rl.func.isRequired,resolution:rl.number,qrArea:rl.array};Wu.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]};const QF=$g.create({baseURL:"https://cadi.onrender.com/",headers:{"Content-Type":"application/json"}}),TF=async(g,e)=>{try{return(await QF.post("alumno/asistencia/",{curp:g,ids_inscripciones:e})).data}catch(I){throw console.error("Error:",I.response?I.response.data:I.message),I}},DF=()=>{const[g,e]=d.useState(!1),[I,t]=d.useState(null);return{registrarAsistencia:async(l,n)=>{e(!0),t(null);try{return await TF(l,n)}catch(o){throw t(o),o}finally{e(!1)}},loading:g,error:I}},jF=()=>{const g=rt(),[e,I]=d.useState(!0),[t,C]=d.useState(null),[l,n]=d.useState([]),[o,r]=d.useState(null),{registrarAsistencia:a,loading:i,error:c}=DF(),A=async Z=>{if(Z&&Z.text){try{const h=JSON.parse(Z.text);Array.isArray(h.inscripciones)||(h.inscripciones=[]),C(h),console.log(h.inscripciones);const u=await a(h.curp,h.inscripciones);console.log(u),u.source&&r(u.source),n(u.mensajes)}catch(h){console.error("Error parsing JSON:",h)}I(!1),setTimeout(()=>{I(!0)},5e3)}},p=Z=>{console.error("QR code error:",Z)},G=()=>{I(!0),n([]),r(null),g("/asistencia")};return s.jsxs("div",{className:"scanner-wrapper",children:[s.jsxs("div",{className:"card-container",children:[s.jsx("h3",{children:"Datos del QR:"}),s.jsx("button",{onClick:G,className:"top-button",children:"Registrar sin credencial"}),i&&s.jsx("p",{children:"Registrando asistencia..."}),c&&s.jsxs("p",{children:["Error: ",c.message]}),l.length>0&&s.jsxs("div",{className:"response-cards",children:[o&&s.jsxs("div",{className:"image-container",children:[s.jsx("h4",{children:"Imagen del Alumno:"}),s.jsx("img",{src:o,alt:"Alumno",className:"alumno-image",style:{width:"150px",height:"auto"}})]}),l.map((Z,h)=>s.jsxs("div",{className:"response-card",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"ID Inscripción:"})," ",Z.idInscripcion]}),s.jsx("p",{children:Z.mensaje})]},h))]})]}),s.jsxs("div",{className:"scanner-section",children:[e&&s.jsxs("div",{className:"scanner-container",children:[s.jsx(Wu,{onScan:A,onError:p,style:{width:"100%",height:"100%"}}),s.jsx("div",{className:"qr-highlight"})," "]}),!e&&s.jsx("p",{children:"Escaneo exitoso. Reiniciando en 5 segundos..."})]})]})};function Sy(){const[g,e]=d.useState(!1),I=rt();return d.useEffect(()=>{const t=document.getElementById("menu_nav"),C=Array.from(document.querySelectorAll(".opcion"));t&&(g?(t.style.width="225px",t.style.paddingRight="10px",C.forEach(l=>{l.style.width="100%"})):(t.style.width="39px",C.forEach(l=>{l.style.width="36px"})))},[g]),s.jsxs("header",{className:"menu_banner",children:[s.jsxs("div",{className:"menu_logo",children:[s.jsx("span",{id:"menu",className:"menu",onClick:()=>{e(!g)},children:g?s.jsx(Vw,{}):s.jsx(kw,{})}),s.jsxs("span",{className:"identificador",onClick:()=>{I("/home")},children:[s.jsx("img",{className:"logo",src:"../../public/foto.png",alt:"Logo"}),s.jsx("h1",{className:"titulo_principal"})]})]}),s.jsx("div",{className:"cont_perfil",children:s.jsx(Je,{variant:"contained",startIcon:s.jsx(Rw,{}),onClick:async()=>{localStorage.clear(),I("/login")},children:"Cerrar sesión"})})]})}Sy.propTypes={mostrarBarraBusqueda:Er.bool.isRequired};const PF=()=>{const{username:g}=ko();return d.useEffect(()=>{if(!g)return;const e=g,I=new WebSocket(`wss://cadi.onrender.com/ws/notificaciones/${e}/`);return I.onopen=()=>{console.log("Conectado al WebSocket"),Notification.permission!=="granted"&&Notification.requestPermission()},I.onmessage=t=>{const C=JSON.parse(t.data);Notification.permission==="granted"&&new Notification("Notificación",{body:C.message,icon:"/public/foto.png"})},I.onclose=()=>{console.log("WebSocket cerrado")},()=>{I.close()}},[]),null};function OF(g){const e=document.querySelector(".opcion_seleccionada"),I=document.getElementById(g);e!=null&&e.classList.remove("opcion_seleccionada"),I!=null&&I.classList.add("opcion_seleccionada")}function qF(){const g=document.querySelector(".cuerpo_menu"),e=document.querySelector(".menu_banner");if(g){const I=e.offsetHeight,C=window.innerHeight-I-55;g.style.height=C+"px"}}function $F(){const{isAdmin:g,isAlumno:e}=ko(),I=[g&&s.jsx(Ot,{id:"registro",icon:s.jsx(Yw,{}),title:"Inscripciones",route:"/registroAlumno"},2),g&&s.jsx(Ot,{id:"Clases",icon:s.jsx(Hw,{}),title:"Clases",route:"/clase"},3),g&&s.jsx(Ot,{id:"llenado_cedula",icon:s.jsx(vw,{}),title:"Pagos",route:"/listaPagos"},4),g&&s.jsx(Ot,{id:"alumnos",icon:s.jsx(Xw,{}),title:"Alumno",route:"/listaAlumnos"},5),e&&s.jsx(Ot,{id:"credencial",icon:s.jsx(Sw,{}),title:"Credencial",route:"/credencial"},6),g&&s.jsx(Ot,{id:"Inscripciones",icon:s.jsx(Jw,{}),title:"Inscripciones",route:"/listarInscripciones"},7),g&&s.jsx(Ot,{id:"Paquetes",icon:s.jsx(Bw,{}),title:"Paquetes",route:"/listarPaquetes"},8),g&&s.jsx(Ot,{id:"TomarAsistencia",icon:s.jsx(Ww,{}),title:"Toma asistencia",route:"/leer"},9)].filter(Boolean);return d.useEffect(()=>{qF()},[]),s.jsxs(s.Fragment,{children:[s.jsx(Sy,{}),s.jsxs("main",{className:"menu_main",children:[s.jsx(PF,{})," ",s.jsx("nav",{className:"navbar",id:"menu_nav",children:I}),s.jsx("section",{className:"contenido_menu",children:s.jsx("div",{className:"cuerpo_menu",children:s.jsx(mV,{})})})]})]})}function Ot({id:g,icon:e,title:I,route:t}){const C=rt();return s.jsxs("span",{className:"navbar_item",id:g,onClick:()=>{OF(g),C(t)},children:[e,s.jsx("p",{children:I})]})}const _F=()=>s.jsxs("div",{className:"unauthorized-container",children:[s.jsx("h1",{children:"Acceso No Autorizado"}),s.jsx("p",{children:"Lo siento, no tienes permiso para acceder a esta página."}),s.jsx(KV,{to:"./home",children:"Volver a la página principal"})]}),g9=()=>s.jsxs("div",{className:"homepage-container",children:[s.jsx("h1",{children:"Bienvenido a CADI"}),s.jsx("p",{children:"Estamos encantados de tenerte aquí. Explora nuestras funciones y servicios."}),s.jsx("p",{children:"¡Disfruta tu experiencia!"})]});class wn extends Error{}wn.prototype.name="InvalidTokenError";function e9(g){return decodeURIComponent(atob(g).replace(/(.)/g,(e,I)=>{let t=I.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t}))}function I9(g){let e=g.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return e9(e)}catch{return atob(e)}}function t9(g,e){if(typeof g!="string")throw new wn("Invalid token specified: must be a string");e||(e={});const I=e.header===!0?0:1,t=g.split(".")[I];if(typeof t!="string")throw new wn(`Invalid token specified: missing part #${I+1}`);let C;try{C=I9(t)}catch(l){throw new wn(`Invalid token specified: invalid base64 for part #${I+1} (${l.message})`)}try{return JSON.parse(C)}catch(l){throw new wn(`Invalid token specified: invalid json for part #${I+1} (${l.message})`)}}const C9=()=>{const g=rt(),[e,I]=d.useState(""),[t,C]=d.useState(""),[l,n]=d.useState(""),{setTokens:o}=ko(),r=async a=>{if(a.preventDefault(),!e||!t){n("Todos los campos son obligatorios");return}n("");try{const i=await $g.post("https://cadi.onrender.com/",{username:e,password:t});console.log("Respuesta de la API:",i.data);const c=t9(i.data.access);console.log(c.user_id);const A=c.isAdmin,p=c.user_id;o(i.data.access,i.data.refresh,A,p),g("/home")}catch(i){console.error("Error en la solicitud:",i),n("Credenciales inválidas")}};return s.jsx("div",{className:"login-container",children:s.jsxs(Vt,{elevation:3,className:"login-form",children:[s.jsx(gI,{variant:"h4",component:"h1",className:"login-title",children:"Iniciar Sesión"}),l&&s.jsx(gI,{color:"error",children:l}),s.jsxs("form",{onSubmit:r,className:"form-content",children:[s.jsx(vg,{label:"Email",variant:"outlined",fullWidth:!0,margin:"normal",value:e,onChange:a=>I(a.target.value),className:"login-input"}),s.jsx(vg,{label:"Contraseña",variant:"outlined",type:"password",fullWidth:!0,margin:"normal",value:t,onChange:a=>C(a.target.value),className:"login-input"}),s.jsx(Je,{type:"submit",variant:"contained",color:"primary",className:"login-button",fullWidth:!0,children:"Entrar"})]})]})})},l9=SV([{path:"/",element:s.jsx($F,{}),children:[{path:"registroAlumno",element:s.jsx(Qe,{element:s.jsx(hw,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"listaAlumnos",element:s.jsx(Qe,{element:s.jsx(ww,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"inscripcion",element:s.jsx(Qe,{element:s.jsx(Nw,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"clase",element:s.jsx(Qe,{element:s.jsx(Kw,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"asistencia",element:s.jsx(Qe,{element:s.jsx(Uw,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"pagos/:curp/:idPago/:monto",element:s.jsx(Qe,{element:s.jsx(Lw,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"listaPagos",element:s.jsx(Qe,{element:s.jsx(Ow,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"crearPaquete/:idClase/:horario/:curp",element:s.jsx(Qe,{element:s.jsx(jw,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"listarInscripciones",element:s.jsx(Qe,{element:s.jsx(Pw,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"listarPaquetes",element:s.jsx(Qe,{element:s.jsx(qw,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"editarPaquete/:curp",element:s.jsx(Qe,{element:s.jsx($w,{}),isAuthenticatedRequired:!0})},{path:"leer",element:s.jsx(Qe,{element:s.jsx(jF,{}),isAuthenticatedRequired:!0,isAdminRequired:!0})},{path:"credencial",element:s.jsx(Qe,{element:s.jsx(mF,{}),isAuthenticatedRequired:!0})},{path:"/home",element:s.jsx(Qe,{element:s.jsx(g9,{}),isAuthenticatedRequired:!0})},{path:"/unauthorized",element:s.jsx(Qe,{element:s.jsx(_F,{}),isAuthenticatedRequired:!0})}]},{path:"login/",element:s.jsx(C9,{})}]),n9=()=>s.jsx(YV,{router:l9});r0(document.getElementById("root")).render(s.jsx(d.StrictMode,{children:s.jsx(n9,{})}));
